
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/paral_dfpt/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>paral_DFPT - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    
        <!-- Plotly support -->
        <script type="text/javascript" src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#parallelism-in-the-dfpt-formalism" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              paral_DFPT
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../variables/" class="md-tabs__link">
        Variables
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        Abitk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_15" type="checkbox" id="__nav_1_15" >
      
      <label class="md-nav__link" for="__nav_1_15">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_15">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        AtomCentered
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        CalcUJ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        GWR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        Install
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        NMR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basepar/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_crpa/" class="md-nav__link">
        cRPA U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lruj/" class="md-nav__link">
        Linear Response U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gwr_intro/" class="md-nav__link">
        GWR_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gwr1/" class="md-nav__link">
        GWR1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lw_quad/" class="md-nav__link">
        quadrupoles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_tdep_legacy/" class="md-nav__link">
        eph_tdep_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" checked>
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          paral_DFPT
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        paral_DFPT
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#atomic-displacements-homogeneous-electric-fields-strain" class="md-nav__link">
    Atomic displacements, homogeneous electric fields, strain.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-structure-of-the-parallelism-for-the-dfpt-part-of-abinit" class="md-nav__link">
    1 The structure of the parallelism for the DFPT part of ABINIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-computation-of-one-dynamical-matrix-q-025-0125-0125-for-fcc-aluminum" class="md-nav__link">
    2 Computation of one dynamical matrix (q =0.25 -0.125 0.125) for FCC aluminum
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-computation-of-one-perturbation-for-a-slab-of-29-atoms-of-barium-titanate" class="md-nav__link">
    3 Computation of one perturbation for a slab of 29 atoms of barium titanate
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        Troubleshooting (old-dokuwiki)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        Tuning (old-dokuwiki)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#atomic-displacements-homogeneous-electric-fields-strain" class="md-nav__link">
    Atomic displacements, homogeneous electric fields, strain.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-structure-of-the-parallelism-for-the-dfpt-part-of-abinit" class="md-nav__link">
    1 The structure of the parallelism for the DFPT part of ABINIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-computation-of-one-dynamical-matrix-q-025-0125-0125-for-fcc-aluminum" class="md-nav__link">
    2 Computation of one dynamical matrix (q =0.25 -0.125 0.125) for FCC aluminum
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-computation-of-one-perturbation-for-a-slab-of-29-atoms-of-barium-titanate" class="md-nav__link">
    3 Computation of one perturbation for a slab of 29 atoms of barium titanate
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/paral_dfpt.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="parallelism-in-the-dfpt-formalism">Parallelism in the DFPT formalism<a class="headerlink" href="#parallelism-in-the-dfpt-formalism" title="Permanent link">&para;</a></h1>
<h2 id="atomic-displacements-homogeneous-electric-fields-strain">Atomic displacements, homogeneous electric fields, strain.<a class="headerlink" href="#atomic-displacements-homogeneous-electric-fields-strain" title="Permanent link">&para;</a></h2>
<p>This tutorial aims at showing how to use the parallelism for all the properties
that are computed on the basis of the density-functional perturbation theory
(DFPT) part of ABINIT, i.e.:</p>
<ul>
<li>responses to atomic displacements (to compute phonon frequencies, band structures, &hellip; )</li>
<li>responses to homogeneous electric fields (dielectric constant, Born effective charges, Infra-red characteristics )</li>
<li>responses to strain (elastic constants, piezoelectric constants &hellip;)</li>
</ul>
<p>Such computations are realized when one of the input variables <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfphon">rfphon</a>,
<a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> or <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> are non-zero, which activates <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=1.
You are supposed to be well-familiarized with such calculations before starting
the present tutorial. See the <a href="/guide/respfn">respfn help file</a>, the input variables described in <a class="wikilink" href="/variables/dfpt">dfpt varset</a> and
the tutorial <a href="/tutorial/rf1">Response-Function 1</a> and subsequent tutorials.</p>
<p>You will learn about the basic implementation of parallelism for DFPT
calculations, then will execute a very simple, quick calculation for one
dynamical matrix for FCC aluminum, whose scaling is limited to a few dozen
computing cores, then you will execute a calculation whose scaling is much
better, but that would take a few hours in sequential, using a provided input file.</p>
<p>For the last section of that part, you would be better off having access
to more than 100 computing cores, although you might also change the input
parameters to adjust to the machine you have at hand. For the other parts of
the tutorial, a 16-computing-core machine is recommended, in order to perform
the scalability measurements.</p>
<p>You are supposed to know already some basics of parallelism in ABINIT,
explained in the tutorial <a href="/tutorial/basepar">A first introduction to ABINIT in parallel</a>.</p>
<p>This tutorial should take less than two hours to be done if a powerful parallel
computer is available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir <span class="c1"># Change this line</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>      <span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/             <span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> ~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="/tutorial/basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic on parallelism</a>.</p>
</div>
<h2 id="1-the-structure-of-the-parallelism-for-the-dfpt-part-of-abinit">1 The structure of the parallelism for the DFPT part of ABINIT<a class="headerlink" href="#1-the-structure-of-the-parallelism-for-the-dfpt-part-of-abinit" title="Permanent link">&para;</a></h2>
<p><strong>1.1.</strong> Let us recall first the basic structure of typical DFPT calculations summarized in box 1.</p>
<p><img alt="Schema 1" src="../paral_dfpt_assets/DFPT_Structure.png" /></p>
<p>The step 1 is done in a preliminary ground-state calculation (either by an
independent run, or by computing them using an earlier dataset before the DFPT calculation).
The parallelisation of this step is examined in a separate tutorial.</p>
<p>The step 2 and step 3 are the time-consuming DFPT steps, to which the present
tutorial is dedicated, and for which the implementation of the parallelism
will be explained. They generate different files, and in particular, one (or several) DDB file(s).
As explained in related tutorials (see e.g.
<a href="/tutorial/rf1">Response-Function 1</a>), several perturbations are usually treated in
one dataset (hence the &ldquo;Do for each perturbation&rdquo;-loop in step 2 of this
Schema). For example, in one dataset, although one considers only one phonon
wavevector, all the primitive atomic displacements for this wavevector (as
determined by the symmetries) can be treated in turn.</p>
<p>The step 4 refers to MRGDDB and ANADDB post-processing of the DDB generated by
steps 2 and 3. These are not time-consuming sections. No parallelism is needed.</p>
<p><strong>1.2.</strong> The equations to be considered for the computation of the first-order
wavefunctions and potentials (step 2 of box 1), which is the really time-consuming part
of any DFPT calculation, are presented in box 2.</p>
<p><img alt="Schema 2" src="../paral_dfpt_assets/DFPT_Equations.png" /></p>
<p>The parallelism currently implemented for the DFPT part of ABINIT is based on
the parallel distribution of the most important arrays: the set of first-order
and ground-state wavefunctions.
While each such wavefunction is stored completely in the memory linked to one
computing core (there is no splitting of different parts of one wavefunction
between different computing cores - neither in real space nor in reciprocal
space), different such wavefunctions might be distributed over different
computing cores. This easily achieves a combined k point, spin and band index
parallelism, as explained in box 3.</p>
<p><img alt="Schema 3" src="../paral_dfpt_assets/1WFs.png" /></p>
<p><strong>1.3.</strong> The parallelism over k points, band index and spin for the set of
wavefunctions is implemented in all relevant steps, except for the reading
(initialisation) of the ground-state wavefunctions (from an external file).
Thus, the most CPU time-consuming parts of the DFPT computations are parallelized.
The following are not parallelized:</p>
<ul>
<li>input of the set of ground-state wavefunctions</li>
<li>computing the first-order change of potential from the first-order density,
    and similar operations that do not depend on the bands or k points.</li>
</ul>
<p>In the case of small systems, the maximum achievable speed-up will be limited
by the input of the set of ground-state wavefunctions. For medium to large
systems, the maximum achievable speed-up will be determined by the operations
that do not depend on the k point and band indices.
Finally, the distribution of the set of ground-state wavefunctions to the
computing cores that need them is partly parallelized, as no parallelism over
bands can be exploited.</p>
<p><em>Before continuing you might work in a different subdirectory as for the other
tutorials. Why not work_paral_dfpt?</em></p>
<p>All the input files can be found in the <em>$ABI_TESTS/tutoparal/Input</em> directory.
You might have to adapt them to the path of the directory in which you have decided to perform your runs.
You can compare your results with reference output files located in <em>$ABI_TESTS/tutoparal/Refs</em>.</p>
<p>In the following, when &ldquo;(mpirun &hellip;) abinit&rdquo; appears, you have to use a
specific command line according to the operating system and architecture of
the computer you are using. This can be for instance: mpirun -np 16 abinit</p>
<h2 id="2-computation-of-one-dynamical-matrix-q-025-0125-0125-for-fcc-aluminum">2 Computation of one dynamical matrix (q =0.25 -0.125 0.125) for FCC aluminum<a class="headerlink" href="#2-computation-of-one-dynamical-matrix-q-025-0125-0125-for-fcc-aluminum" title="Permanent link">&para;</a></h2>
<p>We start by treating the case of a small systems, namely FCC aluminum, for
which there is only one atom per unit cell. Of course, many k points are needed, since this is a metal.</p>
<p><strong>2.1.</strong> The first step is the pre-computation of the ground state
wavefunctions. This is driven by the files <em>tdfpt_01.abi</em>.
You should edit it and examine it.</p>
<div class="text-center"><button id="uuid-5a105df6-7ab3-46c1-9ca9-237f972d3556" class="md-button md-button--secondary"> View tests/tutoparal/Input/tdfpt_01.abi </button></div>
<div id="uuid-d6806fd3-5e59-4876-8c52-229fab7bdb45" class="my_dialog" title="tests/tutoparal/Input/tdfpt_01.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#   FCC Al; 60 special points</span>

<span class="c1">#Definition of the unit cell</span>
 acell <span class="m">3</span>*7.56
 rprim   <span class="m">0</span> .5 .5  .5 <span class="m">0</span> .5  .5 .5 <span class="m">0</span>

<span class="c1">#Definition of the atom types and pseudopotentials</span>
 ntypat  <span class="m">1</span>
 znucl <span class="m">13</span>.0
 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>                 <span class="c1"># This is the path to the directory were pseudopotentials for tests are stored</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pw_standard_psp8/Al.psp8&quot;</span>  <span class="c1"># Name and location of the pseudopotential</span>

<span class="c1">#Definition of the atoms</span>
 natom  <span class="m">1</span>
 typat  <span class="m">1</span>  
 xred  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

<span class="c1">#Numerical parameters of the calculation : planewave basis set and k point grid</span>
 ecut <span class="m">10</span>
 ngkpt <span class="m">8</span> <span class="m">8</span> <span class="m">8</span> 
 nshiftk <span class="m">4</span>
 shiftk <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
        <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5

<span class="c1">#Parameters for the SCF procedure</span>
 nstep <span class="m">20</span>
 occopt <span class="m">4</span>
 tolvrs <span class="m">1</span>.0d-18
 nband <span class="m">5</span>

<span class="c1">#Needed for next calculation</span>
 prtden <span class="m">1</span>   

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tdfpt_01.abi, tdfpt_02.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% nprocs_to_test = 4</span>
<span class="c1">#%% [NCPU_4]</span>
<span class="c1">#%% files_to_test = tdfpt_01_MPI4.abo, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00</span>
<span class="c1">#%% post_commands =</span>
<span class="c1">#%%   ww_mv tdfpt_01_MPI4o_WFK tdfpt_02_MPI4i_WFK;</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = X. Gonze</span>
<span class="c1">#%% keywords =</span>
<span class="c1">#%% description = FCC Al linear response with k point parallelism </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-d6806fd3-5e59-4876-8c52-229fab7bdb45", "#uuid-5a105df6-7ab3-46c1-9ca9-237f972d3556") }); </script>

<p>One relies on a k-point grid of 8x8x8 x 4 shifts (=2048 k points), and 5 bands.
The k-point grid sampling is well converged, actually.
For this ground-state calculation, symmetries can be used to reduce
drastically the number of k points: there are 60 k points in the irreducible
Brillouin zone (this cannot be deduced from the examination of the input file, though).
In order to treat properly the phonon calculation, the number of bands is larger than the
default value, that would have given <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>=3. Indeed, several of the unoccupied bands 
plays a role in the response calculations in the case of metallic occupations.
For example, the acoustic sum rule might be largely violated when too few unoccopied 
bands are treated. </p>
<p>This calculation is very fast, actually.
You can launch it:</p>
<div class="codehilite"><pre><span></span><code>mpirun -n 4  abinit tdfpt_01.abi &gt; log &amp;
</code></pre></div>

<p>A reference output file is available in <em>$ABI_TESTS/tutoparal/Refs</em>, under
the name <em>tdfpt_01.abo</em>. It was obtained using 4 computing cores, and took a few seconds.</p>
<p><strong>2.2.</strong> The second step is the DFPT calculation, see the file <em>tdfpt_02.abi</em></p>
<div class="text-center"><button id="uuid-9d21da78-87c2-4940-8597-65ee4d123bae" class="md-button md-button--secondary"> View tests/tutoparal/Input/tdfpt_02.abi </button></div>
<div id="uuid-cf494f54-447d-4d0e-9510-969671becc4d" class="my_dialog" title="tests/tutoparal/Input/tdfpt_02.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#   FCC Al; ; phonon at 1/4 1/8 1/8</span>

<span class="c1">#Definition of DFPT calculation</span>
 rfphon <span class="m">1</span>
 nqpt   <span class="m">1</span>
 qpt    <span class="m">0</span>.25 -0.125 <span class="m">0</span>.125
 irdwfk <span class="m">1</span>

<span class="c1">#Timing parameters</span>
 prtvol <span class="m">10</span>
 timopt <span class="m">1</span>


<span class="c1">#Definition of the unit cell</span>
 acell <span class="m">3</span>*7.56
 rprim   <span class="m">0</span> .5 .5  .5 <span class="m">0</span> .5  .5 .5 <span class="m">0</span>

<span class="c1">#Definition of the atom types and pseudopotentials</span>
 ntypat  <span class="m">1</span>
 znucl <span class="m">13</span>.0
 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>                 <span class="c1"># This is the path to the directory were pseudopotentials for tests are stored</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pw_standard_psp8/Al.psp8&quot;</span>  <span class="c1"># Name and location of the pseudopotential</span>

<span class="c1">#Definition of the atoms</span>
 natom  <span class="m">1</span>
 typat  <span class="m">1</span>  
 xred  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

<span class="c1">#Numerical parameters of the calculation : planewave basis set and k point grid</span>
 ecut <span class="m">10</span>
 kptopt <span class="m">3</span>
 ngkpt <span class="m">8</span> <span class="m">8</span> <span class="m">8</span> 
 nshiftk <span class="m">4</span>
 shiftk <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
        <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5

<span class="c1">#Parameters for the SCF procedure</span>
 nstep <span class="m">20</span>
 occopt <span class="m">4</span>
 tolvrs <span class="m">1</span>.0d-10
 nband <span class="m">5</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tdfpt_01.abi, tdfpt_02.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% nprocs_to_test = 4</span>
<span class="c1">#%% [NCPU_4]</span>
<span class="c1">#%% files_to_test = tdfpt_02_MPI4.abo, tolnlines= 15, tolabs=  1.1e-05, tolrel=  1.5e-02</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = X. Gonze</span>
<span class="c1">#%% keywords =</span>
<span class="c1">#%% description = FCC Al linear response with k point parallelism</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-cf494f54-447d-4d0e-9510-969671becc4d", "#uuid-9d21da78-87c2-4940-8597-65ee4d123bae") }); </script>

<p>There are three perturbations (three atomic displacements). For the two first
perturbations, no symmetry can be used, while for the third, two symmetries
can be used to reduce the number of k points to 1024. Hence, for the perfectly
scalable sections of the code, the maximum speed up is 5120 (=1024 k points *
5 bands), if you have access to 5120 computing cores. However, the sequential
parts of the code dominate at a much, much lower value. Indeed, the sequential
parts is actually a few percents of the code on one processor, depending on
the machine you run. The speed-up might saturate beyond 8&hellip;16 (depending on
the machine). Note that the number of processors that you use for this second step
is independent of the number of processors that you used for the first step.
The only relevant information from the first step is the *_WFK file.</p>
<p>First copy the output of the ground-state calculation so that it can be used
as the input of the DFPT calculation:</p>
<div class="codehilite"><pre><span></span><code>cp tdfpt_01o_WFK tdfpt_02i_WFK
</code></pre></div>

<p>(A _WFQ file is not needed, as all GS wavefunctions at k+q are present in the GW wavefuction at k).
Then, you can launch the calculation:</p>
<div class="codehilite"><pre><span></span><code>mpirun -n 4 abinit tdfpt_02.abi &gt; tdfpt_02.log &amp;
</code></pre></div>

<p>A reference output file is given in <em>$ABI_TESTS/tutoparal/Refs</em>, under the name
<em>tdfpt_02.abo</em>. Edit it, and examine some information.
The calculation has been made with four computing cores:</p>
<div class="highlight"><pre><span></span><code>-   mpi_nproc: 4, omp_nthreads: -1 (-1 if OMP is not activated)
</code></pre></div>
<p>The wall clock time is less than 50 seconds :</p>
<div class="highlight"><pre><span></span><code>-
- Proc.   0 individual time (sec): cpu=         28.8  wall=         28.9

================================================================================

 Calculation completed.
.Delivered   0 WARNINGs and   0 COMMENTs to log file.
+Overall time at end (sec) : cpu=        115.4  wall=        115.8
</code></pre></div>
<p>The major result is the phonon frequencies:</p>
<div class="codehilite"><pre><span></span><code>  Phonon wavevector (reduced coordinates) :  0.25000 -0.12500  0.12500
 Phonon energies in Hartree :
   6.521506E-04  7.483301E-04  1.099648E-03
 Phonon frequencies in cm-1    :
-  1.431305E+02  1.642395E+02  2.413447E+02
</code></pre></div>

<p><strong>2.3.</strong> Because this test case is quite fast, you should play a bit with it.
In particular, run it several times, with an increasing number of computing
cores (let us say, up to 40 computing cores, at which stage you should have
obtained a saturation of the speed-up).
You should be able to obtain a decent speedup up to 8 processors, then the gain becomes more and more marginal.
Note however that the result is independent (to an exquisite accuracy) of the number of computing cores that is used</p>
<p>Let us explain the timing section. It is present a bit before the end of the output file:</p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span>
<span class="o">-</span> <span class="n">For</span> <span class="n">major</span> <span class="n">independent</span> <span class="n">code</span> <span class="n">sections</span><span class="p">,</span> <span class="n">cpu</span> <span class="n">and</span> <span class="n">wall</span> <span class="n">times</span> <span class="p">(</span><span class="n">sec</span><span class="p">),</span>
<span class="o">-</span>  <span class="n">as</span> <span class="n">well</span> <span class="n">as</span> <span class="err">%</span> <span class="n">of</span> <span class="n">the</span> <span class="n">time</span> <span class="n">and</span> <span class="n">number</span> <span class="n">of</span> <span class="n">calls</span> <span class="n">for</span> <span class="n">node</span> <span class="mi">0</span><span class="o">-</span>
<span class="o">-&lt;</span><span class="n">BEGIN_TIMER</span> <span class="n">mpi_nprocs</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">omp_nthreads</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mpi_rank</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
<span class="o">-</span> <span class="n">cpu_time</span> <span class="o">=</span>           <span class="mf">28.8</span><span class="p">,</span> <span class="n">wall_time</span> <span class="o">=</span>           <span class="mf">28.9</span>
<span class="o">-</span>
<span class="o">-</span> <span class="n">routine</span>                        <span class="n">cpu</span>     <span class="err">%</span>       <span class="n">wall</span>     <span class="err">%</span>      <span class="n">number</span> <span class="n">of</span> <span class="n">calls</span>  <span class="n">Gflops</span>    <span class="n">Speedup</span> <span class="n">Efficacity</span>
<span class="o">-</span>                                                                  <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">=</span><span class="n">no</span> <span class="n">count</span><span class="p">)</span>
<span class="o">-</span> <span class="n">fourwf</span><span class="err">%</span><span class="p">(</span><span class="n">pot</span><span class="p">)</span>                  <span class="mf">14.392</span>  <span class="mf">12.5</span>     <span class="mf">14.443</span>  <span class="mf">12.5</span>         <span class="mi">170048</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">nonlop</span><span class="p">(</span><span class="n">apply</span><span class="p">)</span>                  <span class="mf">2.787</span>   <span class="mf">2.4</span>      <span class="mf">2.802</span>   <span class="mf">2.4</span>         <span class="mi">125248</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">0.99</span>       <span class="mf">0.99</span>
<span class="o">-</span> <span class="n">nonlop</span><span class="p">(</span><span class="n">forces</span><span class="p">)</span>                 <span class="mf">2.609</span>   <span class="mf">2.3</span>      <span class="mf">2.620</span>   <span class="mf">2.3</span>          <span class="mi">64000</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">fourwf</span><span class="err">%</span><span class="p">(</span><span class="n">G</span><span class="o">-&gt;</span><span class="n">r</span><span class="p">)</span>                  <span class="mf">2.044</span>   <span class="mf">1.8</span>      <span class="mf">2.052</span>   <span class="mf">1.8</span>          <span class="mi">47124</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">dfpt_vtorho</span><span class="o">-</span><span class="n">kpt</span> <span class="n">loop</span>           <span class="mf">1.174</span>   <span class="mf">1.0</span>      <span class="mf">1.177</span>   <span class="mf">1.0</span>             <span class="mi">21</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">getgh1c_setup</span>                  <span class="mf">1.111</span>   <span class="mf">1.0</span>      <span class="mf">1.114</span>   <span class="mf">1.0</span>           <span class="mi">8960</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">mkffnl</span>                         <span class="mf">1.087</span>   <span class="mf">0.9</span>      <span class="mf">1.092</span>   <span class="mf">0.9</span>          <span class="mi">20992</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">projbd</span>                         <span class="mf">1.023</span>   <span class="mf">0.9</span>      <span class="mf">1.036</span>   <span class="mf">0.9</span>         <span class="mi">286336</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">0.99</span>       <span class="mf">0.99</span>
<span class="o">-</span> <span class="n">dfpt_vtowfk</span><span class="p">(</span><span class="n">contrib</span><span class="p">)</span>           <span class="mf">0.806</span>   <span class="mf">0.7</span>      <span class="mf">0.805</span>   <span class="mf">0.7</span>             <span class="o">-</span><span class="mi">1</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">others</span> <span class="p">(</span><span class="mi">120</span><span class="p">)</span>                  <span class="o">-</span><span class="mf">2.787</span>  <span class="o">-</span><span class="mf">2.4</span>     <span class="o">-</span><span class="mf">2.825</span>  <span class="o">-</span><span class="mf">2.4</span>             <span class="o">-</span><span class="mi">1</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">0.99</span>       <span class="mf">0.99</span>
<span class="o">-&lt;</span><span class="n">END_TIMER</span><span class="o">&gt;</span>
<span class="o">-</span>
<span class="o">-</span> <span class="n">subtotal</span>                      <span class="mf">24.246</span>  <span class="mf">21.0</span>     <span class="mf">24.317</span>  <span class="mf">21.0</span>                                  <span class="mf">1.00</span>       <span class="mf">1.00</span>

<span class="o">-</span> <span class="n">For</span> <span class="n">major</span> <span class="n">independent</span> <span class="n">code</span> <span class="n">sections</span><span class="p">,</span> <span class="n">cpu</span> <span class="n">and</span> <span class="n">wall</span> <span class="n">times</span> <span class="p">(</span><span class="n">sec</span><span class="p">),</span>
<span class="o">-</span> <span class="n">as</span> <span class="n">well</span> <span class="n">as</span> <span class="err">%</span> <span class="n">of</span> <span class="n">the</span> <span class="n">total</span> <span class="n">time</span> <span class="n">and</span> <span class="n">number</span> <span class="n">of</span> <span class="n">calls</span>

<span class="o">-&lt;</span><span class="n">BEGIN_TIMER</span> <span class="n">mpi_nprocs</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">omp_nthreads</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mpi_rank</span> <span class="o">=</span> <span class="n">world</span><span class="o">&gt;</span>
<span class="o">-</span> <span class="n">cpu_time</span> <span class="o">=</span>         <span class="mf">115.3</span><span class="p">,</span> <span class="n">wall_time</span> <span class="o">=</span>         <span class="mf">115.6</span>
<span class="o">-</span>
<span class="o">-</span> <span class="n">routine</span>                         <span class="n">cpu</span>     <span class="err">%</span>       <span class="n">wall</span>     <span class="err">%</span>      <span class="n">number</span> <span class="n">of</span> <span class="n">calls</span> <span class="n">Gflops</span>    <span class="n">Speedup</span> <span class="n">Efficacity</span>
<span class="o">-</span>                                                                  <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">=</span><span class="n">no</span> <span class="n">count</span><span class="p">)</span>
<span class="o">-</span> <span class="n">fourwf</span><span class="err">%</span><span class="p">(</span><span class="n">pot</span><span class="p">)</span>                  <span class="mf">51.717</span>  <span class="mf">44.8</span>     <span class="mf">51.909</span>  <span class="mf">44.9</span>         <span class="mi">679543</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">dfpt_vtorho</span><span class="p">:</span><span class="n">MPI</span>               <span class="mf">12.267</span>  <span class="mf">10.6</span>     <span class="mf">12.292</span>  <span class="mf">10.6</span>             <span class="mi">84</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">nonlop</span><span class="p">(</span><span class="n">apply</span><span class="p">)</span>                 <span class="mf">10.092</span>   <span class="mf">8.8</span>     <span class="mf">10.149</span>   <span class="mf">8.8</span>         <span class="mi">500343</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">0.99</span>       <span class="mf">0.99</span>
<span class="o">-</span> <span class="n">nonlop</span><span class="p">(</span><span class="n">forces</span><span class="p">)</span>                 <span class="mf">9.520</span>   <span class="mf">8.3</span>      <span class="mf">9.562</span>   <span class="mf">8.3</span>         <span class="mi">256000</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">fourwf</span><span class="err">%</span><span class="p">(</span><span class="n">G</span><span class="o">-&gt;</span><span class="n">r</span><span class="p">)</span>                  <span class="mf">7.367</span>   <span class="mf">6.4</span>      <span class="mf">7.398</span>   <span class="mf">6.4</span>         <span class="mi">187320</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">dfpt_vtorho</span><span class="o">-</span><span class="n">kpt</span> <span class="n">loop</span>           <span class="mf">4.182</span>   <span class="mf">3.6</span>      <span class="mf">4.193</span>   <span class="mf">3.6</span>             <span class="mi">84</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">getgh1c_setup</span>                  <span class="mf">3.955</span>   <span class="mf">3.4</span>      <span class="mf">3.967</span>   <span class="mf">3.4</span>          <span class="mi">35840</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">mkffnl</span>                         <span class="mf">3.911</span>   <span class="mf">3.4</span>      <span class="mf">3.929</span>   <span class="mf">3.4</span>          <span class="mi">83968</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">projbd</span>                         <span class="mf">3.735</span>   <span class="mf">3.2</span>      <span class="mf">3.780</span>   <span class="mf">3.3</span>        <span class="mi">1144046</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">0.99</span>       <span class="mf">0.99</span>
<span class="o">-</span> <span class="n">dfpt_vtowfk</span><span class="p">(</span><span class="n">contrib</span><span class="p">)</span>           <span class="mf">2.754</span>   <span class="mf">2.4</span>      <span class="mf">2.748</span>   <span class="mf">2.4</span>             <span class="o">-</span><span class="mi">4</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">getghc</span><span class="o">-</span><span class="n">other</span>                   <span class="mf">1.861</span>   <span class="mf">1.6</span>      <span class="mf">1.790</span>   <span class="mf">1.5</span>             <span class="o">-</span><span class="mi">4</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.04</span>       <span class="mf">1.04</span>
<span class="o">-</span> <span class="n">pspini</span>                         <span class="mf">0.861</span>   <span class="mf">0.7</span>      <span class="mf">0.865</span>   <span class="mf">0.7</span>              <span class="mi">4</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">0.99</span>       <span class="mf">0.99</span>
<span class="o">-</span> <span class="n">newkpt</span><span class="p">(</span><span class="n">excl</span><span class="p">.</span> <span class="n">rwwf</span>   <span class="p">)</span>          <span class="mf">0.754</span>   <span class="mf">0.7</span>      <span class="mf">0.757</span>   <span class="mf">0.7</span>             <span class="o">-</span><span class="mi">4</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">others</span> <span class="p">(</span><span class="mi">116</span><span class="p">)</span>                 <span class="o">-</span><span class="mf">14.132</span> <span class="o">-</span><span class="mf">12.3</span>    <span class="o">-</span><span class="mf">14.220</span> <span class="o">-</span><span class="mf">12.3</span>             <span class="o">-</span><span class="mi">1</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">0.99</span>       <span class="mf">0.99</span>
<span class="o">-&lt;</span><span class="n">END_TIMER</span><span class="o">&gt;</span>

<span class="o">-</span> <span class="n">subtotal</span>                      <span class="mf">98.845</span>  <span class="mf">85.7</span>     <span class="mf">99.120</span>  <span class="mf">85.7</span>                                  <span class="mf">1.00</span>       <span class="mf">1.00</span>
</code></pre></div>

<p>It is made of two groups of data. The first one corresponds to the analysis of
the timing for the computing core (node) number 0. The second one is the sum
over all computing cores of the data of the first group. Note that there is a
factor of four between these two groups, reflecting that the load balance is good.</p>
<p>Let us examine the second group of data in more detail. It corresponds to a
decomposition of the most time-consuming parts of the code. Note that the
subtotal is 85.7 percent, thus the statistics is not very accurate, as it should be close to 100%.
Actually, as of ABINIT v9, there is must be a bug in the timing decomposition, since, 
e.g. there is a negative time announced for the &ldquo;others&rdquo; subroutines.</p>
<p>Anyhow, several of the most time-consuming parts are directly related to application of the Hamiltonian to wavefunctions,
namely, fourwf%(pot) (application of the local potential, which implies two Fourier transforms), nonlop(apply) 
(application of the non-local part of the Hamiltonian), nonlop(forces) (computation of the non-local part of the
interatomic forces), fourwf%(G-&gt;r) (fourier transform needed to build the first-order density). Also, quite noticeable
is dfpt_vtorho:MPI , synchronisation of the MPI parallelism. </p>
<p>A study of the speed-up brought by the k-point parallelism for this simple test case
gives the following behaviour, between 1 and 40 cores:</p>
<div id="plotly_plot" style="width:90%;height:450px;"></div>
<script>
$(function() {
    Plotly.newPlot(document.getElementById('plotly_plot'), 
        [{ x: [1, 2, 4, 6, 8, 12, 16, 24, 32, 40], y: [1, 2, 4, 6, 8, 12, 16, 24, 32, 40], name: 'Ideal'},
         { x: [1, 2, 4, 6, 8, 12, 16, 24, 32, 40], y: [1, 1.92, 3.75, 5.50, 7.17, 9.34, 11.1, 14.4, 17.8, 19.7], name: 'Observed' }], 
        { title: "Parallel speed-up", 
          xaxis: {title:'Number of cores'} }
    );
});
</script>

<p>At 8 processors, one gets a speed-up of 7.17, which is quite decent (about 90% efficiency),
but 16 processors, the speed-up is only 11.1 (about 70% efficiency), and the efficiency is below 50% at 40 processors,
for a speed-up of 19.7 ..</p>
<h2 id="3-computation-of-one-perturbation-for-a-slab-of-29-atoms-of-barium-titanate">3 Computation of one perturbation for a slab of 29 atoms of barium titanate<a class="headerlink" href="#3-computation-of-one-perturbation-for-a-slab-of-29-atoms-of-barium-titanate" title="Permanent link">&para;</a></h2>
<p><strong>3.1.</strong> This test, with 29 atoms, is slower, but highlights other aspects 
of the DFPT parallelism than the Al FCC case. 
It consists in the computation of one perturbation at <a class="wikilink codevar-wikilink" href="/variables/gstate#qpt">qpt</a> 0.0 0.25
0.0 for a 29 atom slab of barium titanate, artificially terminated by a double
TiO<sub>2</sub> layer on each face, with a reasonable k-point sampling of the Brillouin zone.</p>
<p>The symmetry of the system and perturbation will allow to decrease this
sampling to one quarter of the Brillouin zone. E.g. with the k-point sampling
<a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> 4 4 1, there will be actually 4 k-points in the irreducible Brillouin
zone for the Ground state calculations. For the DFPT case, only one (binary) symmetry
will survive, so that, after the calculation of the frozen-wavefunction part
(for which no symmetry is used), the self-consistent part will be done with 8
k points in the corresponding irreducible Brillouin zone. Beyond 8 cores, the parallelisation
will be done also on the bands. This will prove to be much more dependent
on the computer architecture than the (low-communication) parallelism over k-points.</p>
<p>With the sampling 8 8 1, there will be 32 k points in the irreducible Brillouin zone for the DFPT
case. This will allow potentially to use efficiently a larger number of processors, provided the
computer architecture and network is good enough.</p>
<p>There are 116 occupied bands. For the ground state calculation, 4 additional conduction
bands will be explicitly treated, which will allow better SCF stability thanks to <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> 45.
Note that the value of <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> that is used in the
present tutorial is too low to obtain physical results (it should be around 40 Hartree).
Also, only one atomic displacement is considered, so that the phonon frequencies
delivered at the end of the run are meaningless.</p>
<p>As in the previous case, a preparatory ground-state calculation is needed.
We use the input variable <a class="wikilink codevar-wikilink" href="/variables/paral#autoparal">autoparal</a>=1 . It does not delivers the best repartition of
processors among <a class="wikilink codevar-wikilink" href="/variables/paral#np_spkpt">np_spkpt</a>, <a class="wikilink codevar-wikilink" href="/variables/paral#npband">npband</a> and <a class="wikilink codevar-wikilink" href="/variables/paral#npfft">npfft</a>, but achieves a decent repartition, usually within a factor of two.
With 24 processors, it selects <a class="wikilink codevar-wikilink" href="/variables/paral#np_spkpt">np_spkpt</a>=4 (optimal), <a class="wikilink codevar-wikilink" href="/variables/paral#npband">npband</a>=3 and <a class="wikilink codevar-wikilink" href="/variables/paral#npfft">npfft</a>=2, while <a class="wikilink codevar-wikilink" href="/variables/paral#npband">npband</a>=6 and <a class="wikilink codevar-wikilink" href="/variables/paral#npband">npband</a>=1 would do better.
For information, the speeup going from 24 cores to 64 cores is 1.76, not quite the increase of number of processor (2.76).
Anyhow, the topics of the tutorial is not the GS calculation.</p>
<p>The input files are provided, in the directory <em>$ABI_TESTS/tutoparal/Input</em>.
The preparatory step is driven by <em>tdfpt_03.abi</em>. The real
(=DFPT) test case is driven by <em>tdfpt_04.abi</em>. The
reference output files are present in <em>$ABI_TESTS/tutoparal/Refs</em>:
<em>tdfpt_03_MPI24.abo</em> and <em>tdfpt_04_MPI24.abo</em>. The naming convention is such that the
number of cores used to run them is added after the name of the test: the
<em>tdfpt_03.abi</em> files are run with 24 cores.
The preparatory step takes about 3 minutes, and the DFPT step takes about
3 minutes as well.</p>
<div class="text-center"><div class="btn-group-vertical">
<button id="uuid-4299a993-8b0e-411d-bac3-2747ad56fccb" class="md-button md-button--secondary"> View tests/tutoparal/Input/tdfpt_03.abi </button>
<button id="uuid-1e23fcec-dc8e-4854-9b4a-60e419d9bd8a" class="md-button md-button--secondary"> View tests/tutoparal/Input/tdfpt_04.abi </button>
</div></div>
<div id="uuid-ec3a9476-d007-4369-b4e4-b4b257494aff" class="my_dialog" title="tests/tutoparal/Input/tdfpt_03.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#SLAB ending TiO2 double layer</span>
<span class="c1"># N=9</span>
<span class="c1"># paralelectric configuration</span>

<span class="c1">#Parameters that govern parallelism</span>
paral_kgb <span class="m">1</span>
autoparal <span class="m">1</span>  <span class="c1"># This attempts to find a good distribution of processors. Actually, it is not optimal, but decent.</span>

<span class="c1">#Definition of the unit cell</span>
acell <span class="m">4</span>.0 <span class="m">4</span>.0 <span class="m">28</span>.0 Angstrom

<span class="c1">#Definition of the atom types and pseudopotentials</span>
ntypat <span class="m">3</span>
znucl <span class="m">56</span> <span class="m">22</span> <span class="m">8</span>
pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Pseudodojo_nc_sr_04_pw_standard_psp8&quot;</span>
pseudos <span class="s2">&quot;Ba.psp8, Ti.psp8, O.psp8&quot;</span>

<span class="c1">#Definition of the atoms</span>
natom <span class="m">29</span>
typat <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">1</span> <span class="m">3</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">1</span> <span class="m">3</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">1</span> <span class="m">3</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">1</span> <span class="m">3</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span>
            xcart      <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00 -4.2633349730E+00
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00 -3.2803418097E+00
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00 -3.6627278067E+00
                       <span class="m">3</span>.7794522658E+00  <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.5250113947E-01
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00 -1.0555036964E-01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.2682166278E-01
                       <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.9815918094E+00
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">4</span>.0167907030E+00
                       <span class="m">3</span>.7794522658E+00  <span class="m">0</span>.0000000000E+00  <span class="m">7</span>.7541444349E+00
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00  <span class="m">7</span>.6664087705E+00
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">7</span>.7182324796E+00
                       <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.1412913350E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">1</span>.1416615533E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.5117809063E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00  <span class="m">1</span>.5117809063E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">1</span>.5117809063E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.8822704777E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">1</span>.8819002593E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">0</span>.0000000000E+00  <span class="m">2</span>.2481473692E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00  <span class="m">2</span>.2569209355E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">2</span>.2517385647E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">2</span>.6254026317E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">2</span>.6218827423E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">0</span>.0000000000E+00  <span class="m">2</span>.9583116986E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.0341168496E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">2</span>.9908796464E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.4498953099E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.3515959935E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.3898345933E+01
chksymtnons <span class="m">0</span>  <span class="c1"># The position of the system is such that some symmetry operations have a non-symmorphic shift which </span>
               <span class="c1"># is not a simple fraction. This is not a problem for ABINIT, but this input variable must be activated.</span>

<span class="c1">#Numerical parameters of the calculation : planewave basis set and k point grid</span>
ecut <span class="m">15</span>.0
ngkpt <span class="m">4</span> <span class="m">4</span> <span class="m">1</span>
kptopt <span class="m">1</span>

<span class="c1">#Parameters for the SCF procedure</span>
nstep <span class="m">30</span>
tolvrs <span class="m">1</span>.0d-18 <span class="c1"># This value is much too small for production run (but was chosen to make this tutorial more portable accross platforms).  </span>
               <span class="c1"># A value 1.0d-12 is more reasonable. </span>
iprcel <span class="m">45</span>   <span class="c1"># This is to help the SCF procedure, work quite well in this case of a slab.</span>

<span class="c1">#Electronic structure</span>
nband <span class="m">120</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tdfpt_03.abi, tdfpt_04.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 24</span>
<span class="c1">#%% nprocs_to_test = 24</span>
<span class="c1">#%% [NCPU_24]</span>
<span class="c1">#%% files_to_test = tdfpt_03_MPI24.abo, tolnlines = 0, tolabs = 0.0, tolrel= 0.0</span>
<span class="c1">#%% post_commands = </span>
<span class="c1">#%%   ww_mv tdfpt_03_MPI24o_WFK tdfpt_04_MPI24i_WFK </span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% keywords = NC</span>
<span class="c1">#%% description = BaTiO3 linear response calculation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-ec3a9476-d007-4369-b4e4-b4b257494aff", "#uuid-4299a993-8b0e-411d-bac3-2747ad56fccb") }); </script>

<div id="uuid-0afe6eea-d259-40dc-87a0-0dc002d9429a" class="my_dialog" title="tests/tutoparal/Input/tdfpt_04.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#SLAB ending TiO2 double layer</span>
<span class="c1"># N=9</span>
<span class="c1"># paralelectric configuration</span>

<span class="c1">#Parameters for DFPT</span>
rfphon <span class="m">1</span>
irdwfk <span class="m">1</span>
rfatpol <span class="m">1</span> <span class="m">1</span>
rfdir <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
nqpt <span class="m">1</span>
qpt <span class="m">0</span>.0 <span class="m">0</span>.25  <span class="m">0</span>.0
<span class="c1">#prtwf 0</span>

timopt -2
kptopt <span class="m">3</span>
tolwfr <span class="m">1</span>.0d-18
tolrde <span class="m">0</span>.0 <span class="c1"># This is a development input variable, used in the present case to avoid load unbalance</span>
           <span class="c1"># when studying the scaling with respect to the number of cores. Do not define it in</span>
           <span class="c1"># your production runs</span>

<span class="c1">#Definition of the unit cell</span>
acell <span class="m">4</span>.0 <span class="m">4</span>.0 <span class="m">28</span>.0 Angstrom

<span class="c1">#Definition of the atom types and pseudopotentials</span>
ntypat <span class="m">3</span>
znucl <span class="m">56</span> <span class="m">22</span> <span class="m">8</span>
pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Pseudodojo_nc_sr_04_pw_standard_psp8&quot;</span>
pseudos <span class="s2">&quot;Ba.psp8, Ti.psp8, O.psp8&quot;</span>

<span class="c1">#Definition of the atoms</span>
natom <span class="m">29</span>
typat <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">1</span> <span class="m">3</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">1</span> <span class="m">3</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">1</span> <span class="m">3</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">1</span> <span class="m">3</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span> <span class="m">3</span> <span class="m">3</span> <span class="m">2</span>
            xcart      <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00 -4.2633349730E+00
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00 -3.2803418097E+00
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00 -3.6627278067E+00
                       <span class="m">3</span>.7794522658E+00  <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.5250113947E-01
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00 -1.0555036964E-01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.2682166278E-01
                       <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.9815918094E+00
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">4</span>.0167907030E+00
                       <span class="m">3</span>.7794522658E+00  <span class="m">0</span>.0000000000E+00  <span class="m">7</span>.7541444349E+00
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00  <span class="m">7</span>.6664087705E+00
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">7</span>.7182324796E+00
                       <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.1412913350E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">1</span>.1416615533E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.5117809063E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00  <span class="m">1</span>.5117809063E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">1</span>.5117809063E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.8822704777E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">1</span>.8819002593E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">0</span>.0000000000E+00  <span class="m">2</span>.2481473692E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00  <span class="m">2</span>.2569209355E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">2</span>.2517385647E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">2</span>.6254026317E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">2</span>.6218827423E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">0</span>.0000000000E+00  <span class="m">2</span>.9583116986E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.0341168496E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">2</span>.9908796464E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.4498953099E+01
                       <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.3515959935E+01
                       <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.7794522658E+00  <span class="m">3</span>.3898345933E+01
chksymtnons <span class="m">0</span>

<span class="c1">#Numerical parameters of the calculation : planewave basis set and k point grid</span>
ecut <span class="m">15</span>.0
ngkpt <span class="m">4</span> <span class="m">4</span> <span class="m">1</span>

<span class="c1">#Parameters for the SCF procedure</span>
nstep <span class="m">30</span>

<span class="c1">#Electronic structure</span>
nband <span class="m">116</span>    <span class="c1"># Only the occupied states - will ease the convergence</span>
<span class="c1">#prtden 0</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tdfpt_03.abi, tdfpt_04.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 24</span>
<span class="c1">#%% nprocs_to_test = 24</span>
<span class="c1">#%% [NCPU_24]</span>
<span class="c1">#%% files_to_test = tdfpt_04_MPI24.abo, tolnlines = 6, tolabs = 1e-07, tolrel= 0.01</span>
<span class="c1">#%% post_commands = </span>
<span class="c1">#%%   ww_mv tdfpt_03_MPI24o_WFK tdfpt_04_MPI24i_WFK</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% keywords = NC</span>
<span class="c1">#%% description = BaTiO3 linear response calculation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-0afe6eea-d259-40dc-87a0-0dc002d9429a", "#uuid-1e23fcec-dc8e-4854-9b4a-60e419d9bd8a") }); </script>

<p>You can run now these test cases. For tdfpt_03, with <a class="wikilink codevar-wikilink" href="/variables/paral#autoparal">autoparal</a>=1, 
you will be able to run on different numbers of processors compatible with <a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>=4,
<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>=120 and <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a>=[30 30 192], detected by ABINIT. Alternatively, you might decide to explicitly 
define <a class="wikilink codevar-wikilink" href="/variables/paral#np_spkpt">np_spkpt</a>, <a class="wikilink codevar-wikilink" href="/variables/paral#npband">npband</a> and <a class="wikilink codevar-wikilink" href="/variables/paral#npfft">npfft</a>.
At variance, for tdfpt_04, no adaptation of the input file is
needed to be able to run on an arbitrary number of processors.
To launch the ground-state computation, type:</p>
<div class="codehilite"><pre><span></span><code>mpirun -n 24 abinit tdfpt_03.abi &gt; log &amp;
</code></pre></div>

<p>then copy the output of the ground-state calculation so that it can be used as
the input of the DFPT calculation:</p>
<div class="codehilite"><pre><span></span><code>mv tdfpt_03o_WFK tdfpt_04i_WFK
</code></pre></div>

<p>and launch the calculation:</p>
<div class="codehilite"><pre><span></span><code>mpirun -n 24 abinit tdfpt_04.abi &gt; log &amp;
</code></pre></div>

<p>Now, examine the obtained output file for test 04, especially the timing.</p>
<p>In the reference file <em>$ABI_TESTS/tutoparal/Refs/tdfpt_04_MPI24.abo</em>,
with 24 computing cores, the timing section delivers:</p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span> <span class="n">For</span> <span class="n">major</span> <span class="n">independent</span> <span class="n">code</span> <span class="n">sections</span><span class="p">,</span> <span class="n">cpu</span> <span class="n">and</span> <span class="n">wall</span> <span class="n">times</span> <span class="p">(</span><span class="n">sec</span><span class="p">),</span>
<span class="o">-</span>  <span class="n">as</span> <span class="n">well</span> <span class="n">as</span> <span class="err">%</span> <span class="n">of</span> <span class="n">the</span> <span class="n">time</span> <span class="n">and</span> <span class="n">number</span> <span class="n">of</span> <span class="n">calls</span> <span class="n">for</span> <span class="n">node</span> <span class="mi">0</span><span class="o">-</span>
<span class="o">-&lt;</span><span class="n">BEGIN_TIMER</span> <span class="n">mpi_nprocs</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">omp_nthreads</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mpi_rank</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
<span class="o">-</span> <span class="n">cpu_time</span> <span class="o">=</span>          <span class="mf">159.9</span><span class="p">,</span> <span class="n">wall_time</span> <span class="o">=</span>          <span class="mf">160.0</span>
<span class="o">-</span>
<span class="o">-</span> <span class="n">routine</span>                        <span class="n">cpu</span>     <span class="err">%</span>       <span class="n">wall</span>     <span class="err">%</span>      <span class="n">number</span> <span class="n">of</span> <span class="n">calls</span>  <span class="n">Gflops</span>    <span class="n">Speedup</span> <span class="n">Efficacity</span>
<span class="o">-</span>                                                                  <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">=</span><span class="n">no</span> <span class="n">count</span><span class="p">)</span>
<span class="o">-</span> <span class="n">projbd</span>                        <span class="mf">46.305</span>   <span class="mf">1.2</span>     <span class="mf">46.345</span>   <span class="mf">1.2</span>          <span class="mi">11520</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">nonlop</span><span class="p">(</span><span class="n">apply</span><span class="p">)</span>                 <span class="mf">42.180</span>   <span class="mf">1.1</span>     <span class="mf">42.183</span>   <span class="mf">1.1</span>           <span class="mi">5760</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">dfpt_vtorho</span><span class="p">:</span><span class="n">MPI</span>               <span class="mf">25.087</span>   <span class="mf">0.7</span>     <span class="mf">25.085</span>   <span class="mf">0.7</span>             <span class="mi">30</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">fourwf</span><span class="err">%</span><span class="p">(</span><span class="n">pot</span><span class="p">)</span>                  <span class="mf">22.435</span>   <span class="mf">0.6</span>     <span class="mf">22.436</span>   <span class="mf">0.6</span>           <span class="mi">6930</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">nonlop</span><span class="p">(</span><span class="n">forces</span><span class="p">)</span>                 <span class="mf">5.485</span>   <span class="mf">0.1</span>      <span class="mf">5.486</span>   <span class="mf">0.1</span>           <span class="mi">4563</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">fourwf</span><span class="err">%</span><span class="p">(</span><span class="n">G</span><span class="o">-&gt;</span><span class="n">r</span><span class="p">)</span>                  <span class="mf">4.445</span>   <span class="mf">0.1</span>      <span class="mf">4.446</span>   <span class="mf">0.1</span>           <span class="mi">2340</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">pspini</span>                         <span class="mf">2.311</span>   <span class="mf">0.1</span>      <span class="mf">2.311</span>   <span class="mf">0.1</span>              <span class="mi">1</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>

<span class="o">&lt;</span><span class="p">...</span><span class="o">&gt;</span>

<span class="o">-</span> <span class="n">For</span> <span class="n">major</span> <span class="n">independent</span> <span class="n">code</span> <span class="n">sections</span><span class="p">,</span> <span class="n">cpu</span> <span class="n">and</span> <span class="n">wall</span> <span class="n">times</span> <span class="p">(</span><span class="n">sec</span><span class="p">),</span>
<span class="o">-</span> <span class="n">as</span> <span class="n">well</span> <span class="n">as</span> <span class="err">%</span> <span class="n">of</span> <span class="n">the</span> <span class="n">total</span> <span class="n">time</span> <span class="n">and</span> <span class="n">number</span> <span class="n">of</span> <span class="n">calls</span>

<span class="o">-&lt;</span><span class="n">BEGIN_TIMER</span> <span class="n">mpi_nprocs</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">omp_nthreads</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mpi_rank</span> <span class="o">=</span> <span class="n">world</span><span class="o">&gt;</span>
<span class="o">-</span> <span class="n">cpu_time</span> <span class="o">=</span>        <span class="mf">3826.4</span><span class="p">,</span> <span class="n">wall_time</span> <span class="o">=</span>        <span class="mf">3828.0</span>
<span class="o">-</span>
<span class="o">-</span> <span class="n">routine</span>                         <span class="n">cpu</span>     <span class="err">%</span>       <span class="n">wall</span>     <span class="err">%</span>      <span class="n">number</span> <span class="n">of</span> <span class="n">calls</span> <span class="n">Gflops</span>    <span class="n">Speedup</span> <span class="n">Efficacity</span>
<span class="o">-</span>                                                                  <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">=</span><span class="n">no</span> <span class="n">count</span><span class="p">)</span>
<span class="o">-</span> <span class="n">projbd</span>                      <span class="mf">1238.539</span>  <span class="mf">32.4</span>   <span class="mf">1239.573</span>  <span class="mf">32.4</span>         <span class="mi">278400</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">nonlop</span><span class="p">(</span><span class="n">apply</span><span class="p">)</span>               <span class="mf">1012.783</span>  <span class="mf">26.5</span>   <span class="mf">1012.982</span>  <span class="mf">26.5</span>         <span class="mi">139200</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">fourwf</span><span class="err">%</span><span class="p">(</span><span class="n">pot</span><span class="p">)</span>                 <span class="mf">544.047</span>  <span class="mf">14.2</span>    <span class="mf">544.201</span>  <span class="mf">14.2</span>         <span class="mi">167040</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">dfpt_vtorho</span><span class="p">:</span><span class="n">MPI</span>              <span class="mf">450.196</span>  <span class="mf">11.8</span>    <span class="mf">450.170</span>  <span class="mf">11.8</span>            <span class="mi">720</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">nonlop</span><span class="p">(</span><span class="n">forces</span><span class="p">)</span>               <span class="mf">131.081</span>   <span class="mf">3.4</span>    <span class="mf">131.129</span>   <span class="mf">3.4</span>         <span class="mi">108576</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">fourwf</span><span class="err">%</span><span class="p">(</span><span class="n">G</span><span class="o">-&gt;</span><span class="n">r</span><span class="p">)</span>                <span class="mf">107.885</span>   <span class="mf">2.8</span>    <span class="mf">107.930</span>   <span class="mf">2.8</span>          <span class="mi">55680</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>
<span class="o">-</span> <span class="n">pspini</span>                        <span class="mf">54.945</span>   <span class="mf">1.4</span>     <span class="mf">54.943</span>   <span class="mf">1.4</span>             <span class="mi">24</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">1.00</span>       <span class="mf">1.00</span>

<span class="o">&lt;</span><span class="p">...</span><span class="o">&gt;</span>

<span class="o">-</span> <span class="n">others</span> <span class="p">(</span><span class="mi">99</span><span class="p">)</span>                  <span class="o">-</span><span class="mf">98.669</span>  <span class="o">-</span><span class="mf">2.6</span>    <span class="o">-</span><span class="mf">99.848</span>  <span class="o">-</span><span class="mf">2.6</span>             <span class="o">-</span><span class="mi">1</span>      <span class="o">-</span><span class="mf">1.00</span>        <span class="mf">0.99</span>       <span class="mf">0.99</span>
<span class="o">-&lt;</span><span class="n">END_TIMER</span><span class="o">&gt;</span>

<span class="o">-</span> <span class="n">subtotal</span>                    <span class="mf">3569.873</span>  <span class="mf">93.3</span>   <span class="mf">3570.325</span>  <span class="mf">93.3</span>                                  <span class="mf">1.00</span>       <span class="mf">1.00</span>
</code></pre></div>

<p>You will notice that the run took about 160 seconds (wall clock time)..
The sum of the major independent code sections is reasonably
close to 100%. You might now explore the behaviour of the CPU time for
different numbers of compute cores (consider values below and above 24
processors). Some time-consuming routines will benefit from the parallelism, some other will not.</p>
<p>The kpoint + band parallelism will efficiently work for many important sections
of the code: projbd, fourwf%(pot), nonlop(apply), fourwf%(G-&gt;r).
In this test, the product nkpt (the effective number of k points for the current
perturbation) times nband is 8*120=960. Of course, the total speed-up will
saturate well below this value, as there are some non-parallelized sections of the code.</p>
<p>In the above-mentioned list, the kpoint+band parallelism cannot be exploited
(or is badly exploited) in several sections of the code : &ldquo;dfpt_vtorho:MPI&rdquo;,
about 12 percents of the total time of the run on 24 processors, &ldquo;pspini&rdquo;, about 1.4 percent. 
This amounts to about &#8539; of the total.
However, the scalability of the band parallelisation is rather poor, and effective saturation
in this case already happens at 16 processor.</p>
<p>A study of the speed-up brought by the combined k-point and band parallelism for this test case
on a 2 AMD EPYC 7502 machine (2 CPUS, each with 32 cores)
gives the following behaviour, between 1 and 40 cores:</p>
<div id="plotly_plot2" style="width:90%;height:450px;"></div>
<script>
$(function() {
    Plotly.newPlot(document.getElementById('plotly_plot2'), 
        [{ x: [1, 2, 4, 6, 8, 12, 16, 24, 32, 40], y: [1, 2, 4, 6, 8, 12, 16, 24, 32, 40], name: 'Ideal'},
         { x: [1, 2, 4, 6, 8, 12, 16, 24, 32, 40], y: [1, 1.97, 3.93, 3.86, 7.67, 7.53, 14.77, 16.44, 15.47, 14.37], name: 'Observed' }],
        { title: "Parallel speed-up", 
          xaxis: {title:'Number of cores'} }
    );
}); 
</script>

<p>The additional band parallelism is very efficient when running with 16 cores, bringing 14.77 speed-up,
while using only the k point parallelism, with 6 cores, gives 7.67 speed-up. However, the behaviour
is disappointing beyond 16 cores, or even for a number of processors which is not a multiple of 8.</p>
<p>Such a behaviour might be different on your machine.</p>
<p><strong>3.2.</strong> A better parallelism can be seen if the number of k-points is brought
back to a converged value (8x8x1). Again, 
Try this if you have more than 100 processors at hand.</p>
<p>Set in your input files <em>tdfpt_03.abi</em> and <em>tdfpt_04.abo</em> :</p>
<div class="codehilite"><pre><span></span><code>   ngkpt 8 8 1    ! This should replace ngkpt 4 4 1
</code></pre></div>

<p>and launch again the preliminary step, then the DFPT step. Then, you can
practice the DFPT calculation by varying the number of computing cores. For
the latter, you could even consider varying the number of self-consistent
iterations to see the initialisation effects (small value of nstep), or target
a value giving converged results (<a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a> 50 instead of <a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a> 18). The energy
cut-off might also be increased (e.g. <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> 40 Hartree gives a much better
value). Indeed, with a large value of k points, and large value of nstep, you
might be able to obtain a speed-up of more than one hundred for the DFPT
calculation, when compared to a sequential run (see below). Keep track of the
time for each computing core number, to observe the scaling.</p>
<p>On a machine with a good communication network, the following results were observed in 2011.
The Wall clock timing decreases from</p>
<div class="codehilite"><pre><span></span><code>- Proc.   0 individual time (sec): cpu=       2977.3  wall=       2977.3
</code></pre></div>

<p>with 16 processors to</p>
<div class="codehilite"><pre><span></span><code>- Proc.   0 individual time (sec): cpu=        513.2  wall=        513.2
</code></pre></div>

<p>with 128 processors.</p>
<p>The next figure presents the speed-up of a typical calculation with increasing
number of computing cores (also, the efficiency of the calculation).</p>
<p><img alt="Schema 1" src="../paral_dfpt_assets/Speedup.jpeg" /></p>
<p>Beyond 300 computing cores, the sequential parts of the code start to dominate.
With more realistic computing parameters (<a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> 40), they dominate only beyond 600 processors.</p>
<p>However, on the same (recent, but with slow connection beyond 32 cores) computer than for the <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> 4 4 1 case,
the saturation sets in already beyond 16 cores, with the following behaviour (the reference is taken with respect to the timing at 4 processors):</p>
<div id="plotly_plot3" style="width:90%;height:450px;"></div>
<script>
$(function() {
    Plotly.newPlot(document.getElementById('plotly_plot3'),
        [{ x: [1,4, 8, 12, 16, 24, 32, 40], y: [1, 4, 8, 12, 16, 24, 32, 40], name: 'Ideal'},
         { x: [4, 8, 12, 16, 24, 32, 40], y: [4, 7.86, 10.46, 14.92, 13.82, 16.15, 15.27], name: 'Observed' }],
        { title: "Parallel speed-up",
          xaxis: {title:'Number of cores'} }
    );
});
</script>

<p>Thus, it is very important that you gain some understanding of the scaling of your typical runs
for your particular computer, and that you know the parameters (especially <a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>) of your calculations. 
Up to 4 or 8 cores, the ABINIT scaling will usually be very good, if
k-point parallelism is possible. In the range between 10 and 100 cores, the speed-up might still be good,
but this will depend on details.</p>
<p>This last example is the end of the present tutorial. 
The basics of the current implementation of the parallelism for the DFPT part of ABINIT have been explained,
then you have explored two test cases: one for a small cell
materials, with lots of k points, and another one, medium-size, in which the k
point and band parallelism must be used. It might reveal efficient, but this will depend on the detail of your calculation
and your computer architecture.</p>
                
                  
                
              

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/"
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../paral_images/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              paral_images
            </div>
          </div>
        </a>
      
      
        <a href="../paral_mbt/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              paral_MBPT
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version b'10.2.3-dirty'</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
            (XG)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "b'10.2.3-dirty'"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>