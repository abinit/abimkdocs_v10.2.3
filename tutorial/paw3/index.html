
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/paw3/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>PAW3 - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#third-tutorial-on-the-projector-augmented-wave-paw-technique" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PAW3
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../variables/" class="md-tabs__link">
        Variables
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        Abitk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_15" type="checkbox" id="__nav_1_15" >
      
      <label class="md-nav__link" for="__nav_1_15">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_15">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        AtomCentered
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        CalcUJ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        GWR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        Install
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        NMR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basepar/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" checked>
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_crpa/" class="md-nav__link">
        cRPA U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lruj/" class="md-nav__link">
        Linear Response U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          PAW3
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        PAW3
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#testing-paw-datasets-against-an-all-electron-code" class="md-nav__link">
    Testing PAW datasets against an all-electron code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-introduction-the-quantities-to-be-compared" class="md-nav__link">
    1. Introduction - the quantities to be compared
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-prerequisites-code-components-and-scripts" class="md-nav__link">
    2. Prerequisites, code components and scripts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-carbon-diamond" class="md-nav__link">
    3. Carbon (diamond)
  </a>
  
    <nav class="md-nav" aria-label="3. Carbon (diamond)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-carbon-a-simple-datatset" class="md-nav__link">
    3.1. Carbon - a simple datatset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-carbon-calculating-the-equilibrium-lattice-parameter" class="md-nav__link">
    3.2. Carbon - calculating the equilibrium lattice parameter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-carbon-the-all-electron-calculation" class="md-nav__link">
    3.3. Carbon - the all-electron calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-carbon-improving-the-dataset" class="md-nav__link">
    3.4. Carbon - improving the dataset
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-magnesium-dealing-with-the-fermi-energy-of-a-metallic-system" class="md-nav__link">
    4. Magnesium - dealing with the Fermi energy of a metallic system
  </a>
  
    <nav class="md-nav" aria-label="4. Magnesium - dealing with the Fermi energy of a metallic system">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-magnesium-the-all-electron-calculation" class="md-nav__link">
    4.1. Magnesium - The all-electron calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-magnesium-the-abinit-calculation" class="md-nav__link">
    4.2. Magnesium - The ABINIT calculation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-paw-datasets-for-gw-calculations" class="md-nav__link">
    5. PAW datasets for GW calculations
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gwr_intro/" class="md-nav__link">
        GWR_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gwr1/" class="md-nav__link">
        GWR1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lw_quad/" class="md-nav__link">
        quadrupoles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_tdep_legacy/" class="md-nav__link">
        eph_tdep_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        Troubleshooting (old-dokuwiki)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        Tuning (old-dokuwiki)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#testing-paw-datasets-against-an-all-electron-code" class="md-nav__link">
    Testing PAW datasets against an all-electron code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-introduction-the-quantities-to-be-compared" class="md-nav__link">
    1. Introduction - the quantities to be compared
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-prerequisites-code-components-and-scripts" class="md-nav__link">
    2. Prerequisites, code components and scripts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-carbon-diamond" class="md-nav__link">
    3. Carbon (diamond)
  </a>
  
    <nav class="md-nav" aria-label="3. Carbon (diamond)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-carbon-a-simple-datatset" class="md-nav__link">
    3.1. Carbon - a simple datatset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-carbon-calculating-the-equilibrium-lattice-parameter" class="md-nav__link">
    3.2. Carbon - calculating the equilibrium lattice parameter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-carbon-the-all-electron-calculation" class="md-nav__link">
    3.3. Carbon - the all-electron calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-carbon-improving-the-dataset" class="md-nav__link">
    3.4. Carbon - improving the dataset
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-magnesium-dealing-with-the-fermi-energy-of-a-metallic-system" class="md-nav__link">
    4. Magnesium - dealing with the Fermi energy of a metallic system
  </a>
  
    <nav class="md-nav" aria-label="4. Magnesium - dealing with the Fermi energy of a metallic system">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-magnesium-the-all-electron-calculation" class="md-nav__link">
    4.1. Magnesium - The all-electron calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-magnesium-the-abinit-calculation" class="md-nav__link">
    4.2. Magnesium - The ABINIT calculation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-paw-datasets-for-gw-calculations" class="md-nav__link">
    5. PAW datasets for GW calculations
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/paw3.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="third-tutorial-on-the-projector-augmented-wave-paw-technique">Third tutorial on the Projector Augmented-Wave (PAW) technique<a class="headerlink" href="#third-tutorial-on-the-projector-augmented-wave-paw-technique" title="Permanent link">&para;</a></h1>
<h2 id="testing-paw-datasets-against-an-all-electron-code">Testing PAW datasets against an all-electron code<a class="headerlink" href="#testing-paw-datasets-against-an-all-electron-code" title="Permanent link">&para;</a></h2>
<p>This tutorial will demonstrate how to test a generated PAW dataset against an
all-electron code. We will be comparing results with the open <code>Elk</code> FP-LAPW code
(a branch of the <code>EXCITING</code> code) available under GPLv3.</p>
<p>You will learn how to compare calculations of the <em>equilibrium lattice</em>
parameter, the <em>Bulk modulus</em> and the <em>band structure</em> between <code>ABINIT</code> PAW results
and those from the <code>Elk</code> code.
It is assumed you already know how to use <code>ABINIT</code> in the PAW case. The tutorial
assumes no previous experience with the <code>Elk</code> code, but it is strongly advised
that the users familiarise themselves a bit with this code before attempting
to do similar comparisons with their own datasets.</p>
<p>This tutorial should take about 3h-4h.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir <span class="c1"># Change this line</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>      <span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/             <span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> ~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="/tutorial/basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic on parallelism</a>.</p>
</div>
<h2 id="1-introduction-the-quantities-to-be-compared">1. Introduction - the quantities to be compared<a class="headerlink" href="#1-introduction-the-quantities-to-be-compared" title="Permanent link">&para;</a></h2>
<p>When comparing results between all-electron and pseudopotential codes, it is
usually <strong>impossible to compare total energies</strong>. This is because the total energy
of an all-electron code includes the contribution from the <em>kinetic energy</em> of
the <em>core orbitals</em>, while in the pseudopotential approach, the only information
that is retained is the density distribution of the frozen core. This is
typically so even in a PAW implementation.</p>
<p>Differences in total energies should be comparable, but calculating these to a
given accuracy is usually a long and cumbersome process. However, some things
can be calculated with relative ease. These include structural properties -
such as the equilibrium lattice parameter(s) and the bulk modulus - as well as
orbital energies, i.e. the band structure for a simple bulk system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We are here aiming to compare the results under similar numerical
conditions. That does not necessarily mean that the calculations can be
compared with experimental results, nor that the results of the calculations
individually represent the absolutely most converged values for a given
system. However, to ensure that the numerical precision is equivalent, we must
take care to:</p>
<ul>
<li>Use the same (scalar-relativistic) exchange-correlation functional.</li>
<li>Match the <code>Elk</code> muffin-tin radii and the PAW cutoff radii.</li>
<li>Use a k-point grid of similar quality.</li>
<li>Use a similar cutoff for the plane wave expansion.</li>
<li>Freeze the core in the <code>Elk</code> code (whenever possible), to match the frozen PAW core in <code>ABINIT</code>.</li>
<li>Use a similar atomic on-site radial grid.</li>
</ul>
</div>
<p>We will use <strong>Carbon</strong>, in the <strong>diamond structure</strong>, as an example of a simple solid
with a band gap, and we will use <strong>Magnesium</strong> as an example of a metallic solid.
Naturally, it is important to keep things as simple as possible when
benchmarking PAW datasets, and there is a problem when the element has no
naturally occurring pure solid phase. For elements which are molecular in
their pure state (like Oxygen, Nitrogen and so forth), or occur only in
compound solids, one solution is to compare results on a larger range of
solids where the other constituents have already been well tested. For
instance, for oxygen, one could compare results for ZnO, MgO and MnO, provided
that one has already satisfied oneself that the datasets for Zn, Mg, and Mn in
their pure forms are good.</p>
<p>One could also compare results for molecules, and we encourage you to do this
if you have the time. However, doing this consistently in <code>ABINIT</code> requires a
supercell approach and would make this tutorial very long, so we shall not do
it here. We will now discuss the prerequisites for this tutorial.</p>
<h2 id="2-prerequisites-code-components-and-scripts">2. Prerequisites, code components and scripts<a class="headerlink" href="#2-prerequisites-code-components-and-scripts" title="Permanent link">&para;</a></h2>
<p>It is assumed that you are already familiar with the contents and procedures
in tutorials <a href="/tutorial/paw1">PAW1</a> and <a href="/tutorial/paw2">PAW2</a>, and so
have some familiarity with input files for  <code>ATOMPAW</code> , and the issues in creating
PAW datasets. To exactly reproduce the results in this tutorial, you will
need:</p>
<ul>
<li>The <code>ATOMPAW</code> code for generating PAW datasets (see tutorial <a href="/tutorial/paw2">PAW2</a>, section <strong>2.</strong>).</li>
</ul>
<div class="highlight"><pre><span></span><code>       <span class="nb">cd</span> atompaw-4.x.y.z
       mkdir build
       <span class="nb">cd</span> build
       ../configure
       make
</code></pre></div>
<ul>
<li>
<p>the <code>Elk</code> code (this tutorial was designed with v1.2.15),
    available <a href="https://sourceforge.net/projects/elk/files/">here</a>.
    We will use the <code>Elk</code> code itself, as well as its <code>eos</code> (equation-of-state) utility,
    for calculating equilibrium lattice parameters.</p>
</li>
<li>
<p>Auxiliary <code>bash</code> and <code>python</code> <em>scripts</em> for the comparison of band structures, available in the directory
    <em>$ABI_HOME/doc/tutorial/paw3_assets/scripts/</em>. For the <code>python</code> scripts, <code>python3</code> is required.
    There are also various <em>gnuplot</em> scripts there.</p>
</li>
</ul>
<p>You will of course also need a working copy of <code>ABINIT</code>. Please make sure that
the above components are downloaded and working on your system before
continuing this tutorial. The tutorial also makes extensive use of <a href="http://www.gnuplot.info/">gnuplot</a> , so
please also ensure that a recent and working version is installed on your system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By the time that you are doing this tutorial there will probably be
newer versions of all these programs available. It is of course better to use
the latest versions, and we simply state the versions of codes used when this
tutorial was written so that specific numerical results can be reproduced if necessary.</p>
</div>
<h2 id="3-carbon-diamond">3. Carbon (diamond)<a class="headerlink" href="#3-carbon-diamond" title="Permanent link">&para;</a></h2>
<h3 id="31-carbon-a-simple-datatset">3.1. Carbon - a simple datatset<a class="headerlink" href="#31-carbon-a-simple-datatset" title="Permanent link">&para;</a></h3>
<p>Make a <em>working directory</em> for the <code>ATOMPAW</code> generation (you could call it
<code>C_atompaw</code>) and copy the file: <a href="../paw3_assets/inputs/C_simple.input">C_simple.input</a> to it.</p>
<div class="text-center"><button id="uuid-f49bb382-ad80-4c54-ba8f-84933a1b4209" class="md-button md-button--secondary"> View tutorial/paw3_assets/inputs/C_simple.input </button></div>
<div id="uuid-d0416285-6c09-466c-b0b8-df5c6f3b38c6" class="my_dialog" title="tutorial/paw3_assets/inputs/C_simple.input" hidden><div><pre class="small-text">
C 6                                         ! Atomic name and number
LDA-PW scalarrelativistic loggrid 801 logderivrange -10 40 1000 ! XC approx., SE type, gridtype, # pts, logderiv
2 2 0 0 0 0                                 ! maximum n for each l: 2s,2p,0d,0f..
2 1 2                                       ! Partially filled shell: 2p^2
0 0 0                                       ! Stop marker
c                                           ! 1s - core
v                                           ! 2s - valence
v                                           ! 2p - valence
1                                           ! l_max treated = 1
1.3                                         ! core radius r_c
n                                           ! no more unoccupied s-states
n                                           ! no more unoccupied p-states
vanderbilt                                  ! vanderbilt scheme for finding projectors
2 0                                         ! localisation scheme
1.3                                         ! Core radius for occ. 2s state
1.3                                         ! Core radius for occ. 2p state
XMLOUT                                      ! Run atompaw2abinit converter
prtcorewf noxcnhat nospline noptim          ! XML conversion options
END                                         ! Exit

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-d0416285-6c09-466c-b0b8-df5c6f3b38c6", "#uuid-f49bb382-ad80-4c54-ba8f-84933a1b4209") }); </script>

<p>Then go there and run <code>ATOMPAW</code> by typing (assuming that you have set things up so that you
can run atompaw by just typing <code>atompaw</code>):</p>
<div class="codehilite"><pre><span></span><code>atompaw &lt; C_simple.input
</code></pre></div>

<p>The code should run, and if you do an <code>ls</code>, the contents of the directory will be something like:</p>
<div class="codehilite"><pre><span></span><code> C                        density     logderiv.2  potSC1   tprod.2  wfn2    wfnSC1
 C.LDA-PW-paw.xml         dummy       NC          rvf      vloc     wfn3
 C.LDA-PW-paw.xml.corewf  fort.24     OCCWFN      rVx      wfn001   wfn4
 compare.abinit           logderiv.0  potAE0      tau      wfn002   wfn5
 C_simple.input           logderiv.1  potential   tprod.1  wfn1     wfnAE0
</code></pre></div>

<p>There is a lot of output, so it is useful to work with a graphical overview.
Copy the <code>gnuplot</code> <em>script</em> <a href="../paw3_assets/scripts/plot_C_all.p">plot_C_all.p</a> to your folder.
Open a new terminal window by typing <code>xterm &amp;</code>, and run <code>gnuplot</code> in the new
terminal window. At the <code>gnuplot</code> command prompt type:</p>
<div class="codehilite"><pre><span></span><code><span class="n">gnuplot</span><span class="o">&gt;</span> <span class="nb">load</span> <span class="s1">&#39;plot_C_all.p&#39;</span>
</code></pre></div>

<p>You should get a plot that looks like this:</p>
<p><img alt="Plot of atompaw outputs" src="../paw3_assets/images/plot_C_all_1.png" /></p>
<p>You can now keep the <code>gnuplot</code> terminal and plot window open as you work, and if
you change the <code>ATOMPAW</code> input file and re-run it, you can update the plot by
retyping the <code>load..</code> command. The <code>gnuplot</code> window plots the essential
information from the <code>ATOMPAW</code> outputs, the logarithmic derivatives, (the
derivatives of the dataset are green), the wavefunctions and projectors for
each momentum channel (the full wavefunction is in red, the PW part is green,
and the projector is blue) as well as the local potential. Finally, it shows the Fourier transform
of the projector products (the x-axis is in units of Ha).</p>
<p>The inputs directory also contains scripts for plotting these graphs
individually, and you are encouraged to test and modify them. We can look
inside the <code>C_simple.input</code> file:</p>
<div class="text-center"><button id="uuid-89ed2f3a-561b-49ec-bc26-0fcaac299a2b" class="md-button md-button--secondary"> View tutorial/paw3_assets/inputs/C_simple.input </button></div>
<div id="uuid-926f219b-0d9d-462d-8c61-8af3bb8a6f46" class="my_dialog" title="tutorial/paw3_assets/inputs/C_simple.input" hidden><div><pre class="small-text">
C 6                                         ! Atomic name and number
LDA-PW scalarrelativistic loggrid 801 logderivrange -10 40 1000 ! XC approx., SE type, gridtype, # pts, logderiv
2 2 0 0 0 0                                 ! maximum n for each l: 2s,2p,0d,0f..
2 1 2                                       ! Partially filled shell: 2p^2
0 0 0                                       ! Stop marker
c                                           ! 1s - core
v                                           ! 2s - valence
v                                           ! 2p - valence
1                                           ! l_max treated = 1
1.3                                         ! core radius r_c
n                                           ! no more unoccupied s-states
n                                           ! no more unoccupied p-states
vanderbilt                                  ! vanderbilt scheme for finding projectors
2 0                                         ! localisation scheme
1.3                                         ! Core radius for occ. 2s state
1.3                                         ! Core radius for occ. 2p state
XMLOUT                                      ! Run atompaw2abinit converter
prtcorewf noxcnhat nospline noptim          ! XML conversion options
END                                         ! Exit

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-926f219b-0d9d-462d-8c61-8af3bb8a6f46", "#uuid-89ed2f3a-561b-49ec-bc26-0fcaac299a2b") }); </script>

<p>Here we see that the current dataset is very simple, it has no basis states
beyond the <span><span class="MathJax_Preview">2s</span><script type="math/tex">2s</script></span> and <span><span class="MathJax_Preview">2p</span><script type="math/tex">2p</script></span> occupied valence states in carbon. It is thus not
expected to produce very good results, since there is almost no flexibility in
the PAW dataset. Note that the <code>scalarrelativistic</code> option is turned on. While
this is not strictly necessary for such a light atom, we must always ensure to
have this turned on if we intend to compare with results from the <code>Elk</code> code.</p>
<p>We will now run basic convergence tests in <code>ABINIT</code> for this dataset. The
dataset file for <code>ABINIT</code> has already been generated (it is the <code>C.LDA-PW-paw.xml</code>
file in the current directory). Make a new subdirectory for the
test in the current directory (you could call it <code>abinit_test</code> for instance), go
there and copy the file: <a href="../paw3_assets/inputs/ab_C_test.abi">ab_C_test.abi</a> into
it. This <code>ABINIT</code> input file contains several datasets which increment the <code>ecut</code>
input variable, and perform ground state and band structure calculations for
each value of <code>ecut</code>. This is thus the internal <code>ABINIT</code> convergence study. Any
dataset is expected to converge to a result sooner or later, but that does not
mean that the final result is accurate, unless the dataset is good. The goal
is of course to generate a dataset which both converges quickly and is very accurate.  </p>
<div class="text-center"><button id="uuid-5b9fdcf7-782c-46de-b8e1-261e7bf94726" class="md-button md-button--secondary"> View tutorial/paw3_assets/inputs/ab_C_test.abi </button></div>
<div id="uuid-54dda640-2bd2-4168-8bff-bf0f1bcbfeb7" class="my_dialog" title="tutorial/paw3_assets/inputs/ab_C_test.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Input for PAW3 tutorial</span>
<span class="c1"># C - diamond structure</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Directories and files</span>

<span class="nv">pseudos</span><span class="o">=</span><span class="s2">&quot;C.LDA-PW-paw.xml&quot;</span>

<span class="nv">pp_dirpath</span><span class="o">=</span><span class="s2">&quot;../&quot;</span>
<span class="nv">outdata_prefix</span><span class="o">=</span><span class="s2">&quot;outputs/ab_C_test_o&quot;</span>
<span class="nv">tmpdata_prefix</span><span class="o">=</span><span class="s2">&quot;outputs/ab_C_test&quot;</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Define the different datasets</span>

ndtset <span class="m">18</span>       <span class="c1"># 18 double-index datasets</span>
udtset <span class="m">9</span> <span class="m">2</span>      <span class="c1"># 1st index running from 1 to 9 and the 2nd from 1 to 2</span>

<span class="c1">#Cutoff variables</span>
ecut:?  <span class="m">5</span>.0
ecut+?  <span class="m">5</span>.0
pawecutdg <span class="m">110</span>.0
ecutsm <span class="m">0</span>.5

<span class="c1">#Dataset 1</span>
<span class="c1">#Ground-state run</span>
chksymbreak <span class="m">0</span>
kptopt?1  <span class="m">1</span>
nshiftk?1 <span class="m">1</span>
shiftk?1  <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
ngkpt     <span class="m">10</span> <span class="m">10</span> <span class="m">10</span>
tolvrs?1 <span class="m">1</span>.0d-14
nstep?1  <span class="m">150</span>
getwfk21 <span class="m">11</span>
getwfk31 <span class="m">21</span>
getwfk41 <span class="m">31</span>
getwfk51 <span class="m">41</span>
getwfk61 <span class="m">51</span>
getwfk71 <span class="m">61</span>
getwfk81 <span class="m">71</span>
getwfk91 <span class="m">81</span>
nbdbuf?1 <span class="m">4</span>
nband?1  <span class="m">8</span>

<span class="c1">#Dataset 2</span>
<span class="c1">#Definition of the k-point grid</span>
<span class="c1">#the band structure</span>
iscf?2    -2
getden?2  -1
kptopt?2  -4
nband?2    <span class="m">8</span>
nbdbuf?2   <span class="m">0</span>
ndivk?2    <span class="m">8</span> <span class="m">10</span> <span class="m">6</span> <span class="m">10</span> <span class="c1"># divisions of the 6 segments</span>
kptbounds?2 
           <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="c1">#L</span>
           <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="c1">#Gamma</span>
           <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="c1">#X</span>
           <span class="m">0</span>.75 <span class="m">0</span>.5  <span class="m">0</span>.75 <span class="c1">#U</span>
           <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="c1">#Gamma</span>

tolwfr?2  <span class="m">1</span>.0d-18
enunit?2  <span class="m">0</span>             <span class="c1"># Will output the eigenenergies in Ha</span>
nstep?2 <span class="m">150</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Definition of the Unit cell</span>

<span class="c1">#Definition of the unit cell</span>
acell <span class="m">3</span>*6.7403
rprim
   <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0
   <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5
   <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5

<span class="c1">#Definition of the atom types</span>
ntypat <span class="m">1</span>          <span class="c1"># One tom type</span>
znucl <span class="m">6</span>           <span class="c1"># Carbon </span>

<span class="c1">#Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># 2 atoms per cell</span>
typat <span class="m">1</span> <span class="m">1</span>         <span class="c1"># each of type carbon</span>
xred              <span class="c1"># This keyword indicates that the location of the atoms</span>
                  <span class="c1"># will follow, one triplet of number for each atom</span>
   <span class="m">0</span>.125    <span class="m">0</span>.125    <span class="m">0</span>.125
  -0.125   -0.125   -0.125


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Miscelaneous</span>

<span class="c1">#GS convergence fix</span>
istwfk *1
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-54dda640-2bd2-4168-8bff-bf0f1bcbfeb7", "#uuid-5b9fdcf7-782c-46de-b8e1-261e7bf94726") }); </script>

<p>The <code>ab_C_test.abi</code> file contains:</p>
<div class="codehilite"><pre><span></span><code>pseudos=&quot;C.LDA-PW-paw.xml&quot;

pp_dirpath=&quot;../&quot;
outdata_prefix=&quot;outputs/ab_C_test_o&quot;
tmpdata_prefix=&quot;outputs/ab_C_test&quot;
</code></pre></div>

<p>So it expects the newly generated dataset to be in the directory above.
Also, to keep things tidy, it assumes the outputs will be put in a subdirectory
called <code>outputs/</code>. Make sure to create it before you start the <code>ABINIT</code> run by writing:</p>
<div class="codehilite"><pre><span></span><code>mkdir outputs
</code></pre></div>

<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You may have to change the path to reach the Psps_for_tests repository. For this, modify the varaible <code>pp_dirpath</code> in the input file. </p>
</div>
<p>You can now run the <code>ABINIT</code> tests (maybe even in a separate new <code>xterm</code> window), by executing:</p>
<div class="codehilite"><pre><span></span><code>abinit ab_C_test.abi &gt;&amp; log_C_test
</code></pre></div>

<p>There are 18 double-index datasets in total, with the first index running from
1 to 9 and the second from 1 to 2. You can check on the progress of the
calculation by issuing <code>ls outputs/</code>. When the <code>.._o_DS92..</code> files appear, the
calculation should be just about finished. While the calculation runs you
might want to take a look in the input file. Note the lines pertaining to the
increment in <code>ecut</code> (around line 29):</p>
<div class="codehilite"><pre><span></span><code> <span class="p">...</span>
 <span class="c1">#Cutoff variables</span>
 <span class="n">ecut</span><span class="o">:</span><span class="nv">?</span> <span class="mf">5.0</span>
 <span class="n">ecut</span><span class="o">+</span><span class="nv">?</span>  <span class="mf">5.0</span>
 <span class="n n-Quoted">`pawecutdg`</span> <span class="mf">110.0</span>
 <span class="n">ecutsm</span> <span class="mf">0.5</span>
 <span class="p">...</span>
</code></pre></div>

<p>ecut is increased in increments of 5 Ha from an initial value of 5, to a final
ecut of 45 Ha. Note that <code>pawecutdg</code> is kept fixed, at a value high enough to be
expected to be good for the final value of <code>ecut</code>. In principle, a convergence
study of <code>pawecutdg</code> should be performed as well, once a good value of <code>ecut</code> has been found.</p>
<p>We can now check the basic convergence attributes of the dataset. The
convergence of the total energy is easily checked by issuing some <code>grep</code> commands:</p>
<div class="codehilite"><pre><span></span><code> grep &#39;etotal&#39; ab_C_test.abo
</code></pre></div>

<p>This should give you an output similar to this (though not the text to the left):</p>
<div class="codehilite"><pre><span></span><code>                                     etotal   (ecut)
 etotal11 -1.0972441353E+01
 etotal21 -1.1443217299E+01      - 470.78 mHa (10 Ha)
 etotal31 -1.1507234681E+01      -  64.02 mHa (15 Ha)
 etotal41 -1.1517560274E+01      -  10.33 mHa (20 Ha)
 etotal51 -1.1518066800E+01      -   0.51 mHa (25 Ha)
 etotal61 -1.1518201844E+01      -   0.14 mHa (30 Ha)
 etotal71 -1.1518427967E+01      -   0.23 mHa (35 Ha)
 etotal81 -1.1518542165E+01      -   0.11 mHa (40 Ha)
 etotal91 -1.1518570692E+01      -   0.03 mHa (45 Ha)
</code></pre></div>

<p>Your values might differ slightly in the last decimals. The calculation of
diamond with the current PAW Carbon dataset converged to a precision of the
total energy below 1 mHa for a cutoff of about 25 Ha (this is not particularly
good for a PAW dataset). Also, the convergence is a bit jumpy after an <code>ecut</code> of
about 25 Ha, which is an indication of a) that the number of projectors per
angular momentum channel is low, and  b) that other parameters apart from ecut
dominate convergence beyond this point.</p>
<p>If we turn to the <em>band structure</em>, we can use the script
<a href="../paw3_assets/scripts/comp_bands_abinit2abinit.py">comp_bands_abinit2abinit.py</a>
to check the convergence of the band structure. Copy the script to the
directory where the <code>ABINIT</code> input file is and issue:</p>
<div class="codehilite"><pre><span></span><code> python comp_bands_abinit2abinit.py outputs/ab_C_test_o_DS12_EIG outputs/ab_C_test_o_DS92_EIG eV
</code></pre></div>

<p>This will print a long series of columns and at the end you will see:</p>
<div class="codehilite"><pre><span></span><code> <span class="p">...</span>
 <span class="c1">#        nvals:   280</span>
 <span class="c1"># average diff:     1.758809  eV</span>
 <span class="c1"># minimum diff:    -4.437905  eV</span>
 <span class="c1"># maximum diff:     1.089000  eV</span>
 <span class="c1">#</span>
 <span class="c1"># NOTE: `ABINIT` values are read in fixed format with five decimal</span>
 <span class="c1">#       places. For low values, four or three decimal figures</span>
 <span class="c1">#       may be the highest precision you can get.</span>
</code></pre></div>

<p>This provides you with some statistics of the difference in the band energies.
Specifically this is the average difference between a the band structure
calculated at an <code>ecut</code> of 5 Ha (in dataset 12) and another at an <code>ecut</code> of 45 Ha (in dataset 92).</p>
<p>The differences between these datasets are naturally very large, about 1.8 eV
on average, because the band-structure of the first dataset is far from
converged. The columns output before the statistics are arranged so that if
you pipe the output to a data file:</p>
<div class="codehilite"><pre><span></span><code> python comp_bands_abinit2abinit.py outputs/ab_C_test_o_DS12_EIG outputs/ab_C_test_o_DS92_EIG eV &gt; bands_5Ha_vs_45Ha.dat
</code></pre></div>

<p>you can plot the two band structures in <code>gnuplot</code> directly, by entering:</p>
<div class="codehilite"><pre><span></span><code> gnuplot&gt; plot &#39;bands_5Ha_vs_45Ha.dat&#39; u 1:2 w lp title &#39;5 Ha&#39;, &#39;bands_5Ha_vs_45Ha.dat&#39; u 1:3 w lp title &#39;45 Ha&#39;
</code></pre></div>

<p>This should furnish you with a graph that looks something like this:</p>
<p><img alt="Comparison of bands 5 vs. 45 Ha" src="../paw3_assets/images/plot_C_band_1.png" /></p>
<p>Not surprisingly, the band structures are very different. However, a search
through the datasets of increasing index (i.e. DS22, DS32, DS42, &hellip;) yields
that for dataset 42, i.e with an <code>ecut</code> of 20 Ha, we are already converged to a
level of 0.01 eV. Issuing the command:</p>
<div class="codehilite"><pre><span></span><code> python comp_bands_abinit2abinit.py outputs/ab_C_test_o_DS42_EIG outputs/ab_C_test_o_DS92_EIG eV &gt; bands_20Ha_vs_45Ha.dat
</code></pre></div>

<p>and plotting this with:</p>
<div class="codehilite"><pre><span></span><code> gnuplot&gt; plot &#39;bands_20Ha_vs_45Ha.dat&#39; u 1:2 w lp title &#39;20 Ha&#39;, &#39;bands_20Ha_vs_45Ha.dat&#39; u 1:3 w lp title &#39;45 Ha&#39;
</code></pre></div>

<p>Should give you a plot similar to this:</p>
<p><img alt="Comparison of bands 20 vs. 45 Ha" src="../paw3_assets/images/plot_C_band_2.png" /></p>
<p>You can convince yourself by zooming in that the band structures are very
similar. The statistics at the end of the bands_20Ha_vs_45Ha.dat  file shows
that we are converged within abinit:</p>
<div class="codehilite"><pre><span></span><code>...
#        nvals:   280
# average diff:     0.003808  eV
# minimum diff:    -0.008980  eV
# maximum diff:     0.000272  eV
...
</code></pre></div>

<h3 id="32-carbon-calculating-the-equilibrium-lattice-parameter">3.2. Carbon - calculating the equilibrium lattice parameter<a class="headerlink" href="#32-carbon-calculating-the-equilibrium-lattice-parameter" title="Permanent link">&para;</a></h3>
<p>That we have converged the dataset on its own does of course not mean that the
dataset is good, i.e. that it reproduces the same results as an all-electron
calculation. To independently verify that the dataset is good, we need to
calculate the equilibrium lattice parameter (and the <em>Bulk modulus</em>) and compare
this and the band structure with an <code>Elk</code> calculation.</p>
<p>First, we will need to calculate the total energy of diamond in <code>ABINIT</code> for a
number of lattice parameters around the minimum of the total energy. There is
example input file for doing this at:
<a href="../paw3_assets/inputs/ab_C_equi.abi">ab_C_equi.abi</a>.
The new input file has ten datasets which increment the lattice parameter, alatt,
from 6.1 to 7.0 Bohr in steps of 0.1 Bohr. A look in the input file will tell
you that <code>ecut</code> is set to 25 Hartrees. Copy these to your abinit_test directory and run:</p>
<div class="text-center"><button id="uuid-c8038d7f-8c87-4b1f-90cb-e0ebee5eb4bd" class="md-button md-button--secondary"> View tutorial/paw3_assets/inputs/ab_C_equi.abi </button></div>
<div id="uuid-436c730a-f0d5-499d-bcc3-52744b8303a3" class="my_dialog" title="tutorial/paw3_assets/inputs/ab_C_equi.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Input for PAW3 tutorial</span>
<span class="c1"># C - diamond structure</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Directories and files</span>

<span class="nv">pseudos</span><span class="o">=</span><span class="s2">&quot;C.LDA-PW-paw.xml&quot;</span>

<span class="nv">pp_dirpath</span><span class="o">=</span><span class="s2">&quot;../&quot;</span>
<span class="nv">outdata_prefix</span><span class="o">=</span><span class="s2">&quot;outputs/ab_C_equi_o&quot;</span>
<span class="nv">tmpdata_prefix</span><span class="o">=</span><span class="s2">&quot;outputs/ab_C_equi&quot;</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Define the different datasets</span>

ndtset <span class="m">10</span>            <span class="c1"># 10 datasets</span>
acell: <span class="m">3</span>*6.1  Bohr   <span class="c1"># The starting values of the cell parameters</span>
acell+ <span class="m">3</span>*0.1  Bohr   <span class="c1"># The increment of acell from one dataset to the other</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Convergence parameters</span>

<span class="c1">#Cutoff variables</span>
ecut <span class="m">25</span>.0
pawecutdg <span class="m">110</span>.0
ecutsm <span class="m">0</span>.5

<span class="c1">#Definition of the k-point grid</span>
chksymbreak <span class="m">0</span>
kptopt <span class="m">1</span>
nshiftk <span class="m">1</span>
shiftk <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
ngkpt <span class="m">10</span> <span class="m">10</span> <span class="m">10</span>

<span class="c1">#Bands and occupations</span>
nband  <span class="m">8</span>
nbdbuf <span class="m">4</span>

<span class="c1">#SCF cycle parameters</span>
tolvrs <span class="m">1</span>.0d-10
nstep  <span class="m">150</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Definition of the Unit cell</span>

<span class="c1">#Definition of the unit cell</span>
acell <span class="m">3</span>*6.7403
rprim
   <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0
   <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5
   <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5

<span class="c1">#Definition of the atom types</span>
ntypat <span class="m">1</span>          <span class="c1"># One tom type</span>
znucl <span class="m">6</span>           <span class="c1"># Carbon </span>

<span class="c1">#Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># 2 atoms per cell</span>
typat <span class="m">1</span> <span class="m">1</span>         <span class="c1"># each of type carbon</span>
xred              <span class="c1"># This keyword indicates that the location of the atoms</span>
                  <span class="c1"># will follow, one triplet of number for each atom</span>
   <span class="m">0</span>.125    <span class="m">0</span>.125    <span class="m">0</span>.125
  -0.125   -0.125   -0.125
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-436c730a-f0d5-499d-bcc3-52744b8303a3", "#uuid-c8038d7f-8c87-4b1f-90cb-e0ebee5eb4bd") }); </script>

<div class="codehilite"><pre><span></span><code>abinit ab_C_equi.abi &gt;&amp; log_C_equi
</code></pre></div>

<p>The run should be done fairly quickly, and when it&rsquo;s done we can check on the
volume and the total energy by using &ldquo;grep&rdquo;</p>
<div class="codehilite"><pre><span></span><code> grep &#39;volume&#39; log_C_equi
</code></pre></div>

<p>and</p>
<div class="codehilite"><pre><span></span><code> grep &#39;etotal&#39; log_C_equi
</code></pre></div>

<p>The outputs should be something like this:</p>
<div class="codehilite"><pre><span></span><code> <span class="kc">...</span>
 <span class="n">Unit</span> <span class="n">cell</span> <span class="n">volume</span> <span class="n">ucvol</span><span class="o">=</span>  <span class="m">5.6745250E+01</span> <span class="n">bohr</span><span class="o">^</span><span class="m">3</span>
 <span class="n">Unit</span> <span class="n">cell</span> <span class="n">volume</span> <span class="n">ucvol</span><span class="o">=</span>  <span class="m">5.9582000E+01</span> <span class="n">bohr</span><span class="o">^</span><span class="m">3</span>
 <span class="n">Unit</span> <span class="n">cell</span> <span class="n">volume</span> <span class="n">ucvol</span><span class="o">=</span>  <span class="m">6.2511750E+01</span> <span class="n">bohr</span><span class="o">^</span><span class="m">3</span>
 <span class="n">Unit</span> <span class="n">cell</span> <span class="n">volume</span> <span class="n">ucvol</span><span class="o">=</span>  <span class="m">6.5536000E+01</span> <span class="n">bohr</span><span class="o">^</span><span class="m">3</span>
 <span class="n">Unit</span> <span class="n">cell</span> <span class="n">volume</span> <span class="n">ucvol</span><span class="o">=</span>  <span class="m">6.8656250E+01</span> <span class="n">bohr</span><span class="o">^</span><span class="m">3</span>
 <span class="n">Unit</span> <span class="n">cell</span> <span class="n">volume</span> <span class="n">ucvol</span><span class="o">=</span>  <span class="m">7.1874000E+01</span> <span class="n">bohr</span><span class="o">^</span><span class="m">3</span>
 <span class="n">Unit</span> <span class="n">cell</span> <span class="n">volume</span> <span class="n">ucvol</span><span class="o">=</span>  <span class="m">7.5190750E+01</span> <span class="n">bohr</span><span class="o">^</span><span class="m">3</span>
 <span class="n">Unit</span> <span class="n">cell</span> <span class="n">volume</span> <span class="n">ucvol</span><span class="o">=</span>  <span class="m">7.8608000E+01</span> <span class="n">bohr</span><span class="o">^</span><span class="m">3</span>
 <span class="n">Unit</span> <span class="n">cell</span> <span class="n">volume</span> <span class="n">ucvol</span><span class="o">=</span>  <span class="m">8.2127250E+01</span> <span class="n">bohr</span><span class="o">^</span><span class="m">3</span>
 <span class="n">Unit</span> <span class="n">cell</span> <span class="n">volume</span> <span class="n">ucvol</span><span class="o">=</span>  <span class="m">8.5750000E+01</span> <span class="n">bohr</span><span class="o">^</span><span class="m">3</span>
 <span class="kc">...</span>  
       <span class="n">etotal1</span>    <span class="m">-1.1461991605E+01</span>
       <span class="n">etotal2</span>    <span class="m">-1.1480508012E+01</span>
       <span class="n">etotal3</span>    <span class="m">-1.1494820912E+01</span>
       <span class="n">etotal4</span>    <span class="m">-1.1505365819E+01</span>
       <span class="n">etotal5</span>    <span class="m">-1.1512537944E+01</span>
       <span class="n">etotal6</span>    <span class="m">-1.1516696065E+01</span>   <span class="o">&lt;-</span>
       <span class="n">etotal7</span>    <span class="m">-1.1518166172E+01</span>   <span class="o">&lt;-</span> <span class="n">minimum</span> <span class="n">around</span> <span class="n">here</span>
       <span class="n">etotal8</span>    <span class="m">-1.1517244861E+01</span>   <span class="o">&lt;-</span>
       <span class="n">etotal9</span>    <span class="m">-1.1514202226E+01</span>
       <span class="n">etotal10</span>   <span class="m">-1.1509284702E+01</span>
 <span class="kc">...</span>
</code></pre></div>

<p>If we examine the <code>etotal</code> values, the total energy does indeed go to a
minimum, and we also see that given the magnitude of the variations of the
total energy, an <code>ecut</code> of 25 Ha should be more than sufficient. We will now
extract the equilibrium volume and bulk modulus by using the eos bundled with
elk. This requires us to put the above data in an <code>eos.in</code> file. Create such a
file with your favorite editor and enter the following five lines and then the
data you just extracted:</p>
<div class="codehilite"><pre><span></span><code> <span class="s2">&quot;</span><span class="s">C - Diamond</span><span class="s2">&quot;</span>                : <span class="nv">cname</span> <span class="o">-</span> <span class="nv">name</span> <span class="nv">of</span> <span class="nv">material</span>
 <span class="mi">2</span>                            : <span class="nv">natoms</span> <span class="o">-</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">atoms</span>
 <span class="mi">1</span>                            : <span class="nv">etype</span> <span class="o">-</span> <span class="nv">equation</span> <span class="nv">of</span> <span class="nv">state</span> <span class="nv">fit</span> <span class="nv">type</span>
 <span class="mi">50</span>.<span class="mi">0</span> <span class="mi">95</span>.<span class="mi">0</span> <span class="mi">100</span>                : <span class="nv">vplt1</span>, <span class="nv">vplt2</span>, <span class="nv">nvplt</span> <span class="o">-</span> <span class="nv">start</span>, <span class="k">end</span> <span class="nv">and</span> #<span class="nv">pts</span> <span class="k">for</span> <span class="nv">fit</span>
 <span class="mi">10</span>                            : <span class="nv">nevpt</span> <span class="o">-</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">supplied</span> <span class="nv">points</span>
 <span class="mi">5</span>.<span class="mi">6745250</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1461991605</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">5</span>.<span class="mi">9582000</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1480508012</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">6</span>.<span class="mi">2511750</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1494820912</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">6</span>.<span class="mi">5536000</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1505365819</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">6</span>.<span class="mi">8656250</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1512537944</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">7</span>.<span class="mi">1874000</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1516696065</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">7</span>.<span class="mi">5190750</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1518166172</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">7</span>.<span class="mi">8608000</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1517244861</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">8</span>.<span class="mi">2127250</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1514202226</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">8</span>.<span class="mi">5750000</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1509284702</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
</code></pre></div>

<p>When you run <code>eos</code> (the executable should be located in <code>src/eos/</code> in the
directory where <code>Elk</code> was compiled), it will produce several  <code>.OUT</code> files. The
file <code>PARAM.OUT</code> contains the information we need:</p>
<div class="codehilite"><pre><span></span><code> C - Diamond

 Universal EOS
 Vinet P et al., J. Phys.: Condens. Matter 1, p1941 (1989)

 (Default units are atomic: Hartree, Bohr etc.)

 V0                =            75.50730327    
 E0                =           -11.51817590    
 B0                =           0.1564766690E-01
 B0&#39;               =            3.685291965

 B0 (GPa)          =            460.3701770
</code></pre></div>

<p>This tells us the equilibrium volume and bulk modulus. The volume of our
diamond FCC lattice depends on the lattice parameter as: <span><span class="MathJax_Preview">\frac{a^3}{4}</span><script type="math/tex">\frac{a^3}{4}</script></span>. If we want to
convert the volume to a lattice parameter, we have to multiply by four and
then take the third root, so:</p>
<div class="codehilite"><pre><span></span><code>alatt = (4*75.50730327)^(1/3) = 6.7094 Bohr (3.5505 Å)
</code></pre></div>

<p>at equilibrium for this dataset.</p>
<h3 id="33-carbon-the-all-electron-calculation">3.3. Carbon - the all-electron calculation<a class="headerlink" href="#33-carbon-the-all-electron-calculation" title="Permanent link">&para;</a></h3>
<p>In order to estimate whether these values are good or not, we need independent
verification, and this will be provided by the all-electron <code>Elk</code> code. There is
an <code>Elk</code> input file matching our <code>ABINIT</code> diamond calculation at
<a href="../paw3_assets/inputs/elk_C_diamond.in">elk_C_diamond.in</a>. You need
to copy this file to a directory set up for the <code>Elk</code> run (why not call it
<code>C_elk</code>), and it needs to be renamed to <code>elk.in</code>, which is the required input
name for an <code>Elk</code> calculation. We are now ready to run the <code>Elk</code> code for the first time.</p>
<p>If we take a look in the <code>elk.in</code> file, at the beginning we will see the lines:</p>
<div class="codehilite"><pre><span></span><code> ! Carbon, diamond structure (FCC)

 ! The tasks keyword defines what will be done by the code:
 ! 0 - Perform ground-state calculation from scratch
 ! 1 - Restart GS calc. from STATE.OUT file
 ! 20 - Calculate band structure as defined by plot1d
 tasks
 0
 20

 ! Set core-valence cutoff energy
 ecvcut
  -6.0

 ! Construct atomic species file &#39;C.in&#39;
 species
  6  : atomic number
  &#39;C&#39;
  &#39;carbon&#39;
  21894.16673    : atomic mass
  1.300000000    : muffin-tin radius
  4              : number of occ. states
  1   0   1   2  : 1s
  2   0   1   2  : 2s
  2   1   1   1  : 2p m=1
  2   1   2   1  : 2p m=2
...
</code></pre></div>

<div class="text-center"><button id="uuid-16710d4b-1069-4ffa-9dcd-df3d3a1d50f0" class="md-button md-button--secondary"> View tutorial/paw3_assets/inputs/elk_C_diamond.in </button></div>
<div id="uuid-5773d7ad-673b-4a09-852c-d8a01d0e9f08" class="my_dialog" title="tutorial/paw3_assets/inputs/elk_C_diamond.in" hidden><div><div class="codehilite small-text"><pre><span></span>! Carbon, diamond structure <span class="o">(</span>FCC<span class="o">)</span>

! The tasks define what will be <span class="k">done</span> by the code:
! <span class="m">0</span> - Perform ground-state calculation from scratch
! <span class="m">1</span> - Restart GS calc. from STATE.OUT file
! <span class="m">20</span> - Calculate band structure as defined by plot1d
tasks
<span class="m">0</span>
<span class="m">20</span>

! Set core-valence cutoff energy
ecvcut
 -6.0

! Construct atomic species file <span class="s1">&#39;C.in&#39;</span>
! <span class="o">(</span>comment this <span class="k">if</span> you hve modified <span class="s1">&#39;C.in&#39;</span><span class="o">)</span>
species
   <span class="m">6</span>  : atomic number
 <span class="s1">&#39;C&#39;</span>
 <span class="s1">&#39;carbon&#39;</span> 
   <span class="m">21894</span>.16673    : atomic mass
   <span class="m">1</span>.300000000    : muffin-tin radius
   <span class="m">4</span>              : number of occ. states
   <span class="m">1</span>   <span class="m">0</span>   <span class="m">1</span>   <span class="m">2</span>  : 1s
   <span class="m">2</span>   <span class="m">0</span>   <span class="m">1</span>   <span class="m">2</span>  : 2s
   <span class="m">2</span>   <span class="m">1</span>   <span class="m">1</span>   <span class="m">1</span>  : 2p <span class="nv">m</span><span class="o">=</span><span class="m">1</span>
   <span class="m">2</span>   <span class="m">1</span>   <span class="m">2</span>   <span class="m">1</span>  : 2p <span class="nv">m</span><span class="o">=</span><span class="m">2</span>

! Tolerance on convegence of band energies <span class="o">(</span>absolute<span class="o">)</span>
epsband
 <span class="m">1</span>.e-8

! Tolerance on conv. of potential <span class="o">(</span>relative<span class="o">)</span>
epspot
 <span class="m">1</span>.e-8

! Tolerance on conv. of total energy <span class="o">(</span>absolute<span class="o">)</span>
epsengy
 <span class="m">1</span>.e-6

! Use adaptive linear mixing of densities
! <span class="m">1</span> - Adaptive linear
! <span class="m">2</span> - Pulay mixing
mixtype
 <span class="m">3</span>

! Exchange-correlation functional to use
! LDA <span class="o">(</span>PW92<span class="o">)</span> is <span class="m">3</span> <span class="o">(</span>default<span class="o">)</span> <span class="o">(</span>equiv. Abinit ixc <span class="m">7</span><span class="o">)</span>
! GGA-PBE    is <span class="m">20</span>          <span class="o">(</span>equiv. Abinit ixc <span class="m">11</span><span class="o">)</span>
! <span class="o">(</span>see Elk manual <span class="k">for</span> other options<span class="o">)</span>
xctype
 <span class="m">3</span>

! Define lattice vectors <span class="o">(</span>FCC diamond has an
! experimental lattice parameter of <span class="m">3</span>.567 angstrom<span class="o">)</span>
scale
 <span class="m">6</span>.7403 : lattice parameter <span class="k">in</span> Bohr

avec
     <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0
     <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5
     <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5

! Define atomic species
atoms
   <span class="m">1</span>   : nspecies - Number of species
<span class="s1">&#39;C.in&#39;</span> : spfname - Name of species file
   <span class="m">2</span>   : natoms<span class="p">;</span> atposl, bfcmt below - Atoms <span class="k">in</span> cell, reduced coord. and moments
    <span class="m">0</span>.00000000    <span class="m">0</span>.00000000    <span class="m">0</span>.0000000    <span class="m">0</span>.00000000  <span class="m">0</span>.00000000  <span class="m">0</span>.00000000
    <span class="m">0</span>.25000000    <span class="m">0</span>.25000000    <span class="m">0</span>.2500000    <span class="m">0</span>.00000000  <span class="m">0</span>.00000000  <span class="m">0</span>.00000000

! Set muffin-tin radius automatically
autormt
 .false.

! Freeze core states <span class="o">(</span><span class="k">in</span> abinit PAW, they are frozen<span class="o">)</span>
frozencr
 .true.

! Path to atomic data files
sppath
  <span class="s1">&#39;./&#39;</span>

! Monkhorst-pack k-point grid
ngridk
 <span class="m">9</span>  <span class="m">9</span>  <span class="m">9</span>

! Shift of MP grid
vkloff
<span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5

! Set upper limit of <span class="p">|</span>G+k<span class="p">|</span>, the number below is
! <span class="o">(</span>MT radius<span class="o">)</span>*max<span class="o">(</span><span class="p">|</span>G+k<span class="p">|</span><span class="o">)</span>
rgkmax
<span class="m">8</span>.0

! A value of <span class="m">0</span>.0 makes this being <span class="nb">set</span> automatically
gmaxvr
<span class="m">0</span>.0

! k-points <span class="k">in</span> band plot <span class="o">(</span>this is copied from the k-point list
! reported by ABINIT <span class="k">in</span> oreder to have a one-to-one correspondence<span class="o">)</span>
plot1d
<span class="m">35</span> <span class="m">35</span>  : nvp1d, npp1d
                     <span class="m">5</span>.00000000E-01  <span class="m">5</span>.00000000E-01  <span class="m">5</span>.00000000E-01
                     <span class="m">4</span>.37500000E-01  <span class="m">4</span>.37500000E-01  <span class="m">4</span>.37500000E-01
                     <span class="m">3</span>.75000000E-01  <span class="m">3</span>.75000000E-01  <span class="m">3</span>.75000000E-01
                     <span class="m">3</span>.12500000E-01  <span class="m">3</span>.12500000E-01  <span class="m">3</span>.12500000E-01
                     <span class="m">2</span>.50000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">2</span>.50000000E-01
                     <span class="m">1</span>.87500000E-01  <span class="m">1</span>.87500000E-01  <span class="m">1</span>.87500000E-01
                     <span class="m">1</span>.25000000E-01  <span class="m">1</span>.25000000E-01  <span class="m">1</span>.25000000E-01
                     <span class="m">6</span>.25000000E-02  <span class="m">6</span>.25000000E-02  <span class="m">6</span>.25000000E-02
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
                     <span class="m">5</span>.00000000E-02  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-02
                     <span class="m">1</span>.00000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">1</span>.00000000E-01
                     <span class="m">1</span>.50000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">1</span>.50000000E-01
                     <span class="m">2</span>.00000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">2</span>.00000000E-01
                     <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">2</span>.50000000E-01
                     <span class="m">3</span>.00000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">3</span>.00000000E-01
                     <span class="m">3</span>.50000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">3</span>.50000000E-01
                     <span class="m">4</span>.00000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">4</span>.00000000E-01
                     <span class="m">4</span>.50000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">4</span>.50000000E-01
                     <span class="m">5</span>.00000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-01
                     <span class="m">5</span>.41666667E-01  <span class="m">8</span>.33333333E-02  <span class="m">5</span>.41666667E-01
                     <span class="m">5</span>.83333333E-01  <span class="m">1</span>.66666667E-01  <span class="m">5</span>.83333333E-01
                     <span class="m">6</span>.25000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">6</span>.25000000E-01
                     <span class="m">6</span>.66666667E-01  <span class="m">3</span>.33333333E-01  <span class="m">6</span>.66666667E-01
                     <span class="m">7</span>.08333333E-01  <span class="m">4</span>.16666667E-01  <span class="m">7</span>.08333333E-01
                     <span class="m">7</span>.50000000E-01  <span class="m">5</span>.00000000E-01  <span class="m">7</span>.50000000E-01
                     <span class="m">6</span>.75000000E-01  <span class="m">4</span>.50000000E-01  <span class="m">6</span>.75000000E-01
                     <span class="m">6</span>.00000000E-01  <span class="m">4</span>.00000000E-01  <span class="m">6</span>.00000000E-01
                     <span class="m">5</span>.25000000E-01  <span class="m">3</span>.50000000E-01  <span class="m">5</span>.25000000E-01
                     <span class="m">4</span>.50000000E-01  <span class="m">3</span>.00000000E-01  <span class="m">4</span>.50000000E-01
                     <span class="m">3</span>.75000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">3</span>.75000000E-01
                     <span class="m">3</span>.00000000E-01  <span class="m">2</span>.00000000E-01  <span class="m">3</span>.00000000E-01
                     <span class="m">2</span>.25000000E-01  <span class="m">1</span>.50000000E-01  <span class="m">2</span>.25000000E-01
                     <span class="m">1</span>.50000000E-01  <span class="m">1</span>.00000000E-01  <span class="m">1</span>.50000000E-01
                     <span class="m">7</span>.50000000E-02  <span class="m">5</span>.00000000E-02  <span class="m">7</span>.50000000E-02
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00

! Number of empty bands to include
nempty
<span class="m">4</span>

! Ratio betwen fine and coarse radial grid
! <span class="o">(</span>the coarse grid is used <span class="k">for</span> the calcualation
!  of densities<span class="o">)</span>. This needs to be <span class="nb">set</span> to one
! so that the grid specified <span class="k">in</span> the .in file
! of the atomic species is used everywhere
lradstp
 <span class="m">1</span>       : coarse/fine radial grid ratio
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5773d7ad-673b-4a09-852c-d8a01d0e9f08", "#uuid-16710d4b-1069-4ffa-9dcd-df3d3a1d50f0") }); </script>

<p>Any text after an exclamation mark (or a colon on the lines defining data) is
a comment. The keyword <code>tasks</code> defines what the code should do. In this case
it is set to calculate the ground state for the given structure and to
calculate a band structure. The block <code>ecvcut</code> sets the core-valence cutoff
energy. The next input block, <code>species</code> defines the parameters for the
generation of an atomic species file (it will be given the name <code>C.in</code>). As a
first step, we need to generate this file, but we will need to modify it
before we perform the main calculation. Therefore, you should run the code
briefly (by just running the executable in your directory) and then kill it
after a few seconds (using <code>Ctrl+C</code> for instance ), as soon as it has generated the <code>C.in</code> file.</p>
<p>If you look in your directory after the code has been killed you will probably
see a lot of <code>.OUT</code> files with uppercase names. These are the <code>Elk</code> output files.
You should also see a <code>C.in</code> file. When you open it, you should see:</p>
<div class="codehilite"><pre><span></span><code> &#39;C&#39;                                        : spsymb
 &#39;carbon&#39;                                   : spname
  -6.00000                                  : spzn
   39910624.45                              : spmass
   0.816497E-06    1.3000   38.0877   300    : rminsp, rmt, rmaxsp, nrmt
   4                                        : nstsp
   1   0   1   2.00000    T                 : nsp, lsp, ksp, occsp, spcore
   2   0   1   2.00000    F
   2   1   1   1.00000    F
   2   1   2   1.00000    F
   1                                        : apword
    0.1500   0  F                           : apwe0, apwdm, apwve
   0                                        : nlx
   3                                        : nlorb
   0   2                                    : lorbl, lorbord
    0.1500   0  F                           : lorbe0, lorbdm, lorbve
    0.1500   1  F
   1   2                                    : lorbl, lorbord
    0.1500   0  F                           : lorbe0, lorbdm, lorbve
    0.1500   1  F
   0   2                                    : lorbl, lorbord
    0.1500   0  F                           : lorbe0, lorbdm, lorbve
   -0.5012   0  T
</code></pre></div>

<p>The first four lines contain information pertaining to the symbol, name,
charge and mass of the atom. The fifth line holds data concerning the
numerical grid: the distance of the first grid point from the origin, the
muffin-tin radius, the maximum radius for the on-site atomic calculation, and
the number of grid points. The subsequent lines contain data about the
occupied states (the ones ending with &ldquo;T&rdquo; or &ldquo;F&rdquo;), and after that there is
information pertaining to the FP-LAPW on-site basis functions.</p>
<p>The first important thing to check here is whether all the orbitals that we
have included as valence states in the PAW dataset are treated as valence in
this species file. We do this by checking that there is an &ldquo;F&rdquo; after the
corresponding states in the occupation list:</p>
<div class="codehilite"><pre><span></span><code> ...
    1   0   1   2.00000    T                 : spn, spl, spk, spocc, spcore
    2   0   1   2.00000    F
    2   1   1   1.00000    F
    2   1   2   1.00000    F
 ...
</code></pre></div>

<p>The first two numbers are the <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>, <span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span> quantum numbers of the atomic state, so we
see that the <span><span class="MathJax_Preview">2s</span><script type="math/tex">2s</script></span> states, and the <span><span class="MathJax_Preview">2p</span><script type="math/tex">2p</script></span> states are set to valence as in the PAW dataset.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This might not be the case in general, the version of <code>Elk</code> we use is
modified to accept an adjustment of the <em>cutoff energy</em> for determining whether
a state should be treated as core or valence. This is what is set by the line:
<div class="highlight"><pre><span></span><code>...
ecvcut
-6.0 : core-valence cutoff energy
...
</code></pre></div></p>
</div>
<p>in the <code>elk.in</code> file. If you find too few or too many states are included as
valence for another atomic species, this value needs to be adjusted downwards or upwards.</p>
<p>The second thing we need to check is whether the number of grid points and the
<em>muffin-tin</em> radius that we use in the <code>Elk</code> calculation is roughly equivalent to
the PAW one. If you have a look in the PAW dataset we generated before, i.e.
in the <code>C.LDA-PW-paw.xml</code> file, there is the line:</p>
<div class="codehilite"><pre><span></span><code>   ...
   &lt;radial_grid eq=&quot;r=a*(exp(d*i)-1)&quot; a=&quot; 2.1888410558886799E-03&quot; d=&quot; 1.3133046335332079E-02&quot; istart=&quot;0&quot; iend=&quot;  800&quot; id=&quot;log1&quot;&gt;
&lt;values&gt;
   ...
</code></pre></div>

<p>These define the PAW grids used for wavefunctions, densities and potentials.
To approximately match the intensity of the grids, we should modify the fifth
line in the <code>C.in</code> file:</p>
<div class="codehilite"><pre><span></span><code>   ...
     0.816497E-06    1.3000   38.0877   300    : sprmin, rmt, sprmax, nrmt
   ...
   to:
   ...
     0.816497E-06    1.3000   38.0877   500    : sprmin, rmt, sprmax, nrmt
   ...
</code></pre></div>

<p>You now need to comment out the species generation input block in the <code>elk.in</code> file:</p>
<div class="codehilite"><pre><span></span><code>   ...
   ! Construct atomic species file &#39;C.in&#39;
   !species
   ! 6  : atomic number
   ! &#39;C&#39;
   ! &#39;carbon&#39;
   ! 21894.16673    : atomic mass
   ! 1.300000000    : muffin-tin radius
   ! 4              : number of occ. states
   ! 1   0   1   2  : 1s
   ! 2   0   1   2  : 2s
   ! 2   1   1   1  : 2p m=1
   ! 2   1   2   1  : 2p m=2
   ...
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is very important! If you do not comment these lines the species
file <code>C.in</code> will be regenerated when you run <code>Elk</code> and your modifications will be lost.</p>
</div>
<p>Now it is time to start <code>Elk</code> again. The code will now run and produce a lot of
<code>.OUT</code> files. There is rarely anything output to screen, unless it&rsquo;s an error
message, so to track the progress of the <code>Elk</code> calculation you can use the <code>tail</code> command:</p>
<div class="codehilite"><pre><span></span><code> tail -f INFO.OUT
</code></pre></div>

<p>You get out of <code>tail</code> by pressing <code>CRTL+C</code>. While the calculation is running,
you might want to familiarise yourself with the different input blocks in the
<code>elk.in</code> file. When the <code>Elk</code> run has finished, there will be a <code>BAND.OUT</code> file in
your run directory. We can now do an analogous band structure comparison to
before, by using the python script <a href="../paw3_assets/scripts/comp_bands_abinit2elk.py">comp_bands_abinit2elk.py</a>
(you should copy this to your current directory). If your previous abinit
calculation is in the subdirectory <code>path/abinit_test</code> above you write:</p>
<div class="codehilite"><pre><span></span><code> python comp_bands_abinit2elk.py path/abinit_test/outputs/ab_C_test_o_DS42_EIG BAND.OUT eV
</code></pre></div>

<p>This will get you the ending lines:</p>
<div class="codehilite"><pre><span></span><code> ...
 #        nvals:   280
 # average diff:    12.393189  eV
 # minimum diff:   -12.668010  eV
 # maximum diff:   -12.290953  eV
 ...
</code></pre></div>

<p>So it looks like there is a huge difference! However, there is something we
have forgotten. Pipe the data to a file by writing:</p>
<div class="codehilite"><pre><span></span><code>python comp_bands_abinit2elk.py path/abinit_test/outputs/ab_C_test_o_DS42_EIG BAND.OUT eV &gt; bands.dat
</code></pre></div>

<p>and plot it in <code>gnuplot</code> with:</p>
<div class="codehilite"><pre><span></span><code>gnuplot&gt; plot &#39;bands.dat&#39; u 1:2 w lp title &#39;ABINIT&#39;, &#39;bands.dat&#39; u 1:3 w lp title &#39;Elk&#39;
</code></pre></div>

<p>You should get a graph like this:</p>
<p><img alt="Comparison of ABINIT and elk bands without shift" src="../paw3_assets/images/band_abinit_elk_I.png" /></p>
<p>As you can see, the band structures look alike but differ by an absolute
shift, which is normal, because in a periodic system there is no unique vacuum
energy, and band energies are always defined up to an arbitrary constant
shift. This shift depends on the numerical details, and will be different for
different codes using different numerical approaches. (Note in the <code>Elk</code> input
file that the keyword <code>xctype</code> controls the type - LDA or GGA - of the
exchange-correlation functional.)</p>
<p>However, if we decide upon a reference pont, like the valence band maximum
(VBM), or a point nearby, and align the two band plots at that point, there
will still be differences. By comparing with the plot we just made, we see
that the VBM is at the ninth k-point from the left, on band four. The script
we used previously can accomodate a shift, by issuing the command:</p>
<div class="codehilite"><pre><span></span><code>python comp_bands_abinit2elk.py path/abinit_test/outputs/ab_C_test_o_DS42_EIG BAND.OUT align 9 4 eV
</code></pre></div>

<p>So that if the keyword <code>align</code> is present followed by the k-point index and
band number, we order the script to align at that point. Naturally, that will
make the positions of that particular point fit perfectly, but if we look at
the end of the output:</p>
<div class="codehilite"><pre><span></span><code> ...
 # <span class="nv">AVERAGES</span> <span class="k">FOR</span> <span class="nv">OCCUPIED</span> <span class="nv">STATES</span>:
 #        <span class="nv">nvals</span>:   <span class="mi">106</span>
 # <span class="nv">average</span> <span class="nv">diff</span>:     <span class="mi">0</span>.<span class="mi">021871</span>  <span class="nv">eV</span>
 # <span class="nv">minimum</span> <span class="nv">diff</span>:    <span class="o">-</span><span class="mi">0</span>.<span class="mi">042755</span>  <span class="nv">eV</span>
 # <span class="nv">maximum</span> <span class="nv">diff</span>:     <span class="mi">0</span>.<span class="mi">064097</span>  <span class="nv">eV</span>
 #
 # <span class="nv">AVERAGES</span> <span class="k">FOR</span> <span class="nv">UNOCCUPIED</span> <span class="nv">STATES</span>:
 #        <span class="nv">nvals</span>:   <span class="mi">174</span>
 # <span class="nv">average</span> <span class="nv">diff</span>:     <span class="mi">0</span>.<span class="mi">047221</span>  <span class="nv">eV</span>
 # <span class="nv">minimum</span> <span class="nv">diff</span>:    <span class="o">-</span><span class="mi">0</span>.<span class="mi">287747</span>  <span class="nv">eV</span>
 # <span class="nv">maximum</span> <span class="nv">diff</span>:     <span class="mi">0</span>.<span class="mi">089309</span>  <span class="nv">eV</span>

 ...
</code></pre></div>

<p>we can tell that this is not true for the rest of the points. Since the script
assumes alignment at the VBM, it now separates its statistics for occupied and
unoccupied bands. The uppermost unoccupied bands can fit badly, depending on
what precision was asked of <code>ABINIT</code> (especially, if <code>nbdbuf</code> is used).</p>
<p>The fit is quite bad in general, an average of about 0.025 eV difference for
occupied states, and about 0.05 eV difference for unoccupied states. If you
plot the ouput as before, by piping the above to a <code>bands.dat</code> file and
executing the same <code>gnuplot</code> command, you should get the plot below.</p>
<p><img alt="Comparison of ABINIT and elk bands with shift" src="../paw3_assets/images/band_abinit_elk_II.png" /></p>
<p>On the scale of the band plot there is a small - but visible - difference
between the two. Note that the deviations are usually larger away from the
high-symmetry points, which is why it&rsquo;s important to choose some points away
from these as well when making these comparisons. However, it is difficult to
conclude visually from the band structure that this is a bad dataset without
using the statistics output by the <em>script</em>, and without some sense of what
precision can be expected.</p>
<p>As we are now creating our &ldquo;gold standard&rdquo; with an <code>Elk</code> calculation, we also
need to calculate the equilibrium lattice parameter and Bulk modulus of
diamond with the <code>Elk</code> code. Unfortunately, <code>Elk</code> does not use datasets, so the
various lattice parameters we used in our <code>ABINIT</code> structural search will have
to be put in one by one by hand and the code run for each. The lattice
parameters in the <code>ABINIT</code> run were from 6.1 to 7.0 in increments of 0.1, so
that makes ten runs in total. To perform the first, simply edit the <code>elk.in</code>
file and change the keyword (at line 57):</p>
<div class="codehilite"><pre><span></span><code> ...
 scale
 6.7403 : lattice parameter in Bohr
 ...
</code></pre></div>

<p>to:</p>
<div class="codehilite"><pre><span></span><code> ...
 scale
 6.1 : lattice parameter in Bohr
 ...
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You also have to change the keyword <code>frozencr</code> to &ldquo;.false.&rdquo; because, at
the time of writing, there is an error in the calculation of the total energy
for frozen core-states. This means that the Elk input file must have the keyword (at line 65 ):
<div class="highlight"><pre><span></span><code>...
frozencr
.false.
...
</code></pre></div>
when you are determining parameters which depend on the total energy. (It can
safely be set to &ldquo;.true.&rdquo; for band structure calculations however.) The
difference in the lattice parameters when using frozen versus unfrozen core
states in an all-electron calculation is expected to be of the order of 0.005 Bohr.</p>
</div>
<p>Finally, you don&rsquo;t need to calculate the band structure for each run, so you
might wand to change the <code>tasks</code> keyword section (at line 7):</p>
<div class="codehilite"><pre><span></span><code> ...
 tasks
  0
  20
 ...
</code></pre></div>

<p>to just</p>
<div class="codehilite"><pre><span></span><code> ...
 tasks
  0
 ...
</code></pre></div>

<p>After you&rsquo;ve done these modifications, run <code>Elk</code> again. After the run has
finished, look in the <code>TOTENERGY.OUT</code> and the <code>LATTICE.OUT</code> files to get the
converged total energy and the volume. Write these down or save them in a safe
place, edit the <code>elk.in</code> file again, and so forth until you&rsquo;ve calculated all
ten energies corresponding to the ten lattice parameter values. In the end you
should get a list which you can put in an <code>eos.in</code> file:</p>
<div class="codehilite"><pre><span></span><code> <span class="s2">&quot;</span><span class="s">C - Diamond (Elk)</span><span class="s2">&quot;</span>          : <span class="nv">cname</span> <span class="o">-</span> <span class="nv">name</span> <span class="nv">of</span> <span class="nv">material</span>
 <span class="mi">2</span>                            : <span class="nv">natoms</span> <span class="o">-</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">atoms</span>
 <span class="mi">1</span>                            : <span class="nv">etype</span> <span class="o">-</span> <span class="nv">equation</span> <span class="nv">of</span> <span class="nv">state</span> <span class="nv">fit</span> <span class="nv">type</span>
 <span class="mi">50</span>.<span class="mi">0</span> <span class="mi">95</span>.<span class="mi">0</span> <span class="mi">100</span>                : <span class="nv">vplt1</span>, <span class="nv">vplt2</span>, <span class="nv">nvplt</span> <span class="o">-</span> <span class="nv">start</span>, <span class="k">end</span> <span class="nv">and</span> #<span class="nv">pts</span> <span class="k">for</span> <span class="nv">fit</span>
 <span class="mi">10</span>                           : <span class="nv">nevpt</span> <span class="o">-</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">supplied</span> <span class="nv">points</span>
 <span class="mi">56</span>.<span class="mi">74525000</span>  <span class="o">-</span><span class="mi">75</span>.<span class="mi">5758514889</span>
 <span class="mi">59</span>.<span class="mi">58200000</span>  <span class="o">-</span><span class="mi">75</span>.<span class="mi">5933438506</span>
 <span class="mi">62</span>.<span class="mi">51175000</span>  <span class="o">-</span><span class="mi">75</span>.<span class="mi">6067015802</span>
 <span class="mi">65</span>.<span class="mi">53600000</span>  <span class="o">-</span><span class="mi">75</span>.<span class="mi">6163263051</span>
 <span class="mi">68</span>.<span class="mi">65625000</span>  <span class="o">-</span><span class="mi">75</span>.<span class="mi">6226219775</span>
 <span class="mi">71</span>.<span class="mi">87400000</span>  <span class="o">-</span><span class="mi">75</span>.<span class="mi">6259766731</span>
 <span class="mi">75</span>.<span class="mi">19075000</span>  <span class="o">-</span><span class="mi">75</span>.<span class="mi">6266976640</span>
 <span class="mi">78</span>.<span class="mi">60800000</span>  <span class="o">-</span><span class="mi">75</span>.<span class="mi">6250734731</span>
 <span class="mi">82</span>.<span class="mi">12725000</span>  <span class="o">-</span><span class="mi">75</span>.<span class="mi">6213749855</span>
 <span class="mi">85</span>.<span class="mi">75000000</span>  <span class="o">-</span><span class="mi">75</span>.<span class="mi">6158453243</span>
</code></pre></div>

<p>(Your values might be slightly different in the last few decimals depending on
your system.) By running the <code>eos</code> utility as before we get:</p>
<div class="codehilite"><pre><span></span><code> V0                =            74.47144624
 B0 (GPa)          =            469.7040543

 alatt = (4*74.47144624)^(1/3) = 6.6785 Bohr (3.5341 Å)
</code></pre></div>

<p>So we see that the initial, primitive, <code>ABINIT</code> dataset is about 9 GPa off for
the <em>Bulk modulus</em> and about 0.035 Bohr away from the correct value for the
lattice parameter. In principle, these should be about an order of magnitude
better, so let us see if we can make it so.</p>
<h3 id="34-carbon-improving-the-dataset">3.4. Carbon - improving the dataset<a class="headerlink" href="#34-carbon-improving-the-dataset" title="Permanent link">&para;</a></h3>
<p>Now that you know the target values, is up to you to experiment and see if you
can improve this dataset. The techniques are well documented in tutorial
<a href="/tutorial/paw2">PAW2</a>. Here&rsquo;s a brief summary of main points to be concerned about:</p>
<ul>
<li>Use the keyword series <code>custom rrkj ...</code>, or <code>custom polynom ...</code>, or <code>custom polynom2 ...</code>,
    if you want to have maximum control over the convergence properties of the projectors.</li>
<li>Check the logarithmic derivatives very carefully for the presence of ghost states.</li>
<li>A dataset intended for ground-state calculations needs, as a rule of thumb, at least two projectors
    per angular momentum channel. This is because only the occupied states need to be reproduced very accurately.
    If you need to perform calculations which involve the Fock operator or unoccupied states<ul>
<li>like in GW calculations for instance - you will probably need at least three projectors.
You might also want to add extra projectors in completely unoccupied <span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>-channels.</li>
</ul>
</li>
</ul>
<p>We will now benchmark a more optimized atomic dataset for carbon.
Try and check the convergence properties, equilibrium lattice parameter, bulk modulus,
and bands for the input file below:</p>
<div class="codehilite"><pre><span></span><code> <span class="n">C</span> <span class="mi">6</span>                                     <span class="o">!</span> <span class="n">Atomic</span> <span class="k">name</span> <span class="k">and</span> <span class="k">number</span>
 <span class="n">LDA</span><span class="o">-</span><span class="n">PW</span> <span class="n">scalarrelativistic</span> <span class="n">loggrid</span> <span class="mi">801</span> <span class="n">logderivrange</span> <span class="o">-</span><span class="mi">10</span> <span class="mi">40</span> <span class="mi">1000</span> <span class="o">!</span> <span class="n">XC</span> <span class="n">approx</span><span class="p">.,</span> <span class="n">SE</span> <span class="k">type</span><span class="p">,</span> <span class="n">gridtype</span><span class="p">,</span> <span class="c1"># pts, logderiv</span>
 <span class="mi">2</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>                             <span class="o">!</span> <span class="n">maximum</span> <span class="n">n</span> <span class="k">for</span> <span class="k">each</span> <span class="n">l</span><span class="o">:</span> <span class="n">2s</span><span class="p">,</span><span class="n">2p</span><span class="p">,</span><span class="n">0d</span><span class="p">,</span><span class="n">0f</span><span class="p">..</span>
 <span class="mi">2</span> <span class="mi">1</span> <span class="mi">2</span>                                   <span class="o">!</span> <span class="n">Partially</span> <span class="n">filled</span> <span class="n">shell</span><span class="o">:</span> <span class="n">2p</span><span class="o">^</span><span class="mi">2</span>
 <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>                                   <span class="o">!</span> <span class="k">Stop</span> <span class="n">marker</span>
 <span class="n">c</span>                                       <span class="o">!</span> <span class="n">1s</span> <span class="o">-</span> <span class="n">core</span>
 <span class="n">v</span>                                       <span class="o">!</span> <span class="n">2s</span> <span class="o">-</span> <span class="n">valence</span>
 <span class="n">v</span>                                       <span class="o">!</span> <span class="n">2p</span> <span class="o">-</span> <span class="n">valence</span>
 <span class="mi">1</span>                                       <span class="o">!</span> <span class="n">l_max</span> <span class="n">treated</span> <span class="o">=</span> <span class="mi">1</span>
 <span class="mf">1.3</span>                                     <span class="o">!</span> <span class="n">core</span> <span class="n">radius</span> <span class="n">r_c</span>
 <span class="n">y</span>                                       <span class="o">!</span> <span class="k">Add</span> <span class="n">unocc</span><span class="p">.</span> <span class="n">s</span><span class="o">-</span><span class="n">state</span>
 <span class="mf">12.2</span>                                    <span class="o">!</span>  <span class="k">reference</span> <span class="n">energy</span>
 <span class="n">n</span>                                       <span class="o">!</span> <span class="k">no</span> <span class="n">more</span> <span class="n">unoccupied</span> <span class="n">s</span><span class="o">-</span><span class="n">states</span>
 <span class="n">y</span>                                       <span class="o">!</span> <span class="k">Add</span> <span class="n">unocc</span><span class="p">.</span> <span class="n">p</span><span class="o">-</span><span class="n">state</span>
 <span class="mf">6.9</span>                                     <span class="o">!</span>  <span class="k">reference</span> <span class="n">energy</span>
 <span class="n">n</span>                                       <span class="o">!</span> <span class="k">no</span> <span class="n">more</span> <span class="n">unoccupied</span> <span class="n">p</span><span class="o">-</span><span class="n">states</span>
 <span class="n">custom</span> <span class="n">polynom2</span> <span class="mi">7</span> <span class="mi">11</span> <span class="n">vanderbiltortho</span> <span class="n">sinc</span>   <span class="o">!</span> <span class="n">more</span> <span class="n">complicated</span> <span class="n">scheme</span> <span class="k">for</span> <span class="n">projectors</span>
 <span class="mi">3</span> <span class="mi">0</span> <span class="n">ultrasoft</span>                           <span class="o">!</span> <span class="n">localisation</span> <span class="n">scheme</span>
 <span class="mf">1.3</span>                                     <span class="o">!</span> <span class="n">Core</span> <span class="n">radius</span> <span class="k">for</span> <span class="n">occ</span><span class="p">.</span> <span class="n">2s</span> <span class="n">state</span>
 <span class="mf">1.3</span>                                     <span class="o">!</span> <span class="n">Core</span> <span class="n">radius</span> <span class="k">for</span> <span class="n">unoocc</span><span class="p">.</span> <span class="n">2s</span> <span class="n">state</span>
 <span class="mf">1.3</span>                                     <span class="o">!</span> <span class="n">Core</span> <span class="n">radius</span> <span class="k">for</span> <span class="n">occ</span><span class="p">.</span> <span class="n">2p</span> <span class="n">state</span>
 <span class="mf">1.3</span>                                     <span class="o">!</span> <span class="n">Core</span> <span class="n">radius</span> <span class="k">for</span> <span class="n">unocc</span><span class="p">.</span> <span class="n">2p</span> <span class="n">state</span>
 <span class="n">XMLOUT</span>                                       <span class="o">!</span> <span class="n">Run</span> <span class="n">atompaw2abinit</span> <span class="n">converter</span>
 <span class="n">prtcorewf</span> <span class="n">noxcnhat</span> <span class="n">nospline</span> <span class="n">noptim</span>      <span class="o">!</span> <span class="n n-Quoted">`ABINIT`</span> <span class="n">conversion</span> <span class="k">options</span>
 <span class="mi">0</span>                                       <span class="o">!</span> <span class="k">Stop</span> <span class="n">marker</span>
</code></pre></div>

<p>Generate an atomic data file from this (you can replace the items in the old
input file if you want, or make a new directory for this study). You might
want to try and modify the gnuplot scripts so that they work correctly for
this dataset. (The <code>wfn*</code> files are ordered just like the core radius list at
the end, so now their meaning and the numbering of some other files have
changed.) There is an example of the modifications in the plot script
<a href="../paw3_assets/scripts/plot_C_all_II.p">plot_C_all_II.p</a>, which you
can download and run in gnuplot. You should get a plot like this:</p>
<p><img alt="Plot info for second Carbon dataset" src="../paw3_assets/images/plot_C_all_II.png" /></p>
<p>Note the much better fit of the logarithmic derivatives, and the change in the
shape of the projector functions (in blue in the <code>wfn</code> plots), due to the more
complicated scheme used to optimise them.</p>
<p>Generate the dataset like before and run the <code>ABINIT</code> <code>ecut</code> testing datasets in
the <code>ab_C_test.abi</code> <code>ABINIT</code> input file again. You should get an <code>etotal</code>
convergence like this (again, the values to the left are just there to help):</p>
<div class="codehilite"><pre><span></span><code>                                   etotal   (ecut)
  etotal11 -1.0785137440E+01
  etotal21 -1.1489028406E+01   - 703.89 mHa (10 Ha)
  etotal31 -1.1522398057E+01   -  33.37 mHa (15 Ha)
  etotal41 -1.1523369210E+01   -   0.97 mHa (20 Ha)
  etotal51 -1.1523467540E+01   -   0.10 mHa (25 Ha)
  etotal61 -1.1523515348E+01   -   0.05 mHa (30 Ha)
  etotal71 -1.1523525440E+01   -   0.01 mHa (35 Ha)
  etotal81 -1.1523552361E+01   -   0.03 mHa (40 Ha)
  etotal91 -1.1523572404E+01   -   0.02 mHa (45 Ha)
</code></pre></div>

<p>This dataset already seems to be converged to about 1 mHa at an <code>ecut</code> of 15 Ha,
so it is much more efficient. A comparison of bands (in units of eV) between
datasets 32 and 92 gives:</p>
<div class="codehilite"><pre><span></span><code> ...
 #        nvals:   280
 # average diff:     0.004312  eV
 # minimum diff:    -0.013878  eV
 # maximum diff:     0.000544  eV
 ...
</code></pre></div>

<p>Which also shows a much faster convergence than before. Is the dataset
accurate enough? Well, if you run the <code>ABINIT</code> equilibrium parameter input file
in <code>ab_C_equi.abi</code>, you should get data for an <code>eos.in</code> file:</p>
<div class="codehilite"><pre><span></span><code> <span class="s2">&quot;</span><span class="s">C - Diamond (second PAW dataset)</span><span class="s2">&quot;</span> : <span class="nv">cname</span> <span class="o">-</span> <span class="nv">name</span> <span class="nv">of</span> <span class="nv">material</span>
 <span class="mi">2</span>                                  : <span class="nv">natoms</span> <span class="o">-</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">atoms</span>
 <span class="mi">1</span>                                  : <span class="nv">etype</span> <span class="o">-</span> <span class="nv">equation</span> <span class="nv">of</span> <span class="nv">state</span> <span class="nv">fit</span> <span class="nv">type</span>
 <span class="mi">50</span>.<span class="mi">0</span> <span class="mi">95</span>.<span class="mi">0</span> <span class="mi">100</span>                      : <span class="nv">vplt1</span>, <span class="nv">vplt2</span>, <span class="nv">nvplt</span> <span class="o">-</span> <span class="nv">start</span>, <span class="k">end</span> <span class="nv">and</span> #<span class="nv">pts</span> <span class="k">for</span> <span class="nv">fit</span>
 <span class="mi">10</span>                                 : <span class="nv">nevpt</span> <span class="o">-</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">supplied</span> <span class="nv">points</span>
 <span class="mi">5</span>.<span class="mi">6745250</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1471957529</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">5</span>.<span class="mi">9582000</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1489599125</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">6</span>.<span class="mi">2511750</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1503102315</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">6</span>.<span class="mi">5536000</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1512899444</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">6</span>.<span class="mi">8656250</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1519381720</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">7</span>.<span class="mi">1874000</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1522903996</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">7</span>.<span class="mi">5190750</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1523789014</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">7</span>.<span class="mi">8608000</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1522330567</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">8</span>.<span class="mi">2127250</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1518796247</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
 <span class="mi">8</span>.<span class="mi">5750000</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">1513430193</span><span class="nv">E</span><span class="o">+</span><span class="mi">01</span>
</code></pre></div>

<p>And when fed to <code>eos</code>, this gives us the equilibrium data:</p>
<div class="codehilite"><pre><span></span><code> V0                =            74.71100799
 B0 (GPa)          =            465.7949258

 alatt = (4*74.71100799)^(1/3) = 6.6857 Bohr (3.5379 Å)
</code></pre></div>

<p>For comparison, we list all previous values again:</p>
<div class="codehilite"><pre><span></span><code> Equilibrium        Bulk modulus       lattice
 volume, V0         B0                parameter
 75.5073            460.37            3.5505 Å   (1st primitive PAW dataset)
 74.7110            465.79            3.5379 Å   (2nd better PAW dataset)
 74.4714            469.70            3.5341 Å   (Elk all-electron)
</code></pre></div>

<p>It is obvious that the second dataset is much better than the first one.
A comparison of the most converged values for the bands using the command:</p>
<div class="codehilite"><pre><span></span><code>python comp_bands_abinit2elk.py ab_C_test_o_DS92_EIG BAND.OUT align 9 4 eV
</code></pre></div>

<p>(This assumes that you have all the files you need in the current directory.)
As before, the extra command parameters on the end mean &ldquo;align the 9-th
k-point on the fourth band and convert values to eV&rdquo;. This will align the band
structures at the valence band maximum. The statistics printed out at the end
should be something like this:</p>
<div class="codehilite"><pre><span></span><code> ...
 # <span class="nv">AVERAGES</span> <span class="k">FOR</span> <span class="nv">OCCUPIED</span> <span class="nv">STATES</span>:
 #        <span class="nv">nvals</span>:   <span class="mi">106</span>
 # <span class="nv">average</span> <span class="nv">diff</span>:     <span class="mi">0</span>.<span class="mi">013523</span>  <span class="nv">eV</span>
 # <span class="nv">minimum</span> <span class="nv">diff</span>:    <span class="o">-</span><span class="mi">0</span>.<span class="mi">001229</span>  <span class="nv">eV</span>
 # <span class="nv">maximum</span> <span class="nv">diff</span>:     <span class="mi">0</span>.<span class="mi">040695</span>  <span class="nv">eV</span>
 #
 # <span class="nv">AVERAGES</span> <span class="k">FOR</span> <span class="nv">UNOCCUPIED</span> <span class="nv">STATES</span>:
 #        <span class="nv">nvals</span>:   <span class="mi">174</span>
 # <span class="nv">average</span> <span class="nv">diff</span>:     <span class="mi">0</span>.<span class="mi">016247</span>  <span class="nv">eV</span>
 # <span class="nv">minimum</span> <span class="nv">diff</span>:    <span class="o">-</span><span class="mi">0</span>.<span class="mi">013699</span>  <span class="nv">eV</span>
 # <span class="nv">maximum</span> <span class="nv">diff</span>:     <span class="mi">0</span>.<span class="mi">117064</span>  <span class="nv">eV</span> 
 ...
</code></pre></div>

<p>Which shows a precision, on average, of slightly better than 0.01 eV for both
the four occupied and the four lowest unoccupied bands. As before, you can
pipe this output to a file and plot the bands for visual inspection.</p>
<p>This is a better dataset, but probably by no means the best possible. It is
likely that one can construct a dataset for carbon that has even better
convergence properties, and is even more accurate. You are encouraged to
experiment and try to make a better one.</p>
<h2 id="4-magnesium-dealing-with-the-fermi-energy-of-a-metallic-system">4. Magnesium - dealing with the Fermi energy of a metallic system<a class="headerlink" href="#4-magnesium-dealing-with-the-fermi-energy-of-a-metallic-system" title="Permanent link">&para;</a></h2>
<p>There is added complication if the system is metallic, and that is the
treatment of the smearing used in order to eliminated the sharp peaks in the
<em>density of states</em> (DOS) near the Fermi energy. The DOS is technically
integrated over in any ground-state calculation, and for a metal this
requires, in principle, an infinite k-point grid in order to resolve the Fermi surface.</p>
<p>In practice, a smearing function is used so that a usually quite large - but
finite - number of k-points will be sufficient. This smearing function has a
certain spread controlled by a smearing parameter, and the optimum value of
this parameter depends on the k-point grid used. As the k-point grid becomes
denser, the optimum spread becomes smaller, and all values converge toward
their ideal counterparts in the limit of no smearing and an infinitely dense grid.</p>
<p>The problem is that, in <code>ABINIT</code>, finding the optimum smearing parameter takes a
(potentially time consuming) convergence study. However, we are in luck. The
<code>Elk</code> code has an option for automatically determining the smearing parameter.
Thus we should use the <code>Elk</code> code first, set a relatively dense k-mesh, and
calculate the equilibrium bulk modulus, lattice parameter and band structure.
Then we make sure to match the automatically determined smearing width, and
most importantly, make sure that we match the smearing function used between
the <code>Elk</code> and the <code>ABINIT</code> calculation.</p>
<h3 id="41-magnesium-the-all-electron-calculation">4.1. Magnesium - The all-electron calculation<a class="headerlink" href="#41-magnesium-the-all-electron-calculation" title="Permanent link">&para;</a></h3>
<p>There is an <code>Elk</code> input file prepared at: <a href="../paw3_assets/inputs/elk_Mg_band.in">elk_Mg_band.in</a>,
we suggest you copy it into a subdirectory dedicated to the Mg <code>Elk</code> calculation (why not <code>Mg_elk</code>?), rename
it to <code>elk.in</code> and take a look inside the input file.</p>
<div class="text-center"><button id="uuid-da4ed77c-28a3-4714-8f58-d50e365e2242" class="md-button md-button--secondary"> View tutorial/paw3_assets/inputs/elk_Mg_band.in </button></div>
<div id="uuid-6ff30376-55b8-41f8-97b2-969416c45768" class="my_dialog" title="tutorial/paw3_assets/inputs/elk_Mg_band.in" hidden><div><div class="codehilite small-text"><pre><span></span>! Carbon, diamond structure <span class="o">(</span>FCC<span class="o">)</span>

! The tasks define what will be <span class="k">done</span> by the code:
! <span class="m">0</span> - Perform ground-state calculation from scratch
! <span class="m">1</span> - Restart GS calc. from STATE.OUT file
! <span class="m">20</span> - Calculate band structure as defined by plot1d
tasks
<span class="m">1</span>
<span class="m">20</span>

ecvcut
 -6.0

species
 <span class="m">12</span> : atomic number
 <span class="s1">&#39;Mg&#39;</span>
 <span class="s1">&#39;magnesium&#39;</span>
 <span class="m">44305</span>.30461        : atomic mass
 <span class="m">1</span>.899259351   <span class="m">37</span>.6052   : muffin-tin radius
   <span class="m">5</span>                : number of occ. states
   <span class="m">1</span>   <span class="m">0</span>   <span class="m">1</span>   <span class="m">2</span>    : 1s
   <span class="m">2</span>   <span class="m">0</span>   <span class="m">1</span>   <span class="m">2</span>    : 2s
   <span class="m">2</span>   <span class="m">1</span>   <span class="m">1</span>   <span class="m">2</span>    : 2p <span class="nv">m</span><span class="o">=</span><span class="m">0</span>
   <span class="m">2</span>   <span class="m">1</span>   <span class="m">2</span>   <span class="m">4</span>    : 2p <span class="nv">m</span><span class="o">=</span><span class="m">1</span>
   <span class="m">3</span>   <span class="m">0</span>   <span class="m">1</span>   <span class="m">2</span>    : 3s
!  -6.0              : core-valence cutoff energy

! Tolerance on convegence of band energies <span class="o">(</span>absolute<span class="o">)</span>
epsband
 <span class="m">1</span>.e-8

! Tolerance on conv. of potential <span class="o">(</span>relative<span class="o">)</span>
epspot
 <span class="m">1</span>.e-7

! Tolerance on conv. of total energy <span class="o">(</span>absolute<span class="o">)</span>
epsengy
 <span class="m">1</span>.e-6

! Use adaptive linear mixing of densities
! <span class="m">1</span> - Adaptive linear
! <span class="m">2</span> - Pulay mixing
mixtype
 <span class="m">3</span>

! Exchange-correlation functional to use
! LDA <span class="o">(</span>PW92<span class="o">)</span> is <span class="m">3</span> <span class="o">(</span>default<span class="o">)</span> <span class="o">(</span>equiv. Abinit ixc <span class="m">7</span><span class="o">)</span>
! GGA-PBE    is <span class="m">20</span>          <span class="o">(</span>equiv. Abinit ixc <span class="m">11</span><span class="o">)</span>
! <span class="o">(</span>see Elk manual <span class="k">for</span> other options<span class="o">)</span>
xctype
 <span class="m">3</span>

! Define lattice vectors
! Magnesium has a hexagonal native structure
! with <span class="nv">a</span><span class="o">=</span><span class="nv">b</span><span class="o">=</span><span class="m">3</span>.20927 Å <span class="nv">c</span><span class="o">=</span><span class="m">5</span>.21033 Å  <span class="nv">alpha</span><span class="o">=</span><span class="m">90</span> <span class="nv">beta</span><span class="o">=</span><span class="m">90</span> <span class="nv">gamma</span><span class="o">=</span><span class="m">60</span>

! Scale factor to be applied to all lattice vectors
scale
 <span class="m">1</span>.00

avec
     <span class="m">6</span>.0646414   <span class="m">0</span>.0000000   <span class="m">0</span>.0000000
     <span class="m">3</span>.0323207   <span class="m">5</span>.2521335   <span class="m">0</span>.0000000
     <span class="m">0</span>.0000000   <span class="m">0</span>.0000000   <span class="m">9</span>.8460968

! Define atomic species
atoms
   <span class="m">1</span>   : nspecies - Number of species
<span class="s1">&#39;Mg.in&#39;</span> : spfname - Name of species file
   <span class="m">2</span>   : natoms<span class="p">;</span> atposl, bfcmt below - Atoms <span class="k">in</span> cell, reduced coord. and moments
    <span class="m">0</span>.33333333    <span class="m">0</span>.33333333    <span class="m">0</span>.2500000    <span class="m">0</span>.00000000  <span class="m">0</span>.00000000  <span class="m">0</span>.00000000
    <span class="m">0</span>.66666666    <span class="m">0</span>.66666666    <span class="m">0</span>.7500000    <span class="m">0</span>.00000000  <span class="m">0</span>.00000000  <span class="m">0</span>.00000000

! Don<span class="s1">&#39;t set muffin-tin radius automatically</span>
<span class="s1">autormt</span>
<span class="s1"> .false.</span>

<span class="s1">! Freeze core states (in abinit PAW, they are frozen)</span>
<span class="s1">frozencr</span>
<span class="s1"> .true.</span>

<span class="s1">! Path to atomic data files</span>
<span class="s1">sppath</span>
<span class="s1">  &#39;</span>./<span class="err">&#39;</span>

! Monkhorst-pack k-point grid
ngridk
 <span class="m">10</span>  <span class="m">10</span>  <span class="m">10</span>

! Shift of MP grid
vkloff
<span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5

! Metallic options
stype
 <span class="m">0</span>          : Smearing <span class="nb">type</span> <span class="m">0</span> - Gaussian
autoswidth
 .true.     : Automatic determination of swidth

! Set upper limit of <span class="p">|</span>G+k<span class="p">|</span>, the number below is
! <span class="o">(</span>MT radius<span class="o">)</span>*max<span class="o">(</span><span class="p">|</span>G+k<span class="p">|</span><span class="o">)</span>
rgkmax
<span class="m">9</span>.0

! A value of <span class="m">0</span>.0 makes this being <span class="nb">set</span> automatically
gmaxvr
<span class="m">0</span>.0

! k-points <span class="k">in</span> band plot
plot1d
<span class="m">47</span> <span class="m">47</span>  : nvp1d, npp1d
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-01
                     <span class="m">8</span>.33333333E-02  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-01
                     <span class="m">1</span>.66666667E-01  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-01
                     <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-01
                     <span class="m">3</span>.33333333E-01  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-01
                     <span class="m">4</span>.16666667E-01  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-01
                     <span class="m">5</span>.00000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-01
                     <span class="m">4</span>.72222222E-01  <span class="m">5</span>.55555556E-02  <span class="m">5</span>.00000000E-01
                     <span class="m">4</span>.44444444E-01  <span class="m">1</span>.11111111E-01  <span class="m">5</span>.00000000E-01
                     <span class="m">4</span>.16666667E-01  <span class="m">1</span>.66666667E-01  <span class="m">5</span>.00000000E-01
                     <span class="m">3</span>.88888889E-01  <span class="m">2</span>.22222222E-01  <span class="m">5</span>.00000000E-01
                     <span class="m">3</span>.61111111E-01  <span class="m">2</span>.77777778E-01  <span class="m">5</span>.00000000E-01
                     <span class="m">3</span>.33333333E-01  <span class="m">3</span>.33333333E-01  <span class="m">5</span>.00000000E-01
                     <span class="m">2</span>.77777778E-01  <span class="m">2</span>.77777778E-01  <span class="m">5</span>.00000000E-01
                     <span class="m">2</span>.22222222E-01  <span class="m">2</span>.22222222E-01  <span class="m">5</span>.00000000E-01
                     <span class="m">1</span>.66666667E-01  <span class="m">1</span>.66666667E-01  <span class="m">5</span>.00000000E-01
                     <span class="m">1</span>.11111111E-01  <span class="m">1</span>.11111111E-01  <span class="m">5</span>.00000000E-01
                     <span class="m">5</span>.55555556E-02  <span class="m">5</span>.55555556E-02  <span class="m">5</span>.00000000E-01
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-01
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">4</span>.50000000E-01
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">4</span>.00000000E-01
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">3</span>.50000000E-01
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">3</span>.00000000E-01
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">2</span>.50000000E-01
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">2</span>.00000000E-01
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">1</span>.50000000E-01
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">1</span>.00000000E-01
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">5</span>.00000000E-02
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
                     <span class="m">8</span>.33333333E-02  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
                     <span class="m">1</span>.66666667E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
                     <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
                     <span class="m">3</span>.33333333E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
                     <span class="m">4</span>.16666667E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
                     <span class="m">5</span>.00000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
                     <span class="m">4</span>.72222222E-01  <span class="m">5</span>.55555556E-02  <span class="m">0</span>.00000000E+00
                     <span class="m">4</span>.44444444E-01  <span class="m">1</span>.11111111E-01  <span class="m">0</span>.00000000E+00
                     <span class="m">4</span>.16666667E-01  <span class="m">1</span>.66666667E-01  <span class="m">0</span>.00000000E+00
                     <span class="m">3</span>.88888889E-01  <span class="m">2</span>.22222222E-01  <span class="m">0</span>.00000000E+00
                     <span class="m">3</span>.61111111E-01  <span class="m">2</span>.77777778E-01  <span class="m">0</span>.00000000E+00
                     <span class="m">3</span>.33333333E-01  <span class="m">3</span>.33333333E-01  <span class="m">0</span>.00000000E+00
                     <span class="m">2</span>.77777778E-01  <span class="m">2</span>.77777778E-01  <span class="m">0</span>.00000000E+00
                     <span class="m">2</span>.22222222E-01  <span class="m">2</span>.22222222E-01  <span class="m">0</span>.00000000E+00
                     <span class="m">1</span>.66666667E-01  <span class="m">1</span>.66666667E-01  <span class="m">0</span>.00000000E+00
                     <span class="m">1</span>.11111111E-01  <span class="m">1</span>.11111111E-01  <span class="m">0</span>.00000000E+00
                     <span class="m">5</span>.55555556E-02  <span class="m">5</span>.55555556E-02  <span class="m">0</span>.00000000E+00
                     <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00

! Number of empty bands to include
nempty
<span class="m">10</span>

! Ratio betwen fine and coarse radial grid
! <span class="o">(</span>the coarse grid is used <span class="k">for</span> the calcualation
!  of densities<span class="o">)</span>. This needs to be <span class="nb">set</span> to one
! so that the grid specified <span class="k">in</span> the .in file
! of the atomic species is used everywhere
lradstp
 <span class="m">1</span>       : coarse/fine radial grid ratio
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-6ff30376-55b8-41f8-97b2-969416c45768", "#uuid-da4ed77c-28a3-4714-8f58-d50e365e2242") }); </script>

<p>There will be sections familiar from before, defining the lattice vectors,
structure, etc. (Mg has a 2-atom hexagonal unit cell.) Then there are a couple
of new lines for the metallic case:</p>
<div class="codehilite"><pre><span></span><code> ...
 ! Metallic options
 stype
  0          : Smearing type 0 - Gaussian
 autoswidth
  .true.     : Automatic determination of swidth
 ...
</code></pre></div>

<p>When you run <code>Elk</code> with this file, it will start a ground-state run (this might
take some time due to the dense k-point mesh), all the while automatically
determining the smearing width. At the end of the calculation the final value
of <code>swidth</code> will have been determined, and can be easily extracted with a <code>grep</code>:</p>
<div class="codehilite"><pre><span></span><code> grep &#39; smearing&#39; INFO.OUT
</code></pre></div>

<p>this should furnish you with a list:</p>
<div class="codehilite"><pre><span></span><code> Automatic determination of smearing width
 New smearing width :   0.1000000000E-02
 New smearing width :   0.4116175210E-02
 New smearing width :   0.4056329377E-02
 New smearing width :   0.4060342507E-02
 New smearing width :   0.4078123678E-02
 New smearing width :   0.4097424577E-02
 New smearing width :   0.4105841081E-02
 New smearing width :   0.4109614663E-02
 New smearing width :   0.4109651379E-02
 New smearing width :   0.4109804149E-02
 New smearing width :   0.4109807004E-02
 New smearing width :   0.4109805701E-02
 New smearing width :   0.4109804616E-02
 New smearing width :   0.4109804468E-02
 New smearing width :   0.4109804441E-02
 New smearing width :   0.4109804423E-02
</code></pre></div>

<p>where the last value is the one we seek, i.e. the smearing at convergence.
Since this <code>Elk</code> file will also calculate the band structure, you will have a
<code>BAND.OUT</code> file at the end of this calculation to compare your <code>ABINIT</code> band
structure to. There is one more thing we need to check, and that is the Fermi energy:</p>
<div class="codehilite"><pre><span></span><code> grep &#39;Fermi  &#39; INFO.OUT

 Fermi                       :     0.116185305134    
 Fermi                       :     0.115496524671    
 Fermi                       :     0.122186414492    
 Fermi                       :     0.128341839155    
 Fermi                       :     0.132281493053    
 Fermi                       :     0.133819140456    
 Fermi                       :     0.134308473303    
 Fermi                       :     0.134328785350    
 Fermi                       :     0.134347853104    
 Fermi                       :     0.134347939064    
 Fermi                       :     0.134347635069    
 Fermi                       :     0.134347477436    
 Fermi                       :     0.134347453635    
 Fermi                       :     0.134347448126    
 Fermi                       :     0.134347446032    
 Fermi                       :     0.134347446149
</code></pre></div>

<p>The last one is the Fermi energy at convergence. We will need this later when
we compare band structures to align the band plots at the Fermi energy.</p>
<p>Now it&rsquo;s time to calculate the equilibrium lattice parameters. There is a
prepared file at: <a href="../paw3_assets/inputs/elk_Mg_equi.in">elk_Mg_equi.in</a>.</p>
<div class="text-center"><button id="uuid-530e6b95-6644-44a5-aa87-896e56fc2a69" class="md-button md-button--secondary"> View tutorial/paw3_assets/inputs/elk_Mg_equi.in </button></div>
<div id="uuid-9b85f77b-a2e0-4ed4-83f2-e07a2d88529e" class="my_dialog" title="tutorial/paw3_assets/inputs/elk_Mg_equi.in" hidden><div><div class="codehilite small-text"><pre><span></span>! Carbon, diamond structure <span class="o">(</span>FCC<span class="o">)</span>

! The tasks define what will be <span class="k">done</span> by the code:
! <span class="m">0</span> - Perform ground-state calculation from scratch
! <span class="m">1</span> - Restart GS calc. from STATE.OUT file
! <span class="m">20</span> - Calculate band structure as defined by plot1d
tasks
<span class="m">0</span>

!species
! <span class="m">12</span> : atomic number
! <span class="s1">&#39;Mg&#39;</span>
! <span class="s1">&#39;magnesium&#39;</span>
! <span class="m">44305</span>.30461        : atomic mass
! <span class="m">1</span>.899259351   <span class="m">37</span>.6052   : muffin-tin radius
!   <span class="m">5</span>                : number of occ. states
!   <span class="m">1</span>   <span class="m">0</span>   <span class="m">1</span>   <span class="m">2</span>    : 1s
!   <span class="m">2</span>   <span class="m">0</span>   <span class="m">1</span>   <span class="m">2</span>    : 2s
!   <span class="m">2</span>   <span class="m">1</span>   <span class="m">1</span>   <span class="m">2</span>    : 2p <span class="nv">m</span><span class="o">=</span><span class="m">0</span>
!   <span class="m">2</span>   <span class="m">1</span>   <span class="m">2</span>   <span class="m">4</span>    : 2p <span class="nv">m</span><span class="o">=</span><span class="m">1</span>
!   <span class="m">3</span>   <span class="m">0</span>   <span class="m">1</span>   <span class="m">2</span>    : 3s
!  -6.0              : core-valence cutoff energy

! Tolerance on convegence of band energies <span class="o">(</span>absolute<span class="o">)</span>
epsband
 <span class="m">1</span>.e-8

! Tolerance on conv. of potential <span class="o">(</span>relative<span class="o">)</span>
epspot
 <span class="m">1</span>.e-7

! Tolerance on conv. of total energy <span class="o">(</span>absolute<span class="o">)</span>
epsengy
 <span class="m">1</span>.e-6

! Use adaptive linear mixing of densities
! <span class="m">1</span> - Adaptive linear
! <span class="m">2</span> - Pulay mixing
mixtype
 <span class="m">3</span>

! Exchange-correlation functional to use
! LDA <span class="o">(</span>PW92<span class="o">)</span> is <span class="m">3</span> <span class="o">(</span>default<span class="o">)</span> <span class="o">(</span>equiv. Abinit ixc <span class="m">7</span><span class="o">)</span>
! GGA-PBE    is <span class="m">20</span>          <span class="o">(</span>equiv. Abinit ixc <span class="m">11</span><span class="o">)</span>
! <span class="o">(</span>see Elk manual <span class="k">for</span> other options<span class="o">)</span>
xctype
 <span class="m">3</span>

! Define lattice vectors
! Magnesium has a hexagonal native structure
! with <span class="nv">a</span><span class="o">=</span><span class="nv">b</span><span class="o">=</span><span class="m">3</span>.20927 Å <span class="nv">c</span><span class="o">=</span><span class="m">5</span>.21033 Å  <span class="nv">alpha</span><span class="o">=</span><span class="m">90</span> <span class="nv">beta</span><span class="o">=</span><span class="m">90</span> <span class="nv">gamma</span><span class="o">=</span><span class="m">60</span>
! <span class="o">(</span>experimental, at <span class="m">25</span> degrees Celsius<span class="o">)</span>

! Scale factor to be applied to all lattice vectors
scale
 <span class="m">1</span>.00

avec
     <span class="m">6</span>.0646414   <span class="m">0</span>.0000000   <span class="m">0</span>.0000000
     <span class="m">3</span>.0323207   <span class="m">5</span>.2521335   <span class="m">0</span>.0000000
     <span class="m">0</span>.0000000   <span class="m">0</span>.0000000   <span class="m">9</span>.8460968

! Define atomic species
atoms
   <span class="m">1</span>   : nspecies - Number of species
<span class="s1">&#39;Mg.in&#39;</span> : spfname - Name of species file
   <span class="m">2</span>   : natoms<span class="p">;</span> atposl, bfcmt below - Atoms <span class="k">in</span> cell, reduced coord. and moments
    <span class="m">0</span>.33333333    <span class="m">0</span>.33333333    <span class="m">0</span>.2500000    <span class="m">0</span>.00000000  <span class="m">0</span>.00000000  <span class="m">0</span>.00000000
    <span class="m">0</span>.66666666    <span class="m">0</span>.66666666    <span class="m">0</span>.7500000    <span class="m">0</span>.00000000  <span class="m">0</span>.00000000  <span class="m">0</span>.00000000

! Don<span class="s1">&#39;t set muffin-tin radius automatically</span>
<span class="s1">autormt</span>
<span class="s1"> .false.</span>

<span class="s1">! Freeze core states (in abinit PAW, they are frozen)</span>
<span class="s1">frozencr</span>
<span class="s1"> .false.</span>

<span class="s1">! Path to atomic data files</span>
<span class="s1">sppath</span>
<span class="s1">  &#39;</span>./<span class="err">&#39;</span>

! Monkhorst-pack k-point grid
ngridk
 <span class="m">10</span>  <span class="m">10</span>  <span class="m">10</span>

! Shift of MP grid
vkloff
<span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5

! Metallic options
stype
 <span class="m">0</span>          : Smearing <span class="nb">type</span> <span class="m">0</span> - Gaussian
swidth
 <span class="m">0</span>.4109804423E-02      : Smearing width

! Set upper limit of <span class="p">|</span>G+k<span class="p">|</span>, the number below is
! <span class="o">(</span>MT radius<span class="o">)</span>*max<span class="o">(</span><span class="p">|</span>G+k<span class="p">|</span><span class="o">)</span>
rgkmax
<span class="m">9</span>.0

! A value of <span class="m">0</span>.0 makes this being <span class="nb">set</span> automatically
gmaxvr
<span class="m">0</span>.0

! Number of empty bands to include
nempty
<span class="m">10</span>

! Ratio betwen fine and coarse radial grid
! <span class="o">(</span>the coarse grid is used <span class="k">for</span> the calcualation
!  of densities<span class="o">)</span>. This needs to be <span class="nb">set</span> to one
! so that the grid specified <span class="k">in</span> the .in file
! of the atomic species is used everywhere
lradstp
 <span class="m">1</span>       : coarse/fine radial grid ratio
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-9b85f77b-a2e0-4ed4-83f2-e07a2d88529e", "#uuid-530e6b95-6644-44a5-aa87-896e56fc2a69") }); </script>

<p>As before copy this to your directory rename it to <code>elk.in</code>. The layout of this file looks pretty much
like the one before, except the band structure keywords are missing, and now
switdth is fixed to the value we extracted before:</p>
<div class="codehilite"><pre><span></span><code> ...
 ! Metallic options
 stype
  0          : Smearing type 0 - Gaussian
 swidth
  0.4109804423E-02     : Smearing width
 ...
</code></pre></div>

<p>To calculate the equilibrium lattice parameters, we are going to use the bulk
modulus, which is a quantity defined with respect to a scaling of the entire
cell (as opposed to <em>Young&rsquo;s modulus</em>, for instance, which is defined with
respect to linear scaling along the lattice vectors). There is a handy <code>scale</code>
keyword for <code>Elk</code>, which will accomplish this for us. If we look at the region
where the lattice is defined:</p>
<div class="codehilite"><pre><span></span><code> ...
 ! Define lattice vectors
 ! Magnesium has an hexagonal native structure
 ! with a=b=3.20927 Å c=5.21033 Å  alpha=90 beta=90 gamma=60
 ! (experimental, at 25 degrees Celsius)

 ! Scale factor to be applied to all lattice vectors
 scale
  1.00

  with
       6.0646414   0.0000000   0.0000000
       3.0323207   5.2521335   0.0000000
       0.0000000   0.0000000   9.8460968
 ...
</code></pre></div>

<p>We will here also need to perform several calculations (like we did for the
diamond case) and we need to change the value of the <code>scale</code> keyword for each
one. A good set of values would be: 0.94, 0.96, 0.98, 1.0, 1.02 1.04 and 1.06,
i.e. a change of scale in steps of 2% with seven values in total spaced around
the experimental equilibrium lattice structure.</p>
<p>After each run, as before, you should collect the value of the unit cell
volume and the total energy. After seven runs you should have a set of numbers
which you can put in an <code>eos.in</code> file (depending on the system, your actual
values may differ slightly from these):</p>
<div class="codehilite"><pre><span></span><code> <span class="s2">&quot;</span><span class="s">Mg - bulk metallic</span><span class="s2">&quot;</span>
  <span class="mi">2</span>                      : <span class="nv">natoms</span> <span class="o">-</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">atoms</span>
  <span class="mi">1</span>                      : <span class="nv">etype</span> <span class="o">-</span> <span class="nv">equation</span> <span class="nv">of</span> <span class="nv">state</span> <span class="nv">fit</span> <span class="nv">type</span>
  <span class="mi">260</span>.<span class="mi">0</span> <span class="mi">374</span>.<span class="mi">0</span> <span class="mi">100</span>        : <span class="nv">vplt1</span>, <span class="nv">vplt2</span>, <span class="nv">nvplt</span> <span class="o">-</span> <span class="nv">start</span>, <span class="k">end</span> <span class="nv">and</span> #<span class="nv">pts</span> <span class="k">for</span> <span class="nv">fit</span>
  <span class="mi">7</span>                      : <span class="nv">nevpt</span> <span class="o">-</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">supplied</span> <span class="nv">points</span>
  <span class="mi">260</span>.<span class="mi">4884939</span>  <span class="o">-</span><span class="mi">399</span>.<span class="mi">042203252</span>
  <span class="mi">277</span>.<span class="mi">4716924</span>  <span class="o">-</span><span class="mi">399</span>.<span class="mi">044435776</span>
  <span class="mi">295</span>.<span class="mi">1774734</span>  <span class="o">-</span><span class="mi">399</span>.<span class="mi">044943459</span>
  <span class="mi">313</span>.<span class="mi">6208908</span>  <span class="o">-</span><span class="mi">399</span>.<span class="mi">043962316</span>
  <span class="mi">332</span>.<span class="mi">8169982</span>  <span class="o">-</span><span class="mi">399</span>.<span class="mi">041812744</span>
  <span class="mi">352</span>.<span class="mi">7808497</span>  <span class="o">-</span><span class="mi">399</span>.<span class="mi">038751783</span>
  <span class="mi">373</span>.<span class="mi">5274988</span>  <span class="o">-</span><span class="mi">399</span>.<span class="mi">034932869</span>
</code></pre></div>

<p>Upon using the eos utility you will get standard type of outputs in <code>PARAM.OUT</code>:</p>
<div class="codehilite"><pre><span></span><code> Mg - bulk metallic

 Universal EOS
 Vinet P et al., J. Phys.: Condens. Matter 1, p1941 (1989)

 (Default units are atomic: Hartree, Bohr etc.)

  V0                =            291.6029247    
  E0                =           -399.0449584    
  B0                =           0.1364455738E-02
  B0&#39;               =            4.304295809

  B0 (GPa)          =            40.14366703
</code></pre></div>

<p>Now we have to translate this in terms of the lattice parameters. The
equilibrium scale factor is given by:
<span><span class="MathJax_Preview">scale = (\frac{V_0}{V_1})^{\frac{1}{3}} = (\frac{291.6029247}{313.6208908})^{\frac{1}{3}} = 0.9760280459</span><script type="math/tex">scale = (\frac{V_0}{V_1})^{\frac{1}{3}} = (\frac{291.6029247}{313.6208908})^{\frac{1}{3}} = 0.9760280459</script></span></p>
<p>Where <span><span class="MathJax_Preview">V_1</span><script type="math/tex">V_1</script></span> is the volume with scale set to 1.0. Multiplying all basis vectors
with this scale factor, we have that:</p>
<div class="codehilite"><pre><span></span><code> Equilibrium        Bulk modulus       lattice
 volume, V0         B0                parameters
 291.6029           40.1437            a = b = 3.1323 Å  c = 5.0854 Å
</code></pre></div>

<p>Now we have all the information needed to proceed with the <code>ABINIT</code> calculation.</p>
<h3 id="42-magnesium-the-abinit-calculation">4.2. Magnesium - The <code>ABINIT</code> calculation<a class="headerlink" href="#42-magnesium-the-abinit-calculation" title="Permanent link">&para;</a></h3>
<p>As usual, it&rsquo;s best to prepare a separate subdirectory for the atomic data and
the <code>ABINIT</code> test. We will assume that the subdirectories have been created as:</p>
<div class="codehilite"><pre><span></span><code> mkdir Mg_atompaw
 mkdir Mg_atompaw/abinit_test
 mkdir Mg_atompaw/abinit_test/outputs
</code></pre></div>

<p>and that your current directory is <code>./Mg_atompaw</code>. For the Mg <code>ATOMPAW</code> input,
use the file  <a href="../paw3_assets/inputs/Mg.input">Mg.input</a>.</p>
<div class="text-center"><button id="uuid-2b4d9e3a-e40a-4bbc-8a08-2b2b1a3502e4" class="md-button md-button--secondary"> View tutorial/paw3_assets/inputs/Mg.input </button></div>
<div id="uuid-ba4a7773-ed6d-4c55-a811-8b9199c4559b" class="my_dialog" title="tutorial/paw3_assets/inputs/Mg.input" hidden><div><pre class="small-text">
Mg 12
LDA-PW scalarrelativistic loggrid 801 40. logderivrange -10 40 1000
3 3 0 0 0 0
3 1 0
0 0 0
c
v
v
v
v
1
1.9
n
n
custom polynom2 7 11 vanderbiltortho sincshape
2 0 ultrasoft
1.9
1.9
1.9
1.9
XMLOUT
prtcorewf noxcnhat nospline noptim
END

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-ba4a7773-ed6d-4c55-a811-8b9199c4559b", "#uuid-2b4d9e3a-e40a-4bbc-8a08-2b2b1a3502e4") }); </script>

<p>Note that there are not really many projectors in this dataset, only two
per angular momentum channel. It should be possible to make this much better
adding extra projectors, and maybe even unoccupied <span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>-states. If you run
atompaw with this, you can have a look with the bundled <code>plot_MG_all.p</code> file
and others like it to get a feel for the quality of this dataset.</p>
<p>Generate the <code>ABINIT</code> dataset file, and make sure it&rsquo;s given as:
<code>./Mg_atompaw/Mg_LDA-PW-paw.xml</code>, then go to the subdirectory for the <code>ABINIT</code> test,
and copy these files to it: <a href="../paw3_assets/inputs/ab_Mg_test.abi">ab_Mg_test.abi</a>,
and <a href="../paw3_assets/inputs/ab_Mg_equi.abi">ab_Mg_equi.abi</a>. 
The file for testing the convergence has already been set up so that the smearing
strategy is equivalent to the <code>Elk</code> one, as evidenced by the lines:</p>
<div class="text-center"><button id="uuid-72e02eac-c2d5-4596-9ccb-386c1508fdc4" class="md-button md-button--secondary"> View tutorial/paw3_assets/inputs/ab_Mg_test.abi </button></div>
<div id="uuid-4bdbf1f0-d05e-448b-b930-bb032d2459db" class="my_dialog" title="tutorial/paw3_assets/inputs/ab_Mg_test.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Input for PAW3 tutorial</span>
<span class="c1"># Mg - hexagonal structure</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Directories and files</span>

<span class="nv">pseudos</span><span class="o">=</span><span class="s2">&quot;Mg.LDA-PW-paw.xml&quot;</span>

<span class="nv">pp_dirpath</span><span class="o">=</span><span class="s2">&quot;../&quot;</span>
<span class="nv">outdata_prefix</span><span class="o">=</span><span class="s2">&quot;outputs/ab_Mg_test_o&quot;</span>
<span class="nv">tmpdata_prefix</span><span class="o">=</span><span class="s2">&quot;outputs/ab_Mg_test&quot;</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Define the different datasets</span>

ndtset <span class="m">18</span>       <span class="c1"># 18 double-index datasets</span>
udtset <span class="m">9</span> <span class="m">2</span>      <span class="c1"># 1st index running from 1 to 9 and the 2nd from 1 to 2</span>

<span class="c1">#Cutoff variables</span>
ecut:?  <span class="m">5</span>.0
ecut+?  <span class="m">5</span>.0
pawecutdg <span class="m">110</span>.0
ecutsm <span class="m">0</span>.5

<span class="c1">#Dataset 1</span>
<span class="c1">#Ground-state run</span>
kptopt?1 <span class="m">1</span>
nshiftk?1 <span class="m">1</span>
shiftk?1 <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5
ngkpt <span class="m">10</span> <span class="m">10</span> <span class="m">10</span>
tolvrs?1 <span class="m">1</span>.0d-14
nstep?1  <span class="m">150</span>
getwfk21 <span class="m">11</span>
getwfk31 <span class="m">21</span>
getwfk41 <span class="m">31</span>
getwfk51 <span class="m">41</span>
getwfk61 <span class="m">51</span>
getwfk71 <span class="m">61</span>
getwfk81 <span class="m">71</span>
getwfk91 <span class="m">81</span>
nbdbuf?1 <span class="m">5</span>
nband?1  <span class="m">25</span>

<span class="c1">#Dataset 2</span>
<span class="c1">#Definition of the k-point grid</span>
<span class="c1">#the band structure</span>
iscf?2    -2
getden?2  -1
kptopt?2  -7
nband?2   <span class="m">20</span>
nbdbuf?2   <span class="m">0</span>
ndivk?2    <span class="m">6</span> <span class="m">6</span> <span class="m">6</span> <span class="m">10</span> <span class="m">6</span> <span class="m">6</span> <span class="m">6</span> <span class="c1"># divisions of the 6 segments</span>
kptbounds?2 
           <span class="m">0</span>   <span class="m">0</span>   <span class="m">1</span>/2 <span class="c1"># A</span>
           <span class="m">1</span>/2 <span class="m">0</span>   <span class="m">1</span>/2 <span class="c1"># L</span>
           <span class="m">1</span>/3 <span class="m">1</span>/3 <span class="m">1</span>/2 <span class="c1"># H</span>
           <span class="m">0</span>   <span class="m">0</span>   <span class="m">1</span>/2 <span class="c1"># A</span>
           <span class="m">0</span>   <span class="m">0</span>   <span class="m">0</span>   <span class="c1"># Gamma</span>
           <span class="m">1</span>/2 <span class="m">0</span>   <span class="m">0</span>   <span class="c1"># M</span>
           <span class="m">1</span>/3 <span class="m">1</span>/3 <span class="m">0</span>   <span class="c1"># K</span>
           <span class="m">0</span>   <span class="m">0</span>   <span class="m">0</span>   <span class="c1"># Gamma</span>

tolwfr?2  <span class="m">1</span>.0d-18
enunit?2  <span class="m">0</span>             <span class="c1"># Will output the eigenenergies in Ha</span>
nstep?2   <span class="m">150</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Definition of the Unit cell</span>

<span class="c1">#Definition of the unit cell (hexagonal)</span>
acell <span class="m">2</span>*3.20927 <span class="m">5</span>.21033 angstrom
angdeg <span class="m">90</span> <span class="m">90</span> <span class="m">60</span>

<span class="c1">#Definition of the atom types</span>
ntypat <span class="m">1</span>          <span class="c1"># One tom type</span>
znucl <span class="m">12</span>           <span class="c1"># Magnesium </span>

<span class="c1">#Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># 2 atoms per cell</span>
typat <span class="m">1</span> <span class="m">1</span>         <span class="c1"># each of type carbon</span>
xred              <span class="c1"># This keyword indicates that the location of the atoms</span>
                  <span class="c1"># will follow, one triplet of number for each atom</span>
   <span class="m">1</span>/3   <span class="m">1</span>/3   <span class="m">1</span>/4
   <span class="m">2</span>/3   <span class="m">2</span>/3   <span class="m">3</span>/4

<span class="c1">#Parameters for metals</span>
tsmear <span class="m">0</span>.4109804423E-02
occopt <span class="m">7</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Miscelaneous</span>

<span class="c1">#GS convergence fix</span>
istwfk *1
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-4bdbf1f0-d05e-448b-b930-bb032d2459db", "#uuid-72e02eac-c2d5-4596-9ccb-386c1508fdc4") }); </script>
<div class="text-center"><button id="uuid-493fbdd0-4298-4531-b385-9279aa8c86d9" class="md-button md-button--secondary"> View tutorial/paw3_assets/inputs/ab_Mg_equi.abi </button></div>
<div id="uuid-3a0907d7-8191-4254-8950-099eda1cf74f" class="my_dialog" title="tutorial/paw3_assets/inputs/ab_Mg_equi.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Input for PAW3 tutorial</span>
<span class="c1"># Mg - hexagonal structure - metallic bulk</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Directories and files</span>

<span class="nv">pseudos</span><span class="o">=</span><span class="s2">&quot;Mg.LDA-PW-paw.xml&quot;</span>

<span class="nv">pp_dirpath</span><span class="o">=</span><span class="s2">&quot;../&quot;</span>
<span class="nv">outdata_prefix</span><span class="o">=</span><span class="s2">&quot;outputs/ab_Mg_equi_o&quot;</span>
<span class="nv">tmpdata_prefix</span><span class="o">=</span><span class="s2">&quot;outputs/ab_Mg_equi&quot;</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Define the different datasets</span>

ndtset <span class="m">7</span>             <span class="c1"># 7 datasets</span>
acell: <span class="m">3</span>*0.94 Bohr   <span class="c1"># The starting values of the cell parameters</span>
acell+ <span class="m">3</span>*0.02 Bohr   <span class="c1"># The increment of acell from one dataset to the other</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Convergence parameters</span>

<span class="c1">#Cutoff variables</span>
ecut  <span class="m">15</span>.0
pawecutdg <span class="m">110</span>.0
ecutsm <span class="m">0</span>.5

<span class="c1">#Definition of the k-point grid</span>
chksymbreak <span class="m">0</span>
kptopt <span class="m">1</span>
nshiftk <span class="m">1</span>
shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5
ngkpt <span class="m">10</span> <span class="m">10</span> <span class="m">10</span>

<span class="c1">#Bands and occupations</span>
nband  <span class="m">25</span>
nbdbuf <span class="m">5</span>

<span class="c1">#Parameters for metals</span>
tsmear <span class="m">0</span>.4109804423E-02
occopt <span class="m">7</span>

<span class="c1">#SCF cycle parameters</span>
tolvrs <span class="m">1</span>.0d-14
nstep  <span class="m">150</span>


<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#Definition of the Unit cell</span>

<span class="c1">#Definition of the unit cell</span>
acell <span class="m">3</span>*1.
rprim
     <span class="m">6</span>.0646414   <span class="m">0</span>.0000000   <span class="m">0</span>.0000000
     <span class="m">3</span>.0323207   <span class="m">5</span>.2521335   <span class="m">0</span>.0000000
     <span class="m">0</span>.0000000   <span class="m">0</span>.0000000   <span class="m">9</span>.8460968

<span class="c1">#Definition of the atom types</span>
ntypat <span class="m">1</span>          <span class="c1"># One tom type</span>
znucl <span class="m">12</span>          <span class="c1"># Magnesium </span>

<span class="c1">#Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># 2 atoms per cell</span>
typat <span class="m">1</span> <span class="m">1</span>         <span class="c1"># each of type carbon</span>
xred              <span class="c1"># This keyword indicates that the location of the atoms</span>
                  <span class="c1"># will follow, one triplet of number for each atom</span>
   <span class="m">1</span>/3   <span class="m">1</span>/3   <span class="m">1</span>/4
   <span class="m">2</span>/3   <span class="m">2</span>/3   <span class="m">3</span>/4
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-3a0907d7-8191-4254-8950-099eda1cf74f", "#uuid-493fbdd0-4298-4531-b385-9279aa8c86d9") }); </script>

<div class="codehilite"><pre><span></span><code> ...
 # <span class="nv">Parameters</span> <span class="k">for</span> <span class="nv">metals</span>
 <span class="nv">tsmear</span> <span class="mi">0</span>.<span class="mi">4109804423</span><span class="nv">E</span><span class="o">-</span><span class="mi">02</span>
 <span class="nv">occopt</span> <span class="mi">7</span>
 ...
</code></pre></div>

<p>inside it. The <code>occopt 7</code> input variable corresponds exactly to the Gaussian
smearing which is the default for the <code>Elk</code> code. (In fact it is the 0<sup>th</sup> order
Methfessel-Paxton expression <a class="wikilink citation-wikilink" data-tippy-content="High-precision sampling for Brillouin-zone integration in metals" data-toggle="popover" href="/theory/bibliography#methfessel1989">[Methfessel1989]</a>, for other
possibilities compare the entries for the keyword <code>stype</code> in the <code>Elk</code> manual
and the entries for <code>occopt</code> in ABINIT).</p>
<p>Now run the test input file (if your computer has several cores, you might
want to take advantage of that and run <code>ABINIT</code> in parallel). The test suite can
take some time to complete, because of the dense <em>k-point mesh sampling</em>. Make
sure you pipe the screen to a log file: <code>log_Mg_test</code></p>
<p>When the run is finished, we can check the convergence properties as before,
and we that an <code>ecut</code> of 15 Ha is definitely enough. The interesting thing will
now be to compare the band structures. First we need to check the Fermi energy
of the <code>ABINIT</code> calculation, if you do a <code>grep</code>:</p>
<div class="codehilite"><pre><span></span><code> grep &#39; Fermi&#39; log_Mg_test
</code></pre></div>

<p>you will see a long list of Fermi energies, one for each iteration, finally
converging towards one number:</p>
<div class="codehilite"><pre><span></span><code> ...
 newocc : new Fermi energy is       0.137605 , with nelect=     20.000000
 newocc : new Fermi energy is       0.137605 , with nelect=     20.000000
 newocc : new Fermi energy is       0.137605 , with nelect=     20.000000
</code></pre></div>

<p>The last one of these is the final <em>Fermi energy</em> of the <code>ABINIT</code> calculation. The
<code>abinit2elk</code> band comparison <em>script</em> can now be given the <em>Fermi energies</em> of the
two different calculations and align band structures there. Copy the
<code>BAND.OUT</code> file from the <code>Elk</code> calculation to the current directory, as well as
the band comparison script <code>comp_bands_abinit2elk.py</code>. This script can also be
used to align the bands at different Fermi energies. However, in the
<code>BAND.OUT</code> file from <code>Elk</code>, the bands are already shifted so that the Fermi
energy is at zero, so it is only the alignment of the <code>ABINIT</code> file that is required:</p>
<div class="codehilite"><pre><span></span><code> python comp_bands_abinit2elk.py ./outputs/ab_Mg_test_o_DS32_EIG BAND.OUT Fermi 0.137605 0.0 eV
</code></pre></div>

<p>Issuing this command will provide the final lines:</p>
<div class="codehilite"><pre><span></span><code> ...
 #        nvals:   940
 # average diff:     0.029652  eV
 # minimum diff:    -0.036252  eV
 # maximum diff:     0.215973  eV
 ...
</code></pre></div>

<p>Which means that we are on average accurate to about 0.03 eV. If you pipe the
output to a file <code>bands_abinit_elk.dat</code>, and go into gnuplot and use the script <code>plot_Mg_bands.p</code>:</p>
<div class="codehilite"><pre><span></span><code> <span class="n">gnuplot</span><span class="o">&gt;</span> <span class="nb">load</span> <span class="s1">&#39;plot_Mg_bands.p&#39;</span>
</code></pre></div>

<p>You should get a plot that looks something like this:</p>
<p><img alt="Comparison of Mg ABINIT and Elk bands alignet at Fermi level" src="../paw3_assets/images/band_abinit_elk_III.png" /></p>
<p>As we can see, the bands should fit quite well. Finally, for the structural, a
run of the <code>ab_Mg_equi.abi</code> file gives us all the information we need for the
creation of an <code>eos.in</code> file:</p>
<div class="codehilite"><pre><span></span><code> <span class="s2">&quot;</span><span class="s">Mg - bulk metallic (ABINIT)</span><span class="s2">&quot;</span>
  <span class="mi">2</span>                      : <span class="nv">natoms</span> <span class="o">-</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">atoms</span>
  <span class="mi">1</span>                      : <span class="nv">etype</span> <span class="o">-</span> <span class="nv">equation</span> <span class="nv">of</span> <span class="nv">state</span> <span class="nv">fit</span> <span class="nv">type</span>
  <span class="mi">260</span>.<span class="mi">0</span> <span class="mi">380</span>.<span class="mi">0</span> <span class="mi">100</span>        : <span class="nv">vplt1</span>, <span class="nv">vplt2</span>, <span class="nv">nvplt</span> <span class="o">-</span> <span class="nv">start</span>, <span class="k">end</span> <span class="nv">and</span> #<span class="nv">pts</span> <span class="k">for</span> <span class="nv">fit</span>
  <span class="mi">7</span>                      : <span class="nv">nevpt</span> <span class="o">-</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">supplied</span> <span class="nv">points</span>
  <span class="mi">2</span>.<span class="mi">6048849</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">2697509579</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>
  <span class="mi">2</span>.<span class="mi">7747169</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">2697742149</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>
  <span class="mi">2</span>.<span class="mi">9517747</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">2697801365</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>
  <span class="mi">3</span>.<span class="mi">1362089</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">2697716194</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>
  <span class="mi">3</span>.<span class="mi">3281700</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">2697512888</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>
  <span class="mi">3</span>.<span class="mi">5278085</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">2697212368</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>
  <span class="mi">3</span>.<span class="mi">7352750</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">2696833809</span><span class="nv">E</span><span class="o">+</span><span class="mi">02</span>
</code></pre></div>

<p>When the eos utility is run, we get the equilibrium volume and Bulk modulus:</p>
<div class="codehilite"><pre><span></span><code> ...
 V0                =            293.0281803
 ...
 B0 (GPa)          =            39.19118222
</code></pre></div>

<p>Converting this to lattice parameters as before, we can compare this with the <code>Elk</code> run:</p>
<div class="codehilite"><pre><span></span><code> Equilibrium        Bulk modulus       lattice
 volume, V0         B0                parameters
 291.6029           40.1437        a = b = 3.1323 Å  c = 5.0854 Å  (Elk)
 293.0282           39.1912        a = b = 3.1374 Å  c = 5.0937 Å  (ABINIT)
</code></pre></div>

<p>Which is very close.</p>
<p>Again, this is a decent dataset for ground-state calculations, but it can
probably be made even better. You are encouraged to try and do this.</p>
<h2 id="5-paw-datasets-for-gw-calculations">5. PAW datasets for GW calculations<a class="headerlink" href="#5-paw-datasets-for-gw-calculations" title="Permanent link">&para;</a></h2>
<p>There are a number of issues to consider when making datasets for GW
calculations, here is a list of a few:</p>
<ul>
<li>
<p>Care needs to be taken so that the logarithmic derivatives match for much higher energies
    than for ground-state calculations. They should at least match well up to the energy of
    the unoccupied states used in the calculation. The easiest way of ensuring this is increasing
    the number of projectors per state.</p>
</li>
<li>
<p>The on-site basis needs to be of higher quality to minimise truncation error due to the finite number
    of on-site basis functions (projectors). Again, this requires more projectors per angular momentum channel.</p>
</li>
<li>
<p>As a rule of thumb, a PAW dataset for GW should have at least three projectors per state, if not more.</p>
</li>
<li>
<p>A particularly sensitive thing is the quality of the expansion of the pseudised plane-wave part in terms of the on-site basis.
     This can be checked by using the density of states (DOS), as described in the 
     <a href="/tutorial/paw1">first PAW tutorial</a>.</p>
</li>
</ul>
                
                  
                
              

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/"
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../paw2/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              PAW2
            </div>
          </div>
        </a>
      
      
        <a href="../positron/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              positron
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version b'10.2.3-dirty'</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
            (MS, MT)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "b'10.2.3-dirty'"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>