
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/gw1/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>GW1 - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#first-tutorial-on-gw" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              GW1
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../variables/" class="md-tabs__link">
        Variables
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        Abitk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_15" type="checkbox" id="__nav_1_15" >
      
      <label class="md-nav__link" for="__nav_1_15">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_15">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        AtomCentered
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        CalcUJ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        GWR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        Install
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        NMR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basepar/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_crpa/" class="md-nav__link">
        cRPA U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lruj/" class="md-nav__link">
        Linear Response U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" checked>
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          GW1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        GW1
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-quasi-particle-band-structure-of-silicon-in-the-gw-approximation" class="md-nav__link">
    The quasi-particle band structure of Silicon in the GW approximation.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-general-example-of-an-almost-converged-gw-calculation" class="md-nav__link">
    1 General example of an almost converged GW calculation
  </a>
  
    <nav class="md-nav" aria-label="1 General example of an almost converged GW calculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1a-the-four-steps-of-a-gw-calculation" class="md-nav__link">
    1.a The four steps of a GW calculation.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1b-generating-the-kohn-sham-band-structure-the-wfk-file" class="md-nav__link">
    1.b Generating the Kohn-Sham band structure: the WFK file.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1c-generating-the-screening-the-scr-file" class="md-nav__link">
    1.c Generating the screening: the SCR file.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1d-computing-the-gw-energies" class="md-nav__link">
    1.d Computing the GW energies.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1e-examination-of-the-output-file" class="md-nav__link">
    1.e Examination of the output file.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-preparing-convergence-studies-kohn-sham-structure-wfk-file-and-screening-scr-file" class="md-nav__link">
    2 Preparing convergence studies: Kohn-Sham structure (WFK file) and screening (SCR file)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-convergence-of-the-self-energy-with-respect-to-the-number-of-bands" class="md-nav__link">
    3 Convergence of the self-energy with respect to the number of bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-convergence-of-the-screening-with-respect-to-the-number-of-bands" class="md-nav__link">
    4 Convergence of the screening with respect to the number of bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-convergence-of-the-screening-matrix-with-respect-to-the-number-of-planewaves" class="md-nav__link">
    5 Convergence of the screening matrix with respect to the number of planewaves
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-calculation-of-the-gw-corrections-for-the-band-gap-at-the-zone-center" class="md-nav__link">
    6 Calculation of the GW corrections for the band gap at the zone center
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-how-to-compute-gw-band-structures" class="md-nav__link">
    7 How to compute GW band structures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-advanced-features-of-gw-calculations" class="md-nav__link">
    8 Advanced features of GW calculations
  </a>
  
    <nav class="md-nav" aria-label="8 Advanced features of GW calculations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calculations-without-using-the-plasmon-pole-model" class="md-nav__link">
    Calculations without using the Plasmon-Pole model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self-consistent-calculations" class="md-nav__link">
    Self-consistent calculations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gwr_intro/" class="md-nav__link">
        GWR_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gwr1/" class="md-nav__link">
        GWR1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lw_quad/" class="md-nav__link">
        quadrupoles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_tdep_legacy/" class="md-nav__link">
        eph_tdep_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        Troubleshooting (old-dokuwiki)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        Tuning (old-dokuwiki)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-quasi-particle-band-structure-of-silicon-in-the-gw-approximation" class="md-nav__link">
    The quasi-particle band structure of Silicon in the GW approximation.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-general-example-of-an-almost-converged-gw-calculation" class="md-nav__link">
    1 General example of an almost converged GW calculation
  </a>
  
    <nav class="md-nav" aria-label="1 General example of an almost converged GW calculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1a-the-four-steps-of-a-gw-calculation" class="md-nav__link">
    1.a The four steps of a GW calculation.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1b-generating-the-kohn-sham-band-structure-the-wfk-file" class="md-nav__link">
    1.b Generating the Kohn-Sham band structure: the WFK file.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1c-generating-the-screening-the-scr-file" class="md-nav__link">
    1.c Generating the screening: the SCR file.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1d-computing-the-gw-energies" class="md-nav__link">
    1.d Computing the GW energies.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1e-examination-of-the-output-file" class="md-nav__link">
    1.e Examination of the output file.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-preparing-convergence-studies-kohn-sham-structure-wfk-file-and-screening-scr-file" class="md-nav__link">
    2 Preparing convergence studies: Kohn-Sham structure (WFK file) and screening (SCR file)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-convergence-of-the-self-energy-with-respect-to-the-number-of-bands" class="md-nav__link">
    3 Convergence of the self-energy with respect to the number of bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-convergence-of-the-screening-with-respect-to-the-number-of-bands" class="md-nav__link">
    4 Convergence of the screening with respect to the number of bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-convergence-of-the-screening-matrix-with-respect-to-the-number-of-planewaves" class="md-nav__link">
    5 Convergence of the screening matrix with respect to the number of planewaves
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-calculation-of-the-gw-corrections-for-the-band-gap-at-the-zone-center" class="md-nav__link">
    6 Calculation of the GW corrections for the band gap at the zone center
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-how-to-compute-gw-band-structures" class="md-nav__link">
    7 How to compute GW band structures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-advanced-features-of-gw-calculations" class="md-nav__link">
    8 Advanced features of GW calculations
  </a>
  
    <nav class="md-nav" aria-label="8 Advanced features of GW calculations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calculations-without-using-the-plasmon-pole-model" class="md-nav__link">
    Calculations without using the Plasmon-Pole model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self-consistent-calculations" class="md-nav__link">
    Self-consistent calculations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/gw1.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="first-tutorial-on-gw">First tutorial on GW<a class="headerlink" href="#first-tutorial-on-gw" title="Permanent link">&para;</a></h1>
<h2 id="the-quasi-particle-band-structure-of-silicon-in-the-gw-approximation">The quasi-particle band structure of Silicon in the GW approximation.<a class="headerlink" href="#the-quasi-particle-band-structure-of-silicon-in-the-gw-approximation" title="Permanent link">&para;</a></h2>
<p>This tutorial aims at showing how to calculate self-energy corrections to the
DFT Kohn-Sham (KS) eigenvalues in the GW approximation.</p>
<p>A brief description of the formalism and of the equations implemented in the
code can be found in the <a class="wikilink theory-wikilink" href="/theory/mbt">GW_notes</a>.
The different formulas of the GW formalism have been written in a <a class="wikilink abifile-wikilink" href="/topics/documents/gwa.pdf" target="_blank">pdf document</a>
by Valerio Olevano who also wrote the first version of this tutorial.
For a much more consistent discussion of the theoretical aspects of the GW
method we refer the reader to the review article
<a class="wikilink citation-wikilink" data-tippy-content="Quasiparticle Calculations in Solids" data-toggle="popover" href="/theory/bibliography#aulbur2001">Quasiparticle calculations in solids</a> by W.G Aulbur et al
also available <a href="https://www.abinit.org/sites/default/files/quasiparticle_calculations_in_solids.pdf.bz2">here</a>.</p>
<p>It is suggested to acknowledge the efforts of developers of
the GW part of ABINIT, by citing the <a class="wikilink citation-wikilink" data-tippy-content="A brief introduction to the ABINIT software package" data-toggle="popover" href="/theory/bibliography#gonze2005">2005 ABINIT publication</a>.</p>
<p>The user should be familiarized with the four basic tutorials of ABINIT,
see the <a href="/tutorial">tutorial home page</a>.
After this first tutorial on GW, you should read the <a href="/tutorial/gw2">second GW tutorial</a>.</p>
<p>This tutorial should take about 2 hours.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir <span class="c1"># Change this line</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>      <span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/             <span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> ~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="/tutorial/basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic on parallelism</a>.</p>
</div>
<h2 id="1-general-example-of-an-almost-converged-gw-calculation">1 General example of an almost converged GW calculation<a class="headerlink" href="#1-general-example-of-an-almost-converged-gw-calculation" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider to work in a different subdirectory as
for the other tutorials. Why not Work_gw1?</em></p>
<p>At the end of <a href="/tutorial/base3">tutorial 3</a>, we computed the KS band
structure of silicon. In this approximation, the band dispersion as well as
the band widths are reasonable but the band gaps are qualitatively wrong.
Now we will compute the band gaps much more accurately, using the so-called
GW approximation.</p>
<p>We start by an example, in which we show how to perform in a single input file
the calculation of the ground state density, the Kohn Sham band structure, the
screening, and the GW corrections. We use reasonable values for the parameters
of the calculation. The discussion on the convergence tests is postponed to
the next paragraphs. We will see that GW calculations are <strong>much more</strong> time-consuming
than the computation of the KS eigenvalues.</p>
<p>So, let us run immediately this calculation, and while it is running, we will
explain what has been done.</p>
<div class="highlight"><pre><span></span><code>mkdir Work_gw1
<span class="nb">cd</span> Work_gw1
cp <span class="nv">$ABI_TESTS</span>/tutorial/Input/tgw1_1.abi .
</code></pre></div>
<p>Then, issue:</p>
<div class="highlight"><pre><span></span><code>    abinit tgw1_1.abi &gt; log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>Please run this job in background because it takes about 1 minute.
In the meantime, you should read the following.</p>
<h3 id="1a-the-four-steps-of-a-gw-calculation">1.a The four steps of a GW calculation.<a class="headerlink" href="#1a-the-four-steps-of-a-gw-calculation" title="Permanent link">&para;</a></h3>
<p>In order to perform a standard one-shot GW calculation one has to:</p>
<ol>
<li>
<p>Run a converged Ground State calculation to obtain the self-consistent density.</p>
</li>
<li>
<p>Perform a non self-consistent run to compute the KS eigenvalues and the eigenfunctions
     including several empty states. Note that, unlike standard band structure calculations,
     here the KS states <em>must</em> be computed on a regular grid of <strong>k</strong>-points.
     (This limitation is also present with hybrid functional calculations).</p>
</li>
<li>
<p>Use <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 3 to compute the independent-particle susceptibility <span><span class="MathJax_Preview">\chi^0</span><script type="math/tex">\chi^0</script></span> on a regular grid of
     <strong>q</strong>-points, for at least two frequencies (usually, <span><span class="MathJax_Preview">\omega=0</span><script type="math/tex">\omega=0</script></span> and a purely imaginary
     frequency - of the order of the plasmon frequency, a dozen of eV).
     The inverse dielectric matrix <span><span class="MathJax_Preview">\epsilon^{-1}</span><script type="math/tex">\epsilon^{-1}</script></span> is then obtained via matrix inversion and stored in an external file (SCR).
     The list of <strong>q</strong>-points is automatically defined by the k-mesh used to generate the KS states in the previous step.</p>
</li>
<li>
<p>Use <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 4 to compute the self-energy <span><span class="MathJax_Preview">\Sigma</span><script type="math/tex">\Sigma</script></span> matrix elements for a given set of k-points in order
     to obtain the GW quasiparticle energies.
     Note that the <strong>k</strong>-point must belong to the k-mesh used to generate the WFK file in step 2.</p>
</li>
</ol>
<p>The flowchart diagram of a standard one-shot run is depicted in the figure below.</p>
<p><img alt="" src="../gw1_assets/gw_flowchart.png" /></p>
<p>The input file <em>tgw1_1.abi</em> has precisely that structure: there are four datasets.</p>
<p>The first dataset performs the SCF calculation to get the density. The second
dataset reads the previous density file and performs a NSCF run including
several empty states. The third dataset reads the WFK file produced in the
previous step and drives the computation of susceptibility and dielectric
matrices, producing another specialized file, <em>tgw1_xo_DS2_SCR</em> (<em>_SCR</em> for
&ldquo;Screening&rdquo;, actually the inverse dielectric matrix <span><span class="MathJax_Preview">\epsilon^{-1}</span><script type="math/tex">\epsilon^{-1}</script></span>). Then, in the fourth
dataset, the code calculates the quasiparticle energies for the 4<sup>th</sup> and 5<sup>th</sup> bands at the <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> point.</p>
<p>So, you can edit this <em>tgw1_1.abi</em> file.</p>
<div class="text-center"><button id="uuid-c94462b1-79da-4cf6-afd8-aa9703f27788" class="md-button md-button--secondary"> View tests/tutorial/Input/tgw1_1.abi </button></div>
<div id="uuid-27199e99-0e6f-4cc7-89dd-4bf72dae3aaa" class="my_dialog" title="tests/tutorial/Input/tgw1_1.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>
<span class="c1"># Dataset 1: ground state calculation to get the density </span>
<span class="c1"># Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ</span>
<span class="c1"># Dataset 3: calculation of the screening (epsilon^-1 matrix for W)</span>
<span class="c1"># Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)</span>

ndtset      <span class="m">4</span>

<span class="c1">############</span>
<span class="c1"># Dataset 1</span>
<span class="c1">############</span>
<span class="c1"># SCF-GS run </span>
nband1  <span class="m">6</span>
tolvrs1 <span class="m">1</span>.0e-10

<span class="c1">############</span>
<span class="c1"># Dataset 2</span>
<span class="c1">############</span>
<span class="c1"># Definition of parameters for the calculation of the WFK file</span>
nband2     <span class="m">100</span>       <span class="c1"># Number of (occ and empty) bands to be computed</span>
nbdbuf2     <span class="m">20</span>       <span class="c1"># Do not apply the convergence criterium to the last 20 bands (faster)</span>
iscf2       -2
getden2     -1
tolwfr2  <span class="m">1</span>.0d-12     <span class="c1"># Will stop when this tolerance is achieved </span>

<span class="c1">############</span>
<span class="c1"># Dataset 3</span>
<span class="c1">############</span>
<span class="c1"># Calculation of the screening (epsilon^-1 matrix)</span>
optdriver3  <span class="m">3</span>        <span class="c1"># Screening calculation</span>
getwfk3     -1       <span class="c1"># Obtain WFK file from previous dataset</span>
nband3      <span class="m">60</span>       <span class="c1"># Bands to be used in the screening calculation</span>
ecuteps3    <span class="m">3</span>.6      <span class="c1"># Cut-off energy of the planewave set to represent the dielectric matrix. </span>
                     <span class="c1"># It is important to adjust this parameter, that is usually smaller than ecut,</span>
                     <span class="c1"># and between 5 and 10 Ha..</span>
ppmfrq3    <span class="m">16</span>.7 eV   <span class="c1"># Imaginary frequency where to calculate the screening. </span>
                     <span class="c1"># It is easier (and safer) to let ABINIT compute and use the Drude plasma frequency, </span>
                     <span class="c1"># instead of selecting a value by hand. This would be done thanks to the default value ppmfrq 0.0 .</span>

<span class="c1">############</span>
<span class="c1"># Dataset 4</span>
<span class="c1">############</span>
<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver4  <span class="m">4</span>        <span class="c1"># Self-Energy calculation</span>
getwfk4     -2       <span class="c1"># Obtain WFK file from dataset 1</span>
getscr4     -1       <span class="c1"># Obtain SCR file from previous dataset</span>
nband4      <span class="m">80</span>       <span class="c1"># Bands to be used in the Self-Energy calculation</span>
ecutsigx4    <span class="m">8</span>.0     <span class="c1"># Dimension of the G sum in Sigma_x. </span>
                     <span class="c1"># ecutsigx = ecut is usually a wise choice</span>
                     <span class="c1"># (the dimension in Sigma_c is controlled by ecuteps)</span>


nkptgw4      <span class="m">1</span>       <span class="c1"># number of k-point where to calculate the GW correction</span>
kptgw4               <span class="c1"># k-points in reduced coordinates</span>
   <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw4       <span class="m">4</span>  <span class="m">5</span>     <span class="c1"># calculate GW corrections for bands from 4 to 5</span>



<span class="c1"># Data common to the three different datasets</span>

<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.26         <span class="c1"># Experimental lattice constants</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5   
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the </span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s) </span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom  <span class="m">2</span>          <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25


<span class="c1"># Definition of the k-point grid</span>
ngkpt   <span class="m">2</span> <span class="m">2</span> <span class="m">2</span>  
nshiftk <span class="m">4</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># These shifts will be the same for all grids</span>
        <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.5
        <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.5
        <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.0
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>

<span class="c1"># Definition of the SCF procedure</span>
nstep   <span class="m">20</span>        <span class="c1"># Maximal number of SCF cycles</span>
diemac  <span class="m">12</span>.0      <span class="c1"># Although this is not mandatory, it is worth to</span>
                  <span class="c1"># precondition the SCF cycle. The model dielectric</span>
                  <span class="c1"># function used as the standard preconditioner</span>
                  <span class="c1"># is described in the &quot;dielng&quot; input variable section.</span>
                  <span class="c1"># Here, we follow the prescription for bulk silicon.</span>


 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pbe_standard_psp8/Si.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_1.abo, tolnlines= 10, tolabs=  0.03, tolrel=  1.500e-01</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Olevano, F. Bruneval, M. Giantomassi</span>
<span class="c1">#%% keywords = GW </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline silicon</span>
<span class="c1">#%%   Calculation of the GW corrections</span>
<span class="c1">#%%   Dataset 1: ground state calculation to get the density </span>
<span class="c1">#%%   Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ</span>
<span class="c1">#%%   Dataset 3: calculation of the screening (epsilon^-1 matrix for W)</span>
<span class="c1">#%%   Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-27199e99-0e6f-4cc7-89dd-4bf72dae3aaa", "#uuid-c94462b1-79da-4cf6-afd8-aa9703f27788") }); </script>

<p>In the first half of the file,
you will find specialized input variables for the datasets 1 to 4.</p>
<p>In the second half of the file,
one find the dataset-independent information, namely,
input variables describing the cell, atom types,
number, position, planewave cut-off energy, SCF convergence parameters driving
the KS band structure calculation.</p>
<h3 id="1b-generating-the-kohn-sham-band-structure-the-wfk-file">1.b Generating the Kohn-Sham band structure: the WFK file.<a class="headerlink" href="#1b-generating-the-kohn-sham-band-structure-the-wfk-file" title="Permanent link">&para;</a></h3>
<p>Dataset 1 drives a rather standard SCF calculation. It is worth noticing that we
use <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> to stop the SCF cycle because we want a well-converged KS potential
to be used in the subsequent NSCF calculation. Dataset 2 computes 100 bands and
we set <a class="wikilink codevar-wikilink" href="/variables/gstate#nbdbuf">nbdbuf</a> to 20 so that only the first 80 states must be converged within <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>.
The 20 highest energy states are simply not considered when checking the convergence.</p>
<div class="highlight"><pre><span></span><code>    ###########
    # Dataset 1
    ############
    # SCF-GS run
    nband1  6
    tolvrs1 1.0e-10

    ############
    # Dataset 2
    ############
    # Definition of parameters for the calculation of the WFK file
    nband2     100       # Number of (occ and empty) bands to be computed
    nbdbuf2     20       # Do not apply the convergence criterium to the last 20 bands (faster)
    iscf2       -2
    getden2     -1
    tolwfr2  1.0d-12     # Will stop when this tolerance is achieved
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <a class="wikilink codevar-wikilink" href="/variables/gstate#nbdbuf">nbdbuf</a> trick allows us to <strong>save several minimization steps</strong> because the
last bands usually require more iterations to converge in the iterative diagonalization algorithms.
Also note that it is a very good idea to increase significantly the value of <a class="wikilink codevar-wikilink" href="/variables/gstate#nbdbuf">nbdbuf</a> when
computing many empty states. As a rule of thumb, use 10% of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> or even more
in complicated systems. This can really make a <strong>huge difference</strong> at the level of the wall time.</p>
</div>
<h3 id="1c-generating-the-screening-the-scr-file">1.c Generating the screening: the SCR file.<a class="headerlink" href="#1c-generating-the-screening-the-scr-file" title="Permanent link">&para;</a></h3>
<p>In dataset 3, the calculation of the screening (KS susceptibility <span><span class="MathJax_Preview">\chi^0</span><script type="math/tex">\chi^0</script></span> and then inverse dielectric
matrix <span><span class="MathJax_Preview">\epsilon^{-1}</span><script type="math/tex">\epsilon^{-1}</script></span>) is performed. We need to set <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=3 to do that:</p>
<div class="highlight"><pre><span></span><code>    optdriver3  3        # Screening calculation
</code></pre></div>
<p>The <a class="wikilink codevar-wikilink" href="/variables/files#getwfk">getwfk</a> input variable is similar to other &ldquo;get&rdquo; input variables of ABINIT:</p>
<div class="highlight"><pre><span></span><code>    getwfk3     -1       # Obtain WFK file from previous dataset
</code></pre></div>
<p>In this case, it tells the code to use the WFK file calculated in the previous dataset.</p>
<p>Then, three input variables describe the computation:</p>
<div class="highlight"><pre><span></span><code>    nband3      60   # Bands used in the screening calculation
    ecuteps3    3.6  # Cut-off energy of the planewave set to represent the dielectric matrix
</code></pre></div>
<p>In this case, we use 60 bands to calculate the KS response function <span><span class="MathJax_Preview">\chi^{0}</span><script type="math/tex">\chi^{0}</script></span>.
The dimension of <span><span class="MathJax_Preview">\chi^{0}</span><script type="math/tex">\chi^{0}</script></span>, as well as all the other matrices (<span><span class="MathJax_Preview">\chi</span><script type="math/tex">\chi</script></span>, <span><span class="MathJax_Preview">\epsilon^{-1}</span><script type="math/tex">\epsilon^{-1}</script></span>) is
determined by the cut-off energy <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> = 3.6 Hartree, which yields 169 planewaves in our case.</p>
<p>Finally, we define the frequencies at which the screening must be evaluated:
<span><span class="MathJax_Preview">\omega=0.0</span><script type="math/tex">\omega=0.0</script></span> eV and the imaginary frequency <span><span class="MathJax_Preview">\omega= i 16.7</span><script type="math/tex">\omega= i 16.7</script></span> eV. The latter is determined by
the input variable <a class="wikilink codevar-wikilink" href="/variables/gw#ppmfrq">ppmfrq</a></p>
<div class="highlight"><pre><span></span><code>    ppmfrq3    16.7 eV  # Imaginary frequency where to calculate the screening
</code></pre></div>
<p>The two frequencies are used to calculate the plasmon-pole model parameters.
For the non-zero frequency, it is recommended to use a value close to the
plasmon frequency for the plasmon-pole model to work well. Plasmons
frequencies are usually close to 0.5 Hartree. The parameters for the screening
calculation are not far from the ones that give converged Electron Energy Loss Function
(<span><span class="MathJax_Preview">-\mathrm{Im} \epsilon^{-1}_{00}</span><script type="math/tex">-\mathrm{Im} \epsilon^{-1}_{00}</script></span>) spectra, so that one can start up by using indications
from EELS calculations existing in literature. Alternatively, ABINIT can compute
an approximate plasmon frequency using the Drude formula. This is activated
by letting <a class="wikilink codevar-wikilink" href="/variables/gw#ppmfrq">ppmfrq</a> to its default value. It is actually safer to use the Drude value
than to use blindly a value like 16.7 eV for other materials than silicon.</p>
<h3 id="1d-computing-the-gw-energies">1.d Computing the GW energies.<a class="headerlink" href="#1d-computing-the-gw-energies" title="Permanent link">&para;</a></h3>
<p>In dataset 4 the calculation of the Self-Energy matrix elements is performed.
One needs to define the driver option as well as the _WFK and _SCR files.</p>
<div class="highlight"><pre><span></span><code>    optdriver4  4       # Self-Energy calculation
    getwfk4    -2       # Obtain WFK file from dataset 2
    getscr4    -1       # Obtain SCR file from previous dataset
</code></pre></div>
<p>The <a class="wikilink codevar-wikilink" href="/variables/files#getscr">getscr</a> input variable is similar to other &ldquo;get&rdquo; input variables of ABINIT.</p>
<p>Then, comes the definition of parameters needed to compute the self-energy. As
for the computation of the susceptibility and dielectric matrices, one must
define the set of bands and two sets of planewaves:</p>
<div class="highlight"><pre><span></span><code>    nband4       80      # Bands to be used in the Self-Energy calculation
    ecutsigx4   8.0      # Dimension of the G sum in Sigma_x
                         # (the dimension in Sigma_c is controlled by npweps)
</code></pre></div>
<p>In this case, <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> controls the number of bands used to calculate the
correlation part of the Self-Energy while <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a> gives the number of
planewaves used to calculate <span><span class="MathJax_Preview">\Sigma_x</span><script type="math/tex">\Sigma_x</script></span> (the exchange part of the self-energy). The
size of the planewave set used to compute <span><span class="MathJax_Preview">\Sigma_c</span><script type="math/tex">\Sigma_c</script></span> (the correlation part of the
self-energy) is controlled by <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> and cannot be larger than the value
used to generate the SCR file.
For the initial convergence studies, it is advised to set <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a> to a value as high
as <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> since, anyway, this parameter is not much influential on the total computational time.
Note that the exact treatment of the exchange part requires, in principle, <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a> = 4 * <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>.</p>
<p>Then, come the parameters defining the <strong>k</strong>-points and the band indices for which
the quasiparticle energies will be computed:</p>
<div class="highlight"><pre><span></span><code>    nkptgw4      1           # number of k-point where to calculate the GW correction
    kptgw4  0.00  0.00  0.00 # k-points
    bdgw4       4  5         # calculate GW corrections for bands from 4 to 5
</code></pre></div>
<p><a class="wikilink codevar-wikilink" href="/variables/gw#nkptgw">nkptgw</a> defines the number of <strong>k</strong>-points for which the GW corrections will be
computed. The <strong>k</strong>-point reduced coordinates are specified in <a class="wikilink codevar-wikilink" href="/variables/gw#kptgw">kptgw</a> while <a class="wikilink codevar-wikilink" href="/variables/gw#bdgw">bdgw</a> gives the
minimum/maximum band whose energies are calculated for each selected <strong>k</strong>-point.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>These k-points <strong>must belong</strong> to the k-mesh used to generate the WFK file. Hence
if you wish the GW correction in a particular <strong>k</strong>-point, you should choose a
grid containing it. Usually this is done by taking the <strong>k</strong>-point grid where the
convergence is achieved and shifting it such as at least one k-point is placed
on the wished position in the Brillouin zone.</p>
</div>
<p>There is an additional parameter, called <a class="wikilink codevar-wikilink" href="/variables/gw#zcut">zcut</a>, (not studied here) related to the self-energy
computation. It is meant to avoid some divergences that might occur in the
calculation due to integrable poles along the integration path.</p>
<h3 id="1e-examination-of-the-output-file">1.e Examination of the output file.<a class="headerlink" href="#1e-examination-of-the-output-file" title="Permanent link">&para;</a></h3>
<p>Your calculation should have ended now. Let&rsquo;s examine the output file.
Open <em>tgw1_1.abo</em> in your preferred editor and find the section
corresponding to DATASET 3.</p>
<div class="text-center"><button id="uuid-59f5eefe-e4fe-49b6-9b4b-a83ebd909d34" class="md-button md-button--secondary"> View tests/tutorial/Refs/tgw1_1.abo </button></div>
<div id="uuid-5df453d8-b26e-40cf-96e6-6777326f63d3" class="my_dialog" title="tests/tutorial/Refs/tgw1_1.abo" hidden><div><pre class="small-text">

.Version 10.1.4.5 of ABINIT, released Sep 2024.
.(MPI version, prepared for a x86_64_linux_gnu13.2 computer) 

.Copyright (C) 1998-2024 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Fri 13 Sep 2024.
- ( at 19h06 )

- input  file    -&gt; /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/TestBot_MPI1/tutorial_tgw1_1/tgw1_1.abi
- output file    -&gt; tgw1_1.abo
- root for input  files -&gt; tgw1_1i
- root for output files -&gt; tgw1_1o

 DATASET    1 : space group Fd -3 m (#227); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       6
     lnmax =       6     mgfft =      20  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       1
    occopt =       1   xclevel =       2
-    mband =           6        mffmem =           1         mkmem =           6
       mpw =         303          nfft =        8000          nkpt =           6
================================================================================
P This job should need less than                       3.487 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.168 Mbytes ; DEN or POT disk file :      0.063 Mbytes.
================================================================================

 DATASET    2 : space group Fd -3 m (#227); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       0      iscf =      -2    lmnmax =       6
     lnmax =       6     mgfft =      20  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       1
    occopt =       1   xclevel =       2
-    mband =         100        mffmem =           1         mkmem =           6
       mpw =         303          nfft =        8000          nkpt =           6
================================================================================
P This job should need less than                       5.406 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      2.776 Mbytes ; DEN or POT disk file :      0.063 Mbytes.
================================================================================

 DATASET    3 : space group Fd -3 m (#227); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  3.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       6
     lnmax =       6     mgfft =      20  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       1
    occopt =       1   xclevel =       2
-    mband =          60        mffmem =           1         mkmem =           6
       mpw =         303          nfft =        8000          nkpt =           6
================================================================================
P This job should need less than                       5.083 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      1.666 Mbytes ; DEN or POT disk file :      0.063 Mbytes.
================================================================================

 DATASET    4 : space group Fd -3 m (#227); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  4.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       6
     lnmax =       6     mgfft =      20  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       1
    occopt =       1   xclevel =       2
-    mband =          80        mffmem =           1         mkmem =           6
       mpw =         303          nfft =        8000          nkpt =           6
================================================================================
P This job should need less than                       5.724 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      2.221 Mbytes ; DEN or POT disk file :      0.063 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values
-   iomode0 =  0 , fftalg0 =512 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      1.0260000000E+01  1.0260000000E+01  1.0260000000E+01 Bohr
              amu      2.80855000E+01
             bdgw4          4       5
           diemac      1.20000000E+01
             ecut      8.00000000E+00 Hartree
          ecuteps1     0.00000000E+00 Hartree
          ecuteps2     0.00000000E+00 Hartree
          ecuteps3     3.60000000E+00 Hartree
          ecuteps4     0.00000000E+00 Hartree
         ecutsigx1     0.00000000E+00 Hartree
         ecutsigx2     0.00000000E+00 Hartree
         ecutsigx3     0.00000000E+00 Hartree
         ecutsigx4     8.00000000E+00 Hartree
          ecutwfn1     0.00000000E+00 Hartree
          ecutwfn2     0.00000000E+00 Hartree
          ecutwfn3     8.00000000E+00 Hartree
          ecutwfn4     8.00000000E+00 Hartree
-          fftalg         512
           getden1          0
           getden2         -1
           getden3          0
           getden4          0
           getscr1          0
           getscr2          0
           getscr3          0
           getscr4         -1
           getwfk1          0
           getwfk2          0
           getwfk3         -1
           getwfk4         -2
             iscf1          7
             iscf2         -2
             iscf3          7
             iscf4          7
           istwfk        0    0    1    0    1    1
              ixc          11
           jdtset        1    2    3    4
              kpt     -2.50000000E-01 -2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       0.00000000E+00  0.00000000E+00  0.00000000E+00
            kptgw4     0.00000000E+00  0.00000000E+00  0.00000000E+00
         kptrlatt        2   -2    2     -2    2    2     -2   -2    2
          kptrlen      2.05200000E+01
P           mkmem           6
            natom           2
            nband1          6
            nband2        100
            nband3         60
            nband4         80
           nbdbuf1          0
           nbdbuf2         20
           nbdbuf3          0
           nbdbuf4          0
           ndtset           4
            ngfft          20      20      20
             nkpt           6
           nkptgw1          0
           nkptgw2          0
           nkptgw3          0
           nkptgw4          1
           npweps1          0
           npweps2          0
           npweps3         89
           npweps4          0
          npwsigx1          0
          npwsigx2          0
          npwsigx3          0
          npwsigx4        283
           npwwfn1          0
           npwwfn2          0
           npwwfn3        283
           npwwfn4        283
            nstep          20
             nsym          48
           ntypat           1
              occ1     2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
              occ4     2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
        optdriver1          0
        optdriver2          0
        optdriver3          3
        optdriver4          4
           ppmfrq1     0.00000000E+00 Hartree
           ppmfrq2     0.00000000E+00 Hartree
           ppmfrq3     6.13713734E-01 Hartree
           ppmfrq4     0.00000000E+00 Hartree
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         227
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tnons      0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
           tolvrs1     1.00000000E-10
           tolvrs2     0.00000000E+00
           tolvrs3     0.00000000E+00
           tolvrs4     0.00000000E+00
           tolwfr1     0.00000000E+00
           tolwfr2     1.00000000E-12
           tolwfr3     0.00000000E+00
           tolwfr4     0.00000000E+00
            typat      1  1
              wtk        0.18750    0.37500    0.09375    0.18750    0.12500    0.03125
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       1.3573395400E+00  1.3573395400E+00  1.3573395400E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5650000000E+00  2.5650000000E+00  2.5650000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5000000000E-01  2.5000000000E-01  2.5000000000E-01
            znucl       14.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

 chkinp: Checking input parameters for consistency, jdtset=   3.

 chkinp: Checking input parameters for consistency, jdtset=   4.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 6, mband: 6, nsppol: 1, nspinor: 1, nspden: 1, mpw: 303, }
cutoff_energies: {ecut:   8.0, pawecutdg:  -1.0, }
electrons: {nelect:   8.00000000E+00, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 0, ionmov: 0, optcell: 0, iscf: 7, paral_kgb: 0, }
...

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  5.1300000  5.1300000  G(1)= -0.0974659  0.0974659  0.0974659
 R(2)=  5.1300000  0.0000000  5.1300000  G(2)=  0.0974659 -0.0974659  0.0974659
 R(3)=  5.1300000  5.1300000  0.0000000  G(3)=  0.0974659  0.0974659 -0.0974659
 Unit cell volume ucvol=  2.7001139E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  20  20  20
         ecut(hartree)=      8.000   =&gt; boxcut(ratio)=   2.16515

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Psps_for_tests/Pseudodojo_nc_sr_04_pbe_standard_psp8/Si.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Psps_for_tests/Pseudodojo_nc_sr_04_pbe_standard_psp8/Si.psp8
- Si    ONCVPSP-3.2.3.1  r_core=   1.60303   1.72197   1.91712
- 14.00000   4.00000    170510                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    4.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     2
     extension_switch     1
  pspatm : epsatm=    9.34321699
         --- l  ekb(1:nproj) --&gt;
             0    5.168965    0.829883
             1    2.571282    0.578307
             2   -2.427311   -0.488097
 pspatm: atomic psp has been read  and splines computed

   1.49491472E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

_setup2: Arith. and geom. avg. npw (full set) are     291.094     290.895

================================================================================

--- !BeginCycle
iteration_state: {dtset: 1, }
solver: {iscf: 7, nstep: 20, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-10, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2
 ETOT  1  -8.4477770574543    -8.448E+00 6.039E-03 2.180E+00
 ETOT  2  -8.4508649767972    -3.088E-03 7.993E-04 3.375E-02
 ETOT  3  -8.4508905681654    -2.559E-05 4.495E-04 3.880E-04
 ETOT  4  -8.4508907628105    -1.946E-07 3.877E-04 1.445E-05
 ETOT  5  -8.4508907674908    -4.680E-09 6.981E-05 4.700E-07
 ETOT  6  -8.4508907676239    -1.330E-10 8.334E-05 2.407E-09
 ETOT  7  -8.4508907676242    -3.446E-13 1.045E-05 1.231E-11

 At SCF step    7       vres2   =  1.23E-11 &lt; tolvrs=  1.00E-10 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -4.48073872E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -4.48073872E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -4.48073872E-05  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  0.0000000,   5.1300000,   5.1300000, ]
- [  5.1300000,   0.0000000,   5.1300000, ]
- [  5.1300000,   5.1300000,   0.0000000, ]
lattice_lengths: [   7.25492,    7.25492,    7.25492, ]
lattice_angles: [ 60.000,  60.000,  60.000, ] # degrees, (23, 13, 12)
lattice_volume:   2.7001139E+02
convergence: {deltae: -3.446E-13, res2:  1.231E-11, residm:  1.045E-05, diffor: null, }
etotal    :  -8.45089077E+00
entropy   :   0.00000000E+00
fermie    :   1.62353054E-01
cartesian_stress_tensor: # hartree/bohr^3
- [ -4.48073872E-05,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,  -4.48073872E-05,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,  -4.48073872E-05, ]
pressure_GPa:   1.3183E+00
xred      :
- [  0.0000E+00,   0.0000E+00,   0.0000E+00, Si]
- [  2.5000E-01,   2.5000E-01,   2.5000E-01, Si]
cartesian_forces: # hartree/bohr
- [ -1.13997770E-45,   1.13997770E-45,   2.62441055E-29, ]
- [  1.13997770E-45,  -1.13997770E-45,  -2.62441055E-29, ]
force_length_stats: {min:   2.62441055E-29, max:   2.62441055E-29, mean:   2.62441055E-29, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          1.72529250
    2        2.00000          1.72529250
================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   29.053E-08; max=  10.447E-06
 reduced coordinates (array xred) for    2 atoms
       0.000000000000      0.000000000000      0.000000000000
       0.250000000000      0.250000000000      0.250000000000
 rms dE/dt=  1.5546E-28; max dE/dt=  0.0000E+00; dE/dt below (all hartree)
    1      -0.000000000000     -0.000000000000      0.000000000000
    2       0.000000000000      0.000000000000      0.000000000000

 cartesian coordinates (angstrom) at end:
    1      0.00000000000000     0.00000000000000     0.00000000000000
    2      1.35733954003335     1.35733954003335     1.35733954003335

 cartesian forces (hartree/bohr) at end:
    1     -0.00000000000000     0.00000000000000     0.00000000000000
    2      0.00000000000000    -0.00000000000000    -0.00000000000000
 frms,max,avg= 1.5152041E-29 2.6244105E-29   0.000E+00  0.000E+00  0.000E+00 h/b

 cartesian forces (eV/Angstrom) at end:
    1     -0.00000000000000     0.00000000000000     0.00000000000000
    2      0.00000000000000    -0.00000000000000    -0.00000000000000
 frms,max,avg= 7.7914923E-28 1.3495261E-27   0.000E+00  0.000E+00  0.000E+00 e/A
 length scales= 10.260000000000 10.260000000000 10.260000000000 bohr
              =  5.429358160133  5.429358160133  5.429358160133 angstroms
 prteigrs : about to open file tgw1_1o_DS1_EIG
 Fermi (or HOMO) energy (hartree) =   0.16235   Average Vxc (hartree)=  -0.34044
 Eigenvalues (hartree) for nkpt=   6  k points:
 kpt#   1, nband=  6, wtk=  0.18750, kpt= -0.2500 -0.2500  0.0000 (reduced coord)
  -0.23833    0.03292    0.09196    0.09196    0.20352    0.27776
 prteigrs : prtvol=0 or 1, do not print more k-points.


--- !EnergyTerms
iteration_state     : {dtset: 1, }
comment             : Components of total free energy in Hartree
kinetic             :  3.08753412466341E+00
hartree             :  5.59850380435314E-01
xc                  : -3.09781415724429E+00
Ewald energy        : -8.40046478618609E+00
psp_core            :  5.53648753925927E-01
local_psp           : -2.30656115212583E+00
non_local_psp       :  1.15291606890736E+00
total_energy        : -8.45089076762421E+00
total_energy_eV     : -2.29960432636752E+02
band_energy         : -1.88175119850933E-01
...


 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -4.48073872E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -4.48073872E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -4.48073872E-05  sigma(2 1)=  0.00000000E+00

-Cartesian components of stress tensor (GPa)         [Pressure=  1.3183E+00 GPa]
- sigma(1 1)= -1.31827862E+00  sigma(3 2)=  0.00000000E+00
- sigma(2 2)= -1.31827862E+00  sigma(3 1)=  0.00000000E+00
- sigma(3 3)= -1.31827862E+00  sigma(2 1)=  0.00000000E+00

================================================================================
== DATASET  2 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 2, }
dimensions: {natom: 2, nkpt: 6, mband: 100, nsppol: 1, nspinor: 1, nspden: 1, mpw: 303, }
cutoff_energies: {ecut:   8.0, pawecutdg:  -1.0, }
electrons: {nelect:   8.00000000E+00, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 0, ionmov: 0, optcell: 0, iscf: -2, paral_kgb: 0, }
...

 mkfilename : getden/=0, take file _DEN from output of DATASET   1.

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  5.1300000  5.1300000  G(1)= -0.0974659  0.0974659  0.0974659
 R(2)=  5.1300000  0.0000000  5.1300000  G(2)=  0.0974659 -0.0974659  0.0974659
 R(3)=  5.1300000  5.1300000  0.0000000  G(3)=  0.0974659  0.0974659 -0.0974659
 Unit cell volume ucvol=  2.7001139E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  20  20  20
         ecut(hartree)=      8.000   =&gt; boxcut(ratio)=   2.16515
--------------------------------------------------------------------------------


================================================================================
 prteigrs : about to open file tgw1_1o_DS2_EIG
 Non-SCF case, kpt    1 ( -0.25000 -0.25000  0.00000), residuals and eigenvalues=
  2.31E-13  4.27E-13  6.12E-14  6.35E-14  2.22E-13  8.99E-13  1.42E-13  3.53E-13
  2.37E-14  4.21E-13  3.96E-13  3.90E-13  5.13E-13  1.83E-13  3.55E-13  6.54E-13
  5.91E-13  1.42E-14  2.52E-13  2.43E-14  4.70E-14  5.95E-13  3.93E-13  3.30E-13
  4.65E-13  1.33E-13  4.29E-14  2.82E-14  2.91E-13  4.11E-13  3.53E-13  7.85E-14
  6.45E-14  9.71E-14  6.27E-13  6.93E-14  3.75E-14  1.66E-13  1.02E-13  3.35E-13
  7.76E-14  1.70E-13  2.21E-13  9.01E-14  1.13E-13  2.02E-13  1.62E-13  2.19E-13
  3.65E-13  1.41E-13  2.24E-13  6.83E-13  8.06E-13  8.98E-13  5.94E-13  4.08E-13
  4.94E-13  7.39E-13  8.48E-13  5.05E-13  7.21E-13  7.08E-13  6.87E-14  1.56E-13
  4.29E-13  3.83E-13  2.76E-13  5.63E-13  7.96E-13  4.79E-13  5.38E-13  9.97E-13
  1.36E-13  8.37E-14  9.49E-14  3.45E-13  2.70E-13  1.89E-13  7.06E-13  3.75E-13
  2.20E-13  8.36E-13  1.65E-12  2.63E-12  3.06E-11  3.75E-11  1.29E-10  6.99E-10
  2.69E-09  7.79E-09  4.48E-08  9.65E-09  1.88E-07  2.10E-06  7.78E-07  1.20E-06
  2.58E-06  1.89E-05  2.14E-04  2.52E-04
 -2.3833E-01  3.2916E-02  9.1963E-02  9.1963E-02  2.0352E-01  2.7776E-01
  3.7458E-01  3.7458E-01  4.5966E-01  4.9437E-01  5.8246E-01  6.4334E-01
  6.4334E-01  6.6963E-01  8.0649E-01  8.0649E-01  8.4299E-01  9.1578E-01
  9.3904E-01  1.0878E+00  1.1459E+00  1.1772E+00  1.1772E+00  1.2524E+00
  1.2524E+00  1.2656E+00  1.2843E+00  1.4509E+00  1.4596E+00  1.4770E+00
  1.4770E+00  1.5394E+00  1.5426E+00  1.5426E+00  1.6688E+00  1.6688E+00
  1.6755E+00  1.6845E+00  1.6928E+00  1.7847E+00  1.7847E+00  1.7911E+00
  1.8781E+00  1.9163E+00  1.9163E+00  1.9725E+00  1.9784E+00  2.0346E+00
  2.0466E+00  2.0466E+00  2.0795E+00  2.1289E+00  2.2433E+00  2.2787E+00
  2.2787E+00  2.3791E+00  2.4811E+00  2.4811E+00  2.4898E+00  2.4932E+00
  2.4953E+00  2.4953E+00  2.5176E+00  2.6118E+00  2.6504E+00  2.6703E+00
  2.6703E+00  2.7489E+00  2.7600E+00  2.7881E+00  2.8100E+00  2.8100E+00
  2.8579E+00  2.8844E+00  2.8844E+00  2.9090E+00  2.9736E+00  2.9915E+00
  3.0730E+00  3.0730E+00  3.0827E+00  3.1663E+00  3.1663E+00  3.2167E+00
  3.2686E+00  3.3076E+00  3.3076E+00  3.3803E+00  3.4345E+00  3.4345E+00
  3.4498E+00  3.4534E+00  3.5229E+00  3.5229E+00  3.5259E+00  3.5404E+00
  3.5494E+00  3.5495E+00  3.5903E+00  3.6047E+00
 prteigrs : prtvol=0 or 1, do not print more k-points.



--- !ResultsGS
iteration_state: {dtset: 2, }
comment   : Summary of ground state results
lattice_vectors:
- [  0.0000000,   5.1300000,   5.1300000, ]
- [  5.1300000,   0.0000000,   5.1300000, ]
- [  5.1300000,   5.1300000,   0.0000000, ]
lattice_lengths: [   7.25492,    7.25492,    7.25492, ]
lattice_angles: [ 60.000,  60.000,  60.000, ] # degrees, (23, 13, 12)
lattice_volume:   2.7001139E+02
convergence: {deltae:  0.000E+00, res2:  0.000E+00, residm:  9.975E-13, diffor:  0.000E+00, }
etotal    :  -8.45089077E+00
entropy   :   0.00000000E+00
fermie    :   1.62353054E-01
cartesian_stress_tensor: null
pressure_GPa: null
xred      :
- [  0.0000E+00,   0.0000E+00,   0.0000E+00, Si]
- [  2.5000E-01,   2.5000E-01,   2.5000E-01, Si]
cartesian_forces: null
force_length_stats: {min: null, max: null, mean: null, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          1.72529250
    2        2.00000          1.72529250
================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   31.196E-14; max=  99.749E-14
 reduced coordinates (array xred) for    2 atoms
       0.000000000000      0.000000000000      0.000000000000
       0.250000000000      0.250000000000      0.250000000000

 cartesian coordinates (angstrom) at end:
    1      0.00000000000000     0.00000000000000     0.00000000000000
    2      1.35733954003335     1.35733954003335     1.35733954003335
 length scales= 10.260000000000 10.260000000000 10.260000000000 bohr
              =  5.429358160133  5.429358160133  5.429358160133 angstroms
 prteigrs : about to open file tgw1_1o_DS2_EIG
 Eigenvalues (hartree) for nkpt=   6  k points:
 kpt#   1, nband=100, wtk=  0.18750, kpt= -0.2500 -0.2500  0.0000 (reduced coord)
  -0.23833    0.03292    0.09196    0.09196    0.20352    0.27776    0.37458    0.37458
   0.45966    0.49437    0.58246    0.64334    0.64334    0.66963    0.80649    0.80649
   0.84299    0.91578    0.93904    1.08776    1.14592    1.17716    1.17716    1.25239
   1.25239    1.26564    1.28431    1.45093    1.45964    1.47700    1.47700    1.53936
   1.54263    1.54263    1.66881    1.66881    1.67555    1.68455    1.69275    1.78466
   1.78466    1.79107    1.87812    1.91631    1.91631    1.97250    1.97836    2.03457
   2.04662    2.04662    2.07950    2.12889    2.24331    2.27866    2.27866    2.37907
   2.48107    2.48107    2.48980    2.49323    2.49531    2.49531    2.51758    2.61177
   2.65043    2.67032    2.67032    2.74895    2.76000    2.78805    2.80998    2.80998
   2.85793    2.88444    2.88444    2.90905    2.97358    2.99145    3.07297    3.07297
   3.08272    3.16627    3.16627    3.21675    3.26856    3.30759    3.30759    3.38032
   3.43452    3.43452    3.44983    3.45344    3.52290    3.52290    3.52587    3.54037
   3.54944    3.54946    3.59033    3.60475
 prteigrs : prtvol=0 or 1, do not print more k-points.


================================================================================
== DATASET  3 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 3, }
dimensions: {natom: 2, nkpt: 6, mband: 60, nsppol: 1, nspinor: 1, nspden: 1, mpw: 303, }
cutoff_energies: {ecut:   8.0, pawecutdg:  -1.0, }
electrons: {nelect:   8.00000000E+00, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 3, gwcalctyp: 0, }
...

 mkfilename : getwfk/=0, take file _WFK from output of DATASET   2.

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

 SCREENING: Calculation of the susceptibility and dielectric matrices 

 Based on a program developped by R.W. Godby, V. Olevano, G. Onida, and L. Reining.
 Incorporated in ABINIT by V. Olevano, G.-M. Rignanese, and M. Torrent.
.Using double precision arithmetic ; gwpc =  8

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  5.1300000  5.1300000  G(1)= -0.0974659  0.0974659  0.0974659
 R(2)=  5.1300000  0.0000000  5.1300000  G(2)=  0.0974659 -0.0974659  0.0974659
 R(3)=  5.1300000  5.1300000  0.0000000  G(3)=  0.0974659  0.0974659 -0.0974659
 Unit cell volume ucvol=  2.7001139E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
--------------------------------------------------------------------------------

 ==== K-mesh for the wavefunctions ====
 Number of points in the irreducible wedge :     6
 Reduced coordinates and weights : 

     1)    -2.50000000E-01 -2.50000000E-01  0.00000000E+00       0.18750
     2)    -2.50000000E-01  2.50000000E-01  0.00000000E+00       0.37500
     3)     5.00000000E-01  5.00000000E-01  0.00000000E+00       0.09375
     4)    -2.50000000E-01  5.00000000E-01  2.50000000E-01       0.18750
     5)     5.00000000E-01  0.00000000E+00  0.00000000E+00       0.12500
     6)     0.00000000E+00  0.00000000E+00  0.00000000E+00       0.03125

 Together with 48 symmetry operations and time-reversal symmetry 
 yields    32 points in the full Brillouin Zone.


 ==== Q-mesh for the screening function ====
 Number of points in the irreducible wedge :     6
 Reduced coordinates and weights : 

     1)     0.00000000E+00  0.00000000E+00  0.00000000E+00       0.03125
     2)     5.00000000E-01  5.00000000E-01  0.00000000E+00       0.09375
     3)     5.00000000E-01  2.50000000E-01  2.50000000E-01       0.37500
     4)     0.00000000E+00  5.00000000E-01  0.00000000E+00       0.12500
     5)     5.00000000E-01 -2.50000000E-01  2.50000000E-01       0.18750
     6)     0.00000000E+00 -2.50000000E-01 -2.50000000E-01       0.18750

 Together with 48 symmetry operations and time-reversal symmetry 
 yields    32 points in the full Brillouin Zone.


 setmesh: FFT mesh size selected  =    20x   20x   20
          total number of points  =         8000


- screening: taking advantage of time-reversal symmetry 
- Maximum band index for partially occupied states nbvw = 4
- Remaining bands to be divided among processors   nbcw = 56
- Number of bands treated by each node ~56

 Number of electrons calculated from density =    8.0000; Expected =    8.0000
 average of density, n =  0.029628
 r_s =    2.0048
 omega_plasma =   16.6039 [eV]


 calculating chi0 at frequencies [eV] :
  1    0.000000E+00    0.000000E+00
  2    0.000000E+00    1.670000E+01


--------------------------------------------------------------------------------
  q-point number  1        q = ( 0.000000, 0.000000, 0.000000) [r.l.u.]
--------------------------------------------------------------------------------
  chi0(G,G&#x27;) at the    1 th omega   0.0000   0.0000 [eV]
       1       2       3       4       5       6       7       8       9
    1  -0.000   0.000  -0.000  -0.000   0.000   0.000  -0.000  -0.000   0.000
       -0.000   0.000   0.000  -0.000  -0.000   0.000   0.000  -0.000  -0.000

    2   0.000 -18.770  -0.000  -0.072  -0.000  -0.072   0.000  -0.072   0.000
       -0.000   0.000  -5.064  -0.000  -0.279   0.000  -0.279  -0.000  -0.279

  chi0(G,G&#x27;) at the    2 th omega   0.0000  16.7000 [eV]
       1       2       3       4       5       6       7       8       9
    1  -0.000   0.000  -0.000  -0.000   0.000   0.000  -0.000  -0.000   0.000
       -0.000   0.000   0.000  -0.000  -0.000   0.000   0.000  -0.000  -0.000

    2   0.000  -7.757  -0.000  -0.039  -0.000  -0.039   0.000  -0.039   0.000
       -0.000   0.000  -1.029  -0.000  -0.122  -0.000  -0.122  -0.000  -0.122

 For q-point:  0.000010 0.000020 0.000030
  dielectric constant =  22.4176
  dielectric constant without local fields =  24.7005

  Average fulfillment of the sum rule on Im[epsilon] for q-point    1 :     82.54  [%]
  Heads and wings of the symmetrical epsilon^-1(G,G&#x27;) 

   Upper and lower wings at the    1 th omega   0.0000   0.0000 [eV]
       1       2       3       4       5       6       7       8       9
      0.045   0.004  -0.004  -0.012   0.012   0.012  -0.012  -0.004   0.004
     -0.000   0.004   0.004  -0.012  -0.012   0.012   0.012  -0.004  -0.004
       1       2       3       4       5       6       7       8       9
      0.045   0.004  -0.004  -0.012   0.012   0.012  -0.012  -0.004   0.004
     -0.000  -0.004  -0.004   0.012   0.012  -0.012  -0.012   0.004   0.004


   Upper and lower wings at the    2 th omega   0.0000  16.7000 [eV]
       1       2       3       4       5       6       7       8       9
      0.492   0.007  -0.007  -0.022   0.022   0.022  -0.022  -0.007   0.007
     -0.000   0.007   0.007  -0.022  -0.022   0.022   0.022  -0.007  -0.007
       1       2       3       4       5       6       7       8       9
      0.492   0.007  -0.007  -0.022   0.022   0.022  -0.022  -0.007   0.007
     -0.000  -0.007  -0.007   0.022   0.022  -0.022  -0.022   0.007   0.007




--------------------------------------------------------------------------------
  q-point number  2        q = ( 0.500000, 0.500000, 0.000000) [r.l.u.]
--------------------------------------------------------------------------------
  chi0(G,G&#x27;) at the    1 th omega   0.0000   0.0000 [eV]
       1       2       3       4       5       6       7       8       9
    1 -18.001  -3.139  -1.157  -1.157  -3.139  -1.157  -3.139  -3.139  -1.157
        0.000  -3.139   1.157  -1.157   3.139  -1.157   3.139  -3.139   1.157

    2  -3.139 -17.803  -0.000   0.018  -0.000   0.018  -0.000   0.152   0.000
        3.139   0.000  -2.461   0.000   0.491  -0.000   0.491  -0.000  -0.263

  chi0(G,G&#x27;) at the    2 th omega   0.0000  16.7000 [eV]
       1       2       3       4       5       6       7       8       9
    1  -4.372  -0.918  -0.223  -0.223  -0.918  -0.223  -0.918  -0.918  -0.223
        0.000  -0.918   0.223  -0.223   0.918  -0.223   0.918  -0.918   0.223

    2  -0.918  -8.743  -0.000  -0.031  -0.000  -0.031  -0.000   0.138  -0.000
        0.918   0.000  -0.578   0.000  -0.033  -0.000  -0.034   0.000  -0.061

  Average fulfillment of the sum rule on Im[epsilon] for q-point    2 :     86.77  [%]


--------------------------------------------------------------------------------
  q-point number  3        q = ( 0.500000, 0.250000, 0.250000) [r.l.u.]
--------------------------------------------------------------------------------
  chi0(G,G&#x27;) at the    1 th omega   0.0000   0.0000 [eV]
       1       2       3       4       5       6       7       8       9
    1 -14.492  -2.533   0.521  -2.302  -2.302   0.521  -2.533  -2.302  -2.302
        0.000  -2.533  -0.521  -2.302   2.302   0.521   2.533  -2.302   2.302

    2  -2.533 -18.009  -0.000  -0.299   0.000  -0.041  -0.000  -0.299  -0.000
        2.533   0.000  -3.373  -0.000   0.106   0.000   0.334   0.000   0.106

  chi0(G,G&#x27;) at the    2 th omega   0.0000  16.7000 [eV]
       1       2       3       4       5       6       7       8       9
    1  -2.571  -0.727   0.255  -0.414  -0.414   0.255  -0.727  -0.414  -0.414
        0.000  -0.727  -0.255  -0.414   0.414   0.255   0.727  -0.414   0.414

    2  -0.727  -8.786  -0.000   0.050   0.000  -0.031  -0.000   0.050  -0.000
        0.727   0.000  -0.808  -0.000  -0.055   0.000  -0.047   0.000  -0.055

  Average fulfillment of the sum rule on Im[epsilon] for q-point    3 :     87.33  [%]


--------------------------------------------------------------------------------
  q-point number  4        q = ( 0.000000, 0.500000, 0.000000) [r.l.u.]
--------------------------------------------------------------------------------
  chi0(G,G&#x27;) at the    1 th omega   0.0000   0.0000 [eV]
       1       2       3       4       5       6       7       8       9
    1 -14.428  -1.961  -2.660  -1.961  -2.660  -1.961  -2.660  -2.274   3.152
        0.000  -1.961   2.660  -1.961   2.660  -1.961   2.660  -2.274  -3.152

    2  -1.961 -20.236  -0.000   0.280  -0.000   0.280   0.000   0.340   0.000
        1.961   0.000  -2.681   0.000   0.211  -0.000   0.211  -0.000  -0.897

  chi0(G,G&#x27;) at the    2 th omega   0.0000  16.7000 [eV]
       1       2       3       4       5       6       7       8       9
    1  -3.518  -0.343  -0.716  -0.343  -0.716  -0.343  -0.716  -0.910   0.537
        0.000  -0.343   0.716  -0.343   0.716  -0.343   0.716  -0.910  -0.537

    2  -0.343  -7.557  -0.000  -0.135  -0.000  -0.135   0.000   0.066   0.000
        0.343   0.000  -0.648   0.000  -0.044  -0.000  -0.044  -0.000  -0.102

  Average fulfillment of the sum rule on Im[epsilon] for q-point    4 :     86.99  [%]


--------------------------------------------------------------------------------
  q-point number  5        q = ( 0.500000,-0.250000, 0.250000) [r.l.u.]
--------------------------------------------------------------------------------
  chi0(G,G&#x27;) at the    1 th omega   0.0000   0.0000 [eV]
       1       2       3       4       5       6       7       8       9
    1 -19.327  -3.001  -1.292  -3.006  -2.417  -2.417  -3.006  -1.292  -3.001
        0.000  -3.001   1.292  -3.006   2.417  -2.417   3.006  -1.292   3.001

    2  -3.001 -16.162   0.000   0.366  -0.000   0.549   0.000  -0.242   0.000
        3.001   0.000  -2.479  -0.000   0.207  -0.000   0.320   0.000   0.063

  chi0(G,G&#x27;) at the    2 th omega   0.0000  16.7000 [eV]
       1       2       3       4       5       6       7       8       9
    1  -5.045  -1.050  -0.043  -0.904  -0.625  -0.625  -0.904  -0.043  -1.050
        0.000  -1.050   0.043  -0.904   0.625  -0.625   0.904  -0.043   1.050

    2  -1.050  -8.424   0.000   0.139  -0.000   0.077   0.000   0.008   0.000
        1.050   0.000  -0.510  -0.000  -0.040  -0.000  -0.034   0.000  -0.063

  Average fulfillment of the sum rule on Im[epsilon] for q-point    5 :     86.85  [%]


--------------------------------------------------------------------------------
  q-point number  6        q = ( 0.000000,-0.250000,-0.250000) [r.l.u.]
--------------------------------------------------------------------------------
  chi0(G,G&#x27;) at the    1 th omega   0.0000   0.0000 [eV]
       1       2       3       4       5       6       7       8       9
    1 -10.610  -2.292  -0.014  -0.014  -2.292  -2.292  -0.014  -0.014  -2.292
        0.000  -2.292   0.014  -0.014   2.292  -2.292   0.014  -0.014   2.292

    2  -2.292 -18.972  -0.000  -0.413  -0.000  -0.354  -0.000  -0.413   0.000
        2.292   0.000  -3.503   0.000   0.184  -0.000  -0.374  -0.000   0.184

  chi0(G,G&#x27;) at the    2 th omega   0.0000  16.7000 [eV]
       1       2       3       4       5       6       7       8       9
    1  -1.418  -0.449   0.089   0.089  -0.449  -0.449   0.089   0.089  -0.449
        0.000  -0.449  -0.089   0.089   0.449  -0.449  -0.089   0.089   0.449

    2  -0.449  -8.551  -0.000  -0.048   0.000   0.044  -0.000  -0.048   0.000
        0.449   0.000  -0.896   0.000  -0.063  -0.000  -0.100  -0.000  -0.063

  Average fulfillment of the sum rule on Im[epsilon] for q-point    6 :     88.68  [%]

================================================================================
== DATASET  4 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 4, }
dimensions: {natom: 2, nkpt: 6, mband: 80, nsppol: 1, nspinor: 1, nspden: 1, mpw: 303, }
cutoff_energies: {ecut:   8.0, pawecutdg:  -1.0, }
electrons: {nelect:   8.00000000E+00, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 4, gwcalctyp: 0, }
...

 mkfilename : getwfk/=0, take file _WFK from output of DATASET   2.

 mkfilename : getscr/=0, take file _SCR from output of DATASET   3.

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

 SIGMA: Calculation of the GW corrections 

 Based on a program developped by R.W. Godby, V. Olevano, G. Onida, and L. Reining.
 Incorporated in ABINIT by V. Olevano, G.-M. Rignanese, and M. Torrent.
.Using double precision arithmetic ; gwpc =  8

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  5.1300000  5.1300000  G(1)= -0.0974659  0.0974659  0.0974659
 R(2)=  5.1300000  0.0000000  5.1300000  G(2)=  0.0974659 -0.0974659  0.0974659
 R(3)=  5.1300000  5.1300000  0.0000000  G(3)=  0.0974659  0.0974659 -0.0974659
 Unit cell volume ucvol=  2.7001139E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
--------------------------------------------------------------------------------

 ==== K-mesh for the wavefunctions ====
 Number of points in the irreducible wedge :     6
 Reduced coordinates and weights : 

     1)    -2.50000000E-01 -2.50000000E-01  0.00000000E+00       0.18750
     2)    -2.50000000E-01  2.50000000E-01  0.00000000E+00       0.37500
     3)     5.00000000E-01  5.00000000E-01  0.00000000E+00       0.09375
     4)    -2.50000000E-01  5.00000000E-01  2.50000000E-01       0.18750
     5)     5.00000000E-01  0.00000000E+00  0.00000000E+00       0.12500
     6)     0.00000000E+00  0.00000000E+00  0.00000000E+00       0.03125

 Together with 48 symmetry operations and time-reversal symmetry 
 yields    32 points in the full Brillouin Zone.


 ==== Q-mesh for screening function ====
 Number of points in the irreducible wedge :     6
 Reduced coordinates and weights : 

     1)     0.00000000E+00  0.00000000E+00  0.00000000E+00       0.03125
     2)     5.00000000E-01  5.00000000E-01  0.00000000E+00       0.09375
     3)     5.00000000E-01  2.50000000E-01  2.50000000E-01       0.37500
     4)     0.00000000E+00  5.00000000E-01  0.00000000E+00       0.12500
     5)     5.00000000E-01 -2.50000000E-01  2.50000000E-01       0.18750
     6)     0.00000000E+00 -2.50000000E-01 -2.50000000E-01       0.18750

 Together with 48 symmetry operations and time-reversal symmetry 
 yields    32 points in the full Brillouin Zone.


 setmesh: FFT mesh size selected  =    20x   20x   20
          total number of points  =         8000

 Number of electrons calculated from density =    8.0000; Expected =    8.0000
 average of density, n =  0.029628
 r_s =    2.0048
 omega_plasma =   16.6039 [eV]


 === KS Band Gaps ===
  &gt;&gt;&gt;&gt; For spin  1
   Minimum direct gap =   2.5435 [eV], located at k-point      :   0.0000  0.0000  0.0000
   Fundamental gap    =   0.7097 [eV], Top of valence bands at :   0.0000  0.0000  0.0000
                                       Bottom of conduction at :   0.5000  0.5000  0.0000
 SIGMA fundamental parameters:
 PLASMON POLE MODEL  1
 number of plane-waves for SigmaX                  283
 number of plane-waves for SigmaC and W             89
 number of plane-waves for wavefunctions           283
 number of bands                                    80
 number of independent spin polarizations            1
 number of spinorial components                      1
 number of k-points in IBZ                           6
 number of q-points in IBZ                           6
 number of symmetry operations                      48
 number of k-points in BZ                           32
 number of q-points in BZ                           32
 number of frequencies for dSigma/dE                 9
 frequency step for dSigma/dE [eV]                0.25
 number of omega for Sigma on real axis              0
 max omega for Sigma on real axis  [eV]           0.00
 zcut for avoiding poles [eV]                     0.10

 EPSILON^-1 parameters (SCR file):
 dimension of the eps^-1 matrix on file             89
 dimension of the eps^-1 matrix used                89
 number of plane-waves for wavefunctions           283
 number of bands                                    60
 number of q-points in IBZ                           6
 number of frequencies                               2
 number of real frequencies                          1
 number of imag frequencies                          1

 matrix elements of self-energy operator (all in [eV])

 Perturbative Calculation

--- !SelfEnergy_ee
iteration_state: {dtset: 4, }
kpoint     : [   0.000,    0.000,    0.000, ]
spin       : 1
KS_gap     :    2.544
QP_gap     :    3.110
Delta_QP_KS:    0.567
data: !SigmaeeData |
     Band     E0 &lt;VxcDFT&gt;   SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
        2   4.418 -11.332 -13.262   1.352   0.766  -0.305 -11.775  -0.443   3.975
        3   4.418 -11.332 -13.262   1.352   0.766  -0.305 -11.775  -0.443   3.975
        4   4.418 -11.332 -13.262   1.352   0.766  -0.305 -11.775  -0.443   3.975
        5   6.961 -10.028  -5.550  -4.316   0.766  -0.305  -9.904   0.124   7.085
        6   6.961 -10.028  -5.550  -4.316   0.766  -0.305  -9.904   0.124   7.085
        7   6.961 -10.028  -5.550  -4.316   0.766  -0.305  -9.904   0.124   7.085
...


== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      1.0260000000E+01  1.0260000000E+01  1.0260000000E+01 Bohr
              amu      2.80855000E+01
             bdgw4          4       5
           diemac      1.20000000E+01
             ecut      8.00000000E+00 Hartree
          ecuteps1     0.00000000E+00 Hartree
          ecuteps2     0.00000000E+00 Hartree
          ecuteps3     3.60000000E+00 Hartree
          ecuteps4     0.00000000E+00 Hartree
         ecutsigx1     0.00000000E+00 Hartree
         ecutsigx2     0.00000000E+00 Hartree
         ecutsigx3     0.00000000E+00 Hartree
         ecutsigx4     8.00000000E+00 Hartree
          ecutwfn1     0.00000000E+00 Hartree
          ecutwfn2     0.00000000E+00 Hartree
          ecutwfn3     8.00000000E+00 Hartree
          ecutwfn4     8.00000000E+00 Hartree
           etotal1    -8.4508907676E+00
           etotal3     0.0000000000E+00
           etotal4     0.0000000000E+00
            fcart1    -1.1399776981E-45  1.1399776981E-45  2.6244105489E-29
                       1.1399776981E-45 -1.1399776981E-45 -2.6244105489E-29
            fcart3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart4     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         512
           getden1          0
           getden2         -1
           getden3          0
           getden4          0
           getscr1          0
           getscr2          0
           getscr3          0
           getscr4         -1
           getwfk1          0
           getwfk2          0
           getwfk3         -1
           getwfk4         -2
             iscf1          7
             iscf2         -2
             iscf3          7
             iscf4          7
           istwfk        0    0    1    0    1    1
              ixc          11
           jdtset        1    2    3    4
              kpt     -2.50000000E-01 -2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       0.00000000E+00  0.00000000E+00  0.00000000E+00
            kptgw4     0.00000000E+00  0.00000000E+00  0.00000000E+00
         kptrlatt        2   -2    2     -2    2    2     -2   -2    2
          kptrlen      2.05200000E+01
P           mkmem           6
            natom           2
            nband1          6
            nband2        100
            nband3         60
            nband4         80
           nbdbuf1          0
           nbdbuf2         20
           nbdbuf3          0
           nbdbuf4          0
           ndtset           4
            ngfft          20      20      20
             nkpt           6
           nkptgw1          0
           nkptgw2          0
           nkptgw3          0
           nkptgw4          1
           npweps1          0
           npweps2          0
           npweps3         89
           npweps4          0
          npwsigx1          0
          npwsigx2          0
          npwsigx3          0
          npwsigx4        283
           npwwfn1          0
           npwwfn2          0
           npwwfn3        283
           npwwfn4        283
            nstep          20
             nsym          48
           ntypat           1
              occ1     2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
              occ4     2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000
        optdriver1          0
        optdriver2          0
        optdriver3          3
        optdriver4          4
           ppmfrq1     0.00000000E+00 Hartree
           ppmfrq2     0.00000000E+00 Hartree
           ppmfrq3     6.13713734E-01 Hartree
           ppmfrq4     0.00000000E+00 Hartree
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         227
           strten1    -4.4807387228E-05 -4.4807387228E-05 -4.4807387228E-05
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten4     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tnons      0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
           tolvrs1     1.00000000E-10
           tolvrs2     0.00000000E+00
           tolvrs3     0.00000000E+00
           tolvrs4     0.00000000E+00
           tolwfr1     0.00000000E+00
           tolwfr2     1.00000000E-12
           tolwfr3     0.00000000E+00
           tolwfr4     0.00000000E+00
            typat      1  1
              wtk        0.18750    0.37500    0.09375    0.18750    0.12500    0.03125
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       1.3573395400E+00  1.3573395400E+00  1.3573395400E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5650000000E+00  2.5650000000E+00  2.5650000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5000000000E-01  2.5000000000E-01  2.5000000000E-01
            znucl       14.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin, 
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys 
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=          6.8  wall=          7.5

================================================================================

 Calculation completed.
.Delivered   1 WARNINGs and   8 COMMENTs to log file.
+Overall time at end (sec) : cpu=          6.8  wall=          7.5

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5df453d8-b26e-40cf-96e6-6777326f63d3", "#uuid-59f5eefe-e4fe-49b6-9b4b-a83ebd909d34") }); </script>

<p>After the description of the unit cell and of the pseudopotentials, you will
find the list of <strong>k</strong>-points used for the electrons and the grid of <strong>q</strong>-points (in
the Irreducible part of the Brillouin Zone) on which the susceptibility and
dielectric matrices will be computed.</p>
<div class="highlight"><pre><span></span><code> ==== K-mesh for the wavefunctions ====
 Number of points in the irreducible wedge :     6
 Reduced coordinates and weights :

     1)    -2.50000000E-01 -2.50000000E-01  0.00000000E+00       0.18750
     2)    -2.50000000E-01  2.50000000E-01  0.00000000E+00       0.37500
     3)     5.00000000E-01  5.00000000E-01  0.00000000E+00       0.09375
     4)    -2.50000000E-01  5.00000000E-01  2.50000000E-01       0.18750
     5)     5.00000000E-01  0.00000000E+00  0.00000000E+00       0.12500
     6)     0.00000000E+00  0.00000000E+00  0.00000000E+00       0.03125

 Together with 48 symmetry operations and time-reversal symmetry
 yields    32 points in the full Brillouin Zone.


 ==== Q-mesh for the screening function ====
 Number of points in the irreducible wedge :     6
 Reduced coordinates and weights :

     1)     0.00000000E+00  0.00000000E+00  0.00000000E+00       0.03125
     2)     5.00000000E-01  5.00000000E-01  0.00000000E+00       0.09375
     3)     5.00000000E-01  2.50000000E-01  2.50000000E-01       0.37500
     4)     0.00000000E+00  5.00000000E-01  0.00000000E+00       0.12500
     5)     5.00000000E-01 -2.50000000E-01  2.50000000E-01       0.18750
     6)     0.00000000E+00 -2.50000000E-01 -2.50000000E-01       0.18750

 Together with 48 symmetry operations and time-reversal symmetry
 yields    32 points in the full Brillouin Zone.
</code></pre></div>
<p>The q-mesh is the set of all the possible momentum transfers.
These points are obtained as all the possible differences among the <strong>k</strong>-points ( <span><span class="MathJax_Preview">\mathbf{q} =\mathbf{k}-\mathbf{k}'</span><script type="math/tex">\mathbf{q} =\mathbf{k}-\mathbf{k}'</script></span> ) of the grid chosen to
generate the WFK file. From the last statement it is clear the importance of
choosing homogeneous <strong>k</strong>-point grids in order to minimize the number of <strong>q</strong>-points is clear.</p>
<p>After this section, the code prints the parameters of the FFT grid needed to
represent the wavefunctions and to compute their convolution (required for the
screening matrices). Then we have some information about the MPI distribution
of the bands and the total number of valence electrons computed by integrating
the density in the unit cell.</p>
<div class="highlight"><pre><span></span><code> setmesh: FFT mesh size selected  =  20x 20x 20
          total number of points  =     8000


- screening: taking advantage of time-reversal symmetry
- Maximum band index for partially occupied states nbvw = 4
- Remaining bands to be divided among processors   nbcw = 56
- Number of bands treated by each node ~56
</code></pre></div>
<p>With the valence density, one can obtain the classical Drude plasma
frequency. The next lines calculate the average density of the system, and
evaluate the Wigner radius <span><span class="MathJax_Preview">r_s</span><script type="math/tex">r_s</script></span>, then compute the Drude plasma frequency, reported as omega_plasma.</p>
<div class="highlight"><pre><span></span><code> Number of electrons calculated from density =    7.9999; Expected =    8.0000
 average of density, n =  0.029628
 r_s =    2.0048
 omega_plasma =   16.6039 [eV]
</code></pre></div>
<p>This omega_plasma is the value used when the default for <a class="wikilink codevar-wikilink" href="/variables/gw#ppmfrq">ppmfrq</a>, namely 0.0, is specified. 
It is in fact the second frequency
where the code calculates the dielectric matrix to adjust the plasmon-pole
model parameters.</p>
<p>It has been found that Drude plasma frequency is a
reasonable value where to adjust the model. The control over this parameter is
however left to the user in order to check that the result does not change
when changing <a class="wikilink codevar-wikilink" href="/variables/gw#ppmfrq">ppmfrq</a>. One has to be careful with finite systems or with systems having semicore electrons.
If the result depends much on  <a class="wikilink codevar-wikilink" href="/variables/gw#ppmfrq">ppmfrq</a>, then the plasmon-pole model is
not appropriate and one should go beyond it by taking into account a full
dynamical dependence in the screening (see later, the contour-deformation
method). However, the plasmon-pole model has been found to work well for a
very large range of solid-state systems when focusing only on the real part of the GW
corrections in the band gap region.</p>
<p>At the end of the screening calculation, the macroscopic dielectric constant is printed:</p>
<div class="highlight"><pre><span></span><code>      dielectric constant =  22.4176
      dielectric constant without local fields =  24.7005
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the convergence in the dielectric constant <strong>does not guarantee</strong> the
convergence in the GW corrections and vice-versa. In fact, the dielectric constant is
representative of only one element i.e. the head of the full dielectric
matrix. Even if the convergence on the dielectric constant with local fields
takes somehow into account also other non-diagonal elements. In a GW
calculation the whole <span><span class="MathJax_Preview">\epsilon^{-1}</span><script type="math/tex">\epsilon^{-1}</script></span> matrix is used to build the Self-Energy operator.</p>
</div>
<p>The dielectric constant reported here is the so-called RPA dielectric constant
due to the electrons. Although evaluated at zero frequency, it is understood
that the ionic response is not included (this term can be computed with DFPT
and ANADDB). The RPA dielectric constant restricted to electronic effects is
also not the same as the one computed in the DFPT part of ABINIT, that
includes exchange-correlation effects.</p>
<p>We now enter the fourth dataset. As for dataset 3, after some general
information (origin of WFK file, header, description of unit cell, <strong>k</strong>-points,
<strong>q</strong>-points), the description of the FFT grid and jellium parameters, there is
the echo of parameters for the plasmon-pole model, and the inverse dielectric
function (the screening). The self-energy operator has been constructed, and
one can evaluate the GW energies for each state.</p>
<p>The final results are:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span> <span class="kt">!SelfEnergy_ee</span>
<span class="nt">kpoint     </span><span class="p">:</span> <span class="p p-Indicator">[</span>   <span class="nv">0.000</span><span class="p p-Indicator">,</span>    <span class="nv">0.000</span><span class="p p-Indicator">,</span>    <span class="nv">0.000</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">]</span>
<span class="nt">spin       </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">KS_gap     </span><span class="p">:</span>    <span class="l l-Scalar l-Scalar-Plain">2.544</span>
<span class="nt">QP_gap     </span><span class="p">:</span>    <span class="l l-Scalar l-Scalar-Plain">3.110</span>
<span class="nt">Delta_QP_KS</span><span class="p">:</span>    <span class="l l-Scalar l-Scalar-Plain">0.567</span>
<span class="nt">data</span><span class="p">:</span> <span class="kt">!SigmaeeData</span> <span class="p p-Indicator">|</span>
     <span class="no">Band     E0 &lt;VxcDFT&gt;   SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E</span>
        <span class="no">2   4.418 -11.332 -13.262   1.352   0.766  -0.305 -11.775  -0.443   3.975</span>
        <span class="no">3   4.418 -11.332 -13.262   1.352   0.766  -0.305 -11.775  -0.443   3.975</span>
        <span class="no">4   4.418 -11.332 -13.262   1.352   0.766  -0.305 -11.775  -0.443   3.975</span>
        <span class="no">5   6.961 -10.028  -5.550  -4.316   0.766  -0.305  -9.904   0.124   7.085</span>
        <span class="no">6   6.961 -10.028  -5.550  -4.316   0.766  -0.305  -9.904   0.124   7.085</span>
        <span class="no">7   6.961 -10.028  -5.550  -4.316   0.766  -0.305  -9.904   0.124   7.085</span>
<span class="nn">...</span>
</code></pre></div>
<p>For the desired <strong>k</strong>-point (<span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> point), for state 4, then state 5, one finds different information
in the SigmaeeData section:</p>
<ul>
<li>E0 is the KS eigenenergy</li>
<li>VxcDFT gives the KS exchange-correlation potential expectation value</li>
<li>SigX gives the exchange contribution to the self-energy</li>
<li>SigC(E0) gives the correlation contribution to the self-energy, evaluated at the KS eigenenergy</li>
<li>Z is the renormalisation factor</li>
<li>dSigC/dE is the energy derivative of SigC with respect to the energy</li>
<li>SigC(E) gives the correlation contribution to the self-energy, evaluated at the GW energy</li>
<li>E-E0 is the difference between GW energy and KS eigenenergy</li>
<li>E is the final GW quasiparticle energy</li>
</ul>
<p>In this case, prior to the SigmaeeData section, the direct band gap was also analyzed: KS_gap is the direct KS gap at
that particular <strong>k</strong>-point (and spin, in the case of spin-polarized calculations), QP_gap
is the GW one, and Delta_QP_KS is the difference. This direct gap is always
computed between the band whose number is equal to the number of electrons in
the cell divided by two (integer part, in case of spin-polarized calculation),
and the next one.
This means that the value reported by the code may be wrong if the final QP energies
obtained in the perturbative approach are not ordered by increasing energy anymore.
So it&rsquo;s always a good idea to check that the &ldquo;gap&rdquo; reported by the code corresponds
to the real QP direct gap.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For a metal, these two bands do not systematically
lie below and above the KS Fermi energy - but the concept of a direct gap is not relevant in that case.
Moreover one should compute the Fermi energy of the QP system.</p>
</div>
<p>It is seen that the KS exchange-correlation potential expectation value for the
state 4 (a valence state) is rather close to the exchange self-energy
correction. For that state, the correlation correction is small, and the
difference between KS and GW energies is also small (0.128 eV). By
contrast, the exchange self-energy is much smaller than the average Kohn-Sham
potential for the state 5 (a conduction state), but the correlation correction
is much larger than for state 4.
On the whole, the difference between Kohn-Sham and GW energies is not very large,
but nevertheless, it is quite
important when compared with the size of the gap.</p>
<p>If <a href="https://github.com/abinit/abipy">AbiPy</a>  is installed on your machine, you can use the <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  script
with the <code>--print</code> option to extract the results from the SIGRES.nc file
and print them to terminal:</p>
<div class="highlight"><pre><span></span><code>abiopen.py tgw1_1o_DS4_SIGRES.nc -p

================================= Structure =================================
Full Formula (Si2)
Reduced Formula: Si
abc   :   3.839136   3.839136   3.839136
angles:  60.000000  60.000000  60.000000
Sites (2)
  #  SP       a     b     c
---  ----  ----  ----  ----
  0  Si    0     0     0
  1  Si    0.25  0.25  0.25

Abinit Spacegroup: spgid: 0, num_spatial_symmetries: 48, has_timerev: True, symmorphic: True

============================== Kohn-Sham bands ==============================
Number of electrons: 8.0, Fermi level: 4.773 (eV)
nsppol: 1, nkpt: 6, mband: 80, nspinor: 1, nspden: 1
smearing scheme: none, tsmear_eV: 0.272, occopt: 1
Direct gap:
    Energy: 2.544 (eV)
    Initial state: spin: 0, kpt: [+0.000, +0.000, +0.000], weight: 0.031, band: 3, eig: 4.418, occ: 2.000
    Final state:   spin: 0, kpt: [+0.000, +0.000, +0.000], weight: 0.031, band: 4, eig: 6.961, occ: 0.000
Fundamental gap:
    Energy: 0.710 (eV)
    Initial state: spin: 0, kpt: [+0.000, +0.000, +0.000], weight: 0.031, band: 3, eig: 4.418, occ: 2.000
    Final state:   spin: 0, kpt: [+0.500, +0.500, +0.000], weight: 0.094, band: 4, eig: 5.128, occ: 0.000
Bandwidth: 11.985 (eV)
Valence maximum located at:
    spin: 0, kpt: [+0.000, +0.000, +0.000], weight: 0.031, band: 3, eig: 4.418, occ: 2.000
Conduction minimum located at:
    spin: 0, kpt: [+0.500, +0.500, +0.000], weight: 0.094, band: 4, eig: 5.128, occ: 0.000

TIP: Call set_fermie_to_vbm() to set the Fermi level to the VBM if this is a non-magnetic semiconductor


=============================== QP direct gaps ===============================
QP_dirgap: 3.110 (eV) for K-point: [+0.000, +0.000, +0.000] $\Gamma$, spin: 0


============== QP results for each k-point and spin (all in eV) ==============
K-point: [+0.000, +0.000, +0.000] $\Gamma$, spin: 0
   band     e0    qpe  qpe_diago   vxcme  sigxme  sigcmee0  vUme    ze0
1     1  4.418  3.975      3.840 -11.332 -13.262     1.352   0.0  0.766
2     2  4.418  3.975      3.840 -11.332 -13.262     1.352   0.0  0.766
3     3  4.418  3.975      3.840 -11.332 -13.262     1.352   0.0  0.766
4     4  6.961  7.085      7.123 -10.028  -5.550    -4.316   0.0  0.766
5     5  6.961  7.085      7.123 -10.028  -5.550    -4.316   0.0  0.766
6     6  6.961  7.085      7.123 -10.028  -5.550    -4.316   0.0  0.766
</code></pre></div>
<p>For further details about the SIGRES.nc file and the AbiPy API see the <a href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/sigres.ipynb">Sigres notebook</a> .</p>
<h2 id="2-preparing-convergence-studies-kohn-sham-structure-wfk-file-and-screening-scr-file">2 Preparing convergence studies: Kohn-Sham structure (WFK file) and screening (SCR file)<a class="headerlink" href="#2-preparing-convergence-studies-kohn-sham-structure-wfk-file-and-screening-scr-file" title="Permanent link">&para;</a></h2>
<p>In the following sections, we will perform different convergence studies. In
order to keep the CPU time at a reasonable level, we will use fake WFK and SCR
data. We will focus on the GW correction for <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> point to determine the values of the GW parameters needed
to reach the convergence.
Indeed, we will use a coarse <strong>k</strong>-point grid with one shift only, and we will not vary <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>.
This is a common strategy to find the adequate specific GW parameters before the final calculations, that should be
done with a sufficiently fine <strong>k</strong>-point grid, and an adequate <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>, in addition to adequate specific GW parameters.</p>
<p>In directory <em>Work_gw1</em>, copy the file <em>tgw1_2.abi</em>:
<div class="highlight"><pre><span></span><code>    cp <span class="nv">$ABI_TESTS</span>/tutorial/Input/tgw1_2.abi .
</code></pre></div></p>
<p>Edit the <em>tgw1_2.abi</em> file, and take the time to examine it.
Then, issue:</p>
<div class="highlight"><pre><span></span><code>    abinit tgw1_2.abi &gt; tgw1_2.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>After this step you will need the WFK and SCR files produced in this run for
the next runs. Move <em>tgw1o_DS2_WFK</em> to <em>tgw1o_DS1_WFK</em> and <em>tgw1o_DS3_SCR</em> to <em>tgw1o_DS1_SCR</em>.</p>
<p>The next sections are intended to show you how to find the converged values
of parameters that are specific of a GW calculation. The following parameters might
be used to decrease the CPU time and/or the memory requirements, in addition to the well-known k point sampling and <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>.
For <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 3, one needs to study the convergence with respect to <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> simultaneously,
while for <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 4, only the behaviour with respect to <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> should be monitored.
As mentioned above, the global convergence with respect to <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> and to the number of k points has
to be monitored as well, but the determination of the adequate parameters can be done independently from
the determination of the adequate values for <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>. Altogether, one has to determine the
adequate values of four parameters in GW calculations, instead of only two in ground-state calculations (<a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> and the number of k points).
The adequate values of <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> and the number of k points for converged results <em>might</em> perhaps be the same as for ground-state
calculations, but this is not always the case !</p>
<p>We will test the convergence with respect to <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> and <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a>, simultaneously for <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=3 and =4.
As a side note, there are actually other technical parameters like <a class="wikilink codevar-wikilink" href="/variables/gw#ecutwfn">ecutwfn</a> or <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a>.
However, for them, one can use the default value of <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>.
For PAW, <a class="wikilink codevar-wikilink" href="/variables/paw#pawecutdg">pawecutdg</a> can be tuned as well.</p>
<p>We begin by the convergence study with respect to <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, the most important parameter needed in the self-energy
calculation, <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 4.
This is because for the self-energy calculation, we will not need a double dataset loop to check
this convergence (as <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> is not a parameter of the <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 4 calculation), and we will rely on the previously determined SCR file.</p>
<h2 id="3-convergence-of-the-self-energy-with-respect-to-the-number-of-bands">3 Convergence of the self-energy with respect to the number of bands<a class="headerlink" href="#3-convergence-of-the-self-energy-with-respect-to-the-number-of-bands" title="Permanent link">&para;</a></h2>
<p>Let us check the convergence of the band gap with respect to the number of bands in the calculation of <span><span class="MathJax_Preview">\Sigma_c</span><script type="math/tex">\Sigma_c</script></span>
with a fixed screening file.  This convergence study is very important.
<em>However</em> most of the time, the converged <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> is similar for <span><span class="MathJax_Preview">\Sigma_c</span><script type="math/tex">\Sigma_c</script></span> and for <span><span class="MathJax_Preview">\chi_0</span><script type="math/tex">\chi_0</script></span> so that the same
value is taken for both. Here we will proceed carefully and converge the two occurences of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> independently.</p>
<p>The convergence on the number of bands to calculate <span><span class="MathJax_Preview">\Sigma_c</span><script type="math/tex">\Sigma_c</script></span> will be
done by defining five datasets, with increasing <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>:</p>
<div class="highlight"><pre><span></span><code>    ndtset  5
    nband:  50
    nband+  50
</code></pre></div>
<p>In directory <em>Work_gw1</em>, copy the file <em>tgw1_3.abi</em>:
<div class="highlight"><pre><span></span><code>    cp <span class="nv">$ABI_TESTS</span>/tutorial/Input/tgw1_3.abi .
</code></pre></div></p>
<p>Edit the <em>tgw1_3.abi</em> file, and take the time to examine it.
Then, issue:</p>
<div class="highlight"><pre><span></span><code>    cp tgw1_2o_DS2_WFK tgw1_3o_DS2_WFK
    cp tgw1_2o_DS3_SCR tgw1_3o_DS3_SCR
    abinit tgw1_3.abi &gt; tgw1_3.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<div class="text-center"><button id="uuid-4cc805e4-ff11-43be-a09f-838dc3e8bb28" class="md-button md-button--secondary"> View tests/tutorial/Input/tgw1_3.abi </button></div>
<div id="uuid-e6c78648-66a4-467e-bc1b-954e17a937c9" class="my_dialog" title="tests/tutorial/Input/tgw1_3.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>


<span class="c1"># Convergence with respect to the number of bands in Sigmac</span>
ndtset  <span class="m">5</span>
nband:  <span class="m">50</span>
nband+  <span class="m">50</span>

<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver  <span class="m">4</span>
getwfk     <span class="m">2</span>
getscr     <span class="m">3</span>
ecutsigx    <span class="m">8</span>.0
nkptgw      <span class="m">1</span>
kptgw      <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw       <span class="m">4</span>  <span class="m">5</span> 


<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.26         <span class="c1"># Experimental lattice constants</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>


<span class="c1"># Definition of the k-point grid</span>
ngkpt   <span class="m">2</span> <span class="m">2</span> <span class="m">2</span>
nshiftk <span class="m">1</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>


 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pbe_standard_psp8/Si.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw1_2.abi, tgw1_3.abi, tgw1_4.abi, tgw1_5.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_3.abo, tolnlines= 70, tolabs=  9.000e-03, tolrel=  3.000e-02</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline silicon</span>
<span class="c1">#%%    Calculation of the GW corrections</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-e6c78648-66a4-467e-bc1b-954e17a937c9", "#uuid-4cc805e4-ff11-43be-a09f-838dc3e8bb28") }); </script>

<p>Edit the output file. The number of bands used for the self-energy is
mentioned in the fragments of output:</p>
<div class="highlight"><pre><span></span><code>     SIGMA fundamental parameters:
     PLASMON POLE MODEL
     number of plane-waves for SigmaX                  283
     number of plane-waves for SigmaC and W            169
     number of plane-waves for wavefunctions           283
     number of bands                                    50
</code></pre></div>
<p>Gathering the GW energies for each number of bands, one gets:</p>
<div class="highlight"><pre><span></span><code>     number of bands                                   50
        4   4.665 -11.412 -13.527   1.904   0.785  -0.273 -11.578  -0.165   4.500
        5   7.108  -9.962  -4.945  -4.344   0.793  -0.261  -9.428   0.534   7.643

     number of bands                                  100
        4   4.665 -11.412 -13.527   1.768   0.784  -0.275 -11.684  -0.271   4.394
        5   7.108  -9.962  -4.945  -4.470   0.792  -0.263  -9.528   0.434   7.542

     number of bands                                  150
        4   4.665 -11.412 -13.527   1.741   0.784  -0.275 -11.705  -0.293   4.372
        5   7.108  -9.962  -4.945  -4.494   0.792  -0.263  -9.547   0.415   7.523

     number of bands                                  200
        4   4.665 -11.412 -13.527   1.733   0.784  -0.275 -11.711  -0.299   4.366
        5   7.108  -9.962  -4.945  -4.500   0.792  -0.263  -9.553   0.410   7.518

     number of bands                                  250
        4   4.665 -11.412 -13.527   1.731   0.784  -0.275 -11.713  -0.300   4.365
        5   7.108  -9.962  -4.945  -4.502   0.792  -0.263  -9.554   0.408   7.516
</code></pre></div>
<p>So that <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> = 100 can be considered converged within 30 meV, which is fair to compare with experimental accuracy.</p>
<p>With <a href="https://github.com/abinit/abipy">AbiPy</a> , one can use the <a href="http://abinit.github.io/abipy/scripts/abicomp.html">abicomp.py</a>  script provides to compare multiple SIGRES.nc files
Use the <code>--expose</code> option to visualize of the QP gaps extracted from the different netcdf files:</p>
<div class="highlight"><pre><span></span><code>$ abicomp.py sigres tgw1_3o_*_SIGRES.nc -e -sns

Output of robot.get_dataframe():
                       nsppol     qpgap  nspinor  nspden  nband  nkpt  \
tgw1_3o_DS1_SIGRES.nc       1  3.142871        1       1     50     3
tgw1_3o_DS2_SIGRES.nc       1  3.148588        1       1    100     3
tgw1_3o_DS3_SIGRES.nc       1  3.151012        1       1    150     3
tgw1_3o_DS4_SIGRES.nc       1  3.151603        1       1    200     3
tgw1_3o_DS5_SIGRES.nc       1  3.151485        1       1    250     3

                       ecutwfn   ecuteps  ecutsigx  scr_nband  sigma_nband  \
tgw1_3o_DS1_SIGRES.nc      8.0  5.062893       8.0         60           50
tgw1_3o_DS2_SIGRES.nc      8.0  5.062893       8.0         60          100
tgw1_3o_DS3_SIGRES.nc      8.0  5.062893       8.0         60          150
tgw1_3o_DS4_SIGRES.nc      8.0  5.062893       8.0         60          200
tgw1_3o_DS5_SIGRES.nc      8.0  5.062893       8.0         60          250

                       gwcalctyp  scissor_ene
tgw1_3o_DS1_SIGRES.nc          0          0.0
tgw1_3o_DS2_SIGRES.nc          0          0.0
tgw1_3o_DS3_SIGRES.nc          0          0.0
tgw1_3o_DS4_SIGRES.nc          0          0.0
tgw1_3o_DS5_SIGRES.nc          0          0.0
</code></pre></div>
<p><img alt="" src="../gw1_assets/abicomp_sigres_tgw1_3o.png" /></p>
<p>Invoking the script without options will open an <a href="https://ipython.org/index.html">ipython</a>  terminal to interact with the AbiPy robot.
Use the <code>-nb</code> option to automatically generate a <a href="http://jupyter.org/">jupyter</a>  notebook that will open in your browser.
For further details about the API provided by SigRes Robots see the <a href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/sigres.ipynb">Sigres notebook</a> 
and the <a href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/g0w0/lesson_g0w0.ipynb">notebook with the GW lesson</a>  for GW calculations powered by AbiPy.</p>
<h2 id="4-convergence-of-the-screening-with-respect-to-the-number-of-bands">4 Convergence of the screening with respect to the number of bands<a class="headerlink" href="#4-convergence-of-the-screening-with-respect-to-the-number-of-bands" title="Permanent link">&para;</a></h2>
<p>Now, we come back to the calculation of the screening. Adequate convergence
studies will couple the change of parameters for <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 3 with a
computation of the GW energy changes. One cannot rely on the convergence of
the macroscopic dielectric constant to assess the convergence of the GW energies.</p>
<p>As a consequence, we will define a double loop over the datasets:</p>
<div class="codehilite"><pre><span></span><code>ndtset      10
udtset      5  2
</code></pre></div>

<p>The datasets 12,22,32,42 and 52, drive the computation of the GW energies:</p>
<div class="codehilite"><pre><span></span><code># Calculation of the Self-Energy matrix elements (GW corrections)
optdriver?2   4
getscr?2     -1
ecutsigx      8.0
nband?2       100
</code></pre></div>

<p>The datasets 11,21,31,41 and 51, drive the corresponding computation of the screening:</p>
<div class="codehilite"><pre><span></span><code># Calculation of the screening (epsilon^-1 matrix)
optdriver?1  3
</code></pre></div>

<p>In this latter series, we will have to vary the two different parameters <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.</p>
<p>Let us begin with <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.
This convergence study is rather important. It can be done at the same time as
the convergence study for the number of bands for the self-energy. Note that
the number of bands used to calculate both the screening and the self-energy
can be lowered by a large amount by resorting to the extrapolar technique (see
the input variable <a class="wikilink codevar-wikilink" href="/variables/gw#gwcomp">gwcomp</a>).</p>
<p>Second, we check the convergence on the number of bands in the calculation of
the screening. This will be done by defining five datasets, with increasing <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>:</p>
<div class="codehilite"><pre><span></span><code>nband11  25
nband21  50
nband31  100
nband41  150
nband51  200
</code></pre></div>

<p>In directory <em>Work_gw1</em>, copy the file <em>tgw1_4.abi</em>:
<div class="highlight"><pre><span></span><code>    cp <span class="nv">$ABI_TESTS</span>/tutorial/Input/tgw1_4.abi .
</code></pre></div></p>
<p>Edit the <em>tgw1_4.abi</em> file, and take the time to examine it.
Then, issue:
<div class="highlight"><pre><span></span><code>    cp tgw1_2o_DS2_WFK tgw1_4o_DS2_WFK
    abinit tgw1_4.abi &gt; tgw1_4.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div></p>
<div class="text-center"><button id="uuid-7eb53e0d-d221-4483-a357-0590a10be78a" class="md-button md-button--secondary"> View tests/tutorial/Input/tgw1_4.abi </button></div>
<div id="uuid-7055cffa-4fd2-4af3-9e87-4e7ebbef2074" class="my_dialog" title="tests/tutorial/Input/tgw1_4.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>

ndtset      <span class="m">10</span>
udtset      <span class="m">5</span>  <span class="m">2</span>

<span class="c1"># Convergence with respect to the number of bands to calculate epsilon^-1</span>
nband11  <span class="m">25</span>
nband21  <span class="m">50</span>
nband31  <span class="m">100</span>
nband41  <span class="m">150</span>
nband51  <span class="m">200</span>

<span class="c1"># Calculation of the screening (epsilon^-1 matrix)</span>
optdriver?1  <span class="m">3</span>
ecuteps      <span class="m">6</span>.0

<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver?2  <span class="m">4</span>
getscr?2     -1
ecutsigx     <span class="m">8</span>.0
nband?2      <span class="m">100</span>
nkptgw?2      <span class="m">1</span>
kptgw?2      <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw?2       <span class="m">4</span>  <span class="m">5</span> 

getwfk       <span class="m">2</span>
ppmfrq      <span class="m">16</span>.7 eV  <span class="c1"># It is easier (and safer) to let ABINIT compute and use the Drude plasma frequency, </span>
                     <span class="c1"># instead of selecting a value by hand. This would be done thanks to the default value ppmfrq 0.0 .</span>


<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.26         <span class="c1"># Experimental lattice constants</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>


<span class="c1"># Sampling of the BZ</span>
ngkpt   <span class="m">2</span> <span class="m">2</span> <span class="m">2</span>
nshiftk <span class="m">1</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>


 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pbe_standard_psp8/Si.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw1_2.abi, tgw1_3.abi, tgw1_4.abi, tgw1_5.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_4.abo, tolnlines= 70, tolabs=  7.000e-02, tolrel=  3.000e-02</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline silicon</span>
<span class="c1">#%%   Calculation of the GW corrections</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-7055cffa-4fd2-4af3-9e87-4e7ebbef2074", "#uuid-7eb53e0d-d221-4483-a357-0590a10be78a") }); </script>

<p>Edit the output file. The number of bands used for the wavefunctions in the
computation of the screening is mentioned in the fragments of output:</p>
<div class="highlight"><pre><span></span><code>     EPSILON^-1 parameters (SCR file):
     dimension of the eps^-1 matrix on file            169
     dimension of the eps^-1 matrix used               169
     number of plane-waves for wavefunctions           283
     number of bands                                    25
</code></pre></div>
<p>Gathering the GW energies for each number of bands, one gets:</p>
<div class="highlight"><pre><span></span><code>  number of bands                                    25
        4   4.665 -11.412 -13.527   1.968   0.786  -0.273 -11.527  -0.115   4.550
        5   7.108  -9.962  -4.945  -4.279   0.796  -0.257  -9.375   0.587   7.696
  number of bands                                    50
        4   4.665 -11.412 -13.527   1.798   0.784  -0.275 -11.661  -0.248   4.417
        5   7.108  -9.962  -4.945  -4.446   0.789  -0.268  -9.512   0.451   7.559
  number of bands                                   100
        4   4.665 -11.412 -13.527   1.708   0.784  -0.276 -11.731  -0.318   4.347
        5   7.108  -9.962  -4.945  -4.523   0.791  -0.264  -9.571   0.391   7.499
  number of bands                                   150
        4   4.665 -11.412 -13.527   1.685   0.783  -0.276 -11.749  -0.336   4.329
        5   7.108  -9.962  -4.945  -4.542   0.790  -0.265  -9.586   0.376   7.485
  number of bands                                   200
        4   4.665 -11.412 -13.527   1.678   0.783  -0.277 -11.754  -0.341   4.324
        5   7.108  -9.962  -4.945  -4.549   0.790  -0.265  -9.592   0.370   7.479
</code></pre></div>
<p>So that the computation using 100 bands can be considered converged within 30 meV.
Note that the value of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> that gives a converged dielectric matrix is usually of the same order of magnitude
than the one that gives a converged <span><span class="MathJax_Preview">\Sigma_c</span><script type="math/tex">\Sigma_c</script></span>.</p>
<h2 id="5-convergence-of-the-screening-matrix-with-respect-to-the-number-of-planewaves">5 Convergence of the screening matrix with respect to the number of planewaves<a class="headerlink" href="#5-convergence-of-the-screening-matrix-with-respect-to-the-number-of-planewaves" title="Permanent link">&para;</a></h2>
<p>Then, we check the convergence on the number of plane waves in the
calculation of the screening. This will be done by defining six datasets, with
increasing <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a>:</p>
<div class="codehilite"><pre><span></span><code>ecuteps:?     3.0
ecuteps+?     1.0
</code></pre></div>

<p>In directory <em>Work_gw1</em>, get the file <em>tgw1_5.abi</em>:
<div class="highlight"><pre><span></span><code>    cp <span class="nv">$ABI_TESTS</span>/tutorial/Input/tgw1_5.abi .
</code></pre></div></p>
<p>Edit the <em>tgw1_5.abi</em> file, and take the time to examine it.
Then, issue:</p>
<div class="highlight"><pre><span></span><code>    cp tgw1_2o_DS2_WFK tgw1_5o_DS2_WFK
    abinit tgw1_5.abi &gt; tgw1_5.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<div class="text-center"><button id="uuid-883c7b27-861c-43a0-a89e-16039d0be9bb" class="md-button md-button--secondary"> View tests/tutorial/Input/tgw1_5.abi </button></div>
<div id="uuid-5f25c966-c09f-4d57-990b-8af35a124add" class="my_dialog" title="tests/tutorial/Input/tgw1_5.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>

ndtset      <span class="m">12</span>
udtset      <span class="m">6</span>  <span class="m">2</span>

<span class="c1"># Calculation of the screening (epsilon^-1 matrix)</span>
optdriver?1  <span class="m">3</span>
nband?1      <span class="m">100</span>

<span class="c1"># Convergence with respect to the dimension of epsilon^-1 matrix</span>
ecuteps:?     <span class="m">3</span>.0
ecuteps+?     <span class="m">1</span>.0

<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver?2  <span class="m">4</span>
getscr?2     -1
ecutsigx     <span class="m">8</span>.0
nband?2      <span class="m">100</span>
nkptgw        <span class="m">1</span>
kptgw        <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw         <span class="m">4</span>  <span class="m">5</span> 

<span class="c1"># GW calculation general parameters</span>
getwfk       <span class="m">2</span>
ppmfrq      <span class="m">16</span>.7 eV  <span class="c1"># It is easier (and safer) to let ABINIT compute and use the Drude plasma frequency, </span>
                     <span class="c1"># instead of selecting a value by hand. This would be done thanks to the default value ppmfrq 0.0 .</span>

<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.26         <span class="c1"># Experimental lattice constants</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>


<span class="c1"># Sampling of the BZ</span>
ngkpt   <span class="m">2</span> <span class="m">2</span> <span class="m">2</span> 
nshiftk <span class="m">1</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>


 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pbe_standard_psp8/Si.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw1_2.abi, tgw1_3.abi, tgw1_4.abi, tgw1_5.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_5.abo, tolnlines= 70, tolabs=  7.000e-02, tolrel=  7.000e-02</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline silicon</span>
<span class="c1">#%%   Calculation of the GW corrections</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5f25c966-c09f-4d57-990b-8af35a124add", "#uuid-883c7b27-861c-43a0-a89e-16039d0be9bb") }); </script>

<p>Edit the output file. The number of bands used for the wavefunctions in the
computation of the screening is mentioned in the fragments of output:</p>
<div class="highlight"><pre><span></span><code>     EPSILON^-1 parameters (SCR file):
     dimension of the eps^-1 matrix                     59
</code></pre></div>
<p>Gathering the GW energies for each number of bands, one gets:</p>
<div class="highlight"><pre><span></span><code>     dimension of the eps^-1 matrix                     59
        4   4.665 -11.412 -13.527   1.899   0.786  -0.272 -11.582  -0.169   4.496
        5   7.108  -9.962  -4.945  -4.462   0.791  -0.264  -9.523   0.440   7.548
     dimension of the eps^-1 matrix                    113
        4   4.665 -11.412 -13.527   1.755   0.784  -0.275 -11.694  -0.282   4.383
        5   7.108  -9.962  -4.945  -4.513   0.791  -0.264  -9.563   0.400   7.508
     dimension of the eps^-1 matrix                    137
        4   4.665 -11.412 -13.527   1.728   0.784  -0.276 -11.715  -0.303   4.362
        5   7.108  -9.962  -4.945  -4.518   0.791  -0.264  -9.567   0.395   7.504
     dimension of the eps^-1 matrix                    169
        4   4.665 -11.412 -13.527   1.708   0.784  -0.276 -11.731  -0.318   4.347
        5   7.108  -9.962  -4.945  -4.523   0.791  -0.264  -9.571   0.391   7.499
     dimension of the eps^-1 matrix                    259
        4   4.665 -11.412 -13.527   1.696   0.784  -0.276 -11.740  -0.328   4.338
        5   7.108  -9.962  -4.945  -4.527   0.791  -0.264  -9.574   0.388   7.496
     dimension of the eps^-1 matrix                    283
        4   4.665 -11.412 -13.527   1.695   0.784  -0.276 -11.741  -0.329   4.337
        5   7.108  -9.962  -4.945  -4.527   0.791  -0.264  -9.575   0.388   7.496
</code></pre></div>
<p>So that ecuteps = 6.0 (<a class="wikilink codevar-wikilink" href="/variables/internal#npweps">%npweps</a> = 169) can be considered converged within 10 meV.</p>
<p>At this stage, we know that for the screening computation, we need
<a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> = 6.0 Ha and <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> = 100.</p>
<p>Of course, until now, we have skipped the most difficult part of the
convergence tests: the convergence in the number of <strong>k</strong>-points. It is as
important to check the convergence on this parameter, than on the other ones.
However, this might be very time consuming, since the CPU time scales as the
square of the number of <strong>k</strong>-points (roughly), and the number of k-points can
increase very rapidly from one possible grid to the next denser one. This is
why we will leave this out of the present tutorial, and consider that we
already know a sufficient <strong>k</strong>-point grid, for the last calculation.</p>
<p>As discussed in <a class="wikilink citation-wikilink" data-tippy-content="Automation methodologies and large-scale validation for GW: Towards high-throughput GW calculations" data-toggle="popover" href="/theory/bibliography#setten2017">[Setten2017]</a>, the convergence study for <strong>k</strong>-points
the number of bands and the cutoff energies can be decoupled
in the sense that one can start from a reasonaby coarse k-mesh to find
the converged values of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a>, <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a> and then
fix these values and look at the convergence with respect to the BZ mesh.</p>
<h2 id="6-calculation-of-the-gw-corrections-for-the-band-gap-at-the-zone-center">6 Calculation of the GW corrections for the band gap at the zone center<a class="headerlink" href="#6-calculation-of-the-gw-corrections-for-the-band-gap-at-the-zone-center" title="Permanent link">&para;</a></h2>
<p>Now we try to perform a GW calculation for a real problem: the calculation of
the GW corrections for the direct band gap of bulk silicon at the <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> point.</p>
<p>In directory <em>Work_gw1</em>, get the file <em>tgw1_6.abi</em>:
<div class="highlight"><pre><span></span><code>    cp <span class="nv">$ABI_TESTS</span>/tutorial/Input/tgw1_6.abi .
</code></pre></div></p>
<p>Then, edit the <em>tgw1_6.abi</em> file, and, without examining it, comment the line</p>
<div class="highlight"><pre><span></span><code>     ngkpt    2 2 2    # Density of k points used for the automatic tests of the tutorial
</code></pre></div>
<p>and uncomment the line</p>
<div class="highlight"><pre><span></span><code>    #ngkpt    4 4 4    # Density of k points needed for a converged calculation
</code></pre></div>
<p>Then, issue:</p>
<div class="highlight"><pre><span></span><code>    abinit tgw1_6.abi &gt; tgw1_6.log <span class="m">2</span>&gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>This job lasts a couple of minutes or so. It is worth to run it before the examination of the input file.
Now, you can examine it.</p>
<div class="text-center"><button id="uuid-d116413e-678a-496e-848e-6774347e87ed" class="md-button md-button--secondary"> View tests/tutorial/Input/tgw1_6.abi </button></div>
<div id="uuid-60311ed2-e231-40f0-bd05-f29c9ab3b905" class="my_dialog" title="tests/tutorial/Input/tgw1_6.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW correction to the direct band gap in Gamma</span>
<span class="c1"># Dataset 1: ground state calculation </span>
<span class="c1"># Dataset 2: calculation of the WFK file </span>
<span class="c1"># Dataset 3: calculation of the screening (epsilon^-1 matrix for W)</span>
<span class="c1"># Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)</span>

ndtset      <span class="m">4</span>

ngkpt    <span class="m">2</span> <span class="m">2</span> <span class="m">2</span>         <span class="c1"># Density of k points used for the automatic tests of the tutorial</span>
<span class="c1">#ngkpt    4 4 4        # Density of k points needed for a converged calculation</span>

nshiftk  <span class="m">4</span>
shiftk   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># This grid contains the Gamma point, which is the point at which</span>
         <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.5  <span class="c1"># we will compute the (direct) band gap. There are 19 k points</span>
         <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.5  <span class="c1"># in the irreducible Brillouin zone, if ngkpt 4 4 4 is used.</span>
         <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.0
istwfk  *1            <span class="c1"># For the GW computations, do not take advantage of the </span>
                      <span class="c1"># specificities of k points to reduce the number of components of the</span>
                      <span class="c1"># wavefunction.</span>

<span class="c1"># Dataset1: usual self-consistent ground-state calculation</span>
<span class="c1"># Definition of the k-point grid</span>
nband1  <span class="m">6</span>
tolvrs1 1e-10

<span class="c1"># Dataset2: calculation of WFK file</span>
<span class="c1"># Definition of k-points</span>
iscf2    -2             <span class="c1"># Non self-consistent calculation</span>
getden2  -1             <span class="c1"># Read previous density file</span>
nband2   <span class="m">120</span>
nbdbuf2   <span class="m">20</span>
tolwfr2  <span class="m">1</span>.0d-12   

<span class="c1"># Dataset3: Calculation of the screening (epsilon^-1 matrix)</span>
optdriver3   <span class="m">3</span>       <span class="c1"># Screening calculation</span>
getwfk3     -1       <span class="c1"># Obtain WFK file from previous dataset</span>
nband3      <span class="m">50</span>       <span class="c1"># Bands to be used in the screening calculation</span>
ecuteps3    <span class="m">6</span>.0      <span class="c1"># Dimension of the screening matrix</span>
ppmfrq3    <span class="m">16</span>.7 eV   <span class="c1"># Imaginary frequency where to calculate the screening</span>
                     <span class="c1"># It is easier (and safer) to let ABINIT compute and use the Drude plasma frequency, </span>
                     <span class="c1"># instead of selecting a value by hand. This would be done thanks to the default value ppmfrq 0.0 .</span>

<span class="c1"># Dataset4: Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver4  <span class="m">4</span>        <span class="c1"># Self-Energy calculation</span>
getwfk4     -2       <span class="c1"># Obtain WFK file from dataset 1</span>
getscr4     -1       <span class="c1"># Obtain SCR file from previous dataset</span>
nband4      <span class="m">100</span>      <span class="c1"># Bands to be used in the Self-Energy calculation</span>
ecutsigx4    <span class="m">8</span>.0     <span class="c1"># Dimension of the G sum in Sigma_x</span>

nkptgw4      <span class="m">1</span>               <span class="c1"># number of k-point where to calculate the GW correction</span>
kptgw4                       <span class="c1"># k-points</span>
  <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="c1"># (Gamma)</span>
bdgw4       <span class="m">4</span>  <span class="m">5</span>             <span class="c1"># calculate GW corrections for bands from 4 to 5</span>

<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.26         <span class="c1"># Experimental lattice constants</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5   
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the </span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s) </span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>

<span class="c1"># Definition of the SCF procedure</span>
nstep   <span class="m">10</span>        <span class="c1"># Maximal number of SCF cycles</span>
diemac  <span class="m">12</span>.0      <span class="c1"># Although this is not mandatory, it is worth to</span>
                  <span class="c1"># precondition the SCF cycle. The model dielectric</span>
                  <span class="c1"># function used as the standard preconditioner</span>
                  <span class="c1"># is described in the &quot;dielng&quot; input variable section.</span>
                  <span class="c1"># Here, we follow the prescription for bulk silicon.</span>




 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pbe_standard_psp8/Si.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_6.abo, tolnlines= 70, tolabs=  7.000e-02, tolrel=  3.000e-02, fld_options= -ridiculous</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Olevano, F. Bruneval, M. Giantomassi</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline silicon</span>
<span class="c1">#%%   Calculation of the GW correction to the direct band gap in Gamma</span>
<span class="c1">#%%   Dataset 1: ground state calculation </span>
<span class="c1">#%%   Dataset 2: calculation of the WFK file </span>
<span class="c1">#%%   Dataset 3: calculation of the screening (epsilon^-1 matrix for W)</span>
<span class="c1">#%%   Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-60311ed2-e231-40f0-bd05-f29c9ab3b905", "#uuid-d116413e-678a-496e-848e-6774347e87ed") }); </script>

<p>We need the usual part of the input file to perform a ground state
calculation. This is done in datasets 1 and 2. At the end of dataset 2, we print out the density and wavefunction files.
We use a set of 19 <strong>k</strong>-points in the Irreducible Brillouin Zone.
This set of <strong>k</strong>-points is not shifted so it contains the <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> point.</p>
<p>In dataset 3 we calculate the screening. The screening calculation is very
time-consuming. So, we have decided to decrease a bit the parameters found in
the previous convergence studies. Indeed, <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> has been decreased from
100 to 50. The CPU time of this part is linear with
respect to this parameter (or more exactly, with the number of conduction
bands). Thus, the CPU time has been decreased by a factor of 2. Referring to
our previous convergence study, we see that the absolute accuracy on the GW
energies is now on the order of 0.2 eV only. This would be annoying for the absolute positioning of the band energy
as required for band-offset or ionization potential of finite systems.
However, as long as we are only interested in the gap energy that is fine enough.</p>
<p>Finally, in dataset 4, we calculate the self-energy matrix element at <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>, using
the previously determined parameters.</p>
<p>You should obtain the following results:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span> <span class="kt">!SelfEnergy_ee</span>
<span class="nt">iteration_state</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">dtset</span><span class="p">:</span> <span class="nv">4</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">}</span>
<span class="nt">kpoint     </span><span class="p">:</span> <span class="p p-Indicator">[</span>   <span class="nv">0.000</span><span class="p p-Indicator">,</span>    <span class="nv">0.000</span><span class="p p-Indicator">,</span>    <span class="nv">0.000</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">]</span>
<span class="nt">spin       </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">KS_gap     </span><span class="p">:</span>    <span class="l l-Scalar l-Scalar-Plain">2.564</span>
<span class="nt">QP_gap     </span><span class="p">:</span>    <span class="l l-Scalar l-Scalar-Plain">3.196</span>
<span class="nt">Delta_QP_KS</span><span class="p">:</span>    <span class="l l-Scalar l-Scalar-Plain">0.632</span>
<span class="nt">data</span><span class="p">:</span> <span class="kt">!SigmaeeData</span> <span class="p p-Indicator">|</span>
     <span class="no">Band     E0 &lt;VxcDFT&gt;   SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E</span>
        <span class="no">2   4.369 -11.316 -12.769   0.817   0.765  -0.308 -11.803  -0.487   3.882</span>
        <span class="no">3   4.369 -11.316 -12.769   0.817   0.765  -0.308 -11.803  -0.487   3.882</span>
        <span class="no">4   4.369 -11.316 -12.769   0.817   0.765  -0.308 -11.803  -0.487   3.882</span>
        <span class="no">5   6.933 -10.039  -5.840  -4.010   0.765  -0.307  -9.894   0.144   7.078</span>
        <span class="no">6   6.933 -10.039  -5.840  -4.010   0.765  -0.307  -9.894   0.144   7.078</span>
        <span class="no">7   6.933 -10.039  -5.840  -4.010   0.765  -0.307  -9.894   0.144   7.078</span>
<span class="nn">...</span>
</code></pre></div>
<p>So that the DFT energy gap in <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> is about 2.564 eV, while the GW correction is
about 0.632 eV, so that the GW band gap found is 3.196 eV.</p>
<p>One can compare now what have been obtained to what one can get from the literature.</p>
<div class="highlight"><pre><span></span><code>     EXP         3.40 eV   Landolt-Boernstein

     DFT (LDA)
     LDA         2.57 eV   L. Hedin, Phys. Rev. 139, A796 (1965)
     LDA         2.57 eV   M.S. Hybertsen and S. Louie, PRL 55, 1418 (1985)
     LDA (FLAPW) 2.55 eV   N. Hamada, M. Hwang and A.J. Freeman, PRB 41, 3620 (1990)
     LDA (PAW)   2.53 eV   B. Arnaud and M. Alouani, PRB 62, 4464 (2000)
     LDA         2.53 eV   present work

     GW          3.27 eV   M.S. Hybertsen and S. Louie, PRL 55, 1418 (1985)
     GW          3.35 eV   M.S. Hybertsen and S. Louie, PRB 34, 5390 (1986)
     GW          3.30 eV   R.W. Godby, M. Schlueter, L.J. Sham, PRB 37, 10159 (1988)
     GW  (FLAPW) 3.30 eV   N. Hamada, M. Hwang and A.J. Freeman, PRB 41, 3620 (1990)
     GW  (FLAPW) 3.12 eV   W. Ku and A.G. Eguiluz, PRL 89, 126401 (2002)
     GW          3.20 eV   present work
</code></pre></div>
<p>The values are spread over an interval of 0.2 eV. They depend on the details
of the calculations. In the case of pseudopotential calculations, they depend
of course on the pseudopotential used. However, a GW result is hardly
more accurate than 0.1 eV, in the present state of the art. But this goes also
with the other source of inaccuracy, the choice of the pseudopotential, that
can arrive up to even 0.2 eV. This can also be taken into account when
choosing the level of accuracy for the convergence parameters in the GW calculation.
As a reasonable target, the numerical sources of errors, due to insufficient <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, k point grid,
should be kept lower than 0.02 or 0.03 eV.</p>
<h2 id="7-how-to-compute-gw-band-structures">7 How to compute GW band structures<a class="headerlink" href="#7-how-to-compute-gw-band-structures" title="Permanent link">&para;</a></h2>
<p>Finally, it is possible to calculate a full GW band plot of a system via interpolation.
There are three possible techniques.</p>
<p>The first one is based on the use of Wannier functions to interpolate a few selected points
in the IBZ obtained using the direct GW approach <a class="wikilink citation-wikilink" data-tippy-content="Maximally localized Wannier functions for GW quasiparticles" data-toggle="popover" href="/theory/bibliography#hamann2009">[Hamann2009]</a>.
You need to have the Wannier90 plug-in installed.
See the directory tests/wannier90, test case 03, for an example of a file where a GW calculation
is followed by the use of Wannier90.</p>
<div class="text-center"><button id="uuid-e80c3bac-37c9-4290-bab8-5f9e9fc7240e" class="md-button md-button--secondary"> View tests/wannier90/Input/t03.abi </button></div>
<div id="uuid-982ee8c6-359f-4842-acd5-88872c4c2053" class="my_dialog" title="tests/wannier90/Input/t03.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Self-consistent GW test including wannier90 interface for GW quasiparticles</span>
<span class="c1">#  This test is poorly converged (see GW and wannier90 tutorials).</span>

<span class="c1"># Silicon structure</span>
     acell     <span class="m">10</span>.263  <span class="m">10</span>.263  <span class="m">10</span>.263
     rprim      <span class="m">0</span>.00   <span class="m">0</span>.50   <span class="m">0</span>.50
                <span class="m">0</span>.50   <span class="m">0</span>.00   <span class="m">0</span>.50
                <span class="m">0</span>.50   <span class="m">0</span>.50   <span class="m">0</span>.00
     natom      <span class="m">2</span>
      xred      <span class="m">0</span>.00   <span class="m">0</span>.00   <span class="m">0</span>.00
                <span class="m">0</span>.25   <span class="m">0</span>.25   <span class="m">0</span>.25
    ntypat      <span class="m">1</span>
     typat      <span class="m">1</span>      <span class="m">1</span>
     znucl     <span class="m">14</span>.00
 symmorphi      <span class="m">0</span>
 symsigma       <span class="m">0</span>

<span class="c1"># Parameters common to all runs</span>
      ecut      <span class="m">6</span>.00
  ecutsigx      <span class="m">5</span>.00000000
   ecuteps      <span class="m">1</span>.49923969
    istwfk      <span class="m">8</span>*1
     ngkpt      <span class="m">4</span>      <span class="m">4</span>      <span class="m">4</span>
     nstep    <span class="m">100</span>
   nshiftk      <span class="m">1</span>
    shiftk      <span class="m">0</span>.00   <span class="m">0</span>.00   <span class="m">0</span>.00
    enunit      <span class="m">2</span>
 gw_icutcoul      <span class="m">6</span> <span class="c1"># To preserve the results of older tests: current default gw_icutcoul=3</span>

    ndtset      <span class="m">7</span>
    gwpara      <span class="m">1</span>

<span class="c1"># Self-consistent run to get the density</span>
    toldfe1     <span class="m">1</span>.00d-6

<span class="c1"># Non-self-consistent run to get all cg wavefunctions</span>
    getden2     <span class="m">1</span>
    getwfk2     <span class="m">1</span>
      iscf2     -2
    tolwfr2     <span class="m">1</span>.0d-10
     nband2     <span class="m">30</span>

<span class="c1"># Calculation of the dielectric matrix - iteration 1</span>
 optdriver3     <span class="m">3</span>
 gwcalctyp3    <span class="m">28</span>
    getwfk3     <span class="m">2</span>

     nband3    <span class="m">10</span>
    ecutwfn3    <span class="m">5</span>.00    <span class="c1"># Increased value to stabilize the test</span>
      awtr3     <span class="m">0</span>       <span class="c1"># Note : the default awtr 1 is better</span>

<span class="c1"># Calculation of the model GW corrections - iteration 1</span>
 optdriver4     <span class="m">4</span>
 gwcalctyp4    <span class="m">28</span>
    getwfk4     <span class="m">2</span>
    getscr4     <span class="m">3</span>
     nband4    <span class="m">10</span>
   ecutwfn4     <span class="m">5</span>.00    <span class="c1"># Increased value to stabilize the test</span>
 gw_icutcoul4     <span class="m">3</span>     <span class="c1"># old deprecated value of icutcoul, only used for legacy</span>


<span class="c1"># Calculation of the dielectric matrix - iteration 2</span>
 optdriver5     <span class="m">3</span>
 gwcalctyp5    <span class="m">28</span>
    getwfk5     <span class="m">2</span>
    getqps5     <span class="m">4</span>

     nband5    <span class="m">10</span>
   ecutwfn5     <span class="m">5</span>.00      <span class="c1"># Increased value to stabilize the test</span>
      awtr5       <span class="m">0</span>       <span class="c1"># Note : the default awtr 1 is better</span>

<span class="c1"># Calculation of the model GW corrections - iteration 2</span>

 optdriver6     <span class="m">4</span>
 gwcalctyp6    <span class="m">28</span>
    getwfk6     <span class="m">2</span>
    getqps6     <span class="m">4</span>
    getscr6     <span class="m">5</span>
     nband6    <span class="m">10</span>
   ecutwfn6     <span class="m">5</span>.00  <span class="c1"># Increased value to stabilize the test</span>
 gw_icutcoul6     <span class="m">3</span>   <span class="c1"># old deprecated value of icutcoul, only used for legacy</span>

<span class="c1"># Calculation of the quasiparticle Wannier functions</span>

    getden7     <span class="m">1</span>
    getwfk7     <span class="m">2</span>   <span class="c1"># Must point to lda wavefunction file completely</span>
                    <span class="c1">#  consistent with _WFK file generated for GW</span>
    getqps7     <span class="m">6</span>
    kptopt7     <span class="m">3</span>   <span class="c1"># Must use full-zone k mesh for wannier90</span>
    istwfk7     <span class="m">64</span>*1
      iscf7     -2
     nstep7     <span class="m">0</span>   <span class="c1"># Irreducible-zone wavefunctions will be transformed</span>
                    <span class="c1">#  using symmetry operations to fill the full zone,</span>
                    <span class="c1">#  and must not be modified (for consistency with GW)</span>

    tolwfr7     <span class="m">1</span>.0d-10   <span class="c1"># Dummy, but necessary</span>
     nband7     <span class="m">10</span>  <span class="c1"># Must be consistent with nband in quasiparticle GW above</span>

   prtwant7     <span class="m">3</span>   <span class="c1"># Flag for wannier90 interface with quaisparticles</span>

 w90iniprj7     <span class="m">2</span>   <span class="c1"># Flag to use hydrogenic or gaussian orbital initial</span>
                    <span class="c1">#  projectors (to be specified in *.win file)</span>

 w90prtunk7     <span class="m">0</span>   <span class="c1"># Flag for producing UNK files necessary for plotting</span>
                    <span class="c1">#  (suppressed here by 0 value)</span>


<span class="c1">#Common to all model GW calculations</span>
   rhoqpmix     <span class="m">0</span>.5
     nkptgw     <span class="m">8</span>
      kptgw
              <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
              <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
              <span class="m">5</span>.00000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
              <span class="m">2</span>.50000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00
              <span class="m">5</span>.00000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00
             -2.50000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00
              <span class="m">5</span>.00000000E-01  <span class="m">5</span>.00000000E-01  <span class="m">0</span>.00000000E+00
             -2.50000000E-01  <span class="m">5</span>.00000000E-01  <span class="m">2</span>.50000000E-01
       bdgw
              <span class="m">1</span> <span class="m">8</span>   <span class="c1"># Only bands 1-8 are quasiparticle.  LDA will be used for</span>
                    <span class="c1">#  bands 9 and 10 in the wannier90 calculation.</span>
              <span class="m">1</span> <span class="m">8</span>
              <span class="m">1</span> <span class="m">8</span>
              <span class="m">1</span> <span class="m">8</span>
              <span class="m">1</span> <span class="m">8</span>
              <span class="m">1</span> <span class="m">8</span>
              <span class="m">1</span> <span class="m">8</span>
              <span class="m">1</span> <span class="m">8</span>


 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;PseudosTM_pwteter/14si.pspnc&quot;</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   t03.abo, tolnlines = 30, tolabs = 7.0e-03, tolrel = 1.05e-00</span>
<span class="c1">#%% extra_inputs = t03o_DS7_w90.win</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   Cannot be executed in parallel (mlwfovl_qp)</span>
<span class="c1">#%%   Si fcc, in primitive cell (2 atoms/cell)</span>
<span class="c1">#%%   Test of self-consistent model GW (2 iterations) following Faleev et al.,</span>
<span class="c1">#%%   [PRL 93, 126406 (2004)] followed by construction of quasiparticle</span>
<span class="c1">#%%   maximally-localized wannier functions [Hamann &amp; Vanderbilt,</span>
<span class="c1">#%%   arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-</span>
<span class="c1">#%%   acceptable speed, and the results are poorly converged.  The input</span>
<span class="c1">#%%   file is sufficiently annotated to serve as a model.  Note that well-</span>
<span class="c1">#%%   converged GW calculations are extremely time consuming, and in general</span>
<span class="c1">#%%   it is advisable to run the SCGW part separately on a parallel system,</span>
<span class="c1">#%%   and then run a separate serial job modeled on the last dataset,</span>
<span class="c1">#%%   substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with</span>
<span class="c1">#%%   appropriate links to the files produced in the serial run.  Note that</span>
<span class="c1">#%%   the _DEN file from the first dataset is also needed as input, although</span>
<span class="c1">#%%   the discontinued &quot;irdden&quot; input variable is not needed or supported.</span>
<span class="c1">#%%   Note that acceptable names for the secondary input file needed by the</span>
<span class="c1">#%%   wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset</span>
<span class="c1">#%%   &gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files</span>
<span class="c1">#%%   file and n is the wannier dataset.</span>
<span class="c1">#%% topics = Wannier</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-982ee8c6-359f-4842-acd5-88872c4c2053", "#uuid-e80c3bac-37c9-4290-bab8-5f9e9fc7240e") }); </script>

<p>The wannier interpolation is a very accurate method, can handle band crossings
but it may require additional work to obtain well localized wannier functions.
Another practical way follows from the
fact that the QP energies, similarly to the KS eigenvalues,
must fulfill the symmetry properties:</p>
<div>
<div class="MathJax_Preview">
\ee(\kpG) = \ee(\kk)
</div>
<script type="math/tex; mode=display">
\ee(\kpG) = \ee(\kk)
</script>
</div>
<p>and</p>
<div>
<div class="MathJax_Preview">
\ee(S\kk) = \ee(\kk)
</div>
<script type="math/tex; mode=display">
\ee(S\kk) = \ee(\kk)
</script>
</div>
<p>where <span><span class="MathJax_Preview">\GG</span><script type="math/tex">\GG</script></span> is a reciprocal lattice vector and <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> is a rotation of the point group of the crystal.
Therefore it&rsquo;s possible to employ the star-function interpolation by Shankland, Koelling and Wood
<a class="wikilink citation-wikilink" data-tippy-content="Crystalline Interpolation with Applications to Brillouin-Zone Averages and Energy-Band Interpolation" data-toggle="popover" href="/theory/bibliography#euwema1969">[Euwema1969]</a>, <a class="wikilink citation-wikilink" data-tippy-content="On the interpolation of eigenvalues and a resultant integration scheme" data-toggle="popover" href="/theory/bibliography#koelling1986">[Koelling1986]</a>
in the improved version proposed by <a class="wikilink citation-wikilink" data-tippy-content="Smooth Fourier interpolation of periodic functions" data-toggle="popover" href="/theory/bibliography#pickett1988">[Pickett1988]</a> to fit the ab-initio results.
This interpolation technique, by construction, passes through the initial points and satisfies
the basic symmetry property of the band energies.
It should be stressed, however, that this Fourier-based method can have problems in the presence of band crossings
that may cause unphysical oscillations between the ab-initio points.
To reduce this spurious effect, we suggest to interpolate the GW corrections instead of the GW energies.
The corrections, indeed, are usually smoother in k-space and the resulting fit is more stable.
A python example showing how to construct an interpolated scissor operator with AbiPy is available
<a href="http://abinit.github.io/abipy/gallery/plot_qpbands_with_interpolation.html#sphx-glr-gallery-plot-qpbands-with-interpolation-py">here</a></p>
<p>The third method uses the fact that the GW corrections are usually linear with the energy,
for each group of bands. This is evident when reporting on a plot the GW correction with
respect to the 0-order KS energy for each state.
One can then simply correct the KS band structure at any point, by using a GW correction for the
<strong>k</strong>-points where it has not been calculated explicitly, using a fit of the GW
correction at a sparse set of points.
A python example showing how to construct an energy-dependent scissor operator with AbiPy is available
<a href="http://abinit.github.io/abipy/gallery/plot_qpbands_with_scissor.html#sphx-glr-gallery-plot-qpbands-with-scissor-py">here</a>.</p>
<h2 id="8-advanced-features-of-gw-calculations">8 Advanced features of GW calculations<a class="headerlink" href="#8-advanced-features-of-gw-calculations" title="Permanent link">&para;</a></h2>
<p>The user might switch to the <a href="/tutorial/gw2">second GW tutorial</a> before
coming back to the present section.</p>
<h3 id="calculations-without-using-the-plasmon-pole-model">Calculations without using the Plasmon-Pole model<a class="headerlink" href="#calculations-without-using-the-plasmon-pole-model" title="Permanent link">&para;</a></h3>
<p>In order to circumvent the plasmon-pole model, the GW frequency convolution
has to be calculated explicitly along the real axis. This is a tough job,
since G and W have poles along the real axis. Therefore it is more convenient
to use another path of integration along the imaginary axis plus the residues
enclosed in the path.</p>
<p>Consequently, it is better to evaluate the screening for imaginary frequencies
(to perform the integration) and also for real frequencies (to evaluate the
contributions of the residues that may enter into the path of integration).
The number of imaginary frequencies is set by the input variable <a class="wikilink codevar-wikilink" href="/variables/gw#nfreqim">nfreqim</a>.
The regular grid of real frequencies is determined by the input variables
<a class="wikilink codevar-wikilink" href="/variables/gw#nfreqre">nfreqre</a>, which sets the number of real frequencies, and <a class="wikilink codevar-wikilink" href="/variables/gw#freqremax">freqremax</a>,
which indicates the maximum real frequency used.</p>
<p>The method is particularly suited to output the spectral function (contained
in file out.sig). The grid of real frequencies used to calculate the spectral
function is set by the number of frequencies (input variable <a class="wikilink codevar-wikilink" href="/variables/gw#nfreqsp">nfreqsp</a>) and
by the maximum frequency calculated (input variable <a class="wikilink codevar-wikilink" href="/variables/gw#freqspmax">freqspmax</a>).</p>
<h3 id="self-consistent-calculations">Self-consistent calculations<a class="headerlink" href="#self-consistent-calculations" title="Permanent link">&para;</a></h3>
<p>The details in the implementation and the justification for the approximations
retained can be found in <a class="wikilink citation-wikilink" data-tippy-content="Effect of self-consistency on quasiparticles in solids" data-toggle="popover" href="/theory/bibliography#bruneval2006">[Bruneval2006]</a>.
The only added input variables are <a class="wikilink codevar-wikilink" href="/variables/files#getqps">getqps</a> and <a class="wikilink codevar-wikilink" href="/variables/files#irdqps">irdqps</a>. These variables
concerns the reading of the _QPS file, that contains the eigenvalues and the
unitary transform matrices of a previous quasiparticle calculation. QPS stands
for &ldquo;QuasiParticle Structure&rdquo;.</p>
<p>The only modified input variables for self-consistent calculations are
<a class="wikilink codevar-wikilink" href="/variables/gw#gwcalctyp">gwcalctyp</a> and <a class="wikilink codevar-wikilink" href="/variables/gw#bdgw">bdgw</a>.
When the variable <a class="wikilink codevar-wikilink" href="/variables/gw#gwcalctyp">gwcalctyp</a> is in between 0 and 9, The code calculates the
quasiparticle energies only and does not output any QPS file (as in a standard GW run).
When the variable <a class="wikilink codevar-wikilink" href="/variables/gw#gwcalctyp">gwcalctyp</a> is in between 10 and 19, the code calculates
the quasiparticle energies only and outputs them in a QPS file.
When the variable <a class="wikilink codevar-wikilink" href="/variables/gw#gwcalctyp">gwcalctyp</a> is in between 20 and 29, the code calculates
the quasiparticle energies and wavefunctions and outputs them in a QPS file.</p>
<p>For a full self-consistency calculation, the quasiparticle wavefunctions are
expanded in the basis set of the KS wavefunctions. The variable
<a class="wikilink codevar-wikilink" href="/variables/gw#bdgw">bdgw</a> now indicates the size of all matrices to be calculated and
diagonalized. The quasiparticle wavefunctions are consequently linear
combinations of the KS wavefunctions in between the min and max values of <a class="wikilink codevar-wikilink" href="/variables/gw#bdgw">bdgw</a>.</p>
<p>A correct self-consistent calculation should consist of the following runs:</p>
<ul>
<li>1) Self-consistent KS calculation: outputs a WFK file</li>
<li>2) Screening calculation (with KS inputs): outputs a SCR file</li>
<li>3) Sigma calculation (with KS inputs): outputs a QPS file</li>
<li>4) Screening calculation (with the WFK, and QPS file as an input): outputs a new SCR file</li>
<li>5) Sigma calculation (with the WFK, QPS and the new SCR files): outputs a new QPS file</li>
<li>6) Screening calculation (with the WFK, the new QPS file): outputs a newer SCR file</li>
<li>7) Sigma calculation (with the WFK, the newer QPS and SCR files): outputs a newer QPS</li>
<li>............ and so on, until the desired accuracy is reached</li>
</ul>
<p>Note that for Hartree-Fock calculations a dummy screening is required for
initialization reasons. Therefore, a correct HF calculations should look like</p>
<ul>
<li>1) Self-consistent KS calculation: outputs a WFK file</li>
<li>2) Screening calculation using very low convergence parameters (with KS inputs): output a <strong>dummy</strong> SCR file</li>
<li>3) Sigma calculation (with KS inputs): outputs a QPS file</li>
<li>4) Sigma calculation (with the WFK and QPS files): outputs a new QPS file</li>
<li>5) Sigma calculation (with the WFK and the new QPS file): outputs a newer QPS file</li>
<li>............ and so on, until the desired accuracy is reached</li>
</ul>
<p>In the case of a self-consistent calculation, the output is slightly more complex:
<strong>For instance, at iteration 2</strong></p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span> <span class="kt">!SelfEnergy_ee</span>
<span class="nt">iteration_state</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">dtset</span><span class="p">:</span> <span class="nv">3</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">}</span>
<span class="nt">kpoint     </span><span class="p">:</span> <span class="p p-Indicator">[</span>   <span class="nv">0.500</span><span class="p p-Indicator">,</span>    <span class="nv">0.250</span><span class="p p-Indicator">,</span>    <span class="nv">0.000</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">]</span>
<span class="nt">spin       </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">KS_gap     </span><span class="p">:</span>    <span class="l l-Scalar l-Scalar-Plain">3.684</span>
<span class="nt">QP_gap     </span><span class="p">:</span>    <span class="l l-Scalar l-Scalar-Plain">5.764</span>
<span class="nt">Delta_QP_KS</span><span class="p">:</span>    <span class="l l-Scalar l-Scalar-Plain">2.080</span>
<span class="nt">data</span><span class="p">:</span> <span class="kt">!SigmaeeData</span> <span class="p p-Indicator">|</span>
     <span class="no">Band     E_DFT   &lt;VxcDFT&gt;   E(N-1)  &lt;Hhartree&gt;   SigX  SigC[E(N-1)]    Z     dSigC/dE  Sig[E(N)]  DeltaE  E(N)_pert E(N)_diago</span>
        <span class="no">1    -3.422   -10.273    -3.761     6.847   -15.232     4.034     1.000     0.000   -11.198    -0.590    -4.351    -4.351</span>
        <span class="no">2    -0.574   -10.245    -0.850     9.666   -13.806     2.998     1.000     0.000   -10.807    -0.291    -1.141    -1.141</span>
        <span class="no">3     2.242    -9.606     2.513    11.841   -11.452     1.931     1.000     0.000    -9.521    -0.193     2.320     2.320</span>
        <span class="no">4     3.595   -10.267     4.151    13.866   -11.775     1.842     1.000     0.000    -9.933    -0.217     3.934     3.934</span>
        <span class="no">5     7.279    -8.804     9.916    16.078    -4.452    -1.592     1.000     0.000    -6.044     0.119    10.034    10.035</span>
        <span class="no">6    10.247    -9.143    13.462    19.395    -4.063    -1.775     1.000     0.000    -5.838     0.095    13.557    13.557</span>
        <span class="no">7    11.488    -9.704    15.159    21.197    -4.061    -1.863     1.000     0.000    -5.924     0.113    15.273    15.273</span>
        <span class="no">8    11.780    -9.180    15.225    20.958    -3.705    -1.893     1.000     0.000    -5.598     0.135    15.360    15.360</span>
<span class="nn">...</span>
</code></pre></div>
<p>The columns are</p>
<ul>
<li><strong>Band</strong>: Index of the band</li>
<li><strong>E_DFT</strong>: DFT eigenvalue</li>
<li><strong>VxcDFT</strong>: Diagonal expectation value of the xc potential in between DFT bra and ket</li>
<li><strong>E(N-1)</strong>: Quasiparticle energy of the previous iteration (equal to DFT for the first iteration)</li>
<li><strong>Hhartree</strong>: Diagonal expectation value of the Hartree Hamiltonian (equal to E_DFT - VxcDFT for the first iteration only)</li>
<li><strong>SigX</strong>: Diagonal expectation value of the exchange self-energy</li>
<li><strong>SigC[E(N-1)]</strong>: Diagonal expectation value of the correlation self-energy
    (evaluated for the energy of the preceeding iteration)</li>
<li><strong>Z</strong>: Quasiparticle renormalization factor Z (taken equal to 1 in methods HF, SEX, COHSEX and model GW)</li>
<li><strong>dSigC/dE</strong>: Derivative of the correlation self-energy with respect to the energy</li>
<li><strong>Sig[E(N)]</strong>: Total self-energy for the new quasiparticle energy</li>
<li><strong>DeltaE</strong>: Energy difference with respect to the previous step</li>
<li><strong>E(N)_pert</strong>: QP energy as obtained by the usual perturbative method</li>
<li><strong>E(N)_diago</strong>: QP energy as obtained by the full diagonalization</li>
</ul>
                
                  
                
              

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/"
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../positron/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              positron
            </div>
          </div>
        </a>
      
      
        <a href="../gw2/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              GW2
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version b'10.2.3-dirty'</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
            (VOlevano, FBruneval, MG, XG)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "b'10.2.3-dirty'"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>