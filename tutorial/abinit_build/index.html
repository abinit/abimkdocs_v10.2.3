
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/abinit_build/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>ABINIT_build - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-to-build-abinit-using-the-autotools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ABINIT_build
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../variables/" class="md-tabs__link">
        Variables
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        Abitk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_15" type="checkbox" id="__nav_1_15" >
      
      <label class="md-nav__link" for="__nav_1_15">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_15">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        AtomCentered
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        CalcUJ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        GWR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        Install
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        NMR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ABINIT_build
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        ABINIT_build
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting started
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compile-blas-and-lapack" class="md-nav__link">
    How to compile BLAS and LAPACK
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compile-libxc" class="md-nav__link">
    How to compile libxc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compiling-and-installing-fftw" class="md-nav__link">
    Compiling and installing FFTW
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-mpi" class="md-nav__link">
    Installing MPI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-hdf5-and-netcdf4" class="md-nav__link">
    Installing HDF5 and netcdf4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compile-abinit" class="md-nav__link">
    How to compile ABINIT
  </a>
  
    <nav class="md-nav" aria-label="How to compile ABINIT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-libraries-and-ldd" class="md-nav__link">
    Dynamic libraries and ldd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compile-abinit-on-a-cluster-with-the-intel-toolchain-and-modules" class="md-nav__link">
    How to compile ABINIT on a cluster with the intel toolchain and modules
  </a>
  
    <nav class="md-nav" aria-label="How to compile ABINIT on a cluster with the intel toolchain and modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-compile-libxc-netcdf4hdf5-with-intel" class="md-nav__link">
    How to compile libxc, netcdf4/hdf5 with intel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compile-abinit-with-support-for-openmp-threads" class="md-nav__link">
    How to compile ABINIT with support for OpenMP threads
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basepar/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_crpa/" class="md-nav__link">
        cRPA U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lruj/" class="md-nav__link">
        Linear Response U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gwr_intro/" class="md-nav__link">
        GWR_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gwr1/" class="md-nav__link">
        GWR1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lw_quad/" class="md-nav__link">
        quadrupoles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph_tdep_legacy/" class="md-nav__link">
        eph_tdep_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        Troubleshooting (old-dokuwiki)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        Tuning (old-dokuwiki)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting started
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compile-blas-and-lapack" class="md-nav__link">
    How to compile BLAS and LAPACK
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compile-libxc" class="md-nav__link">
    How to compile libxc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compiling-and-installing-fftw" class="md-nav__link">
    Compiling and installing FFTW
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-mpi" class="md-nav__link">
    Installing MPI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-hdf5-and-netcdf4" class="md-nav__link">
    Installing HDF5 and netcdf4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compile-abinit" class="md-nav__link">
    How to compile ABINIT
  </a>
  
    <nav class="md-nav" aria-label="How to compile ABINIT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-libraries-and-ldd" class="md-nav__link">
    Dynamic libraries and ldd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compile-abinit-on-a-cluster-with-the-intel-toolchain-and-modules" class="md-nav__link">
    How to compile ABINIT on a cluster with the intel toolchain and modules
  </a>
  
    <nav class="md-nav" aria-label="How to compile ABINIT on a cluster with the intel toolchain and modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-compile-libxc-netcdf4hdf5-with-intel" class="md-nav__link">
    How to compile libxc, netcdf4/hdf5 with intel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-compile-abinit-with-support-for-openmp-threads" class="md-nav__link">
    How to compile ABINIT with support for OpenMP threads
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/abinit_build.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="how-to-build-abinit-using-the-autotools">How to build ABINIT using the Autotools<a class="headerlink" href="#how-to-build-abinit-using-the-autotools" title="Permanent link">&para;</a></h1>
<p>This tutorial explains how to build ABINIT including the external dependencies
without relying on pre-compiled libraries, package managers and root privileges.
You will learn how to use the standard <strong>configure</strong> and <strong>make</strong> Linux tools
to build and install your own software stack including the MPI library and the associated
<em>mpif90</em> and <em>mpicc</em> wrappers required to compile MPI applications.</p>
<p>It is assumed that you already have a standard Unix-like installation
that provides the basic tools needed to build software from source (Fortran/C compilers and <em>make</em>).
The changes required for macOS are briefly mentioned when needed.
Windows users should install <a href="https://cygwin.com/index.html">cygwin</a> that
provides a POSIX-compatible environment
or, alternatively, use a <a href="https://docs.microsoft.com/en-us/windows/wsl/about">Windows Subsystem for Linux</a>.
Note that the procedure described in this tutorial has been tested with Linux/macOS hence
feedback and suggestions from Windows users are welcome.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In the last part of the tutorial, we discuss more advanced topics such as using <strong>modules</strong> in supercomputing centers,
compiling and linking with the <strong>intel compilers</strong> and the <strong>MKL library</strong> as well as <strong>OpenMP threads</strong>.
You may want to jump directly to this section if you are already familiar with software compilation.</p>
</div>
<p>In the following, we will make extensive use of the bash shell hence familiarity with the terminal is assumed.
For a quick introduction to the command line, please consult
this <a href="https://ubuntu.com/tutorials/command-line-for-beginners#1-overview">Ubuntu tutorial</a>.
If this is the first time you use the <strong>configure &amp;&amp; make</strong> approach to build software,
we <strong>strongly</strong> recommend to read this
<a href="https://www.codecoffee.com/software-installation-configure-make-install/">guide</a>
before proceeding with the next steps.</p>
<p>If, on the other hand, you are <strong>not interested in compiling all the components from source</strong>,
you may want to consider the following alternatives:</p>
<ul>
<li>
<p>Compilation with external libraries provided by apt-based Linux distributions (e.g. <strong>Ubuntu</strong>).
  More info available <a href="/INSTALL_Ubuntu">here</a>.</p>
</li>
<li>
<p>Compilation with external libraries on <strong>Fedora/RHEL/CentOS</strong> Linux distributions.
  More info available <a href="/INSTALL_CentOS">here</a>.</p>
</li>
<li>
<p>Homebrew bottles or macports for <strong>macOS</strong>.
  More info available <a href="/INSTALL_MacOS">here</a>.</p>
</li>
<li>
<p>Automatic compilation and generation of modules on clusters with <strong>EasyBuild</strong>.
  More info available <a href="/INSTALL_EasyBuild">here</a>.</p>
</li>
<li>
<p>Compiling Abinit using the <strong>internal fallbacks</strong> and the <em>build-abinit-fallbacks.sh</em> script
  automatically generated by <em>configure</em> if the mandatory dependencies are not found.</p>
</li>
<li>
<p>Using precompiled binaries provided by conda-forge (for Linux and macOS users).</p>
</li>
</ul>
<p>Before starting, it is also worth reading this document prepared by Marc Torrent
that introduces important concepts and provides a detailed description of the configuration options
supported by the ABINIT build system.
Note that these slides have been written for Abinit v8 hence some examples should be changed in order
to be compatible with the build system of version 9, yet the document represents a valuable source of information.</p>
<p><embed src="https://school2019.abinit.org/images/lectures/abischool2019_installing_abinit_lecture.pdf"
type="application/pdf" width="100%" height="480px"></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The aim of this tutorial is to teach you how to compile code from source but we cannot guarantee
that these recipes will work out of the box on every possible architecture.
We will do our best to explain how to <strong>setup your environment</strong> and how to <strong>avoid the typical pitfalls</strong>
but we cannot cover all the possible cases.</p>
<p>Fortunately, the internet provides lots of resources.
Search engines and stackoverflow are your best friends and in some cases one can find the solution
by just <strong>copying the error message in the search bar</strong>.
For more complicated issues, you can ask for help on the <a href="https://discourse.abinit.org">ABINIT discourse forum</a>
or contact the sysadmin of your cluster but remember to provide enough information about your system
and the problem you are encountering.</p>
</div>
<h2 id="getting-started">Getting started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<p>Since ABINIT is written in Fortran, we need a <strong>recent Fortran compiler</strong>
that supports the <strong>F2003 specifications</strong> as well as a C compiler.
At the time of writing (November 05, 2024 ), the C++ compiler is optional and required only for advanced features
that are not treated in this tutorial.</p>
<p>In what follows, we will be focusing on the GNU toolchain i.e. <em>gcc</em> for C and <em>gfortran</em> for Fortran.
These &ldquo;sequential&rdquo; compilers are adequate if you don&rsquo;t need to compile parallel MPI applications.
The compilation of MPI code, indeed, requires the installation of <strong>additional libraries</strong>
and <strong>specialized wrappers</strong> (<em>mpicc</em>, <em>mpif90</em> or <em>mpiifort</em> ) replacing the &ldquo;sequential&rdquo; compilers.
This very important scenario is covered in more detail in the next sections.
For the time being, we mainly focus on the compilation of sequential applications/libraries.</p>
<p>First of all, let&rsquo;s make sure the <strong>gfortran</strong> compiler is installed on your machine
by issuing in the terminal the following command:</p>
<div class="highlight"><pre><span></span><code>which gfortran
/usr/bin/gfortran
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <strong>which</strong> command, returns the <strong>absolute path</strong> of the executable.
This Unix tool is extremely useful to pinpoint possible problems and we will use it
a lot in the rest of this tutorial.</p>
</div>
<p>In our case, we are lucky that the Fortran compiler is already installed in <em>/usr/bin</em> and we can immediately
use it to build our software stack.
If <em>gfortran</em> is not installed, you may want to use the package manager provided by your
Linux distribution to install it.
On Ubuntu, for instance, use:</p>
<div class="highlight"><pre><span></span><code>sudo apt-get install gfortran
</code></pre></div>
<p>To get the version of the compiler, use the <code>--version</code> option:</p>
<div class="highlight"><pre><span></span><code>gfortran --version
GNU Fortran <span class="o">(</span>GCC<span class="o">)</span> <span class="m">5</span>.3.1 <span class="m">20160406</span> <span class="o">(</span>Red Hat <span class="m">5</span>.3.1-6<span class="o">)</span>
Copyright <span class="o">(</span>C<span class="o">)</span> <span class="m">2015</span> Free Software Foundation, Inc.
</code></pre></div>
<p>Starting with version 9, ABINIT requires gfortran &gt;= v5.4.
Consult the release notes to check whether your gfortran version is supported by the latest ABINIT releases.</p>
<p>Now let&rsquo;s check whether <strong>make</strong> is already installed using:</p>
<div class="highlight"><pre><span></span><code>which make
/usr/bin/make
</code></pre></div>
<p>Hopefully, the C compiler <em>gcc</em> is already installed on your machine.</p>
<div class="highlight"><pre><span></span><code>which gcc
/usr/bin/gcc
</code></pre></div>
<p>At this point, we have all the basic building blocks needed to compile ABINIT from source and we
can proceed with the next steps.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Life gets hard if you are a macOS user as Apple does not officially
support Fortran (😞) so you need to install <em>gfortran</em> and <em>gcc</em> either via
<a href="https://brew.sh/">homebrew</a> or <a href="https://www.macports.org/">macport</a>.
Alternatively, one can install <em>gfortran</em> using one of the standalone DMG installers
provided by the <a href="https://github.com/fxcoudert/gfortran-for-macOS/releases">gfortran-for-macOS project</a>.
Note also that macOS users will need to install <strong>make</strong> via <a href="https://developer.apple.com/xcode/">Xcode</a>.
More info can be found in <a href="/INSTALL_MacOS">this page</a>.</p>
</div>
<h2 id="how-to-compile-blas-and-lapack">How to compile BLAS and LAPACK<a class="headerlink" href="#how-to-compile-blas-and-lapack" title="Permanent link">&para;</a></h2>
<p>BLAS and LAPACK represent the workhorse of many scientific codes and an optimized implementation
is crucial for achieving <strong>good performance</strong>.
In principle this step can be skipped as any decent Linux distribution already provides
pre-compiled versions but, as already mentioned in the introduction, we are geeks and we
prefer to compile everything from source.
Moreover the compilation of BLAS/LAPACK represents an excellent exercise
that gives us the opportunity to discuss some basic concepts that
will reveal very useful in the other parts of this tutorial.</p>
<p>First of all, let&rsquo;s create a new directory inside your <code>$HOME</code> (let&rsquo;s call it <strong>local</strong>) using the command:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$HOME</span> <span class="o">&amp;&amp;</span> mkdir <span class="nb">local</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>$HOME is a standard shell variable that stores the absolute path to your home directory.
Use:</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span> My home directory is <span class="nv">$HOME</span>
</code></pre></div>
<p>to print the value of the variable.</p>
<p>The <strong>&amp;&amp;</strong> syntax is used to chain commands together, such that the next command is executed if and only
if the preceding command exited without errors (or, more accurately, exits with a return code of 0).
We will use this trick a lot in the other examples to reduce the number of lines we have to type
in the terminal so that one can easily cut and paste the examples in the terminal.</p>
</div>
<p>Now create the <code>src</code> subdirectory inside $HOME/local with:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$HOME</span>/local <span class="o">&amp;&amp;</span> mkdir src <span class="o">&amp;&amp;</span> <span class="nb">cd</span> src
</code></pre></div>
<p>The <em>src</em> directory will be used to store the packages with the source files and compile code,
whereas executables and libraries will be installed in <code>$HOME/local/bin</code> and <code>$HOME/local/lib</code>, respectively.
We use <code>$HOME/local</code> because we are working as <strong>normal users</strong> and we cannot install software
in <code>/usr/local</code> where root privileges are required and a <code>sudo make install</code> would be needed.
Moreover, working inside <code>$HOME/local</code> allows us to keep our software stack well separated
from the libraries installed by our Linux distribution so that we can easily test new libraries and/or
different versions without affecting the software stack installed by our distribution.</p>
<p>Now download the tarball from the <a href="https://www.openblas.net/">openblas website</a> with:</p>
<div class="highlight"><pre><span></span><code>wget https://github.com/xianyi/OpenBLAS/archive/v0.3.7.tar.gz
</code></pre></div>
<p>If <em>wget</em> is not available, use <em>curl</em> with the <code>-o</code> option to specify the name of the output file as in:</p>
<div class="highlight"><pre><span></span><code>curl -L https://github.com/xianyi/OpenBLAS/archive/v0.3.7.tar.gz -o v0.3.7.tar.gz
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To get the URL associated to a HTML link inside the browser, hover the mouse pointer over the link,
press the right mouse button and then select <code>Copy Link Address</code> to copy the link to the system clipboard.
Then paste the text in the terminal by selecting the <code>Copy</code> action in the menu
activated by clicking on the right button.
Alternatively, one can press the central button (mouse wheel) or use CMD + V on macOS.
This trick is quite handy to fetch tarballs directly from the terminal.</p>
</div>
<p>Uncompress the tarball with:</p>
<div class="highlight"><pre><span></span><code>tar -xvf v0.3.7.tar.gz
</code></pre></div>
<p>then <code>cd</code> to the directory with:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> OpenBLAS-0.3.7
</code></pre></div>
<p>and execute</p>
<div class="highlight"><pre><span></span><code>make -j2 <span class="nv">USE_THREAD</span><span class="o">=</span><span class="m">0</span> <span class="nv">USE_LOCKING</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>to build the single thread version.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>By default, <em>openblas</em> activates threads (see <a href="https://github.com/xianyi/OpenBLAS/wiki/Faq#multi-threaded">FAQ page</a>)
but in our case we prefer to use the sequential version as Abinit is mainly optimized for MPI.
The <code>-j2</code> option tells <em>make</em> to use 2 processes to build the code in order to speed up the compilation.
Adjust this value according to the number of <strong>physical cores</strong> available on your machine.</p>
</div>
<p>At the end of the compilation, you should get the following output (note <strong>Single threaded</strong>):</p>
<div class="highlight"><pre><span></span><code> OpenBLAS build complete. (BLAS CBLAS LAPACK LAPACKE)

  OS               ... Linux
  Architecture     ... x86_64
  BINARY           ... 64bit
  C compiler       ... GCC  (command line : cc)
  Fortran compiler ... GFORTRAN  (command line : gfortran)
  Library Name     ... libopenblas_haswell-r0.3.7.a (Single threaded)

To install the library, you can run &quot;make PREFIX=/path/to/your/installation install&quot;.
</code></pre></div>
<!--
As a side note, a compilation with plain *make* would give:

<div class="highlight"><pre><span></span><code>  Library Name     ... libopenblas_haswellp-r0.3.7.a (Multi threaded; Max num-threads is 12)
</code></pre></div>

that indicates that the openblas library now supports threads.
-->

<p>You may have noticed that, in this particular case, <em>make</em> is not just building the library but is also
running <strong>unit tests</strong> to validate the build.
This means that if <em>make</em> completes successfully, we can be confident that the build is OK
and we can proceed with the installation.
Other packages use a more standard approach and provide a <strong>make check</strong> option that should be executed after <em>make</em>
in order to run the test suite before installing the package.</p>
<p>To install <em>openblas</em> in $HOME/local, issue:</p>
<div class="highlight"><pre><span></span><code>make <span class="nv">PREFIX</span><span class="o">=</span><span class="nv">$HOME</span>/local/ install
</code></pre></div>
<p>At this point, we should have the following <strong>include files</strong> installed in $HOME/local/include:</p>
<div class="highlight"><pre><span></span><code>ls <span class="nv">$HOME</span>/local/include/
cblas.h  f77blas.h  lapacke.h  lapacke_config.h  lapacke_mangling.h  lapacke_utils.h  openblas_config.h
</code></pre></div>
<p>and the following <strong>libraries</strong> installed in $HOME/local/lib:</p>
<div class="highlight"><pre><span></span><code>ls <span class="nv">$HOME</span>/local/lib/libopenblas*

/home/gmatteo/local/lib/libopenblas.a     /home/gmatteo/local/lib/libopenblas_haswell-r0.3.7.a
/home/gmatteo/local/lib/libopenblas.so    /home/gmatteo/local/lib/libopenblas_haswell-r0.3.7.so
/home/gmatteo/local/lib/libopenblas.so.0
</code></pre></div>
<p>Files ending with <code>.so</code> are <strong>shared libraries</strong> (<code>.so</code> stands for shared object) whereas
<code>.a</code> files are <strong>static libraries</strong>.
When compiling source code that relies on external libraries, the name of the library
(without the <em>lib</em> prefix and the file extension) as well as the directory where the library is located must be passed
to the linker.</p>
<p>The name of the library is usually specified with the <code>-l</code> option while the directory is given by <code>-L</code>.
According to these simple rules, in order to compile source code that uses BLAS/LAPACK routines,
one should use the following option:</p>
<div class="codehilite"><pre><span></span><code>-L$HOME/local/lib -lopenblas
</code></pre></div>

<p>We will use a similar syntax to help the ABINIT <em>configure</em> script locate the external linear algebra library.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You may have noticed that we haven&rsquo;t specified the file extension in the library name.
If both static and shared libraries are found, the linker gives preference to linking with the shared library
unless the <code>-static</code> option is used.
<strong>Dynamic is the default behaviour</strong> on several Linux distributions so we assume dynamic linking
in what follows.</p>
</div>
<p>If you are compiling C or Fortran code that requires include files with the declaration of prototypes and the definition
of named constants, you will need to specify the location of the <strong>include files</strong> via the <code>-I</code> option.
In this case, the previous options should be augmented by:</p>
<div class="highlight"><pre><span></span><code>-L<span class="nv">$HOME</span>/local/lib -lopenblas -I<span class="nv">$HOME</span>/local/include
</code></pre></div>
<p>This approach is quite common for C code where <code>.h</code> files must be included to compile properly.
It is less common for modern Fortran code in which include files are usually replaced by <code>.mod</code> files
<em>i.e.</em> Fortran modules produced by the compiler whose location is usually specified via the <code>-J</code> option.
Still, the <code>-I</code> option for include files is valuable also when compiling Fortran applications as libraries
such as FFTW and MKL rely on (Fortran) include files whose location should be passed to the compiler
via <code>-I</code> instead of <code>-J</code>,
see also the official <a href="https://gcc.gnu.org/onlinedocs/gfortran/Directory-Options.html#Directory-Options">gfortran documentation</a>.</p>
<p>Do not worry if this rather technical point is not clear to you.
Any external library has its own requirements and peculiarities and the ABINIT build system provides several options
to automate the detection of external dependencies and the final linkage.
The most important thing is that you are now aware that the compilation of ABINIT requires
the correct specification of <code>-L</code>, <code>-l</code> for libraries, <code>-I</code> for include files, and <code>-J</code> for Fortran modules.
We will elaborate more on this topic when we discuss the configuration options supported by the ABINIT build system.</p>
<!--
https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html

<div class="highlight"><pre><span></span><code>nm <span class="nv">$HOME</span>/local/lib/libopenblas.so
</code></pre></div>
to list the symbols presented in the library.
-->

<p>Since we have installed the package in a <strong>non-standard directory</strong> ($HOME/local),
we need to update two important shell variables: <code>$PATH</code> and <code>$LD_LIBRARY_PATH</code>.
If this is the first time you hear about $PATH and $LD_LIBRARY_PATH, please take some time to learn
about the meaning of these environment variables.
More information about <code>$PATH</code> is available <a href="http://www.linfo.org/path_env_var.html">here</a>.
See <a href="https://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html">this page</a> for <code>$LD_LIBRARY_PATH</code>.</p>
<p>Add these two lines at the end of your <code>$HOME/.bash_profile</code> file</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$HOME</span>/local/bin:<span class="nv">$PATH</span>

<span class="nb">export</span> <span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$HOME</span>/local/lib:<span class="nv">$LD_LIBRARY_PATH</span>
</code></pre></div>
<p>then execute:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> <span class="nv">$HOME</span>/.bash_profile
</code></pre></div>
<p>to activate these changes without having to start a new terminal session.
Now use:</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span> <span class="nv">$PATH</span>
<span class="nb">echo</span> <span class="nv">$LD_LIBRARY_PATH</span>
</code></pre></div>
<p>to print the value of these variables.
On my Linux box, I get:</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span> <span class="nv">$PATH</span>
/home/gmatteo/local/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin

<span class="nb">echo</span> <span class="nv">$LD_LIBRARY_PATH</span>
/home/gmatteo/local/lib:
</code></pre></div>
<p>Note how <code>/home/gmatteo/local/bin</code> has been <strong>prepended</strong> to the previous value of $PATH.
From now on, we can invoke any executable located in $HOME/local/bin by just typing
its <strong>base name</strong> in the shell without having to the enter the full path.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$HOME</span>/local/bin
</code></pre></div>
<p>is not a very good idea as the shell will stop working. Can you explain why?</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>macOS users should replace <code>LD_LIBRARY_PATH</code> with <code>DYLD_LIBRARY_PATH</code></p>
<p>Remember also that one can use <code>env</code> to print all the environment variables defined
in your session and pipe the results to other Unix tools.
Try e.g.:</p>
<div class="highlight"><pre><span></span><code>env <span class="p">|</span> grep LD_
</code></pre></div>
<p>to print only the variables whose name starts with <strong>LD_</strong></p>
</div>
<p>We conclude this section with another tip.
From time to time, some compilers complain or do not display important messages
because <strong>language support is improperly configured</strong> on your computer.
Should this happen, we recommend to export the two variables:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">LANG</span><span class="o">=</span>C
<span class="nb">export</span> <span class="nv">LC_ALL</span><span class="o">=</span>C
</code></pre></div>
<p>This will reset the language support to its most basic defaults and will make sure that you get
all messages from the compilers in English.</p>
<h2 id="how-to-compile-libxc">How to compile libxc<a class="headerlink" href="#how-to-compile-libxc" title="Permanent link">&para;</a></h2>
<p>At this point, it should not be so difficult to compile and install
<a href="https://www.tddft.org/programs/libxc/">libxc</a>, a library that provides
many useful XC functionals (PBE, meta-GGA, hybrid functionals, etc).
Libxc is written in C and can be built using the standard <code>configure &amp;&amp; make</code> approach.
No external dependency is needed, except for basic C libraries that are available
on any decent Linux distribution.</p>
<p>Let&rsquo;s start by fetching the tarball from the internet:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Get the tarball.</span>
<span class="c1"># Note the -O option used in wget to specify the name of the output file</span>

<span class="nb">cd</span> <span class="nv">$HOME</span>/local/src
wget http://www.tddft.org/programs/libxc/down.php?file<span class="o">=</span><span class="m">4</span>.3.4/libxc-4.3.4.tar.gz -O libxc.tar.gz
tar -zxvf libxc.tar.gz
</code></pre></div>
<p>Now configure the package with the standard <code>--prefix</code> option
to <strong>specify the location</strong> where all the libraries, executables, include files,
Fortran modules, man pages, etc. will be installed when we execute <code>make install</code>
(the default is <code>/usr/local</code>)</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> libxc-4.3.4 <span class="o">&amp;&amp;</span> ./configure --prefix<span class="o">=</span><span class="nv">$HOME</span>/local
</code></pre></div>
<p>Finally, build the library, run the tests and install it with:</p>
<div class="highlight"><pre><span></span><code>make -j2
make check <span class="o">&amp;&amp;</span> make install
</code></pre></div>
<p>At this point, we should have the following include files in $HOME/local/include</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>gmatteo@bob libxc-4.3.4<span class="o">]</span>$ ls ~/local/include/*xc*
/home/gmatteo/local/include/libxc_funcs_m.mod  /home/gmatteo/local/include/xc_f90_types_m.mod
/home/gmatteo/local/include/xc.h               /home/gmatteo/local/include/xc_funcs.h
/home/gmatteo/local/include/xc_f03_lib_m.mod   /home/gmatteo/local/include/xc_funcs_removed.h
/home/gmatteo/local/include/xc_f90_lib_m.mod   /home/gmatteo/local/include/xc_version.h
</code></pre></div>
<p>where <code>.mod</code> are Fortran modules generated by the compiler that are needed
when compiling Fortran source using the <em>libxc</em> Fortran API.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code>.mod</code> files are <strong>compiler- and version-dependent</strong>.
In other words, one cannot use these <code>.mod</code> files to compile code with a different Fortran compiler.
Moreover, you should not expect to be able to use modules compiled with
a <strong>different version of the same compiler</strong>, especially if the major version has changed.
This is one of the reasons why the version of the Fortran compiler employed
to build our software stack is very important.</p>
</div>
<p>Finally, we have the following static libraries installed in ~/local/lib</p>
<div class="highlight"><pre><span></span><code>ls ~/local/lib/libxc*
/home/gmatteo/local/lib/libxc.a   /home/gmatteo/local/lib/libxcf03.a   /home/gmatteo/local/lib/libxcf90.a
/home/gmatteo/local/lib/libxc.la  /home/gmatteo/local/lib/libxcf03.la  /home/gmatteo/local/lib/libxcf90.la
</code></pre></div>
<p>where:</p>
<ul>
<li><strong>libxc</strong> is the C library</li>
<li><strong>libxcf90</strong> is the library with the F90 API</li>
<li><strong>libxcf03</strong> is the library with the F2003 API</li>
</ul>
<p>Both <em>libxcf90</em> and <em>libxcf03</em> depend on the C library where most of the work is done.
At present, ABINIT requires the F90 API only so we should use</p>
<div class="codehilite"><pre><span></span><code>-L$HOME/local/lib -lxcf90 -lxc
</code></pre></div>

<p>for the libraries and</p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="nv">I</span>$<span class="nv">HOME</span><span class="o">/</span><span class="nv">local</span><span class="o">/</span><span class="k">include</span>
</code></pre></div>

<p>for the include files.</p>
<p>Note how <code>libxcf90</code> comes <strong>before</strong> the C library <code>libxc</code>.
This is done on purpose as <code>libxcf90</code> depends on <code>libxc</code> (the Fortran API calls the C implementation).
Inverting the order of the libraries will likely trigger errors (<strong>undefined references</strong>)
in the last step of the compilation when the linker tries to build the final application.</p>
<p>Things become even more complicated when we have to build applications using many different interdependent
libraries as the <strong>order of the libraries</strong> passed to the linker is of crucial importance.
Fortunately the ABINIT build system is aware of this problem and all the dependencies
(BLAS, LAPACK, FFT, LIBXC, MPI, etc) will be automatically put in the right order so
you don&rsquo;t have to worry about this point although it is worth knowing about it.</p>
<h2 id="compiling-and-installing-fftw">Compiling and installing FFTW<a class="headerlink" href="#compiling-and-installing-fftw" title="Permanent link">&para;</a></h2>
<p>FFTW is a C library for computing the Fast Fourier transform in one or more dimensions.
ABINIT already provides an internal implementation of the FFT algorithm implemented in Fortran
hence FFTW is considered an optional dependency.
Nevertheless, <strong>we do not recommend the internal implementation if you really care about performance</strong>.
The reason is that FFTW (or, even better, the DFTI library provided by intel MKL)
is usually much faster than the internal version.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>FFTW is very easy to install on Linux machines once you have <em>gcc</em> and <em>gfortran</em>.
The <a class="wikilink codevar-wikilink" href="/variables/dev#fftalg">fftalg</a> variable defines the implementation to be used and 312 corresponds to the FFTW implementation.
The default value of <a class="wikilink codevar-wikilink" href="/variables/dev#fftalg">fftalg</a> is automatically set by the <em>configure</em> script via pre-preprocessing options.
In other words, if you activate support for FFTW (DFTI) at configure time,
ABINIT will use <a class="wikilink codevar-wikilink" href="/variables/dev#fftalg">fftalg</a> 312 (512) as default.</p>
</div>
<p>The FFTW source code can be downloaded from <a href="http://www.fftw.org/">fftw.org</a>,
and the tarball of the latest version is available at <a href="http://www.fftw.org/fftw-3.3.8.tar.gz">http://www.fftw.org/fftw-3.3.8.tar.gz</a>.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$HOME</span>/local/src

wget http://www.fftw.org/fftw-3.3.8.tar.gz
tar -zxvf fftw-3.3.8.tar.gz <span class="o">&amp;&amp;</span> <span class="nb">cd</span> fftw-3.3.8
</code></pre></div>
<p>The compilation procedure is very similar to the one already used for the <em>libxc</em> package.
Note, however, that ABINIT needs both the <strong>single-precision</strong> and the <strong>double-precision</strong> version.
This means that we need to configure, build and install the package <strong>twice</strong>.</p>
<p>To build the single precision version, use:</p>
<div class="highlight"><pre><span></span><code>./configure --prefix<span class="o">=</span><span class="nv">$HOME</span>/local --enable-single
make -j2
make check <span class="o">&amp;&amp;</span> make install
</code></pre></div>
<p>During the configuration step, make sure that <em>configure</em> finds the Fortran compiler
because ABINIT needs the Fortran interface.</p>
<div class="highlight"><pre><span></span><code>checking for gfortran... gfortran
checking whether we are using the GNU Fortran 77 compiler... yes
checking whether gfortran accepts -g... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... no
checking whether to build static libraries... yes
</code></pre></div>
<p>Let&rsquo;s have a look at the libraries we&rsquo;ve just installed:</p>
<div class="highlight"><pre><span></span><code>ls <span class="nv">$HOME</span>/local/lib/libfftw3*
/home/gmatteo/local/lib/libfftw3f.a  /home/gmatteo/local/lib/libfftw3f.la
</code></pre></div>
<p>the <code>f</code> at the end stands for <code>float</code> (C jargon for single precision).
Note that only static libraries have been built.
To build shared libraries, one should use <code>--enable-shared</code> when configuring.</p>
<p>Now we configure for the double precision version (this is the default behaviour so no extra option is needed)</p>
<div class="highlight"><pre><span></span><code>./configure --prefix<span class="o">=</span><span class="nv">$HOME</span>/local
make -j2
make check <span class="o">&amp;&amp;</span> make install
</code></pre></div>
<p>After this step, you should have two libraries with the single and the double precision API:</p>
<div class="highlight"><pre><span></span><code>ls <span class="nv">$HOME</span>/local/lib/libfftw3*
/home/gmatteo/local/lib/libfftw3.a   /home/gmatteo/local/lib/libfftw3f.a
/home/gmatteo/local/lib/libfftw3.la  /home/gmatteo/local/lib/libfftw3f.la
</code></pre></div>
<p>To compile ABINIT with FFTW3 support, one should use:</p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="nv">L</span>$<span class="nv">HOME</span><span class="o">/</span><span class="nv">local</span><span class="o">/</span><span class="nv">lib</span> <span class="o">-</span><span class="nv">lfftw3f</span> <span class="o">-</span><span class="nv">lfftw3</span> <span class="o">-</span><span class="nv">I</span>$<span class="nv">HOME</span><span class="o">/</span><span class="nv">local</span><span class="o">/</span><span class="k">include</span>
</code></pre></div>

<p>Note that, unlike in <em>libxc</em>, here we don&rsquo;t have to specify different libraries for Fortran and C
as FFTW3 bundles <strong>both the C and the Fortran API in the same library</strong>.
The Fortran interface is included by default provided the FFTW3 <em>configure</em> script can find a Fortran compiler.
In our case, we know that our FFTW3 library supports Fortran as <em>gfortran</em> was found by <em>configure</em>
but this may not be true if you are using a precompiled library installed via your package manager.</p>
<p>To make sure we have the Fortran API, use the <code>nm</code> tool
to get the list of symbols in the library and then use <em>grep</em> to search for the Fortran API.
For instance we can check whether our library contains the Fortran routine for multiple single-precision
FFTs (<em>sfftw_plan_many_dft</em>) and the version for multiple double-precision FFTs (<em>dfftw_plan_many_dft</em>)</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>gmatteo@bob fftw-3.3.8<span class="o">]</span>$ nm <span class="nv">$HOME</span>/local/lib/libfftw3f.a <span class="p">|</span> grep sfftw_plan_many_dft
<span class="m">0000000000000400</span> T sfftw_plan_many_dft_
<span class="m">0000000000003570</span> T sfftw_plan_many_dft__
0000000000001a90 T sfftw_plan_many_dft_c2r_
0000000000004c00 T sfftw_plan_many_dft_c2r__
0000000000000f60 T sfftw_plan_many_dft_r2c_
00000000000040d0 T sfftw_plan_many_dft_r2c__

<span class="o">[</span>gmatteo@bob fftw-3.3.8<span class="o">]</span>$ nm <span class="nv">$HOME</span>/local/lib/libfftw3.a <span class="p">|</span> grep dfftw_plan_many_dft
<span class="m">0000000000000400</span> T dfftw_plan_many_dft_
<span class="m">0000000000003570</span> T dfftw_plan_many_dft__
0000000000001a90 T dfftw_plan_many_dft_c2r_
0000000000004c00 T dfftw_plan_many_dft_c2r__
0000000000000f60 T dfftw_plan_many_dft_r2c_
00000000000040d0 T dfftw_plan_many_dft_r2c__
</code></pre></div>
<p>If you are using a FFTW3 library without Fortran support, the ABINIT <em>configure</em> script will complain that the library
cannot be called from Fortran and you will need to dig into <em>config.log</em> to understand what&rsquo;s going on.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At present, there is no need to compile FFTW with MPI support because ABINIT implements its own
version of the MPI-FFT algorithm based on the sequential FFTW version.
The MPI algorithm implemented in ABINIT is optimized for plane-waves codes
as it supports zero-padding and composite transforms for the applications of the local part of the KS potential.</p>
<p>Also, <strong>do not use MKL with FFTW3</strong> for the FFT as the MKL library exports the same symbols as FFTW.
This means that the linker will receive multiple definitions for the same procedure and
the <strong>behaviour is undefined</strong>! Use either MKL or FFTW3 with e.g. openblas.</p>
</div>
<h2 id="installing-mpi">Installing MPI<a class="headerlink" href="#installing-mpi" title="Permanent link">&para;</a></h2>
<p>In this section, we discuss how to compile and install the MPI library.
This step is required if you want to run ABINIT with multiple processes and/or you
need to compile MPI-based libraries such as PBLAS/Scalapack or the HDF5 library with support for parallel IO.</p>
<p>It is worth stressing that the MPI installation provides two scripts (<strong>mpif90</strong> and <strong>mpicc</strong>)
that act as a sort of wrapper around the sequential Fortran and the C compilers, respectively.
These scripts must be used to compile parallel software using MPI instead
of the &ldquo;sequential&rdquo; <em>gfortran</em> and <em>gcc</em>.
The MPI library also provides launcher scripts installed in the <em>bin</em> directory (<strong>mpirun</strong> or <strong>mpiexec</strong>)
that must be used to execute an MPI application EXEC with NUM_PROCS MPI processes with the syntax:</p>
<div class="highlight"><pre><span></span><code>mpirun -n NUM_PROCS EXEC <span class="o">[</span>EXEC_ARGS<span class="o">]</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Keep in mind that there are <strong>several MPI implementations</strong> available around
(<em>openmpi</em>, <em>mpich</em>, <em>intel mpi</em>, etc) and you must <strong>choose one implementation and stick to it</strong>
when building your software stack.
In other words, all the libraries and executables requiring MPI must be compiled, linked and executed
<strong>with the same MPI library</strong>.</p>
<p>Don&rsquo;t try to link a library compiled with e.g. <em>mpich</em> if you are building the code with
the <em>mpif90</em> wrapper provided by e.g. <em>openmpi</em>.
By the same token, don&rsquo;t try to run executables compiled with e.g. <em>intel mpi</em> with the
<em>mpirun</em> launcher provided by <em>openmpi</em> unless you are looking for troubles!
Again, the <em>which</em> command is quite handy to pinpoint possible problems especially if there are multiple
installations of MPI in your $PATH (not a very good idea!).</p>
</div>
<p>In this tutorial, we employ the <em>mpich</em> implementation that can be downloaded
from this <a href="https://www.mpich.org/downloads/">webpage</a>.
In the terminal, issue:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$HOME</span>/local/src
wget http://www.mpich.org/static/downloads/3.3.2/mpich-3.3.2.tar.gz
tar -zxvf mpich-3.3.2.tar.gz
<span class="nb">cd</span> mpich-3.3.2/
</code></pre></div>
<p>to download and uncompress the tarball.
Then configure/compile/test/install the library with:</p>
<div class="highlight"><pre><span></span><code>./configure --prefix<span class="o">=</span><span class="nv">$HOME</span>/local
make -j2
make check <span class="o">&amp;&amp;</span> make install
</code></pre></div>
<p>Once the installation is completed, you should obtain this message
(possibly not the last message, you might have to look for it).</p>
<div class="highlight"><pre><span></span><code>----------------------------------------------------------------------
Libraries have been installed <span class="k">in</span>:
   /home/gmatteo/local/lib

If you ever happen to want to link against installed libraries
<span class="k">in</span> a given directory, LIBDIR, you must either use libtool, and
specify the full pathname of the library, or use the <span class="s1">&#39;-LLIBDIR&#39;</span>
flag during linking and <span class="k">do</span> at least one of the following:
   - add LIBDIR to the <span class="s1">&#39;LD_LIBRARY_PATH&#39;</span> environment variable
     during execution
   - add LIBDIR to the <span class="s1">&#39;LD_RUN_PATH&#39;</span> environment variable
     during linking
   - use the <span class="s1">&#39;-Wl,-rpath -Wl,LIBDIR&#39;</span> linker flag
   - have your system administrator add LIBDIR to <span class="s1">&#39;/etc/ld.so.conf&#39;</span>

See any operating system documentation about shared libraries <span class="k">for</span>
more information, such as the ld<span class="o">(</span><span class="m">1</span><span class="o">)</span> and ld.so<span class="o">(</span><span class="m">8</span><span class="o">)</span> manual pages.
----------------------------------------------------------------------
</code></pre></div>
<p>The reason why we should add <code>$HOME/local/lib</code> to <code>$LD_LIBRARY_PATH</code> now should be clear to you.</p>
<p>Let&rsquo;s have a look at the MPI executables we have just installed in $HOME/local/bin:</p>
<div class="highlight"><pre><span></span><code>ls <span class="nv">$HOME</span>/local/bin/mpi*
/home/gmatteo/local/bin/mpic++        /home/gmatteo/local/bin/mpiexec        /home/gmatteo/local/bin/mpifort
/home/gmatteo/local/bin/mpicc         /home/gmatteo/local/bin/mpiexec.hydra  /home/gmatteo/local/bin/mpirun
/home/gmatteo/local/bin/mpichversion  /home/gmatteo/local/bin/mpif77         /home/gmatteo/local/bin/mpivars
/home/gmatteo/local/bin/mpicxx        /home/gmatteo/local/bin/mpif90
</code></pre></div>
<p>Since we added $HOME/local/bin to $PATH, we should see that <em>mpi90</em> is actually
pointing to the version we have just installed:</p>
<div class="highlight"><pre><span></span><code>which mpif90
~/local/bin/mpif90
</code></pre></div>
<p>As already mentioned, <em>mpif90</em> is a wrapper around the sequential Fortran compiler.
To show the Fortran compiler invoked by <em>mpif90</em>, use:</p>
<div class="highlight"><pre><span></span><code>mpif90 -v

mpifort <span class="k">for</span> MPICH version <span class="m">3</span>.3.2
Using built-in specs.
<span class="nv">COLLECT_GCC</span><span class="o">=</span>gfortran
<span class="nv">COLLECT_LTO_WRAPPER</span><span class="o">=</span>/usr/libexec/gcc/x86_64-redhat-linux/5.3.1/lto-wrapper
Target: x86_64-redhat-linux
Configured with: ../configure --enable-bootstrap --enable-languages<span class="o">=</span>c,c++,objc,obj-c++,fortran,ada,go,lto --prefix<span class="o">=</span>/usr --mandir<span class="o">=</span>/usr/share/man --infodir<span class="o">=</span>/usr/share/info --with-bugurl<span class="o">=</span>http://bugzilla.redhat.com/bugzilla --enable-shared --enable-threads<span class="o">=</span>posix --enable-checking<span class="o">=</span>release --enable-multilib --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-linker-hash-style<span class="o">=</span>gnu --enable-plugin --enable-initfini-array --disable-libgcj --with-isl --enable-libmpx --enable-gnu-indirect-function --with-tune<span class="o">=</span>generic --with-arch_32<span class="o">=</span>i686 --build<span class="o">=</span>x86_64-redhat-linux
Thread model: posix
gcc version <span class="m">5</span>.3.1 <span class="m">20160406</span> <span class="o">(</span>Red Hat <span class="m">5</span>.3.1-6<span class="o">)</span> <span class="o">(</span>GCC<span class="o">)</span>
</code></pre></div>
<p>The C include files (<em>.h</em>) and the Fortran modules (<em>.mod</em>) have been installed in $HOME/local/include</p>
<div class="highlight"><pre><span></span><code>ls <span class="nv">$HOME</span>/local/include/mpi*

/home/gmatteo/local/include/mpi.h              /home/gmatteo/local/include/mpicxx.h
/home/gmatteo/local/include/mpi.mod            /home/gmatteo/local/include/mpif.h
/home/gmatteo/local/include/mpi_base.mod       /home/gmatteo/local/include/mpio.h
/home/gmatteo/local/include/mpi_constants.mod  /home/gmatteo/local/include/mpiof.h
/home/gmatteo/local/include/mpi_sizeofs.mod
</code></pre></div>
<p>In principle, the location of the directory must be passed to the Fortran compiler either
with the <code>-J</code> (<code>mpi.mod</code> module for MPI2+) or the <code>-I</code> option (<code>mpif.h</code> include file for MPI1).
Fortunately, the ABINIT build system can automatically detect your MPI installation and set all the compilation
options automatically if you provide the installation root ($HOME/local).</p>
<h2 id="installing-hdf5-and-netcdf4">Installing HDF5 and netcdf4<a class="headerlink" href="#installing-hdf5-and-netcdf4" title="Permanent link">&para;</a></h2>
<p>Abinit developers are trying to move away from Fortran binary files as this
format is not portable and difficult to read from high-level languages such as python.
For this reason, in Abinit v9, HDF5 and netcdf4 have become <strong>hard-requirements</strong>.
This means that the <em>configure</em> script will abort if these libraries are not found.
In this section, we explain how to build HDF5 and netcdf4 from source including support for parallel IO.</p>
<p>Netcdf4 is built on top of HDF5 and consists of two different layers:</p>
<ul>
<li>
<p>The <strong>low-level C library</strong></p>
</li>
<li>
<p>The <strong>Fortran bindings</strong> i.e. Fortran routines calling the low-level C implementation.
  This is the high-level API used by ABINIT to perform all the IO operations on netcdf files.</p>
</li>
</ul>
<p>To build the libraries required by ABINIT, we will compile the three different layers
in a bottom-up fashion starting from the HDF5 package (<em>HDF5 &rarr; netcdf-c &rarr; netcdf-fortran</em>).
Since we want to activate support for parallel IO, we need to compile the libraries <strong>using the wrappers</strong>
provided by our MPI installation instead of using <em>gcc</em> or <em>gfortran</em> directly.</p>
<p>Let&rsquo;s start by downloading the HDF5 tarball from this <a href="https://www.hdfgroup.org/downloads/hdf5/source-code/">download page</a>.
Uncompress the archive with <em>tar</em> as usual, then configure the package with:</p>
<div class="highlight"><pre><span></span><code>./configure --prefix<span class="o">=</span><span class="nv">$HOME</span>/local/ <span class="se">\</span>
            <span class="nv">CC</span><span class="o">=</span><span class="nv">$HOME</span>/local/bin/mpicc --enable-parallel --enable-shared
</code></pre></div>
<p>where we&rsquo;ve used the <strong>CC</strong> variable to specify the C compiler.
This step is crucial in order to activate support for parallel IO.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A table with the more commonly-used predefined variables is available
<a href="https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html">here</a></p>
</div>
<p>At the end of the configuration step, you should get the following output:</p>
<div class="highlight"><pre><span></span><code>                     AM C Flags:
               Shared C Library: yes
               Static C Library: yes

                        Fortran: no
                            C++: no
                           Java: no

Features:
---------
                   Parallel HDF5: yes
Parallel Filtered Dataset Writes: yes
              Large Parallel I/O: yes
              High-level library: yes
                    Threadsafety: no
             Default API mapping: v110
  With deprecated public symbols: yes
          I/O filters <span class="o">(</span>external<span class="o">)</span>: deflate<span class="o">(</span>zlib<span class="o">)</span>
                             MPE:
                      Direct VFD: no
                         dmalloc: no
  Packages w/ extra debug output: none
                     API tracing: no
            Using memory checker: no
 Memory allocation sanity checks: no
          Function stack tracing: no
       Strict file format checks: no
    Optimization instrumentation: no
</code></pre></div>
<p>The line with:</p>
<div class="highlight"><pre><span></span><code>Parallel HDF5: yes
</code></pre></div>
<p>tells us that our HDF5 build supports parallel IO.
The Fortran API is not activated but this is not a problem
as ABINIT will be interfaced with HDF5 through the Fortran bindings provided by netcdf-fortran.
In other words, <strong>ABINIT requires <em>netcdf-fortran</em></strong> and not the HDF5 Fortran bindings.</p>
<p>Again, issue <code>make -j NUM</code> followed by <code>make check</code> and finally <code>make install</code>.
Note that <code>make check</code> may take some time so you may want to install immediately and run the tests in another terminal
so that you can continue with the tutorial.</p>
<p>Now let&rsquo;s move to netcdf.
Download the C version and the Fortran bindings from the
<a href="https://www.unidata.ucar.edu/downloads/netcdf/">netcdf website</a>
and unpack the tarball files as usual.</p>
<div class="highlight"><pre><span></span><code>wget ftp://ftp.unidata.ucar.edu/pub/netcdf/netcdf-c-4.7.3.tar.gz
tar -xvf netcdf-c-4.7.3.tar.gz

wget ftp://ftp.unidata.ucar.edu/pub/netcdf/netcdf-fortran-4.5.2.tar.gz
tar -xvf netcdf-fortran-4.5.2.tar.gz
</code></pre></div>
<p>To compile the C library, use:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> netcdf-c-4.7.3
./configure --prefix<span class="o">=</span><span class="nv">$HOME</span>/local/ <span class="se">\</span>
            <span class="nv">CC</span><span class="o">=</span><span class="nv">$HOME</span>/local/bin/mpicc <span class="se">\</span>
            <span class="nv">LDFLAGS</span><span class="o">=</span>-L<span class="nv">$HOME</span>/local/lib <span class="nv">CPPFLAGS</span><span class="o">=</span>-I<span class="nv">$HOME</span>/local/include
</code></pre></div>
<p>where <code>mpicc</code> is used as C compiler (<strong>CC</strong> environment variable)
and we have to specify <strong>LDFLAGS</strong> and <strong>CPPFLAGS</strong> as we want to link against our installation of <em>hdf5</em>.
At the end of the configuration step, we should obtain</p>
<div class="highlight"><pre><span></span><code><span class="c1"># NetCDF C Configuration Summary</span>
<span class="o">==============================</span>

<span class="c1"># General</span>
-------
NetCDF Version:     <span class="m">4</span>.7.3
Dispatch Version:       <span class="m">1</span>
Configured On:      Wed Apr  <span class="m">8</span> <span class="m">00</span>:53:19 CEST <span class="m">2020</span>
Host System:        x86_64-pc-linux-gnu
Build Directory:    /home/gmatteo/local/src/netcdf-c-4.7.3
Install Prefix:         /home/gmatteo/local

<span class="c1"># Compiling Options</span>
-----------------
C Compiler:     /home/gmatteo/local/bin/mpicc
CFLAGS:
CPPFLAGS:       -I/home/gmatteo/local/include
LDFLAGS:        -L/home/gmatteo/local/lib
AM_CFLAGS:
AM_CPPFLAGS:
AM_LDFLAGS:
Shared Library:     yes
Static Library:     yes
Extra libraries:    -lhdf5_hl -lhdf5 -lm -ldl -lz -lcurl

<span class="c1"># Features</span>
--------
NetCDF-2 API:       yes
HDF4 Support:       no
HDF5 Support:       yes
NetCDF-4 API:       yes
NC-4 Parallel Support:  yes
PnetCDF Support:    no
DAP2 Support:       yes
DAP4 Support:       yes
Byte-Range Support: no
Diskless Support:   yes
MMap Support:       no
JNA Support:        no
CDF5 Support:       yes
ERANGE Fill Support:    no
Relaxed Boundary Check: yes
</code></pre></div>
<p>The section:</p>
<div class="highlight"><pre><span></span><code>HDF5 Support:       yes
NetCDF-4 API:       yes
NC-4 Parallel Support:  yes
</code></pre></div>
<p>tells us that <em>configure</em> detected our installation of <em>hdf5</em> and that support for parallel-IO is activated.</p>
<p>Now use the standard sequence of commands to compile and install the package:</p>
<div class="highlight"><pre><span></span><code>make -j2
make check <span class="o">&amp;&amp;</span> make install
</code></pre></div>
<p>Once the installation is completed, use the <code>nc-config</code> executable to
inspect the features provided by the library we&rsquo;ve just installed.</p>
<div class="highlight"><pre><span></span><code>which nc-config
/home/gmatteo/local/bin/nc-config

<span class="c1"># installation directory</span>
nc-config --prefix
/home/gmatteo/local/
</code></pre></div>
<p>To get a summary of the options used to build the C layer and the available features, use</p>
<div class="highlight"><pre><span></span><code>nc-config --all

This netCDF <span class="m">4</span>.7.3 has been built with the following features:

  --cc            -&gt; /home/gmatteo/local/bin/mpicc
  --cflags        -&gt; -I/home/gmatteo/local/include
  --libs          -&gt; -L/home/gmatteo/local/lib -lnetcdf
  --static        -&gt; -lhdf5_hl -lhdf5 -lm -ldl -lz -lcurl
  ....
  &lt;snip&gt;
</code></pre></div>
<p><em>nc-config</em> is quite useful as it prints the compiler options required to
build C applications requiring netcdf-c (<code>--cflags</code> and <code>--libs</code>).
Unfortunately, this tool is not enough for ABINIT as we need the Fortran bindings as well.</p>
<p>To compile the Fortran bindings, execute:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> netcdf-fortran-4.5.2
./configure --prefix<span class="o">=</span><span class="nv">$HOME</span>/local/ <span class="se">\</span>
            <span class="nv">FC</span><span class="o">=</span><span class="nv">$HOME</span>/local/bin/mpif90 <span class="se">\</span>
            <span class="nv">LDFLAGS</span><span class="o">=</span>-L<span class="nv">$HOME</span>/local/lib <span class="nv">CPPFLAGS</span><span class="o">=</span>-I<span class="nv">$HOME</span>/local/include
</code></pre></div>
<p>where <strong>FC</strong> points to our <em>mpif90</em> wrapper (<strong>CC</strong> is not needed here).
For further info on how to build <em>netcdf-fortran</em>, see the
<a href="https://www.unidata.ucar.edu/software/netcdf/docs/building_netcdf_fortran.html">official documentation</a>.</p>
<p>Now issue:</p>
<div class="highlight"><pre><span></span><code>make -j2
make check <span class="o">&amp;&amp;</span> make install
</code></pre></div>
<p>To inspect the features activated in our Fortran library, use <code>nf-config</code> instead of <code>nc-config</code>
(note the <code>nf-</code> prefix):</p>
<div class="highlight"><pre><span></span><code>which nf-config
/home/gmatteo/local/bin/nf-config

<span class="c1"># installation directory</span>
nf-config --prefix
/home/gmatteo/local/
</code></pre></div>
<p>To get a summary of the options used to build the Fortran bindings and the list of available features, use</p>
<div class="highlight"><pre><span></span><code>nf-config --all

This netCDF-Fortran <span class="m">4</span>.5.2 has been built with the following features:

  --cc        -&gt; gcc
  --cflags    -&gt;  -I/home/gmatteo/local/include -I/home/gmatteo/local/include

  --fc        -&gt; /home/gmatteo/local/bin/mpif90
  --fflags    -&gt; -I/home/gmatteo/local/include
  --flibs     -&gt; -L/home/gmatteo/local/lib -lnetcdff -L/home/gmatteo/local/lib -lnetcdf -lnetcdf -ldl -lm
  --has-f90   -&gt;
  --has-f03   -&gt; yes

  --has-nc2   -&gt; yes
  --has-nc4   -&gt; yes

  --prefix    -&gt; /home/gmatteo/local
  --includedir-&gt; /home/gmatteo/local/include
  --version   -&gt; netCDF-Fortran <span class="m">4</span>.5.2
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><em>nf-config</em> is quite handy to pass options to the ABINIT <em>configure</em> script.
Instead of typing the full list of libraries (<code>--flibs</code>) and the location of the include files (<code>--fflags</code>)
we can delegate this boring task to <em>nf-config</em> using
<a href="https://unix.stackexchange.com/questions/48392/understanding-backtick/48393">backtick syntax</a>:</p>
<div class="highlight"><pre><span></span><code><span class="nv">NETCDF_FORTRAN_LIBS</span><span class="o">=</span><span class="sb">`</span>nf-config --flibs<span class="sb">`</span>
<span class="nv">NETCDF_FORTRAN_FCFLAGS</span><span class="o">=</span><span class="sb">`</span>nf-config --fflags<span class="sb">`</span>
</code></pre></div>
<p>Alternatively, one can simply pass the installation directory (here we use the <code>$(...)</code> syntax):</p>
<div class="highlight"><pre><span></span><code>--with-netcdf-fortran<span class="o">=</span><span class="k">$(</span>nf-config --prefix<span class="k">)</span>
</code></pre></div>
<p>and then let <em>configure</em> detect <strong>NETCDF_FORTRAN_LIBS</strong> and <strong>NETCDF_FORTRAN_FCFLAGS</strong> for us.</p>
</div>
<h2 id="how-to-compile-abinit">How to compile ABINIT<a class="headerlink" href="#how-to-compile-abinit" title="Permanent link">&para;</a></h2>
<p>In this section, we finally discuss how to compile ABINIT using the
MPI compilers and the libraries installed previously.
First of all, download the ABINIT tarball from <a href="https://www.abinit.org/packages">this page</a> using e.g.</p>
<div class="highlight"><pre><span></span><code>wget https://www.abinit.org/sites/default/files/packages/abinit-9.10.3.tar.gz
</code></pre></div>
<p>Here we are using version 9.10.3 but you may want to download the
latest production version to take advantage of new features and benefit from bug fixes.</p>
<p>Once you got the tarball, uncompress it by typing:</p>
<div class="highlight"><pre><span></span><code>tar -xvzf abinit-9.10.3.tar.gz
</code></pre></div>
<p>Then <code>cd</code> into the newly created <em>abinit-9.10.3</em> directory.
Before actually starting the compilation, type:</p>
<div class="highlight"><pre><span></span><code>./configure --help
</code></pre></div>
<p>and take some time to read the documentation of the different options.</p>
<p>The documentation mentions the most important environment variables
that can be used to specify compilers and compilation flags.
We already encountered some of these variables in the previous examples:</p>
<div class="highlight"><pre><span></span><code>Some influential environment variables:
  CC          C compiler command
  CFLAGS      C compiler flags
  LDFLAGS     linker flags, e.g. -L&lt;lib dir&gt; if you have libraries in a
              nonstandard directory &lt;lib dir&gt;
  LIBS        libraries to pass to the linker, e.g. -l&lt;library&gt;
  CPPFLAGS    (Objective) C/C++ preprocessor flags, e.g. -I&lt;include dir&gt; if
              you have headers in a nonstandard directory &lt;include dir&gt;
  CPP         C preprocessor
  CXX         C++ compiler command
  CXXFLAGS    C++ compiler flags
  FC          Fortran compiler command
  FCFLAGS     Fortran compiler flags
</code></pre></div>
<p>Besides the standard environment variables: <strong>CC</strong>, <strong>CFLAGS</strong>, <strong>FC</strong>, <strong>FCFLAGS</strong> etc.
the build system also provides specialized options to activate support for external libraries.
For <em>libxc</em>, for instance, we have:</p>
<div class="highlight"><pre><span></span><code>LIBXC_CPPFLAGS
            C preprocessing flags for LibXC.
LIBXC_CFLAGS
            C flags for LibXC.
LIBXC_FCFLAGS
            Fortran flags for LibXC.
LIBXC_LDFLAGS
            Linker flags for LibXC.
LIBXC_LIBS
            Library flags for LibXC.
</code></pre></div>
<p>According to what we have seen during the compilation of <em>libxc</em>, one should pass to
<em>configure</em> the following options:</p>
<div class="highlight"><pre><span></span><code><span class="nv">LIBXC_LIBS</span><span class="o">=</span><span class="s2">&quot;-L</span><span class="nv">$HOME</span><span class="s2">/local/lib -lxcf90 -lxc&quot;</span>
<span class="nv">LIBXC_FCFLAGS</span><span class="o">=</span><span class="s2">&quot;-I</span><span class="nv">$HOME</span><span class="s2">/local/include&quot;</span>
</code></pre></div>
<p>Alternatively, one can use the <strong>high-level interface</strong> provided by the <code>--with-LIBNAME</code> options
to specify the installation directory as in:</p>
<div class="highlight"><pre><span></span><code>--with-libxc<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/local/lib&quot;</span>
</code></pre></div>
<p>In this case, <em>configure</em> will try to <strong>automatically detect</strong> the other options.
This is the easiest approach but if <em>configure</em> cannot detect the dependency properly,
you may need to inspect <code>config.log</code> for error messages and/or set the options manually.</p>
<!--
https://www.cprogramming.com/tutorial/shared-libraries-linux-gcc.html
In this example, we will be taking advantage of the high-level interface provided by the *with_XXX* options
to tell the build system where external dependencies are located instead of passing options explicitly.
-->

<p>In the previous examples, we executed <em>configure</em> in the top level directory of the package but
for ABINIT we prefer to do things in a much cleaner way using a <strong>build directory</strong>
The advantage of this approach is that we keep object files and executables separated from the source code
and this allows us to <strong>build different executables using the same source tree</strong>.
For example, one can have a build directory with a version compiled with <em>gfortran</em> and another
build directory for the intel <em>ifort</em> compiler or other builds done with same compiler but different compilation options.</p>
<p>Let&rsquo;s call the build directory <code>build_gfortran</code>:</p>
<div class="highlight"><pre><span></span><code>mkdir build_gfortran <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build_gfortran
</code></pre></div>
<p>Now we should define the options that will be passed to the <em>configure</em> script.
Instead of using the command line as done in the previous examples,
we will be using an <strong>external file</strong> (<em>myconf.ac9</em>) to collect all our options.
The syntax to read options from file is:</p>
<div class="highlight"><pre><span></span><code>../configure --with-config-file<span class="o">=</span><span class="s2">&quot;myconf.ac9&quot;</span>
</code></pre></div>
<p>where double quotation marks may be needed for portability reasons.
Note the use of <code>../configure</code> as we are working inside the build directory <code>build_gfortran</code> while
the <code>configure</code> script is located in the top level directory of the package.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The name of the options in <code>myconf.ac9</code> is in <strong>normalized form</strong> that is
the initial <code>--</code> is removed from the option name and all the other <code>-</code> characters in the string
are replaced by an underscore <code>_</code>.
Following these simple rules, the  <em>configure</em> option <code>--with-mpi</code> becomes <code>with_mpi</code> in the ac9 file.</p>
<p>Also note that in the configuration file it is possible to use <strong>shell variables</strong>
and reuse the output of external tools using
<a href="https://unix.stackexchange.com/questions/48392/understanding-backtick/48393">backtick syntax</a>
as is <code>nf-config --flibs</code> or, if you prefer, <code>${nf-config --flibs}</code>.
This tricks allow us to reduce the amount of typing
and have configuration files that can be easily reused for other machines.</p>
</div>
<p>This is an example of configuration file in which we use the high-level interface
(<code>with_LIBNAME=dirpath</code>) as much as possible, except for linalg and FFTW3.
The explicit value of <em>LIBNAME_LIBS</em> and <em>LIBNAME_FCFLAGS</em> is also reported in the commented sections.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># -------------------------------------------------------------------------- #</span>
<span class="c1"># MPI support                                                                #</span>
<span class="c1"># -------------------------------------------------------------------------- #</span>

<span class="c1">#   * the build system expects to find subdirectories named bin/, lib/,</span>
<span class="c1">#     include/ inside the with_mpi directory</span>
<span class="c1">#</span>
<span class="nv">with_mpi</span><span class="o">=</span><span class="nv">$HOME</span>/local/

<span class="c1"># Flavor of linear algebra libraries to use (default is netlib)</span>
<span class="c1">#</span>
<span class="nv">with_linalg_flavor</span><span class="o">=</span><span class="s2">&quot;openblas&quot;</span>

<span class="c1"># Library flags for linear algebra (default is unset)</span>
<span class="c1">#</span>
<span class="nv">LINALG_LIBS</span><span class="o">=</span><span class="s2">&quot;-L</span><span class="nv">$HOME</span><span class="s2">/local/lib -lopenblas&quot;</span>

<span class="c1"># -------------------------------------------------------------------------- #</span>
<span class="c1"># Optimized FFT support                                                      #</span>
<span class="c1"># -------------------------------------------------------------------------- #</span>

<span class="c1"># Flavor of FFT framework to support (default is auto)</span>
<span class="c1">#</span>
<span class="c1"># The high-level interface does not work yet so we pass options explicitly</span>
<span class="c1">#with_fftw3=&quot;$HOME/local/lib&quot;</span>

<span class="c1"># Explicit options for fftw3</span>
<span class="nv">with_fft_flavor</span><span class="o">=</span><span class="s2">&quot;fftw3&quot;</span>
<span class="nv">FFTW3_LIBS</span><span class="o">=</span><span class="s2">&quot;-L</span><span class="nv">$HOME</span><span class="s2">/local/lib -lfftw3f -lfftw3&quot;</span>
<span class="nv">FFTW3_FCFLAGS</span><span class="o">=</span><span class="s2">&quot;-L</span><span class="nv">$HOME</span><span class="s2">/local/include&quot;</span>

<span class="c1"># -------------------------------------------------------------------------- #</span>
<span class="c1"># LibXC</span>
<span class="c1"># -------------------------------------------------------------------------- #</span>
<span class="c1"># Install prefix for LibXC (default is unset)</span>
<span class="c1">#</span>
<span class="nv">with_libxc</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/local&quot;</span>

<span class="c1"># Explicit options for libxc</span>
<span class="c1">#LIBXC_LIBS=&quot;-L$HOME/local/lib -lxcf90 -lxc&quot;</span>
<span class="c1">#LIBXC_FCFLAGS=&quot;-I$HOME/local/include&quot;</span>

<span class="c1"># -------------------------------------------------------------------------- #</span>
<span class="c1"># NetCDF</span>
<span class="c1"># -------------------------------------------------------------------------- #</span>

<span class="c1"># install prefix for NetCDF (default is unset)</span>
<span class="c1">#</span>
<span class="nv">with_netcdf</span><span class="o">=</span><span class="k">$(</span>nc-config --prefix<span class="k">)</span>
<span class="nv">with_netcdf_fortran</span><span class="o">=</span><span class="k">$(</span>nf-config --prefix<span class="k">)</span>

<span class="c1"># Explicit options for netcdf</span>
<span class="c1">#with_netcdf=&quot;yes&quot;</span>
<span class="c1">#NETCDF_FORTRAN_LIBS=`nf-config --flibs`</span>
<span class="c1">#NETCDF_FORTRAN_FCFLAGS=`nf-config --fflags`</span>

<span class="c1"># install prefix for HDF5 (default is unset)</span>
<span class="c1">#</span>
<span class="nv">with_hdf5</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/local&quot;</span>

<span class="c1"># Explicit options for hdf5</span>
<span class="c1">#HDF5_LIBS=`nf-config --flibs`</span>
<span class="c1">#HDF5_FCFLAGS=`nf-config --fflags`</span>

<span class="c1"># Enable OpenMP (default is no)</span>
<span class="nv">enable_openmp</span><span class="o">=</span><span class="s2">&quot;no&quot;</span>
</code></pre></div>
<p>A documented template with all the supported options can be found here</p>
<div class="text-center"><button id="uuid-9d399aae-e550-4805-b319-c781cf29fb5d" class="md-button md-button--secondary"> View build/config-template.ac9 </button></div>
<div id="uuid-b87cb3b1-1b60-4ee0-a0ed-6d4745610253" class="my_dialog" title="build/config-template.ac9" hidden><div><pre class="small-text">
#
# Generic config file for ABINIT (documented template)
#
# After editing this file to suit your needs, you may save it as
# &quot;~/.abinit/build/&lt;hostname&gt;.ac9&quot; to keep these parameters as per-user
# defaults. Just replace &quot;&lt;hostname&gt;&quot; by the name of your machine,
# excluding the domain name.
#
# Example: if your machine is called &quot;myhost.mydomain&quot;, you will save
#          this file as &quot;~/.abinit/build/myhost.ac9&quot;.
#
# You may put this file at the top level of an ABINIT source tree as well,
# in which case its definitions will apply to this particular tree only. In
# some situations, you may even want to put it at your current top build
# directory, in which case it will replace any other config file.
#
# Hint: If you do not know the name of your machine, just type &quot;hostname&quot;
#       in a terminal, or &quot;hostname -s&quot; to obtain the name without domain name.
#

#
# IMPORTANT NOTES
#
# 1. Setting CPPFLAGS, CFLAGS, CXXFLAGS, or FCFLAGS manually is not
#    recommended and will override any setting made by the build system.
#    A gentler way to do is to use the CFLAGS_EXTRA, CXXFLAGS_EXTRA and
#    FCFLAGS_EXTRA environment variables, or to override only one kind
#    of flags. See the sections dedicated to C, C++ and Fortran below
#    for details.
#
# 2. Do not forget to remove the leading &quot;#&quot; on a line when you customize
#    an option.
#

# -------------------------------------------------------------------------- #
# Global build options                                                       #
# -------------------------------------------------------------------------- #

# Where to install ABINIT (default is /usr/local)
#
#prefix=&quot;${HOME}/hpc&quot;

# Select debug level (default is basic)
#
# Allowed values:
#
#     * none     : strip debugging symbols
#     * custom   : allow for user-defined debug flags
#     * basic    : add &#x27;-g&#x27; option when the compiler allows for it
#     * verbose  : like basic + definition of the DEBUG_VERBOSE CPP option
#     * enhanced : disable optimizations and debug verbosely
#     * paranoid : enhanced debugging with additional warnings
#     * naughty  : paranoid debugging with array bound checks
#
# Levels other than no and yes are &quot;profile mode&quot; levels in which
# user-defined flags are overriden and optimizations disabled (see
# below)
#
# Note: debug levels are incremental, i.e. the flags of one level are
# appended to those of the previous ones
#
#with_debug_flavor=&quot;custom&quot;

# Select optimization level whenever possible (default is standard,
# except when debugging is in profile mode - see above - in which case
# optimizations are turned off)
#
# Supported levels:
#
#     * none       : disable optimizations
#     * custom     : enable optimizations with user-defined flags
#     * safe       : build slow and very reliable code
#     * standard   : build fast and reliable code
#     * aggressive : build very fast code, regardless of reliability
#
# Levels other than no and yes are &quot;profile mode&quot; levels in which
# user-defined flags are overriden
#
# Note:
#
#     * this option is ignored when the debug is level is higher than basic
#
#with_optim_flavor=&quot;aggressive&quot;

# Reduce AVX optimizations in sensitive subprograms (default is no)
#
#enable_avx_safe_mode=&quot;yes&quot;

# Enable compiler hints (default is yes)
#
# Allowed values:
#
#     * no       : do not apply any hint
#     * yes      : apply all available hints
#
#enable_hints=&quot;no&quot;

# -------------------------------------------------------------------------- #
# C support                                                                  #
# -------------------------------------------------------------------------- #

# C preprocessor (should not be set in most cases)
#
#CPP=&quot;/usr/bin/cpp&quot;

# C preprocessor custom debug flags (when with_debug_flavor=custom)
#
#CPPFLAGS_DEBUG=&quot;-DDEV_MG_DEBUG_MODE&quot;

# C preprocessor custom optimization flags (when with_optim_flavor=custom)
#
#CPPFLAGS_OPTIM=&quot;-DDEV_DIAGO_DP&quot;

# C preprocessor additional custom flags
#
#CPPFLAGS_EXTRA=&quot;-P&quot;

# Forced C preprocessor flags
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#CPPFLAGS=&quot;-P&quot;

                       # ------------------------------ #

# C compiler
#
#CC=&quot;gcc&quot;

# C compiler custom debug flags (when with_debug_flavor=custom)
#
#CFLAGS_DEBUG=&quot;-g3&quot;

# C compiler custom optimization flags (when with_optim_flavor=custom)
#
#CFLAGS_OPTIM=&quot;-O5&quot;

# C compiler additional custom flags
#
#CFLAGS_EXTRA=&quot;-O2&quot;

# Forced C compiler flags
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#CFLAGS=&quot;-O2&quot;

                       # ------------------------------ #

# C linker custom debug flags (when with_debug_flavor=custom)
#
#CC_LDFLAGS_DEBUG=&quot;-Wl,-debug&quot;

# C linker custom optimization flags (when with_optim_flavor=custom)
#
#CC_LDFLAGS_OPTIM=&quot;-Wl,-ipo&quot;

# C linker additional custom flags
#
#CC_LDFLAGS_EXTRA=&quot;-Bstatic&quot;

# Forced C linker flags
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#CC_LDFLAGS=&quot;-Bstatic&quot;

# C linker custom debug libraries (when with_debug_flavor=custom)
#
#CC_LIBS_DEBUG=&quot;-ldebug&quot;

# C linker custom optimization libraries (when with_optim_flavor=custom)
#
#CC_LIBS_OPTIM=&quot;-lopt_funcs&quot;

# C linker additional custom libraries
#
#CC_LIBS_EXTRA=&quot;-lrt&quot;

# Forced C linker libraries
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#CC_LIBS=&quot;-lrt&quot;

# -------------------------------------------------------------------------- #
# C++ support                                                                #
# -------------------------------------------------------------------------- #

# Note: the XPP* environment variables will likely have no effect

# C++ preprocessor (should not be set in most cases)
#
#XPP=&quot;/usr/bin/cpp&quot;

# C++ preprocessor custom debug flags (when with_debug_flavor=custom)
#
#XPPFLAGS_DEBUG=&quot;-DDEV_MG_DEBUG_MODE&quot;

# C++ preprocessor custom optimization flags (when with_optim_flavor=custom)
#
#XPPFLAGS_OPTIM=&quot;-DDEV_DIAGO_DP&quot;

# C++ preprocessor additional custom flags
#
#XPPFLAGS_EXTRA=&quot;-P&quot;

# Forced C++ preprocessor flags
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#XPPFLAGS=&quot;-P&quot;

                       # ------------------------------ #

# C++ compiler
#
#CXX=&quot;g++&quot;

# C++ compiler custom debug flags (when with_debug_flavor=custom)
#
#CXXFLAGS_DEBUG=&quot;-g3&quot;

# C++ compiler custom optimization flags (when with_optim_flavor=custom)
#
#CXXFLAGS_OPTIM=&quot;-O5&quot;

# C++ compiler additional custom flags
#
#CXXFLAGS_EXTRA=&quot;-O2&quot;

# Forced C++ compiler flags
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#CXXFLAGS=&quot;-O2&quot;

                       # ------------------------------ #

# C++ linker custom debug flags (when with_debug_flavor=custom)
#
#CXX_LDFLAGS_DEBUG=&quot;-Wl,-debug&quot;

# C++ linker custom optimization flags (when with_optim_flavor=custom)
#
#CXX_LDFLAGS_OPTIM=&quot;-Wl,-ipo&quot;

# C++ linker additional custom flags
#
#CXX_LDFLAGS_EXTRA=&quot;-Bstatic&quot;

# Forced C++ linker flags
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#CXX_LDFLAGS=&quot;-Bstatic&quot;

# C++ linker custom debug libraries (when with_debug_flavor=custom)
#
#CXX_LIBS_DEBUG=&quot;-ldebug&quot;

# C++ linker custom optimization libraries (when with_optim_flavor=custom)
#
#CXX_LIBS_OPTIM=&quot;-lopt_funcs&quot;

# C++ linker additional custom libraries
#
#CXX_LIBS_EXTRA=&quot;-lblitz&quot;

# Forced C++ linker libraries
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#CXX_LIBS=&quot;-lblitz&quot;

# -------------------------------------------------------------------------- #
# Fortran support                                                            #
# -------------------------------------------------------------------------- #

# Fortran preprocessor (should not be set in most cases)
#
#FPP=&quot;/usr/local/bin/fpp&quot;

# Fortran preprocessor custom debug flags (when with_debug_flavor=custom)
#
#FPPFLAGS_DEBUG=&quot;-DDEV_MG_DEBUG_MODE&quot;

# Fortran preprocessor custom optimization flags (when with_optim_flavor=custom)
#
#FPPFLAGS_OPTIM=&quot;-DDEV_DIAGO_DP&quot;

# Fortran preprocessor additional custom flags
#
#FPPFLAGS_EXTRA=&quot;-P&quot;

# Forced Fortran preprocessor flags
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#FPPFLAGS=&quot;-P&quot;

                       # ------------------------------ #

# Fortran compiler
#
#FC=&quot;gfortran&quot;

# Fortran 77 compiler (addition for the Windows/Cygwin environment)
#
#F77=&quot;gfortran&quot;

# Fortran compiler custom debug flags (when with_debug_flavor=custom)
#
#FCFLAGS_DEBUG=&quot;-g3&quot;

# Fortran compiler custom OpenMP flags
#
#FCFLAGS_OPENMP=&quot;-fopenmp&quot;

# Fortran compiler custom OpenMP GPU offload flags
#
#FCFLAGS_OPENMP_OFFLOAD=&quot;-fopenmp&quot;

# Fortran compiler custom optimization flags (when with_optim_flavor=custom)
#
#FCFLAGS_OPTIM=&quot;-O5&quot;

# Fortran compiler additional custom flags
#
#FCFLAGS_EXTRA=&quot;-O2&quot;

# Forced Fortran compiler flags
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#FCFLAGS=&quot;-O2&quot;

# Fortran flags for fixed-form source files
#
#FCFLAGS_FIXEDFORM=&quot;-ffixed-form&quot;

# Fortran flags for free-form source files
#
#FCFLAGS_FREEFORM=&quot;-ffree-form&quot;

# Fortran compiler flags to use a module directory
#
#FCFLAGS_MODDIR==&quot;-J$(abinit_moddir)&quot;

# Tricky Fortran compiler flags
#
#FCFLAGS_HINTS=&quot;-ffree-line-length-none&quot;

# Fortran linker custom debug flags (when with_debug_flavor=custom)
#
#FC_LDFLAGS_DEBUG=&quot;-Wl,-debug&quot;

# Fortran linker custom optimization flags (when with_optim_flavor=custom)
#
#FC_LDFLAGS_OPTIM=&quot;-Wl,-ipo&quot;

# Fortran linker custom flags
#
#FC_LDFLAGS_EXTRA=&quot;-Bstatic&quot;

# Forced Fortran linker flags
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#FC_LDFLAGS=&quot;-Bstatic&quot;

# Fortran linker custom debug libraries (when with_debug_flavor=custom)
#
#FC_LIBS_DEBUG=&quot;-ldebug&quot;

# Fortran linker custom optimization libraries (when with_optim_flavor=custom)
#
#FC_LIBS_OPTIM=&quot;-lopt_funcs&quot;

# Fortran linker additional custom libraries
#
#FC_LIBS_EXTRA=&quot;-lsvml&quot;

# Forced Fortran linker libraries
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#FC_LIBS=&quot;-lsvml&quot;

                       # ------------------------------ #

# Use C clock instead of Fortran clock for timings (default is no)
#
#enable_cclock=&quot;yes&quot;

# Wrap Fortran compiler calls (default is auto-detected)
# Combine this option with with_debug_flavor=&quot;basic&quot; (or some other debug flavor) to keep preprocessed source
# files (they are removed by default, except if their build fails)
#
#enable_fc_wrapper=&quot;yes&quot;

# Choose whether to read file lists from standard input or &quot;ab.files&quot;
# (default is yes = standard input)
#
#enable_stdin=&quot;no&quot;

# Set per-directory Fortran optimizations (useful when a Fortran compiler
# crashes during the build)
#
# Note: this option is not available through the command line
#
#fcflags_opt_95_drive=&quot;-O0&quot;

# -------------------------------------------------------------------------- #
# Python support                                                             #
# -------------------------------------------------------------------------- #

# Flags to pass to the Python interpreter (default is unset)
#
#PYFLAGS=&quot;-B&quot;

# Preprocessing flags for C/Python bindings
#
#PYTHON_CPPFLAGS=&quot;-I/usr/local/include/numpy&quot;

# -------------------------------------------------------------------------- #
# Libraries and linking                                                      #
# -------------------------------------------------------------------------- #

# Set archiver name
#
#AR=&quot;xiar&quot;

# Archiver custom debug flags (when with_debug_flavor=custom)
#
#ARFLAGS_DEBUG=&quot;&quot;

# Archiver custom optimization flags (when with_optim_flavor=custom)
#
#ARFLAGS_OPTIM=&quot;&quot;

# Archiver additional custom flags
#
#ARFLAGS_EXTRA=&quot;-X 64&quot;

# Forced archiver flags
# Note: will override build-system configuration - USE AT YOUR OWN RISKS!
#
#ARFLAGS=&quot;-X 32_64&quot;

                       # ------------------------------ #

# Note: the following definitions are necessary for MINGW/WINDOW$ only
#       and should be left unset on other architectures

# Archive index generator
#RANLIB=&quot;ranlib&quot;

# Object symbols lister
#NM=&quot;nm&quot;

# Generic linker
#LD=&quot;ld&quot;

# Language-independent libraries to add to the build configuration
#LIBS=&quot;-lstdc++ -lpython2.7&quot;

# -------------------------------------------------------------------------- #
# MPI support                                                                #
# -------------------------------------------------------------------------- #

# Determine whether to build parallel code (default is auto)
#
# Permitted values:
#
#   * no       : disable MPI support
#   * yes      : enable MPI support, assuming the compiler is MPI-aware
#   * &lt;prefix&gt; : look for MPI in the &lt;prefix&gt; directory
#
# If left unset, the build system will take all appropriate decisions by
# itself, and MPI will be enabled only if the build environment supports
# it. If set to &quot;yes&quot;, the configure script will stop if it does not find
# a working MPI environment.
#
# Note:
#
#   * the build system expects to find subdirectories named bin/, lib/,
#     include/ under the prefix.
#
#with_mpi=&quot;/usr/local/openmpi-gcc&quot;

# Define MPI flavor (optional, only useful on some systems)
#
# Permitted values:
#
#   * auto         : Let the build system configure MPI (recommended).
#
#   * double-wrap  : Internally wrap the MPI compiler wrappers, only for
#                    severely bugged and oldish MPI implementations.
#
#   * flags        : Do not look for MPI compiler wrappers, only use
#                    compiler flags to enable MPI.
#
#   * native       : Assume that the compilers have native MPI support.
#
#   * prefix       : Assume that MPI wrappers are located under
#                    specified prefix and exclude any other
#                    configuration.
#
#with_mpi_flavor=&quot;native&quot;

# Activate code branches to perform MPI operations on GPU buffers,
# which allow performance gains on intra-node communications.
# WARNING: this feature requires a MPI that is &quot;GPU-aware&quot;, which usually
# means &quot;compiled with CUDA/ROCm support&quot;
#
#enable_mpi_gpu_aware=&quot;no&quot;

# Activate the MPI_IN_PLACE option whenever possible (default is no)
# WARNING: this feature requires MPI2, ignored if the MPI library
# is not MPI2 compliant.
#
#enable_mpi_inplace=&quot;no&quot;

# Activate parallel I/O (default is auto)
#
# Permitted values:
#
#   * auto : let the configure script auto-detect MPI I/O support
#   * no   : disable MPI I/O support
#   * yes  : enable MPI I/O support
#
# If left unset, the build system will take all appropriate decisions by
# itself, and MPI I/O will be enabled only if the build environment supports
# it. If set to &quot;yes&quot;, the configure script will stop if it does not find
# a working MPI I/O environment.
#
#enable_mpi_io=&quot;yes&quot;

# Enable MPI-IO mode in Abinit (use MPI I/O as default I/O library,
# change the default values of iomode)   
# Beware that not all the features of Abinit support MPI I/O,
# This options is mainly used by developers for debugging purposes.
#
#enable_mpi_io_default=&quot;no&quot;

# Set MPI standard level (default is auto-detected)
# Note: all current implementations should support at least level 2
#
# Supported levels:
#
#   * 1 : use &#x27;mpif.h&#x27; header
#   * 2 : use mpi Fortran module
#   * 3 : use mpi_f08 Fortran module
#
#with_mpi_level=&quot;2&quot;

# C preprocessor flags for MPI (default is unset)
#
#MPI_CPPFLAGS=&quot;-I/usr/local/include&quot;

# C flags for MPI (default is unset)
#
#MPI_CFLAGS=&quot;&quot;

# C++ flags for MPI (default is unset)
#
#MPI_CXXFLAGS=&quot;&quot;

# Fortran flags for MPI (default is unset)
#
#MPI_FCFLAGS=&quot;&quot;

# Link flags for MPI (default is unset)
#
#MPI_LDFLAGS=&quot;&quot;

# Library flags for MPI (default is unset)
#
#MPI_LIBS=&quot;-L/usr/local/lib -lmpi&quot;

# -------------------------------------------------------------------------- #
# GPU support                                                                #
# -------------------------------------------------------------------------- #

# Requirement: go through README.GPU before doing anything
#
# Note: this is highly experimental - USE AT YOUR OWN RISKS!

# Trigger and install prefix for GPU libraries and compilers
#
# Permitted values:
#
#   * no       : disable GPU support
#   * yes      : enable GPU support, assuming the build environment
#                is properly set
#   * &lt;prefix&gt; : look for GPU in the &lt;prefix&gt; directory
#
# Note: The build system expects to find subdirectories named bin/, lib/,
#       include/ under the prefix.
#
#with_gpu=&quot;/usr/local/cuda&quot;

# Flavor of the GPU library to use (default is cuda-single)
#
# Supported libraries:
#
#   * cuda-single : Cuda with single-precision arithmetic
#   * cuda-double : Cuda with double-precision arithmetic
#   * none        : not implemented (will replace enable_gpu)
#
#with_gpu_flavor=&quot;cuda-double&quot;

# GPU C preprocessor flags (default is unset)
#
#GPU_CPPFLAGS=&quot;-I/usr/local/include/cuda&quot;

# GPU C flags (default is unset)
#
#GPU_CFLAGS=&quot;-I/usr/local/include/cuda&quot;

# GPU C++ flags (default is unset)
#
#GPU_CXXFLAGS=&quot;-std=c++11&quot;

# GPU Fortran flags (default is unset)
#
#GPU_FCFLAGS=&quot;-I/usr/local/include/cuda&quot;

# GPU link flags (default is unset)
#
#GPU_LDFLAGS=&quot;-L/usr/local/cuda/lib64 -lcublas -lcufft -lcudart&quot;

# GPU link flags (default is unset)
#
#GPU_LIBS=&quot;-L/usr/local/cuda/lib64 -lcublas -lcufft -lcudart&quot;

# GPU arch, useful for autosetting OpenMP offload flags (default is NVIDIA Ampere)
# Example values : - 60 (NVIDIA Pascal)
#                  - 70 (NVIDIA Volta)
#                  - 75 (NVIDIA Turing)
#                  - 80 (NVIDIA Ampere)
#                  - 90 (NVIDIA Hopper)
#
#GPU_ARCH=80

                       # ------------------------------ #

# Advanced GPU options (experts only)
#
# DO NOT EDIT THIS SECTION UNLESS YOU *TRULY* KNOW WHAT YOU ARE DOING!
# In any case, the outcome of setting the following options is highly
# impredictible.

# nVidia C compiler (should not be set)
#
#NVCC=&quot;/usr/local/cuda/bin/nvcc&quot;

# Forced nVidia C compiler preprocessing flags (should not be set)
#
#NVCC_CPPFLAGS=&quot;-DHAVE_CUDA_SDK&quot;

# Forced nVidia C compiler flags (should not be set)
#
#NVCC_CFLAGS=&quot;-arch=sm_13&quot;

# Forced nVidia linker flags (should not be set)
#
#NVCC_LDFLAGS=&quot;&quot;

# Forced nVidia linker libraries (should not be set)
#
#NVCC_LIBS=&quot;&quot;

# -------------------------------------------------------------------------- #
# Linear algebra support                                                     #
# -------------------------------------------------------------------------- #

# A large set of linear algebra libraries are available on the Web.
# See e.g. https://hpc.llnl.gov/manuals/mathematical-software/math-libraries-and-interactive-tools
# Among all those, many are supported by ABINIT.

# WARNING: when setting the value of the linear algebra flavor to &quot;custom&quot;,
#          the associated CPP options may be defined in an impredictable
#          manner by the build system. In such a case, checking which
#          CPP options are enabled by looking at the output of abinit
#          is thus highly recommended before running production
#          calculations.

# Supported libraries:
#
#   * aocl      : AMD Optimizing CPU Libraries
#                 https://developer.amd.com/amd-aocl/
#
#   * atlas     : Automatically Tuned Linear Algebra Software
#                 http://math-atlas.sourceforge.net/
#
#   * auto      : automatically look for linear algebra libraries
#                 depending on the build environment (default)
#
#   * easybuild : EasyBuild - Building software with ease
#                 https://easybuilders.github.io/easybuild/
#
#   * elpa      : Eigen soLvers for Petaflops Applications
#                 http://elpa.rzg.mpg.de
#
#   * magma     : Matrix Algebra on GPU and Multicore Architectures
#                 (MAGMA minimal version&gt;=1.1.0, requires Cuda)
#                 http://icl.cs.utk.edu/magma/
#
#   * mkl       : Intel Math Kernel Library
#                 http://software.intel.com/en-us/articles/intel-mkl/
#
#   * netlib    : Netlib repository reference libraries
#                 http://www.netlib.org/lapack/
#                 http://www.netlib.org/scalapack/
#
#   * none      : just check user-specified libraries, do not try to
#                 detect their type
#
#
#   * nvpl      : Nvidia Performance Library (NVPL)
#                 (only for ARM processors)
#                 https://docs.nvidia.com/nvpl/
#
#   * openblas  : OpenBLAS - An Optimized BLAS Library
#                 https://www.openblas.net/
#
#   * plasma    : Parallel Linear Algebra for Scalable Multicore
#                 Architectures (requires MPI)
#                 http://icl.cs.utk.edu/plasma/
#
# Notes:
#
#   * you may combine &quot;magma&quot; and/or &quot;plasma&quot; with
#     any other flavor, using &#x27;+&#x27; as a separator
#
#   * &quot;custom&quot; also works when the Fortran compiler provides a full
#     BLAS+LAPACK implementation internally (e.g. Lahey Fortran)
#
#   * the include and link flags for MAGMA and ScaLAPACK have to be
#     specified together with those of BLAS and LAPACK (see options below)
#
#   * please consult the MKL link line advisor if you experience
#     problems with MKL, by going to
#     http://software.intel.com/en-us/articles/intel-mkl-link-line-advisor/
#
#   * if with_linalg is set to &quot;no&quot;, linear algebra tests will be disabled
#     and the configuration will be assumed to work as-is by the build
#     system (USE AT YOUR OWN RISKS)
#
#   * with_linalg_incs and with_linalg_libs systematically override the
#     contents of with_linalg
#
#   * in order to enable SCALAPACK, you might have to specify -lscalapack 
#     or use another appropriate syntax for your system.
#
#  Additional information might be obtained from
#  https://wiki.abinit.org/doku.php?id=build:linear_algebra
#  and
#  https://wiki.abinit.org/doku.php?id=developers:buildsys:internals

# Install prefix for linear algebra
#
#with_linalg=&quot;/usr/local&quot;

# Flavor of linear algebra libraries to use (default is netlib)
#
#with_linalg_flavor=&quot;openblas&quot;

# C preprocessing flags for linear algebra (default is unset)
#
#LINALG_CPPFLAGS=&quot;-I/usr/local/include&quot;

# C flags for linear algebra (default is unset)
#
#LINALG_CFLAGS=&quot;-m64&quot;

# C++ flags for linear algebra (default is unset)
#
#LINALG_CXXFLAGS=&quot;-m64&quot;

# Fortran flags for linear algebra (default is unset)
#
#LINALG_FCFLAGS=&quot;-I/usr/local/include&quot;

# Link flags for linear algebra (default is unset)
#
#LINALG_LDFLAGS=&quot;&quot;

# Library flags for linear algebra (default is unset)
#
#LINALG_LIBS=&quot;-L/usr/local/lib -llapack -lblas -lscalapack&quot;

# -------------------------------------------------------------------------- #
# Optimized FFT support                                                      #
# -------------------------------------------------------------------------- #

# Supported libraries:
#
#   * auto          : select library depending on build environment (default)
#   * custom        : bypass build-system checks
#   * dfti          : native MKL FFT library
#   * fftw3         : serial FFTW3 library
#   * fftw3-threads : threaded FFTW3 library
#   * nvpl          : NVPL: Nvidia Performance Library (only for ARM)
#   * pfft          : MPI-parallel PFFT library (for maintainers only)
#   * goedecker     : Abinit internal FFT
#
# Notes:
#
#   * only one flavor can be selected at a time, flavors being mutually
#     exclusive
#

# The following lines relate to a generic FFT library (e.g. they are used for dfti) 

# Install prefix for the FFT library
#
#with_fft=&quot;/usr/local&quot;

# Flavor of FFT framework to support (default is auto)
#
#with_fft_flavor=&quot;fftw3&quot;

# C preprocessor flags for the FFT framework (default is unset)
#
#FFT_CPPFLAGS=&quot;-I/usr/local/include/fftw&quot;

# C flags for the FFT framework (default is unset)
#
#FFT_CFLAGS=&quot;-I/usr/local/include/fftw&quot;

# Fortran flags for the FFT framework (default is unset)
#
#FFT_FCFLAGS=&quot;-I/usr/local/include/fftw&quot;

# Link flags for the FFT framework (default is unset)
#
#FFT_LDFLAGS=&quot;-L/usr/local/lib/fftw -lfftw3&quot;

# Library flags for the FFT framework (default is unset)
#
#FFT_LIBS=&quot;-L/usr/local/lib/fftw -lfftw3&quot;

                       # ------------------------------ #

# The following lines relate specifically to the FFTW3 library 

# Install prefix for the FFTW3 library
#
#with_fftw3=&quot;/usr/local&quot;

# C preprocessor flags for the FFTW3 library (default is unset)
#
#FFTW3_CPPFLAGS=&quot;-I/usr/local/include/fftw&quot;

# C flags for the FFTW3 library (default is unset)
#
#FFTW3_CFLAGS=&quot;-I/usr/local/include/fftw&quot;

# Fortran flags for the FFTW3 library (default is unset)
#
#FFTW3_FCFLAGS=&quot;-I/usr/local/include/fftw&quot;

# Link flags for the FFTW3 library (default is unset)
#
#FFTW3_LDFLAGS=&quot;-L/usr/local/lib/fftw -lfftw3&quot;

# Library flags for the FFTW3 library (default is unset)
#
#FFTW3_LIBS=&quot;-L/usr/local/lib/fftw -lfftw3&quot;

                       # ------------------------------ #

# The following lines relate specifically to the PFFT library 

# Install prefix for the PFFT library
#
#with_pfft=&quot;/usr/local&quot;

# C preprocessor flags for the PFFT library (default is unset)
#
#PFFT_CPPFLAGS=&quot;-I/usr/local/include/fftw&quot;

# C flags for the PFFT library (default is unset)
#
#PFFT_CFLAGS=&quot;-I/usr/local/include/fftw&quot;

# Fortran flags for the PFFT library (default is unset)
#
#PFFT_FCFLAGS=&quot;-I/usr/local/include/fftw&quot;

# Link flags for the PFFT library (default is unset)
#
#PFFT_LDFLAGS=&quot;-L/usr/local/lib/fftw -lfftw3&quot;

# Library flags for the PFFT library (default is unset)
#
#PFFT_LIBS=&quot;-L/usr/local/lib/fftw -lfftw3&quot;

# -------------------------------------------------------------------------- #
# Feature triggers                                                           #
# -------------------------------------------------------------------------- #

# Through feature triggers, the build system of Abinit tries to link
# prioritarily with external libraries to provide the requested
# functionality. When unsuccessful, Abinit will run in degraded mode,
# which means that it will provide poor performance and scalability, as
# well as refuse to run some standard calculations. However, in some
# cases, for historical reasons, it can resort to a limited internal
# implementation.
#
# Enabling feature triggers is necessary for packaging and is recommended
# in most other cases. Relying upon external optimized libraries is always
# smarter than embedding their source code, as their performance and
# integration within the local environment are always significantly
# better.
#
# The following optional dependencies are sorted by alphabetical order.
# Please note that some of them may depend on others, as indicated.

# Notes:
#
#   * when specifying with_package=&quot;prefix&quot;, the build system automatically
#     looks for the relevant libraries in prefix/include and prefix/lib
#
#   * the &#x27;with_package&#x27; options can also be set to yes or no, to let the
#     build system find out the corresponding parameters on plaftorms where
#     the external packages are available system-wide
#
#   * the &#x27;with_package_incs&#x27; and &#x27;with_package_libs&#x27; options systematically
#     override the settings provided by corresponding &#x27;with_package&#x27; options
#

                       # ------------------------------ #

# BigDFT (depends on LibXC, see below)
# Website: http://bigdft.org/

# Enable BigDFT support (default is no)
#
#with_bigdft=&quot;yes&quot;

# Fortran flags for BigDFT (default is unset)
#
#BIGDFT_FCFLAGS=&quot;-I/usr/local/include/bigdft&quot;

# Link flags for BigDFT (default is unset)
#
#BIGDFT_LDFLAGS=&quot;&quot;

# Library flags for BigDFT (default is unset)
#
#BIGDFT_LIBS=&quot;-L/usr/local/lib/bigdft -lbigdft -lpoissonsolver -labinit&quot;

                       # ------------------------------ #

# Kokkos Core library
# Website: http://kokkos.org/

# Enable Kokkos Core support (default is no)
#
#with_kokkos=&quot;yes&quot;

# C++ flags for Kokkos Core (default is unset)
#
#KOKKOS_CXXFLAGS=&quot;-I/usr/local/include/kokkos&quot;

# Fortran flags for Kokkos Core (default is unset)
#
#KOKKOS_FCFLAGS=&quot;-I/usr/local/include/kokkos&quot;

# Link flags for Kokkos Core (default is unset)
#
#KOKKOS_LDFLAGS=&quot;&quot;

# Library flags for Kokkos Core (default is unset)
#
#KOKKOS_LIBS=&quot;-L/usr/local/lib/kokkos -lkokkoscore&quot;

                       # ------------------------------ #

# Levenberg-Marquardt algorithm
# Website: http://users.ics.forth.gr/~lourakis/levmar/

# Trigger and install prefix for Levmar (default is unset)
#
#with_levmar=&quot;yes&quot;

# C preprocessor flags for Levmar (default is unset)
#
#LEVMAR_CPPFLAGS=&quot;-I/opt/etsf/include&quot;

# C flags for Levmar (default is unset)
#
#LEVMAR_CFLAGS=&quot;-I/opt/etsf/include&quot;

# Fortran flags for Levmar (default is unset)
#
#LEVMAR_FCFLAGS=&quot;-I/opt/etsf/include&quot;

# Link flags for Levmar (default is unset)
#
#LEVMAR_LDFLAGS=&quot;&quot;

# Library flags for Levmar (default is unset)
#
#LEVMAR_LIBS=&quot;-L/opt/etsf/lib -llevmar&quot;

                       # ------------------------------ #

# LibXC
# Website: http://www.tddft.org/programs/octopus/wiki/index.php/Libxc

# Trigger and install prefix for LibXC (default is unset)
#
#with_libxc=&quot;/usr/local&quot;

# C preprocessor flags for LibXC (default is unset)
#
#LIBXC_CPPFLAGS=&quot;-I/usr/local/include&quot;

# C flags for LibXC (default is unset)
#
#LIBXC_CFLAGS=&quot;-I/usr/local/include&quot;

# Fortran flags for LibXC (default is unset)
#
#LIBXC_FCFLAGS=&quot;-I/usr/local/include&quot;

# Link flags for the LibXC library (default is unset)
#
#LIBXC_LDFLAGS=&quot;&quot;

# Library flags for LibXC (default is unset)
#
#LIBXC_LIBS=&quot;-L/usr/local/lib -lxcf90 -lxc&quot;

                       # ------------------------------ #

# LibXML2
# Website: http://www.xmlsoft.org/

# Trigger and install prefix for LibXML2 (default is unset)
#
#with_libxml2=&quot;/usr/local&quot;

# C preprocessor flags for LibXML2 (default is unset)
#
#LIBXML2_CPPFLAGS=&quot;-I/usr/local/include&quot;

# C flags for LibXML2 (default is unset)
#
#LIBXML2_CFLAGS=&quot;-I/usr/local/include&quot;

# Fortran flags for LibXML2 (default is unset)
#
#LIBXML2_FCFLAGS=&quot;-I/usr/local/include&quot;

# Link flags for the LibXML2 library (default is unset)
#
#LIBXML2_LDFLAGS=&quot;&quot;

# Library flags for LibXML2 (default is unset)
#
#LIBXML2_LIBS=&quot;-L/usr/local/lib -lxcf90 -lxc&quot;

                       # ------------------------------ #

# HDF5
# Website: https://www.hdfgroup.org/

# Trigger and install prefix for HDF5 (default is unset)
#
#with_hdf5=&quot;/usr/local&quot;

# Location of the h5cc (or h5pcc) compiler (default is unset)
#
# Note: This parameter can greatly help the build system of ABINIT in
#       selecting the correct version of HDF5.
#
#H5CC=&quot;/opt/local/hdf5-serial/bin/h5cc&quot;

# C preprocessing flags for HDF5 (default is unset)
#
#HDF5_CPPFLAGS=&quot;-I/usr/local/include/hdf5&quot;

# C flags for HDF5 (default is unset)
#
#HDF5_CFLAGS=&quot;-std=c99&quot;

# Fortran flags for HDF5 (default is unset)
#
#HDF5_FCFLAGS=&quot;-I/usr/local/include/hdf5&quot;

# Link flags for HDF5 (default is unset)
#
#HDF5_LDFLAGS=&quot;&quot;

# Library flags for HDF5 (default is unset)
#
#HDF5_LIBS=&quot;-L/usr/local/lib/hdf5 -lhdf5 -lhdf5_hl&quot;

                       # ------------------------------ #

# NetCDF
# Website: http://www.unidata.ucar.edu/software/netcdf/

# Trigger and install prefix for NetCDF (default is unset)
#
#with_netcdf=&quot;/usr/local&quot;

# C preprocessing flags for NetCDF (default is unset)
#
#NETCDF_CPPFLAGS=&quot;-I/usr/local/include/netcdf&quot;

# C flags for NetCDF (default is unset)
#
#NETCDF_CFLAGS=&quot;-std=c99&quot;

# Fortran flags for NetCDF (default is unset)
#
#NETCDF_FCFLAGS=&quot;-I/usr/local/include/netcdf&quot;

# Link flags for NetCDF (default is unset)
#
#NETCDF_LDFLAGS=&quot;&quot;

# Library flags for NetCDF (default is unset)
#
#NETCDF_LIBS=&quot;-L/usr/local/lib/netcdf -lnetcdf&quot;

# Enable Netcdf mode in Abinit (use netcdf as default I/O library,
# change the default values of accesswff)   
#
#enable_netcdf_default=&quot;no&quot;

                       # ------------------------------ #

# NetCDF-Fortran
# Website: http://www.unidata.ucar.edu/software/netcdf/

# Trigger and install prefix for NetCDF-Fortran (default is unset)
#
#with_netcdf_fortran=&quot;/usr/local&quot;

# C preprocessing flags for NetCDF-Fortran (default is unset)
#
#NETCDF_FORTRAN_CPPFLAGS=&quot;-I/usr/local/include/netcdf_fortran&quot;

# C flags for NetCDF-Fortran (default is unset)
#
#NETCDF_FORTRAN_CFLAGS=&quot;&quot;

# Fortran flags for NetCDF-Fortran (default is unset)
#
#NETCDF_FORTRAN_FCFLAGS=&quot;-I/usr/local/include/netcdf_fortran&quot;

# Link flags for NetCDF-Fortran (default is unset)
#
#NETCDF_FORTRAN_LDFLAGS=&quot;&quot;

# Library flags for NetCDF-Fortran (default is unset)
#
#NETCDF_FORTRAN_LIBS=&quot;-L/usr/local/lib/netcdf_fortran -lnetcdff&quot;

                       # ------------------------------ #

# Enable LibPSML support (default is no)
#
#with_libpsml=&quot;yes&quot;

# Fortran flags for the LibPSML library (default is unset)
#
#LIBPSML_FCFLAGS=&quot;-I/usr/local/libpsml-1.1.7/include&quot;

# Link flags for the LibPSML library (default is unset)
#
#LIBPSML_LDFLAGS=&quot;&quot;

# Library flags for LibPSML (default is unset)
#
#LIBPSML_LIBS=&quot;-L/usr/local/libpsml-1.1.7/lib -lpsml&quot;

                       # ------------------------------ #

# TRIQS DMFT library (for CTQMC and rotationally invariant interaction)
# Website: https://triqs.ipht.cnrs.fr/1.x/index.html

# Trigger and install prefix for TRIQS (default is unset)
#
#with_triqs=&quot;/usr/local&quot;

# Allow Fortran programs to call Python
#
#enable_python_invocation=&quot;yes&quot;

# Select the 1.4 version of TRIQS
#
#enable_triqs_v1_4=&quot;yes&quot;

# Select the 2.0 version of TRIQS
#
#enable_triqs_v2_0=&quot;yes&quot;

# C++ flags for the TRIQS library (default is unset)
#
#TRIQS_CXXFLAGS=&quot;-I/usr/local/triqs/include -I/usr/local/cthyb/src/c++&quot;

# Fortran flags for the TRIQS library (default is unset)
#
#TRIQS_FCFLAGS=&quot;-I/usr/local/triqs/include -I/usr/local/cthyb/src/c++&quot;

# Link flags for the TRIQS library (default is unset)
#
#TRIQS_LDFLAGS=&quot;-L/usr/local/triqs/lib -ltriqs -lcthyb_c&quot;

# Link flags for the TRIQS library (default is unset)
#
#TRIQS_LIBS=&quot;-L/usr/local/triqs/lib -ltriqs -lcthyb_c&quot;

                       # ------------------------------ #

# Enable Wannier90 support (default is no)
#
#with_wannier90=&quot;yes&quot;

# Fortran flags for the Wannier90 library (default is unset)
#
#WANNIER90_FCFLAGS=&quot;-I/usr/local/include/wannier90&quot;

# Link flags for the Wannier90 library (default is unset)
#
#WANNIER90_LDFLAGS=&quot;&quot;

# Link flags for the Wannier90 library (default is unset)
#
#WANNIER90_LIBS=&quot;-L${HOME}/lib/wannier90 -lwannier90&quot;

                       # ------------------------------ #

# Enable XMLF90 support (default is no)
#
#with_xmlf90=&quot;yes&quot;

# Fortran flags for the XMLF90 library (default is unset)
#
#XMLF90_FCFLAGS=&quot;-I/usr/local/include&quot;

# Link flags for the LibPSML library (default is unset)
#
#XMLF90_LDFLAGS=&quot;&quot;

# Link flags for the LibPSML library (default is unset)
#
#XMLF90_LIBS=&quot;-L/usr/local/lib -lxmlf90&quot;

                       # ------------------------------ #

# YAKL (Yet Another Kernel Launcher) library
# Small C++ framework used in ABINIT for GPU memory pool allocation
# Website: https://github.com/mrnorman/YAKL

# Enable YAKL support (default is no)
#
#with_yakl=&quot;yes&quot;

# Fortran flags for YAKL (default is unset)
#
#YAKL_FCFLAGS=&quot;-I/usr/local/include/yakl&quot;

# Link flags for YAKL (default is unset)
#
#YAKL_LDFLAGS=&quot;&quot;

# Library flags for YAKL (default is unset)
#
#YAKL_LIBS=&quot;-L/usr/local/lib/yakl -lyakl_fortran_interface&quot;

# -------------------------------------------------------------------------- #
# Profiling and performance analysis                                         #
# -------------------------------------------------------------------------- #

# Enable internal Abinit timer (default is yes)
#
#enable_timer=&quot;no&quot;

# Enable PAPI support (default is no)
#
#with_papi=&quot;yes&quot;

# C preprocessor flags for the PAPI library (default is unset)
#
#PAPI_CPPFLAGS=&quot;-I/usr/local/include/papi&quot;

# C flags for the PAPI library (default is unset)
#
#PAPI_CFLAGS=&quot;-I/usr/local/include/papi&quot;

# Fortran flags for the PAPI library (default is unset)
#
#PAPI_FCFLAGS=&quot;-I/usr/local/include/papi&quot;

# Link flags for the PAPI library (default is unset)
#
#PAPI_LDFLAGS=&quot;&quot;

# Library flags for the PAPI library (default is unset)
#
#PAPI_LIBS=&quot;-L/usr/local/lib/papi -lpapi&quot;

# -------------------------------------------------------------------------- #
# Fallbacks                                                                  #
# -------------------------------------------------------------------------- #

# Fallbacks are external packages pre-built together for Abinit, in order to
# partly compensate for the absence of required external packages. If used,
# they will provide lower reliability, performance and scalability than the
# proper installation of the full-fledged corresponding packages. In any case,
# they should not be used in production.
#
# Fallbacks are enabled when the &quot;with_fallbacks&quot; option below points to
# an existing and readable directory. If this is not the case, failed
# detections of external packages will cause configure to abort.
#
# Example: if you set with_fallbacks=&quot;/path/to/fallbacks&quot;, the
# build system of Abinit will look for:
#
#   * executables in /path/to/fallbacks/bin/
#   * C headers and Fortran modules in /path/to/fallbacks/include/
#   * libraries in /path/to/fallbacks/lib/
#
# when it cannot detect properly installed external packages.
#
# Please note that this mechanism will work only if you have built and
# installed the fallbacks you need beforehand. You can have a look at
# the following helper script after running configure for more
# information:
#
#   ~abinit-builddir/fallbacks/build-abinit-fallbacks.sh
#
# Comprehensive documentation about how to use external packages properly
# and build fallbacks can be found on the Abinit Wiki, at:
#
#   https://wiki.abinit.org/
#

# Prefix for already installed fallbacks (default is unset)
#
#with_fallbacks=&quot;/opt/abinit-dev/fallbacks/gnu/4.9/mpi&quot;

# -------------------------------------------------------------------------- #
# Build workflow                                                             #
# -------------------------------------------------------------------------- #

# Note: if you do not know what the following is about, just leave it unset.

# Use external ABINIT Common (default is no)
#
#with_abinit_common=&quot;yes&quot;

# Fortran flags for ABINIT Common (default is unset)
#
#ABINIT_COMMON_FCFLAGS=&quot;-I/usr/local/include/abinit_common&quot;

# Link flags for ABINIT Common (default is unset)
#
#ABINIT_COMMON_LDFLAGS=&quot;&quot;

# Library flags for ABINIT Common (default is unset)
#
#ABINIT_COMMON_LIBS=&quot;-L${HOME}/abinit/lib -labinit_common&quot;

                       # ------------------------------ #

# Use external LibPAW (default is no)
#
#with_libpaw=&quot;yes&quot;

# C preprocessing flags for LibPAW (default is unset)
#
#LIBPAW_CPPFLAGS=&quot;-I/usr/local/include/libpaw&quot;

# C flags for LibPAW (default is unset)
#
#LIBPAW_CFLAGS=&quot;-std=c99&quot;

# Fortran flags for LibPAW (default is unset)
#
#LIBPAW_FCFLAGS=&quot;-I/usr/local/include/libpaw&quot;

# Link flags for LibPAW (default is unset)
#
#LIBPAW_LDFLAGS=&quot;&quot;

# Library flags for LibPAW (default is unset)
#
#LIBPAW_LIBS=&quot;-L${HOME}/abinit_shared/lib -lpaw&quot;

# -------------------------------------------------------------------------- #
# Developer options                                                          #
# -------------------------------------------------------------------------- #

# Note: all the following options are disabled by default because they
#       enable the build of highly experimental code (i.e. they have
#       the complementary default values to those displayed below)
#
# Uncomment the following lines at your own risks

# Enable optimized cRPA build for ifort &lt;=17 (routerovitch)
#
#enable_crpa_optim=&quot;yes&quot;

# Enable double precision for GW calculations (gmatteo)
#
#enable_gw_dpc=&quot;yes&quot;

# Use tetrahedrons from Libtetra (torrent)
#
#enable_libtetra=&quot;yes&quot;

# Enable lotf (mancini)
#
#enable_lotf=&quot;yes&quot;

# Enable memory profiling (waroquiers)
#
#enable_memory_profiling=&quot;yes&quot;

# Enable OpenMP (gmatteo, torrent)
#
#enable_openmp=&quot;yes&quot;

# Enable OpenMP GPU offload (sarrautem, torrent)
#
#enable_openmp_offload=&quot;yes&quot;

# Enable ZDOTC and ZDOTU bugfix (gmatteo)
#
#enable_zdot_bugfix=&quot;yes&quot;

# Activate workaround for buggy MPI interfaces (not having interfaces for scalars)
#
#enable_mpi_interfaces_bugfix=&quot;yes&quot;

# -------------------------------------------------------------------------- #
# Maintainer options                                                         #
# -------------------------------------------------------------------------- #

# Fortran compiler vendor to be used by the build system (default is unset)
#
# Note: do not use if you do not know what it is about
#
#with_fc_vendor=&quot;dummy&quot;

# Fortran compiler version to be used by the build system (default is unset)
#
# Note: do not use if you do not know what it is about
#
#with_fc_version=&quot;0.0&quot;

# Build debugging instructions present in the source code
#
#enable_source_debug=&quot;yes&quot;

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-b87cb3b1-1b60-4ee0-a0ed-6d4745610253", "#uuid-9d399aae-e550-4805-b319-c781cf29fb5d") }); </script>

<p>Copy the content of the example in <em>myconf.ac9</em>, then run:</p>
<div class="highlight"><pre><span></span><code>../configure --with-config-file<span class="o">=</span><span class="s2">&quot;myconf.ac9&quot;</span>
</code></pre></div>
<p>If everything goes smoothly, you should obtain the following summary:</p>
<div class="highlight"><pre><span></span><code>==============================================================================
<span class="gh">=== Final remarks                                                          ===</span>
<span class="gh">==============================================================================</span>


<span class="gu">Core build parameters</span>
<span class="gu">---------------------</span>

  <span class="k">*</span> C compiler       : gnu version 5.3
  <span class="k">*</span> Fortran compiler : gnu version 5.3
  <span class="k">*</span> architecture     : intel xeon (64 bits)
  <span class="k">*</span> debugging        : basic
  <span class="k">*</span> optimizations    : standard

  <span class="k">*</span> OpenMP enabled   : no (collapse: ignored)
  <span class="k">*</span> MPI    enabled   : yes (flavor: auto)
  <span class="k">*</span> MPI    in-place  : no
  <span class="k">*</span> MPI-IO enabled   : yes
  <span class="k">*</span> GPU    enabled   : no (flavor: none)

  <span class="k">*</span> LibXML2 enabled  : no
  <span class="k">*</span> LibPSML enabled  : no
  <span class="k">*</span> XMLF90  enabled  : no
  <span class="k">*</span> HDF5 enabled     : yes (MPI support: yes)
  <span class="k">*</span> NetCDF enabled   : yes (MPI support: yes)
  <span class="k">*</span> NetCDF-F enabled : yes (MPI support: yes)

  <span class="k">*</span> FFT flavor       : fftw3 (libs: user-defined)
  <span class="k">*</span> LINALG flavor    : openblas (libs: user-defined)

  <span class="k">*</span> Build workflow   : monolith

0 deprecated options have been used:.

Configuration complete.
You may now type &quot;make&quot; to build Abinit.
(or &quot;make -j&lt;n&gt;&quot;, where &lt;n&gt; is the number of available processors)
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Please take your time to read carefully the final summary and <strong>make sure you are getting what you expect</strong>.
A lot of typos or configuration errors can be easily spotted at this level.</p>
<p>You might then find useful to have a look at other examples available <a href="/developers/autoconf_examples">in this page</a>.
Additional configuration files for clusters can be found in the
<a href="https://github.com/abinit/abiconfig">abiconfig package</a>.</p>
</div>
<p>The <em>configure</em> script has generated several <strong>Makefiles</strong> required by <em>make</em> as well as the <strong>config.h</strong>
include file with all the pre-processing options that will be used to build ABINIT.
This file is included in every ABINIT source file and it defines the features that will be activated or deactivated
at compilation-time depending on the libraries available on your machine.
Let&rsquo;s have a look at a selected portion of <strong>config.h</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* Define to 1 if you have a working MPI installation. */</span><span class="w"></span>
<span class="cp">#define HAVE_MPI 1</span>

<span class="cm">/* Define to 1 if you have a MPI-1 implementation (obsolete, broken). */</span><span class="w"></span>
<span class="cm">/* #undef HAVE_MPI1 */</span><span class="w"></span>

<span class="cm">/* Define to 1 if you have a MPI-2 implementation. */</span><span class="w"></span>
<span class="cp">#define HAVE_MPI2 1</span>

<span class="cm">/* Define to 1 if you want MPI I/O support. */</span><span class="w"></span>
<span class="cp">#define HAVE_MPI_IO 1</span>

<span class="cm">/* Define to 1 if you have a parallel NetCDF library. */</span><span class="w"></span>
<span class="cm">/* #undef HAVE_NETCDF_MPI */</span><span class="w"></span>
</code></pre></div>
<p>This file tells us that</p>
<ul>
<li>we are building ABINIT with MPI support</li>
<li>we have a library implementing the MPI2 specifications</li>
<li>our MPI implementation supports parallel MPI-IO. Note that this does not mean that <em>netcdf</em> supports MPI-IO.
  In this example, indeed, <strong>HAVE_NETCDF_MPI is undefined</strong> and this means the library does not have
  parallel-IO capabilities.</li>
</ul>
<p>Of course, end users are mainly concerned with the final summary reported
by the <em>configure</em> script to understand whether
a particular feature has been activated or not but more advanced users may
find the content of <code>config.h</code> valuable to understand what&rsquo;s going on.</p>
<p>Now we can finally compile the package with e.g. <em>make -j2</em>.
If the compilation completes successfully (🙌), you should end up with a bunch of executables inside <em>src/98_main</em>.
Note, however, that the fact that the compilation completed successfully <strong>does not necessarily imply that
the executables will work as expected</strong> as there are many different things that can go
<a href="https://en.wikiquote.org/wiki/Murphy%27s_law">wrong at runtime</a>.</p>
<p>First of all, let&rsquo;s try to execute:</p>
<div class="highlight"><pre><span></span><code>abinit --version
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If this is a parallel build, you may need to use</p>
<div class="highlight"><pre><span></span><code>mpirun -n <span class="m">1</span> abinit --version
</code></pre></div>
<p>even for a sequential run as certain MPI libraries are not able to bootstrap the MPI library
without <em>mpirun</em> (<em>mpiexec</em>). On some clusters with Slurm, the syadmin may ask you to use
<em>srun</em> instead of <em>mpirun</em>.</p>
</div>
<p>To get the summary of options activated during the build, run <em>abinit</em> with the <code>-b</code> option
(or <code>--build</code> if you prefer the verbose version)</p>
<div class="highlight"><pre><span></span><code>./src/98_main/abinit -b
</code></pre></div>
<p>If the executable does not crash (🙌), you may want to execute</p>
<div class="highlight"><pre><span></span><code>make test_fast
</code></pre></div>
<p>to run some basic tests.
If something goes wrong when executing the binary or when running the tests,
checkout the <a href="#troubleshooting">Troubleshooting</a> section for possible solutions.</p>
<p>Finally, you may want to execute the <em>runtests.py</em> python script in the <em>tests</em> directory
in order to validate the build before running production calculations:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> tests
../../tests/runtests.py v1 -j4
</code></pre></div>
<p>As usual, use:</p>
<div class="highlight"><pre><span></span><code>../../tests/runtests.py --help
</code></pre></div>
<p>to list the available options.
A more detailed discussion is given in <a href="/developers/testsuite_howto">this page</a>.</p>
<p><a href="https://asciinema.org/a/40324"><img alt="asciicast" src="https://asciinema.org/a/40324.png" /></a></p>
<h3 id="dynamic-libraries-and-ldd">Dynamic libraries and ldd<a class="headerlink" href="#dynamic-libraries-and-ldd" title="Permanent link">&para;</a></h3>
<p>Since we decided to compile with <strong>dynamic linking</strong>, the external libraries are not included in the final executables.
Actually, the libraries will be loaded by the Operating System (OS) at runtime when we execute the binary.
The OS will search for dynamic libraries using the list of directories specified
in <code>$LD_LIBRARY_PATH</code> (<code>$DYLD_LIBRARY_PATH</code> for MacOs).</p>
<p>A typical mistake is to execute <em>abinit</em> with a wrong <code>$LD_LIBRARY_PATH</code> that is either <strong>empty or
different from the one used when compiling the code</strong>
(if it&rsquo;s different and it works, I assume you know what you are doing so you should not be reading this section!)</p>
<p>On Linux, one can use the <em>ldd</em> tool to print the shared objects (shared libraries) required by each
program or shared object specified on the command line:</p>
<div class="highlight"><pre><span></span><code>ldd src/98_main/abinit

    linux-vdso.so.1 <span class="o">(</span>0x00007fffbe7a4000<span class="o">)</span>
    libopenblas.so.0 <span class="o">=</span>&gt; /home/gmatteo/local/lib/libopenblas.so.0 <span class="o">(</span>0x00007fc892155000<span class="o">)</span>
    libnetcdff.so.7 <span class="o">=</span>&gt; /home/gmatteo/local/lib/libnetcdff.so.7 <span class="o">(</span>0x00007fc891ede000<span class="o">)</span>
    libnetcdf.so.15 <span class="o">=</span>&gt; /home/gmatteo/local/lib/libnetcdf.so.15 <span class="o">(</span>0x00007fc891b62000<span class="o">)</span>
    libhdf5_hl.so.200 <span class="o">=</span>&gt; /home/gmatteo/local/lib/libhdf5_hl.so.200 <span class="o">(</span>0x00007fc89193c000<span class="o">)</span>
    libhdf5.so.200 <span class="o">=</span>&gt; /home/gmatteo/local/lib/libhdf5.so.200 <span class="o">(</span>0x00007fc891199000<span class="o">)</span>
    libz.so.1 <span class="o">=</span>&gt; /lib64/libz.so.1 <span class="o">(</span>0x00007fc890f74000<span class="o">)</span>
    libdl.so.2 <span class="o">=</span>&gt; /lib64/libdl.so.2 <span class="o">(</span>0x00007fc890d70000<span class="o">)</span>
    libgfortran.so.3 <span class="o">=</span>&gt; /lib64/libgfortran.so.3 <span class="o">(</span>0x00007fc890a43000<span class="o">)</span>
    libm.so.6 <span class="o">=</span>&gt; /lib64/libm.so.6 <span class="o">(</span>0x00007fc890741000<span class="o">)</span>
    libmpifort.so.12 <span class="o">=</span>&gt; /home/gmatteo/local/lib/libmpifort.so.12 <span class="o">(</span>0x00007fc89050a000<span class="o">)</span>
    libmpi.so.12 <span class="o">=</span>&gt; /home/gmatteo/local/lib/libmpi.so.12 <span class="o">(</span>0x00007fc88ffb9000<span class="o">)</span>
    libquadmath.so.0 <span class="o">=</span>&gt; /lib64/libquadmath.so.0 <span class="o">(</span>0x00007fc88fd7a000<span class="o">)</span>
    libgcc_s.so.1 <span class="o">=</span>&gt; /lib64/libgcc_s.so.1 <span class="o">(</span>0x00007fc88fb63000<span class="o">)</span>
    libc.so.6 <span class="o">=</span>&gt; /lib64/libc.so.6 <span class="o">(</span>0x00007fc88f7a1000<span class="o">)</span>
    ...
    &lt;snip&gt;
</code></pre></div>
<p>As expected, our executable uses the  <em>openblas</em>, <em>netcdf</em>, <em>hdf5</em>, <em>mpi</em> libraries installed in $HOME/local/lib plus
other basic libs coming from <code>lib64</code>(e.g. <em>libgfortran</em>) added by the compiler.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>On macOS, replace <em>ldd</em> with <em>otool</em> and the syntax:</p>
<div class="highlight"><pre><span></span><code>otool -L abinit
</code></pre></div>
<p>If you see entries like:</p>
<div class="highlight"><pre><span></span><code>/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib <span class="o">(</span>compatibility version <span class="m">1</span>.0.0, current version <span class="m">1</span>.0.0<span class="o">)</span>
/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib <span class="o">(</span>compatibility version <span class="m">1</span>.0.0, current version <span class="m">1</span>.0.0<span class="o">)</span>
</code></pre></div>
<p>it means that you are linking against <strong>macOS VECLIB</strong>.
In this case, make sure to use <code>--enable-zdot-bugfix="yes"</code> when configuring the package
otherwise the code will crash at runtime due to ABI incompatibility (calling conventions
for functions returning complex values).
Did I tell you that macOS does not care about Fortran?
If you wonder about the difference between API and ABI, please read this
<a href="https://stackoverflow.com/questions/2171177/what-is-an-application-binary-interface-abi">stackoverflow post</a>.</p>
</div>
<p>To understand why LD_LIBRARY_PATH is so important, let&rsquo;s try to reset the value of this variable with</p>
<div class="highlight"><pre><span></span><code><span class="nb">unset</span> LD_LIBRARY_PATH
<span class="nb">echo</span> <span class="nv">$LD_LIBRARY_PATH</span>
</code></pre></div>
<p>then rerun <em>ldd</em> (or <em>otool</em>) again.
Do you understand what&rsquo;s happening here?
Why it&rsquo;s not possible to execute <em>abinit</em> with an empty <code>$LD_LIBRARY_PATH</code>?
How would you fix the problem?</p>
<h3 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h3>
<p>Problems can appear at different levels:</p>
<ul>
<li>configuration time</li>
<li>compilation time</li>
<li>runtime <em>i.e.</em> when executing the code</li>
</ul>
<p><strong>Configuration-time errors</strong> are usually due to misconfiguration of the environment, missing (hard) dependencies
or critical problems in the software stack that will make <em>configure</em> abort.
Unfortunately, the error message reported by <em>configure</em> is not always self-explanatory.
To pinpoint the source of the problem you will need to <strong>search for clues in <em>config.log</em></strong>,
especially the error messages associated to the feature/library that is triggering the error.</p>
<p>This is not as easy as it looks since <em>configure</em> sometimes performs multiple tests to detect your architecture
and some of these tests are <strong>supposed to fail</strong>.
As a consequence, not all the error messages reported in <em>config.log</em> are necessarily relevant.
Even if you find the test that makes <em>configure</em> abort, the error message may be obscure and difficult to decipher.
In this case, you can ask for help on the forum but remember to provide enough info on your architecture, the
compilation options and, most importantly, <strong>a copy of <em>config.log</em></strong>.
Without this file, indeed, it is almost impossible to understand what&rsquo;s going on.</p>
<p>An example will help.
Let&rsquo;s assume we are compiling on a cluster using modules provided by our sysadmin.
More specifically, there is an <code>openmpi_intel2013_sp1.1.106</code> module that is supposed to provide
the <em>openmpi</em> implementation of the MPI library compiled with a particular version of the intel compiler
(remember what we said about using the same version of the compiler).
Obviously <strong>we need to load the modules before running configure</strong> in order to setup our environment
so we issue:</p>
<div class="highlight"><pre><span></span><code>module load openmpi_intel2013_sp1.1.106
</code></pre></div>
<p>The module seems to work as no error message is printed to the terminal and <code>which mpicc</code> shows
that the compiler has been added to $PATH.
At this point we try to configure ABINIT with:</p>
<div class="highlight"><pre><span></span><code><span class="nv">with_mpi_prefix</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MPI_HOME</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<p>where <code>$MPI_HOME</code> is a environment variable set by <em>module load</em> (use e.g. <code>env | grep MPI</code>).
Unfortunately, the <em>configure</em> script aborts at the very beginning complaining
that the C compiler does not work!</p>
<div class="highlight"><pre><span></span><code>checking for gcc... /cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/bin/mpicc
checking for C compiler default output file name...
configure: error: in `/home/gmatteo/abinit/build&#39;:
configure: error: C compiler cannot create executables
See `config.log&#39; for more details.
</code></pre></div>
<p>Let&rsquo;s analyze the output of <em>configure</em>.
The line:</p>
<div class="highlight"><pre><span></span><code>checking for gcc... /cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/bin/mpicc
</code></pre></div>
<p>indicates that <em>configure</em> was able to find <em>mpicc</em> in <em>${MPI_HOME}/bin</em>.
Then an internal test is executed to make sure the wrapper can compile a rather simple Fortran program using MPI
but the test fails and <em>configure</em> aborts immediately with the pretty explanatory message:</p>
<div class="highlight"><pre><span></span><code>configure: error: C compiler cannot create executables
See `config.log&#39; for more details.
</code></pre></div>
<p>If we want to understand why <em>configure</em> failed, we have to <strong>open <em>config.log</em> in the editor</strong>
and search for error messages towards the end of the log file.
For example one can search for the string &ldquo;C compiler cannot create executables&rdquo;.
Immediately above this line, we find the following section:</p>
<details class="note"><summary>config.log</summary><div class="highlight"><pre><span></span><code>configure:12104: checking whether the C compiler works
configure:12126: /cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/bin/mpicc conftest.c  &gt;<span class="p">&amp;</span><span class="m">5</span>
/cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/lib/libmpi.so: undefined reference to <span class="sb">`</span>ibv_reg_xrc_rcv_qp@IBVERBS_1.1<span class="s1">&#39;</span>
<span class="s1">/cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/lib/libmpi.so: undefined reference to `ibv_modify_xrc_rcv_qp@IBVERBS_1.1&#39;</span>
/cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/lib/libmpi.so: undefined reference to <span class="sb">`</span>ibv_open_xrc_domain@IBVERBS_1.1<span class="s1">&#39;</span>
<span class="s1">/cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/lib/libmpi.so: undefined reference to `ibv_unreg_xrc_rcv_qp@IBVERBS_1.1&#39;</span>
/cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/lib/libmpi.so: undefined reference to <span class="sb">`</span>ibv_query_xrc_rcv_qp@IBVERBS_1.1<span class="s1">&#39;</span>
<span class="s1">/cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/lib/libmpi.so: undefined reference to `ibv_create_xrc_rcv_qp@IBVERBS_1.1&#39;</span>
/cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/lib/libmpi.so: undefined reference to <span class="sb">`</span>ibv_create_xrc_srq@IBVERBS_1.1<span class="s1">&#39;</span>
<span class="s1">/cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/lib/libmpi.so: undefined reference to `ibv_close_xrc_domain@IBVERBS_1.1&#39;</span>
configure:12130: <span class="nv">$?</span> <span class="o">=</span> <span class="m">1</span>
configure:12168: result: no
configure: failed program was:
<span class="p">|</span> /* confdefs.h */
<span class="p">|</span> <span class="c1">#define PACKAGE_NAME &quot;ABINIT&quot;</span>
<span class="p">|</span> <span class="c1">#define PACKAGE_TARNAME &quot;abinit&quot;</span>
<span class="p">|</span> <span class="c1">#define PACKAGE_VERSION &quot;9.1.2&quot;</span>
<span class="p">|</span> <span class="c1">#define PACKAGE_STRING &quot;ABINIT 9.1.2&quot;</span>
<span class="p">|</span> <span class="c1">#define PACKAGE_BUGREPORT &quot;https://bugs.launchpad.net/abinit/&quot;</span>
<span class="p">|</span> <span class="c1">#define PACKAGE_URL &quot;&quot;</span>
<span class="p">|</span> <span class="c1">#define PACKAGE &quot;abinit&quot;</span>
<span class="p">|</span> <span class="c1">#define VERSION &quot;9.1.2&quot;</span>
<span class="p">|</span> <span class="c1">#define ABINIT_VERSION &quot;9.1.2&quot;</span>
<span class="p">|</span> <span class="c1">#define ABINIT_VERSION_MAJOR &quot;9&quot;</span>
<span class="p">|</span> <span class="c1">#define ABINIT_VERSION_MINOR &quot;1&quot;</span>
<span class="p">|</span> <span class="c1">#define ABINIT_VERSION_MICRO &quot;2&quot;</span>
<span class="p">|</span> <span class="c1">#define ABINIT_VERSION_BUILD &quot;20200824&quot;</span>
<span class="p">|</span> <span class="c1">#define ABINIT_VERSION_BASE &quot;9.1&quot;</span>
<span class="p">|</span> <span class="c1">#define HAVE_OS_LINUX 1</span>
<span class="p">|</span> /* end confdefs.h.  */
<span class="p">|</span>
<span class="p">|</span> int
<span class="p">|</span> main <span class="o">()</span>
<span class="p">|</span> <span class="o">{</span>
<span class="p">|</span>
<span class="p">|</span>   <span class="p">;</span>
<span class="p">|</span>   <span class="k">return</span> <span class="m">0</span><span class="p">;</span>
<span class="p">|</span> <span class="o">}</span>
</code></pre></div>
</details>
<p>The line</p>
<div class="highlight"><pre><span></span><code>configure:12126: /cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/bin/mpicc conftest.c  &gt;<span class="p">&amp;</span><span class="m">5</span>
</code></pre></div>
<p>tells us that <em>configure</em> tried to compile a C file named <em>conftest.c</em> and that the return value
stored in the <code>$?</code> shell variable is non-zero thus indicating failure:</p>
<div class="highlight"><pre><span></span><code>configure:12130: <span class="nv">$?</span> <span class="o">=</span> <span class="m">1</span>
configure:12168: result: no
</code></pre></div>
<p>The failing program (the C main after the line &ldquo;configure: failed program was:&rdquo;)
is a rather simple piece of code and our <em>mpicc</em> compiler is not able to compile it!
If we look more carefully at the lines after the invocation of <em>mpicc</em>,
we see lots of undefined references to functions of the <em>libibverbs</em> library:</p>
<div class="highlight"><pre><span></span><code>configure:12126: /cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/bin/mpicc conftest.c  &gt;<span class="p">&amp;</span><span class="m">5</span>
/cm/shared/apps/openmpi/1.7.5/intel2013_sp1.1.106/lib/libmpi.so: undefined reference to <span class="sb">`</span>ibv_reg_xrc_rcv_qp@IBVERBS_1.1
</code></pre></div>
<p>This looks like some mess in the system configuration and not necessarily a problem in the ABINIT build system.
Perhaps there have been changes to the environment, maybe a system upgrade or the module is simply broken.
In this case you should send the <em>config.log</em> to the sysadmin so that he/she can fix the problem or just use
another more recent module.</p>
<p>Obviously, one can encounter cases in which modules are properly configured yet the <em>configure</em> script aborts
because it does not know how to deal with your software stack.
In both cases, <strong><em>config.log</em> is key to pinpoint the problem</strong> and sometimes you will find that
the problem is rather simple to solve.
For instance, you are using a Fortran module files produced by <em>gfortran</em> while trying to compile with the
intel compiler or perhaps you are trying to use modules produced by a different version of the same compiler.
Perhaps you forgot to add the include directory required by an external library and the compiler
cannot find the include file or maybe there is a typo in the configuration options.
The take-home message is that several mistakes can be detected by just <strong>inspecting the log messages</strong>
reported in <em>configure.log</em> if you know how to search for them.</p>
<p><strong>Compilation-time errors</strong> are usually due to syntax errors, portability issues or
Fortran constructs that are not supported by that particular version of the compiler.
In the first two cases, please report the problem on the forum.
In the later case, you will need a more recent version of the compiler.
Sometimes the compilation aborts with an <strong>internal compiler error</strong> that should be considered
as a <strong>bug in the compiler</strong> rather than an error in the ABINIT source code.
Decreasing the optimization level when compiling the particular routine that triggers the error
(use -O1 or even -O0 for the most problematic cases) may solve the problem else
try a more recent version of the compiler.
If you have made non-trivial changes in code (modifications in the datatypes/interfaces),
run <code>make clean</code> and recompile.</p>
<p><strong>Runtime errors</strong> are more difficult to fix as they may require the use of a debugger and some basic
understanding of <a href="https://en.wikipedia.org/wiki/Signal_(IPC)">Linux signals</a>.
Here we focus on two common scenarios: <strong>SIGILL</strong> and <strong>SIGSEGV</strong>.</p>
<p>If the code raises the <strong>SIGILL</strong> signal, it means that the CPU attempted to execute
an instruction it didn&rsquo;t understand.
Very likely, your executables/libraries have been compiled for the <strong>wrong architecture</strong>.
This may happen on clusters when the CPU family available on the frontend differs
from the one available on the compute node and aggressive optimization options (-O3, -march, -xHost, etc) are used.
Removing the optimization options and using the much safer -O2 level may help.
Alternatively, one can <strong>configure and compile</strong> the source directly on the compute node or use compilation options
compatible both with the frontend and the compute node (ask your sysadmin for details).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Never ever run calculations on CPUs belonging to different families unless
you know what you are doing.
Many MPI codes assume reproducibility at the binary level:
on different MPI processes the same set of bits in input should produce the same set of bits in output.
If you are running on a heterogeneous cluster, select the queue with the same CPU family
and make sure the code has been compiled with options that are compatibile with the compute node.</p>
</div>
<p>Segmentation faults (<strong>SIGSEGV</strong>) are usually due to bugs in the code but they may also be
triggered by non-portable code or misconfiguration of the software stack.
When reporting this kind of problem on the forum, please add an input file so that developers
can try to reproduce the problem.
Keep in mind, however, that the problem may not be reproducible on other architectures.
The ideal solution would be to run the code under the control of the debugger,
use the backtrace to locate the line of code where the segmentation fault occurs and then
attach the backtrace to your issue on the forum.</p>
<details class="note"><summary>How to run gdb</summary><p>Using the debugger in sequential is really simple.
First of all, make sure the code have been compiled with the <code>-g</code> option
to generate <strong>source-level debug information</strong>.
To use the <code>gdb</code> GNU debugger, perform the following operations:</p>
<ol>
<li>
<p>Load the executable in the GNU debugger using the syntax:</p>
<div class="highlight"><pre><span></span><code>gdb path_to_abinit_executable
</code></pre></div>
</li>
<li>
<p>Run the code with the <code>run</code> command and pass the input file as argument:</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span> run t02.in
</code></pre></div>
</li>
<li>
<p>Wait for the error e.g. SIGSEGV, then print the <strong>backtrace</strong> with:</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span> bt
</code></pre></div>
</li>
</ol>
<p>PS: avoid debugging code compiled with <code>-O3</code> or <code>-Ofast</code> as the backtrace may not be reliable.
Sometimes, even <code>-O2</code> (default) is not reliable and you have to resort to print statements
and bisection to braket the problematic piece of code.</p>
</details>
<h2 id="how-to-compile-abinit-on-a-cluster-with-the-intel-toolchain-and-modules">How to compile ABINIT on a cluster with the intel toolchain and modules<a class="headerlink" href="#how-to-compile-abinit-on-a-cluster-with-the-intel-toolchain-and-modules" title="Permanent link">&para;</a></h2>
<p>On intel-based clusters, we suggest to compile ABINIT with the intel compilers (<strong><em>icc</em></strong> and <strong><em>ifort</em></strong>)
and MKL in order to achieve better performance.
The MKL library, indeed, provides highly-optimized implementations for BLAS, LAPACK, FFT, and SCALAPACK
that can lead to a <strong>significant speedup</strong> while simplifying considerably the compilation process.
As concerns MPI, intel provides its own implementation (<strong>Intel MPI</strong>) but it is also possible to employ
<em>openmpi</em> or <em>mpich</em> provided these libraries have been compiled with the <strong>same intel compilers</strong>.</p>
<p>In what follows, we assume a cluster in which scientific software is managed
with <strong>modules</strong> and the <a href="https://easybuild.readthedocs.io/en/latest/index.html">EasyBuild</a> framework.
Before proceeding with the next steps, it is worth summarizing the most important <em>module</em> commands.</p>
<details class="note"><summary>module commands</summary><p>To list the modules installed on the cluster, use:</p>
<div class="highlight"><pre><span></span><code>module avail
</code></pre></div>
<p>The syntax to load the module <code>MODULE_NAME</code> is:</p>
<div class="highlight"><pre><span></span><code>module load MODULE_NAME
</code></pre></div>
<p>while</p>
<div class="highlight"><pre><span></span><code>module list
</code></pre></div>
<p>prints the list of modules currently loaded.</p>
<p>To list all modules containing &ldquo;string&rdquo;, use:</p>
<div class="highlight"><pre><span></span><code>module spider string  <span class="c1"># requires LMOD with LUA</span>
</code></pre></div>
<p>Finally,</p>
<div class="highlight"><pre><span></span><code>module show MODULE_NAME
</code></pre></div>
<p>shows the commands in the module file (useful for debugging).
For a more complete introduction to environment modules, please consult
<a href="https://support.ceci-hpc.be/doc/_contents/UsingSoftwareAndLibraries/UsingPreInstalledSoftware/index.html">this page</a>.</p>
</details>
<!--
The first thing we should do is to locate the module(s) proving MKL and the MPI library.
Sorry for repeating it again but this step is crucial as the MPI module
will define our toolchain (MPI library + compilers)
and all the other libraries **must be compiled with the same toolchain**.
-->

<p>On my cluster, I can activate <strong>intel MPI</strong> by executing:</p>
<div class="highlight"><pre><span></span><code>module load releases/2018b
module load intel/2018b
module load iimpi/2018b
</code></pre></div>
<p>to load the 2018b intel MPI <a href="https://easybuild.readthedocs.io/en/latest/Common-toolchains.html">EasyBuild toolchain</a>.
On your cluster, you may need to load different modules but the effect
at the level of the shell environment should be the same.
More specifically, <strong>mpiifort</strong> is now in <strong>PATH</strong> (note how <em>mpiifort</em> wraps intel <em>ifort</em>):</p>
<div class="highlight"><pre><span></span><code>mpiifort -v
mpiifort <span class="k">for</span> the Intel<span class="o">(</span>R<span class="o">)</span> MPI Library <span class="m">2018</span> Update <span class="m">3</span> <span class="k">for</span> Linux*
Copyright<span class="o">(</span>C<span class="o">)</span> <span class="m">2003</span>-2018, Intel Corporation.  All rights reserved.
ifort version <span class="m">18</span>.0.3  
</code></pre></div>
<p>the directories with the libraries required by the compiler/MPI have been added
to <strong>LD_LIBRARY_PATH</strong> while <strong>CPATH</strong> stores the locations to search for include file.
Last but not least, the env should now define <a href="https://software.intel.com/content/www/us/en/develop/documentation/mpi-developer-reference-windows/top/environment-variable-reference/compilation-environment-variables.html">intel-specific variables</a>
whose name starts with <code>I_</code>:</p>
<div class="highlight"><pre><span></span><code>$ env <span class="p">|</span> grep I_
<span class="nv">I_MPI_ROOT</span><span class="o">=</span>/opt/cecisw/arch/easybuild/2018b/software/impi/2018.3.222-iccifort-2018.3.222-GCC-7.3.0-2.30
</code></pre></div>
<p>Since <strong>I_MPI_ROOT</strong> points to the installation directory of intel MPI, 
we can use this environment variable to tell <em>configure</em> how to locate our MPI installation:</p>
<div class="highlight"><pre><span></span><code><span class="nv">with_mpi</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">I_MPI_ROOT</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="nv">FC</span><span class="o">=</span><span class="s2">&quot;mpiifort&quot;</span>  <span class="c1"># Use intel wrappers. Important!</span>
<span class="nv">CC</span><span class="o">=</span><span class="s2">&quot;mpiicc&quot;</span>    <span class="c1"># See warning below</span>
<span class="nv">CXX</span><span class="o">=</span><span class="s2">&quot;mpiicpc&quot;</span>

<span class="c1"># with_optim_flavor=&quot;aggressive&quot;</span>
<span class="c1"># FCFLAGS=&quot;-g -O2&quot;</span>
</code></pre></div>
<p>Optionally, you can use <code>with_optim_flavor="aggressive</code> to let <em>configure</em> select compilations
options tuned for performance or set the options explicitly via <strong>FCFLAGS</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Intel MPI installs <strong>two sets of MPI wrappers</strong>.
(<em>mpiicc</em>, <em>mpicpc</em>, <em>mpiifort</em>) and (<em>mpicc</em>, <em>mpicxx</em>, <em>mpif90</em>) that use
Intel compilers and GNU compilers, respectively.
Use the <code>-show</code> option (e.g. <code>mpif90 -show</code>) to display the underlying compiler.
As expected</p>
<div class="highlight"><pre><span></span><code>$ mpif90 -v

mpif90 <span class="k">for</span> the Intel<span class="o">(</span>R<span class="o">)</span> MPI Library <span class="m">2018</span> Update <span class="m">3</span> <span class="k">for</span> Linux*
<span class="nv">COLLECT_GCC</span><span class="o">=</span>gfortran
&lt;snip&gt;
Thread model: posix
gcc version <span class="m">7</span>.3.0 <span class="o">(</span>GCC<span class="o">)</span>
</code></pre></div>
<p>shows that <code>mpif90</code> wraps GNU <em>gfortran</em>.
Unless you really need to use GNU compilers, we strongly suggest the wrappers
based on the Intel compilers (<strong><em>mpiicc</em></strong>, <strong><em>mpicpc</em></strong>, <strong><em>mpiifort</em></strong>)</p>
</div>
<p>If we run <em>configure</em> with these options, we should see a section at the beginning
in which the build system is testing basic capabilities of the Fortran compiler.
If <em>configure</em> stops at this level it means there&rsquo;s a severe problem with your toolchain.</p>
<div class="highlight"><pre><span></span><code> ==============================================================================
 === Fortran support                                                        ===
 ==============================================================================

checking for mpiifort... /opt/cecisw/arch/easybuild/2018b/software/impi/2018.3.222-iccifort-2018.3.222-GCC-7.3.0-2.30/bin64/mpiifort
checking whether we are using the GNU Fortran compiler... no
checking whether mpiifort accepts -g... yes
checking which type of Fortran compiler we have... intel 18.0
</code></pre></div>
<p>Then we have a section in which <em>configure</em> tests the MPI implementation:</p>
<details class="note"><summary>Multicore architecture support</summary><div class="highlight"><pre><span></span><code>==============================================================================
=== Multicore architecture support                                         ===
==============================================================================

checking whether to enable OpenMP support... no
checking whether to enable MPI... yes
checking how MPI parameters have been set... yon
checking whether the MPI C compiler is set... yes
checking whether the MPI C++ compiler is set... yes
checking whether the MPI Fortran compiler is set... yes
checking for MPI C preprocessing flags...
checking for MPI C flags...
checking for MPI C++ flags...
checking for MPI Fortran flags...
checking for MPI linker flags...
checking for MPI library flags...
checking whether the MPI C API works... yes
checking whether the MPI C environment works... yes
checking whether the MPI C++ API works... yes
checking whether the MPI C++ environment works... yes
checking whether the MPI Fortran API works... yes
checking whether the MPI Fortran environment works... yes
checking whether to build MPI I/O code... auto
checking which level of MPI is supported by the Fortran compiler... 2
configure: forcing MPI-2 standard level support
checking whether the MPI library supports MPI_INTEGER16... yes
checking whether the MPI library supports MPI_CREATE_TYPE_STRUCT... yes
checking whether the MPI library supports MPI_IBCAST (MPI3)... yes
checking whether the MPI library supports MPI_IALLGATHER (MPI3)... yes
checking whether the MPI library supports MPI_IALLTOALL (MPI3)... yes
checking whether the MPI library supports MPI_IALLTOALLV (MPI3)... yes
checking whether the MPI library supports MPI_IGATHERV (MPI3)... yes
checking whether the MPI library supports MPI_IALLREDUCE (MPI3)... yes
configure:
configure: dumping all MPI parameters for diagnostics
configure: ------------------------------------------
configure:
configure: Configure options:
configure:
configure:   * enable_mpi_inplace = &#39;&#39;
configure:   * enable_mpi_io      = &#39;&#39;
configure:   * with_mpi           = &#39;yes&#39;
configure:   * with_mpi_level     = &#39;&#39;
configure:
configure: Internal parameters
configure:
configure:   * MPI enabled (required)                       : yes
configure:   * MPI C compiler is set (required)             : yes
configure:   * MPI C compiler works (required)              : yes
configure:   * MPI Fortran compiler is set (required)       : yes
configure:   * MPI Fortran compiler works (required)        : yes
configure:   * MPI environment usable (required)            : yes
configure:   * MPI C++ compiler is set (optional)           : yes
configure:   * MPI C++ compiler works (optional)            : yes
configure:   * MPI-in-place enabled (optional)              : no
configure:   * MPI-IO enabled (optional)                    : yes
configure:   * MPI configuration type (computed)            : yon
configure:   * MPI Fortran level supported (detected)       : 2
configure:   * MPI_Get_library_version available (detected) : unknown
configure:
configure: All required parameters must be set to &#39;yes&#39;.
configure: If not, the configuration and/or the build with
configure: MPI support will very likely fail.
configure:
checking whether to activate GPU support... no
</code></pre></div>
</details>
<p>So far so good. Our compilers and MPI seem to work so we can proceed with
the setup of the external libraries.</p>
<p>On my cluster, <code>module load intel/2018b</code> has also defined the <strong>MKLROOT</strong> env variable</p>
<div class="highlight"><pre><span></span><code>env <span class="p">|</span> grep MKL

<span class="nv">MKLROOT</span><span class="o">=</span>/opt/cecisw/arch/easybuild/2018b/software/imkl/2018.3.222-iimpi-2018b/mkl
<span class="nv">EBVERSIONIMKL</span><span class="o">=</span><span class="m">2018</span>.3.222
</code></pre></div>
<p>that can be used in conjunction with the <strong>highly recommended</strong>
<a href="https://software.intel.com/en-us/articles/intel-mkl-link-line-advisor">mkl-link-line-advisor</a>
to link with MKL. On other clusters, you may need load an <em>mkl</em> module explicitly
(or <em>composerxe</em> or <em>parallel-studio-xe</em>)</p>
<p>Let&rsquo;s now discuss how to configure ABINIT with MKL starting from the simplest cases:</p>
<ul>
<li>BLAS and Lapack from MKL</li>
<li>FFT from MKL DFTI</li>
<li>no Scalapack</li>
<li>no OpenMP threads.</li>
</ul>
<p>These are the options I have to select in the
<a href="https://software.intel.com/en-us/articles/intel-mkl-link-line-advisor">mkl-link-line-advisor</a>
to enable this configuration with my software stack:</p>
<p><img alt="" src="../abinit_build_assets/link_line_advisor.png" /></p>
<p>The options should be self-explanatory.
Perhaps the tricky part is <strong>Select interface layer</strong> where one should select <strong>32-bit integer</strong>.
This simply means that we are compiling and linking code in which default integer is 32-bits wide
(default behaviour).
Note how the threading layer is set to <strong>Sequential</strong> (no OpenMP threads)
and how we chose to <strong>link with MKL libraries explicitly</strong> the get the full
link line and compiler options.</p>
<p>Now we can use these options in our configuration file:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># BLAS/LAPACK with MKL</span>
<span class="nv">with_linalg_flavor</span><span class="o">=</span><span class="s2">&quot;mkl&quot;</span>

<span class="nv">LINALG_CPPFLAGS</span><span class="o">=</span><span class="s2">&quot;-I</span><span class="si">${</span><span class="nv">MKLROOT</span><span class="si">}</span><span class="s2">/include&quot;</span>
<span class="nv">LINALG_FCFLAGS</span><span class="o">=</span><span class="s2">&quot;-I</span><span class="si">${</span><span class="nv">MKLROOT</span><span class="si">}</span><span class="s2">/include&quot;</span>
<span class="nv">LINALG_LIBS</span><span class="o">=</span><span class="s2">&quot;-L</span><span class="si">${</span><span class="nv">MKLROOT</span><span class="si">}</span><span class="s2">/lib/intel64 -lmkl_intel_lp64 -lmkl_core -lmkl_sequential -lpthread -lm -ldl&quot;</span>

<span class="c1"># FFT from MKL</span>
<span class="nv">with_fft_flavor</span><span class="o">=</span><span class="s2">&quot;dfti&quot;</span>

<span class="nv">FFT_CPPFLAGS</span><span class="o">=</span><span class="s2">&quot;-I</span><span class="si">${</span><span class="nv">MKLROOT</span><span class="si">}</span><span class="s2">/include&quot;</span>
<span class="nv">FFT_FCFLAGS</span><span class="o">=</span><span class="s2">&quot;-I</span><span class="si">${</span><span class="nv">MKLROOT</span><span class="si">}</span><span class="s2">/include&quot;</span>
<span class="nv">FFT_LIBS</span><span class="o">=</span><span class="s2">&quot;-L</span><span class="si">${</span><span class="nv">MKLROOT</span><span class="si">}</span><span class="s2">/lib/intel64 -lmkl_intel_lp64 -lmkl_core -lmkl_sequential -lpthread -lm -ldl&quot;</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Do not use MKL with FFTW3</strong> for the FFT as the MKL library exports the same symbols as FFTW.
This means that the linker will receive multiple definitions for the same procedure and
the <strong>behaviour is undefined</strong>! Use either MKL or FFTW3 with e.g. <em>openblas</em>.</p>
</div>
<p>If we run <em>configure</em> with these options, we should obtain the following output in the
<strong>Linear algebra support</strong> section:</p>
<details class="note"><summary>Linear algebra support</summary><div class="highlight"><pre><span></span><code>==============================================================================
=== Linear algebra support                                                 ===
==============================================================================

checking for the requested linear algebra flavor... mkl
checking for the serial linear algebra detection sequence... mkl
checking for the MPI linear algebra detection sequence... mkl
checking for the MPI acceleration linear algebra detection sequence... none
checking how to detect linear algebra libraries... verify
checking for BLAS support in the specified libraries... yes
checking for AXPBY support in the BLAS libraries... yes
checking for GEMM3M in the BLAS libraries... yes
checking for mkl_imatcopy in the specified libraries... yes
checking for mkl_omatcopy in the specified libraries... yes
checking for mkl_omatadd in the specified libraries... yes
checking for mkl_set/get_threads in the specified libraries... yes
checking for LAPACK support in the specified libraries... yes
checking for LAPACKE C API support in the specified libraries... no
checking for PLASMA support in the specified libraries... no
checking for BLACS support in the specified libraries... no
checking for ELPA support in the specified libraries... no
checking how linear algebra parameters have been set... env (flavor: kwd)
checking for the actual linear algebra flavor... mkl
checking for linear algebra C preprocessing flags... none
checking for linear algebra C flags... none
checking for linear algebra C++ flags... none
checking for linear algebra Fortran flags... -I/opt/cecisw/arch/easybuild/2018b/software/imkl/2018.3.222-iimpi-2018b/mkl/include
checking for linear algebra linker flags... none
checking for linear algebra library flags... -L/opt/cecisw/arch/easybuild/2018b/software/imkl/2018.3.222-iimpi-2018b/mkl/lib/intel64 -lmkl_intel_lp64 -lmkl_core -lmkl_sequential -lpthread -lm -ldl
configure: WARNING: parallel linear algebra is not available
</code></pre></div>
</details>
<p>Excellent, <em>configure</em> detected a working BLAS/Lapack installation, plus some MKL extensions (<em>mkl_imatcopy</em> etc).
BLACS and Scalapack (parallel linear algebra) have not been detected but this is expected as we haven&rsquo;t asked
for these libraries in the mkl-link-line-advisor GUI.</p>
<p>This is the section in which <em>configure</em> checks the presence of the FFT library
(DFTI from MKL, goedecker means internal Fortran version).</p>
<details class="note"><summary>Optimized FFT support</summary><div class="highlight"><pre><span></span><code>==============================================================================
=== Optimized FFT support                                                  ===
==============================================================================

checking which FFT flavors to enable... dfti goedecker
checking for FFT flavor... dfti
checking for FFT C preprocessing flags...
checking for FFT C flags...
checking for FFT Fortran flags...
checking for FFT linker flags...
checking for FFT library flags...
checking for the FFT flavor to try... dfti
checking whether to enable DFTI... yes
checking how DFTI parameters have been set... mkl
checking for DFTI C preprocessing flags... none
checking for DFTI C flags... none
checking for DFTI Fortran flags... -I/opt/cecisw/arch/easybuild/2018b/software/imkl/2018.3.222-iimpi-2018b/mkl/include
checking for DFTI linker flags... none
checking for DFTI library flags... -L/opt/cecisw/arch/easybuild/2018b/software/imkl/2018.3.222-iimpi-2018b/mkl/lib/intel64 -lmkl_intel_lp64 -lmkl_core -lmkl_sequential -lpthread -lm -ldl
checking whether the DFTI library works... yes
checking for the actual FFT flavor to use... dfti
</code></pre></div>
</details>
<p>The line</p>
<div class="highlight"><pre><span></span><code>checking whether the DFTI library works... yes
</code></pre></div>
<p>tells us that DFTI has been found and we can link against it although this does not necessarily mean
that the final executable will work out of the box.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You may have noticed that it is also possible to use MKL with GNU <em>gfortran</em> but in this case you need
to use a different set of libraries including the so-called <strong>compatibility layer</strong> that allows GCC code
to call MKL routines.
Also, <strong>MKL Scalapack requires either Intel MPI or MPICH2</strong>.</p>
</div>
<details class="note"><summary>Optional Exercise</summary><p>Compile ABINIT with BLAS/ScalaPack from MKL.
 Scalapack (or ELPA) may lead to a significant speedup when running GS calculations
 with large <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>. See also the <a class="wikilink codevar-wikilink" href="/variables/paral#np_slk">np_slk</a> input variable.</p>
</details>
<h3 id="how-to-compile-libxc-netcdf4hdf5-with-intel">How to compile libxc, netcdf4/hdf5 with intel<a class="headerlink" href="#how-to-compile-libxc-netcdf4hdf5-with-intel" title="Permanent link">&para;</a></h3>
<p>At this point, one should check whether our cluster provides modules for
<em>libxc</em>, <em>netcdf-fortran</em>, <em>netcdf-c</em> and <em>hdf5</em> <strong>compiled with the same toolchain</strong>.
Use <code>module spider netcdf</code> or <code>module keyword netcdf</code> to find the modules (if any).</p>
<p>Hopefully, you will find a pre-existent installation for <em>netcdf</em> and <em>hdf5</em> (possibly with MPI-IO support)
as these libraries are quite common on HPC centers.
Load these modules to have <code>nc-config</code> and <code>nf-config</code> in your $PATH and then use the
<code>--prefix</code> option to specify the installation directory as done in the previous examples.
Unfortunately, <em>libxc</em> and <em>hdf5</em> do not provide similar tools so you will have to find
the installation directory for these libs and pass it to <em>configure</em>.</p>
<!--
For libxc and hdf5
<div class="highlight"><pre><span></span><code><span class="nv">with_netcdf</span><span class="o">=</span><span class="s2">&quot;`nc-config --prefix`&quot;</span>
<span class="nv">with_netcdf_fortran</span><span class="o">=</span><span class="s2">&quot;`nf-config --prefix`&quot;</span>
<span class="nv">with_hdf5</span><span class="o">=</span><span class="s2">&quot;`installation_dir_for_hdf5`&quot;</span>
<span class="nv">with_hdf5</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">EBROOTHDF5</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># libxc</span>
<span class="nv">with_libxc</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">EBROOTLIBXC</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
-->

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You may encounter problems with <em>libxc</em> as this library is rather domain-specific
and not all the HPC centers install it.
If your cluster does not provide <em>libxc</em>, it should not be that difficult
to reuse the expertise acquired in this tutorial to build
your version and then install the missing dependencies inside $HOME/local.
Just remember to:</p>
<ol>
<li>load the correct modules for MPI with the associated compilers before configuring</li>
<li><em>configure</em> with <strong>CC=mpiicc</strong> and <strong>FC=mpiifort</strong> so that the intel compilers are used</li>
<li>install the libraries and prepend $HOME/local/lib to LD_LIBRARY_PATH</li>
<li>use the <em>with_LIBNAME</em> option in conjunction with $HOME/local/lib in the ac9 file.</li>
<li>run <em>configure</em> with the ac9 file.</li>
</ol>
</div>
<p>In the worst case scenario in which neither <em>netcdf4/hdf5</em> nor <em>libxc</em> are installed, you may want to
use the <strong>internal fallbacks</strong>.
The procedure goes as follows.</p>
<ul>
<li>Start to configure with a minimalistic set of options just for MPI and MKL (linalg and FFT)</li>
<li>The build system will detect that some hard dependencies are missing and will generate a
  <em>build-abinit-fallbacks.sh</em> script in the <em>fallbacks</em> directory.</li>
<li>Execute the script to build the missing dependencies <strong>using the toolchain specified
  in the initial configuration file</strong></li>
<li>Finally, reconfigure ABINIT with the fallbacks.</li>
</ul>
<h2 id="how-to-compile-abinit-with-support-for-openmp-threads">How to compile ABINIT with support for OpenMP threads<a class="headerlink" href="#how-to-compile-abinit-with-support-for-openmp-threads" title="Permanent link">&para;</a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For a quick introduction to MPI and OpenMP and a comparison between the two parallel programming paradigms, see this
<a href="https://princetonuniversity.github.io/PUbootcamp/sessions/parallel-programming/Intro_PP_bootcamp_2018.pdf">presentation</a>.</p>
</div>
<p>Compiling ABINIT with OpenMP is not that difficult as everything boils down to:</p>
<ul>
<li>Using a <strong>threaded version</strong> for BLAS, LAPACK and FFTs</li>
<li>Passing <strong>enable_openmp=&rdquo;yes&rdquo;</strong> to the ABINIT configure script
  so that OpenMP is activated also at level of the ABINIT Fortran code.</li>
</ul>
<p>On the contrary, answering the questions:</p>
<ul>
<li>When and why should I use OpenMP threads for my calculations?</li>
<li>How many threads should I use and what is the parallel speedup I should expect?</li>
</ul>
<p>is much more difficult as there are several factors that should be taken into account.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To keep a long story short, one should use OpenMP threads
when we start to trigger <strong>limitations or bottlenecks in the MPI implementation</strong>,
especially at the level of the memory requirements or in terms of parallel scalability.
These problems are usually observed in calculations with large <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, <a class="wikilink codevar-wikilink" href="/variables/internal#mpw">%mpw</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.</p>
<p>As a matter of fact, it does not make sense to compile ABINIT with OpenMP
if your calculations are relatively small.
Indeed, ABINIT is mainly designed with MPI-parallelism in mind.
For instance, calculations done with a relatively large number of <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points will benefit more of MPI than OpenMP,
especially if the number of MPI processes divides the number of <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points exactly.
Even worse, do not compile the code with OpenMP support if you do not plan to use threads because the OpenMP
version will have an <strong>additional overhead</strong> due to the creation of the threaded sections.</p>
<p>Remember also that increasing the number of threads does not necessarily leads to faster calculations
(the same is true for MPI processes).
There&rsquo;s always an <strong>optimal value</strong> for the number of threads (MPI processes)
beyond which the parallel efficiency starts to deteriorate.
Unfortunately, this value is strongly hardware and software dependent so you will need to <strong>benchmark the code</strong>
before running production calculations.</p>
<p>Last but not least, OpenMP threads are not necessarily Posix threads. Hence if you have a library that provides
both Open and Posix-threads, link with the OpenMP version.</p>
</div>
<p>After this necessary preamble, let&rsquo;s discuss how to compile a threaded version.
To activate OpenMP support in the Fortran routines of ABINIT, pass</p>
<div class="highlight"><pre><span></span><code><span class="nv">enable_openmp</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span>
</code></pre></div>
<p>to the <em>configure</em> script via the configuration file.
This will automatically activate the compilation option needed to enable OpenMP in the ABINIT source code
(e..g. <code>-fopenmp</code> option for <em>gfortran</em>) and the CPP variable <strong>HAVE_OPENMP in <em>config.h</em></strong>.
Note that this option is just part of the story as a significant fraction of the wall-time is spent in the external
BLAS/FFT routines so <strong>do not expect big speedups if you do not link against threaded libraries</strong>.</p>
<p>If you are building your own software stack for BLAS/LAPACK and FFT, you will have to
reconfigure with the correct options for the OpenMP version and then issue
<em>make and make install</em> again to build the threaded version.
Also note that some libraries may change.
FFTW3, for example, ships the OpenMP version in <strong><em>libfftw3_omp</em></strong>
(see the <a href="http://www.fftw.org/fftw3_doc/Installation-and-Supported-Hardware_002fSoftware.html#Installation-and-Supported-Hardware_002fSoftware">official documentation</a>) hence the list of libraries in <strong>FFTW3_LIBS</strong> should be changed accordingly.</p>
<p>Life is much easier if you are using intel MKL because in this case
it is just a matter of selecting <em>OpenMP threading</em> as threading layer
in the <a href="https://software.intel.com/en-us/articles/intel-mkl-link-line-advisor">mkl-link-line-advisor interface</a>
and then pass these options to the ABINIT build system together with <code>enable_openmp="yes"</code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When using threaded libraries remember to set explicitly the number of threads with e.g.</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">2</span>
</code></pre></div>
<p>either in your <em>bash_profile</em> or in the submission script (or in both).
<strong>By default, OpenMP uses all the available CPUs</strong> so it is very easy to overload
the machine, especially if one uses threads in conjunction with MPI processes.</p>
<p>When running threaded applications with MPI, we suggest to allocate a number of <strong>physical CPUs</strong>
that is equal to the number of MPI processes times the number of OpenMP threads.
Computational intensive applications such as DFT codes have less chance to be improved in performance
from Hyper-Threading technology (usually referred to as number of <strong>logical CPUs</strong>).</p>
<p>We also recommend to increase the <strong>stack size limit</strong> using e.g.</p>
<div class="highlight"><pre><span></span><code><span class="nb">ulimit</span> -s unlimited
</code></pre></div>
<p>if the sysadmin allows you to do so.</p>
<p>To run the ABINIT test suite with e.g. two OpenMP threads, use the <code>-o2</code> option of <em>runtests.py</em></p>
</div>
                
                  
                
              

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/"
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../base4/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              basic4
            </div>
          </div>
        </a>
      
      
        <a href="../paw1/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              PAW1
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version b'10.2.3-dirty'</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
            (MG)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "b'10.2.3-dirty'"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>