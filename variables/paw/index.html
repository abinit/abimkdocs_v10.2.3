
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="paw input variables">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/variables/paw/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>PAW - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#paw-input-variables" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PAW
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Variables
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorial/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        Abitk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_15" type="checkbox" id="__nav_1_15" >
      
      <label class="md-nav__link" for="__nav_1_15">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_15">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        AtomCentered
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        CalcUJ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        GWR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        Install
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        NMR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" checked>
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          PAW
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        PAW
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bxctmindg" class="md-nav__link">
    bxctmindg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmatpawu" class="md-nav__link">
    dmatpawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmatpuopt" class="md-nav__link">
    dmatpuopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmatudiag" class="md-nav__link">
    dmatudiag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#f4of2_sla" class="md-nav__link">
    f4of2_sla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#f6of2_sla" class="md-nav__link">
    f6of2_sla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iboxcut" class="md-nav__link">
    iboxcut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jpawu" class="md-nav__link">
    jpawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lambsig" class="md-nav__link">
    lambsig
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ldaminushalf" class="md-nav__link">
    ldaminushalf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lexexch" class="md-nav__link">
    lexexch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lpawu" class="md-nav__link">
    lpawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mqgriddg" class="md-nav__link">
    mqgriddg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngfftdg" class="md-nav__link">
    ngfftdg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nucefg" class="md-nav__link">
    nucefg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nucfc" class="md-nav__link">
    nucfc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optdcmagpawu" class="md-nav__link">
    optdcmagpawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawcpxocc" class="md-nav__link">
    pawcpxocc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawcross" class="md-nav__link">
    pawcross
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawecutdg" class="md-nav__link">
    pawecutdg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawfatbnd" class="md-nav__link">
    pawfatbnd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawlcutd" class="md-nav__link">
    pawlcutd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawlmix" class="md-nav__link">
    pawlmix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawmixdg" class="md-nav__link">
    pawmixdg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawnhatxc" class="md-nav__link">
    pawnhatxc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawnphi" class="md-nav__link">
    pawnphi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawntheta" class="md-nav__link">
    pawntheta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawnzlm" class="md-nav__link">
    pawnzlm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawoptmix" class="md-nav__link">
    pawoptmix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawoptosc" class="md-nav__link">
    pawoptosc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawovlp" class="md-nav__link">
    pawovlp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprtden" class="md-nav__link">
    pawprtden
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprtdos" class="md-nav__link">
    pawprtdos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprtvol" class="md-nav__link">
    pawprtvol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprtwf" class="md-nav__link">
    pawprtwf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawspnorb" class="md-nav__link">
    pawspnorb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawstgylm" class="md-nav__link">
    pawstgylm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawsushat" class="md-nav__link">
    pawsushat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawusecp" class="md-nav__link">
    pawusecp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawxcdev" class="md-nav__link">
    pawxcdev
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtnabla" class="md-nav__link">
    prtnabla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ptcharge" class="md-nav__link">
    ptcharge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quadmom" class="md-nav__link">
    quadmom
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spnorbscl" class="md-nav__link">
    spnorbscl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upawu" class="md-nav__link">
    upawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usedmatpu" class="md-nav__link">
    usedmatpu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useexexch" class="md-nav__link">
    useexexch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usepawu" class="md-nav__link">
    usepawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usexcnhat" class="md-nav__link">
    usexcnhat
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/basepar/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/ucalc_crpa/" class="md-nav__link">
        cRPA U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lruj/" class="md-nav__link">
        Linear Response U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr_intro/" class="md-nav__link">
        GWR_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr1/" class="md-nav__link">
        GWR1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lw_quad/" class="md-nav__link">
        quadrupoles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_tdep_legacy/" class="md-nav__link">
        eph_tdep_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        Troubleshooting (old-dokuwiki)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        Tuning (old-dokuwiki)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bxctmindg" class="md-nav__link">
    bxctmindg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmatpawu" class="md-nav__link">
    dmatpawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmatpuopt" class="md-nav__link">
    dmatpuopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmatudiag" class="md-nav__link">
    dmatudiag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#f4of2_sla" class="md-nav__link">
    f4of2_sla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#f6of2_sla" class="md-nav__link">
    f6of2_sla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iboxcut" class="md-nav__link">
    iboxcut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jpawu" class="md-nav__link">
    jpawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lambsig" class="md-nav__link">
    lambsig
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ldaminushalf" class="md-nav__link">
    ldaminushalf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lexexch" class="md-nav__link">
    lexexch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lpawu" class="md-nav__link">
    lpawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mqgriddg" class="md-nav__link">
    mqgriddg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngfftdg" class="md-nav__link">
    ngfftdg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nucefg" class="md-nav__link">
    nucefg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nucfc" class="md-nav__link">
    nucfc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optdcmagpawu" class="md-nav__link">
    optdcmagpawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawcpxocc" class="md-nav__link">
    pawcpxocc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawcross" class="md-nav__link">
    pawcross
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawecutdg" class="md-nav__link">
    pawecutdg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawfatbnd" class="md-nav__link">
    pawfatbnd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawlcutd" class="md-nav__link">
    pawlcutd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawlmix" class="md-nav__link">
    pawlmix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawmixdg" class="md-nav__link">
    pawmixdg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawnhatxc" class="md-nav__link">
    pawnhatxc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawnphi" class="md-nav__link">
    pawnphi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawntheta" class="md-nav__link">
    pawntheta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawnzlm" class="md-nav__link">
    pawnzlm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawoptmix" class="md-nav__link">
    pawoptmix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawoptosc" class="md-nav__link">
    pawoptosc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawovlp" class="md-nav__link">
    pawovlp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprtden" class="md-nav__link">
    pawprtden
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprtdos" class="md-nav__link">
    pawprtdos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprtvol" class="md-nav__link">
    pawprtvol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprtwf" class="md-nav__link">
    pawprtwf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawspnorb" class="md-nav__link">
    pawspnorb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawstgylm" class="md-nav__link">
    pawstgylm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawsushat" class="md-nav__link">
    pawsushat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawusecp" class="md-nav__link">
    pawusecp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawxcdev" class="md-nav__link">
    pawxcdev
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtnabla" class="md-nav__link">
    prtnabla
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ptcharge" class="md-nav__link">
    ptcharge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quadmom" class="md-nav__link">
    quadmom
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spnorbscl" class="md-nav__link">
    spnorbscl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upawu" class="md-nav__link">
    upawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usedmatpu" class="md-nav__link">
    usedmatpu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useexexch" class="md-nav__link">
    useexexch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usepawu" class="md-nav__link">
    usepawu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usexcnhat" class="md-nav__link">
    usexcnhat
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/variables/paw.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->
<h1 id="paw-input-variables">paw input variables<a class="headerlink" href="#paw-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
paw input variables to be used in the input file for the abinit executable.</p>
<h2 id="bxctmindg"><strong>bxctmindg</strong><a class="headerlink" href="#bxctmindg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BoX CuT-off MINimum for the Double Grid (PAW)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users
Silicon with few k-points and low cut-off" data-toggle="popover" href="/tests/v4/Input/t17.abi" target="_blank">t17.abi</a></li>
</ul>
</details>
<p>The box cut-off ratio is the ratio between the wavefunction plane wave sphere
radius, and the radius of the sphere that can be inserted in the FFT box, in
reciprocal space.</p>
<p>If the density was generated only from wavefunctions, this ratio should be at
least two in order for the density to be exact. If one uses a smaller ratio,
one will gain speed, at the expense of accuracy. In case of pure ground state
calculation (e.g. for the determination of geometries), this is sensible.
However, the wavefunctions that are obtained CANNOT be used for starting
response function calculation.</p>
<p>However, some augmentation charge is always added in PAW, and even with the
box cut-off ratio larger than two, the density is never exact. Sometimes, this
ratio must be much larger than two for the computation to be converged at the
required level of accuracy.</p>
<h2 id="dmatpawu"><strong>dmatpawu</strong><a class="headerlink" href="#dmatpawu" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> initial Density MATrix for PAW+U<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic DOS and related topics" data-toggle="popover" href="/topics/ElecDOS">topic_ElecDOS</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (2*max(<a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a>)+1,2*max(<a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a>)+1,max(<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a>),<a class="wikilink codevar-wikilink" href="/variables/internal#natpawu">%natpawu</a>)<br />
<em>Default value:</em> <em>-10.0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#usedmatpu">usedmatpu</a> != 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [16/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a></li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="third run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_3.abi" target="_blank">tdftu_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Fourth run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_4.abi" target="_blank">tdftu_4.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U features.
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Antiferromagnetism and PAW+U
* Use of an initial and constant density matrix during the first SCF iterations" data-toggle="popover" href="/tests/v5/Input/t37.abi" target="_blank">t37.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT on Gd (f-orbitals) without spin-orbit coupling : compute occupations and energy." data-toggle="popover" href="/tests/v6/Input/t47.abi" target="_blank">t47.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test to use usepawu=4
Test done in comparison to [[cite:Chen2016a]]." data-toggle="popover" href="/tests/v8/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p>For Ground state calculations only.
Gives the value of an initial density matrix used in DFT+U and kept fixed
during the first abs(<a class="wikilink codevar-wikilink" href="/variables/paw#usedmatpu">usedmatpu</a>) SCF iterations.
Only components corresponding to <a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a> angular momentum are requested.
Restriction: In order to use dmatpawu, <a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a> must be identical for all atom types (or -1).</p>
<p>The occupation matrix is in the basis of real spherical harmonics Slm (note
that this differs from the choice made when <a class="wikilink codevar-wikilink" href="/variables/files#prtdosm">prtdosm</a> = 1, that is in the
basis of complex spherical harmonics). They are ordered by increasing m, and
are defined e.g. in <a class="wikilink citation-wikilink" data-tippy-content="Evaluation of the rotation matrices in the basis of real spherical harmonics" data-toggle="popover" href="/theory/bibliography#blancoa1997">[Blancoa1997]</a>. For the case l=2 (d states), the five
columns corresponds respectively to (the normalisation factor has been dropped)</p>
<ul>
<li>m=-2, <span><span class="MathJax_Preview">xy</span><script type="math/tex">xy</script></span></li>
<li>m=-1, <span><span class="MathJax_Preview">yz</span><script type="math/tex">yz</script></span></li>
<li>m=0, <span><span class="MathJax_Preview">3z^{2}-r^{2}</span><script type="math/tex">3z^{2}-r^{2}</script></span></li>
<li>m=1, <span><span class="MathJax_Preview">xz</span><script type="math/tex">xz</script></span></li>
<li>m=2, <span><span class="MathJax_Preview">x^{2}-y^{2}</span><script type="math/tex">x^{2}-y^{2}</script></span></li>
</ul>
<p><strong>dmatpawu</strong>  must always be given as a &ldquo;spin-up&rdquo; occupation matrix (and
if needed a &ldquo;spin-down&rdquo; matrix). Be aware that its physical meaning depends
on the magnetic properties imposed to the system (with <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>,
<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>):</p>
<ul>
<li>
<p><strong>Non-magnetic system</strong> (<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 1):
One (2lpawu+1)x(2lpawu+1)  <strong>dmatpawu</strong>  matrix is given for each atom on which
+U is applied.
It contains the &ldquo;spin-up&rdquo; occupations.</p>
</li>
<li>
<p><strong>Ferromagnetic spin-polarized (collinear) system</strong> (<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 2):
Two (2lpawu+1)x(2lpawu+1)  <strong>dmatpawu</strong>  matrices are given for each atom on
which +U is applied.
They contain the &ldquo;spin-up&rdquo; and &ldquo;spin-down&rdquo; occupations.</p>
</li>
<li>
<p><strong>Anti-ferromagnetic spin-polarized (collinear) system</strong> (<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 2):
One (2lpawu+1)x(2lpawu+1)  <strong>dmatpawu</strong>  matrix is given for each atom on which +U is applied.
It contains the &ldquo;spin-up&rdquo; occupations.</p>
</li>
<li>
<p><strong>Non-collinear magnetic system</strong> (<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 4):
Two (2lpawu+1)x(2lpawu+1)  <strong>dmatpawu</strong>  matrices are given for each atom on
which +U is applied.
They contains the &ldquo;spin-up&rdquo; and &ldquo;spin-down&rdquo; occupations (defined as
n_up=(n+|m|)/2 and n_dn=(n-|m|)/2), where m is the integrated magnetization
vector).
The direction of the magnetization (which is also the direction of n_up and n_dn) is given by <a class="wikilink codevar-wikilink" href="/variables/gstate#spinat">spinat</a>.
_Warning: unlike collinear case, atoms having the same magnetization magnitude
with different directions must be given the same occupation matrix;
the magnetization will be oriented by the value of <a class="wikilink codevar-wikilink" href="/variables/gstate#spinat">spinat</a> (this is the
case for antiferro-magnetism). _</p>
</li>
<li>
<p><strong>Non-collinear magnetic system with zero magnetization</strong> (<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 1):
Two (2lpawu+1)x(2lpawu+1)  <strong>dmatpawu</strong>  matrices are given for each atom on
which +U is applied.
They contain the &ldquo;spin-up&rdquo; and &ldquo;spin-down&rdquo; occupations;
But, as &ldquo;spin-up&rdquo; and &ldquo;spin-down&rdquo; are constrained identical, the &ldquo;spin-down&rdquo; one is ignored by the code.</p>
</li>
</ul>
<h2 id="dmatpuopt"><strong>dmatpuopt</strong><a class="headerlink" href="#dmatpuopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Density MATrix for PAW+U OPTion<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [53/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for SrVO3 using Hubard I code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
AFII NiO 4-atom cell | LRUJ utility | LMac 2022
Linear Response Hubbard U and Hund&#x27;s J (LRUJ)
post-processing utility for the determination of
said parameters in situ and ab initio" data-toggle="popover" href="/tests/tutorial/Input/tlruj_1.abi" target="_blank">tlruj_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AFII NiO 4-atom cell | LRUJ utility | LMac 2022
Linear Response Hubbard U and Hund&#x27;s J (LRUJ)
post-processing utility for the determination of
said parameters in situ and ab initio" data-toggle="popover" href="/tests/tutorial/Input/tlruj_2.abi" target="_blank">tlruj_2.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni atom in a big box.
Test the use of the atvshift variable :
change the potential of the d orbitals." data-toggle="popover" href="/tests/v5/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni molecule in a big box.
Test the use of the atvshift variable
First dataset : no shift, the ten states number 9 to 18
come from the 3d atomic states, the state number 19 is a bonding 4s state.
States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1).
State number 18 is a 3d sigma antibonding state (m=0).
Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the
levels change by less than 0.0002 (and their energy decrease), except state number
9 (a 3d sigma bonding state (m=0)), that goes from -0.24020 to -0.23982 (+0.0004)
and state number 18, that goes from -0.15439 to 0.15399 (+0.0004).
Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials.
All the levels are affected (likely the m=1 and -1 orbitals adjust, and cause modification
of the potential), but the states 10, 11, 16, and 17 increase their energy, while the
other state see their energy decrease.
Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking
of the degeneracy.
This test was not easy to make portable. The problem lies in the fact that when the density
becomes negative, due to Bragg oscillations, the xc kernel can be extremely large, and when
use for the prediction of the residual of the forces, the differences between machines
can be extremely large. IN order to see this effect, put ecut 7 and npulayit 7 (its default value)." data-toggle="popover" href="/tests/v5/Input/t15.abi" target="_blank">t15.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to use usepawu=4
Test done in comparison to [[cite:Chen2016a]]." data-toggle="popover" href="/tests/v8/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t78.abi" target="_blank">t78.abi</a> &hellip;</li>
</ul>
</details>
<p>This option governs the way occupations of localized atomic levels are computed:</p>
<ul>
<li>
<p><strong>dmatpuopt</strong>  = 1: atomic occupations are projections on atomic orbitals (Eq. (6) of <a class="wikilink citation-wikilink" data-tippy-content="γ and β cerium: LDA+U calculations of ground-state parameters" data-toggle="popover" href="/theory/bibliography#amadon2008a">[Amadon2008a]</a>).</p>
</li>
<li>
<p><strong>dmatpuopt</strong>  = 2: atomic occupations are integrated values in PAW spheres of angular-momentum-decomposed charge densities (Eq. (7) of <a class="wikilink citation-wikilink" data-tippy-content="γ and β cerium: LDA+U calculations of ground-state parameters" data-toggle="popover" href="/theory/bibliography#amadon2008a">[Amadon2008a]</a>).</p>
</li>
<li>
<p><strong>dmatpuopt</strong>  = 3: only for tests</p>
</li>
<li>
<p><strong>dmatpuopt</strong>  = 4: Extrapolations of occupancies outside the PAW-sphere. This Definition gives normalized operator for occupation.</p>
</li>
</ul>
<p>In the general case  <strong>dmatpuopt</strong>  = 2 is suitable. The use of  <strong>dmatpuopt</strong>  = 1 is
restricted to PAW datasets in which the first atomic wavefunction of the
correlated subspace is a normalized atomic eigenfunction.</p>
<h2 id="dmatudiag"><strong>dmatudiag</strong><a class="headerlink" href="#dmatudiag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Density MATrix for paw+U, DIAGonalization<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> != 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a></li>
</ul>
</details>
<p>Relevant only for Ground-State calculations.
This option can be used to diagonalize the occupation matrix Nocc_{m,m_prime}.
Relevant values are:</p>
<ul>
<li>0: deactivated.</li>
<li>1: occupation matrix is diagonalized and printed in log file at each SCF cycle
    (eigenvectors are also given in the log file).</li>
<li>2: for testing purpose.</li>
</ul>
<h2 id="f4of2_sla"><strong>f4of2_sla</strong><a class="headerlink" href="#f4of2_sla" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> F4 Over F2 ratio of Slater integrals<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.625 if d electrons,
0.6681 if f electrons,
0 otherwise.</p>
<p><em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and (<a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> == 1 or <a class="wikilink codevar-wikilink" href="/variables/dev#usedmft">usedmft</a> == 1)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [14/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for SrVO3 using Hubard I code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t86.abi" target="_blank">t86.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/paral/Input/t99.abi" target="_blank">t99.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v7/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test entropy calculation for SrVO3 within DMFT" data-toggle="popover" href="/tests/v7/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test restart of entropy calculation for SrVO3 within DMFT" data-toggle="popover" href="/tests/v7/Input/t31.abi" target="_blank">t31.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a></li>
</ul>
</details>
<p>This gives the ratio of Slater Integrals F4 and F2. It is used in DFT+U or
DFT+DMFT for the calculation of the orbital dependent screened coulomb interaction.</p>
<h2 id="f6of2_sla"><strong>f6of2_sla</strong><a class="headerlink" href="#f6of2_sla" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> F6 Over F2 ratio of Slater integrals<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.4943<br />
<em>Only relevant if:</em> (<a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> == 1 or <a class="wikilink codevar-wikilink" href="/variables/dev#usedmft">usedmft</a> == 1) and <a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a> == 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a></li>
</ul>
</details>
<p>Gives the ratio of Slater Integrals F6 and F2. It is used with
<a class="wikilink codevar-wikilink" href="/variables/paw#f4of2_sla">f4of2_sla</a> == 3 in DFT+U or DFT+DMFT for the calculation of the orbital
dependent screened coulomb interaction.</p>
<h2 id="iboxcut"><strong>iboxcut</strong><a class="headerlink" href="#iboxcut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer governing the internal use of BOXCUT - not a very good choice of variable name<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users
Silicon with few k-points and low cut-off" data-toggle="popover" href="/tests/v4/Input/t17.abi" target="_blank">t17.abi</a></li>
</ul>
</details>
<p>Concern all summations in the reciprocal space and is allowed in PAW and norm-conserving.</p>
<ul>
<li>if set to 0 all reciprocal space summations are done in a sphere contained in the FFT box.</li>
<li>if set to 1 all reciprocal space summations are done in the whole FFT box (useful for tests).</li>
</ul>
<h2 id="jpawu"><strong>jpawu</strong><a class="headerlink" href="#jpawu" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> value of J for PAW+U<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> <em>0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [56/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for SrVO3 using Hubard I code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="second run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_2.abi" target="_blank">tdftu_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="third run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_3.abi" target="_blank">tdftu_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Fourth run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_4.abi" target="_blank">tdftu_4.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
27-electron PAW pseudo (4f and 5d are explicitly treated : 4d10 4f7 5s2 5p6 (5d0) 6s2 )
Test of initialisation using occopt=1 (the default) with non-zero spinmagntarget,
and also metallic occopt. Also test pawxcdev=0" data-toggle="popover" href="/tests/v7/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to use usepawu=4
Test done in comparison to [[cite:Chen2016a]]." data-toggle="popover" href="/tests/v8/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t78.abi" target="_blank">t78.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the value of the screened exchange interaction between correlated
electrons corresponding to <a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a> for each species.
In the case where <a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a> =-1, the value is not used.</p>
<h2 id="lambsig"><strong>lambsig</strong><a class="headerlink" href="#lambsig" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> LAMB shielding SIGma<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to calculate NMR chemical shieldings" data-toggle="popover" href="/topics/NMR">topic_NMR</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to take into account an external magnetic field" data-toggle="popover" href="/topics/MagField">topic_MagField</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> <em>0<br />
*Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a></li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP" data-toggle="popover" href="/tests/v9/Input/t140.abi" target="_blank">t140.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nspinor 2" data-toggle="popover" href="/tests/v9/Input/t141.abi" target="_blank">t141.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nsppol 2" data-toggle="popover" href="/tests/v9/Input/t142.abi" target="_blank">t142.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP with discretized wavefunctions" data-toggle="popover" href="/tests/v9/Input/t144.abi" target="_blank">t144.abi</a></li>
</ul>
</details>
<p>Chemical shielding at each nucleus due to the core electrons. This quantity is
input as an array of values, one for each type, see <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>. In calculations
where the orbital magnetic moment is requested in the presence of a nuclear magnetic
dipole moment (see <a class="wikilink codevar-wikilink" href="/variables/dfpt#orbmag">orbmag</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#nucdipmom">nucdipmom</a>), the effect of this shielding
will be included. If a PAW dataset is used where this quantity is included, then a non-zero
value in  <strong>lambsig</strong>  will override the PAW value.
The value to be used here can be obtained from the PAW core wavefunctions and the
Lamb formula <a class="wikilink citation-wikilink" data-tippy-content="The principles of nuclear magnetism" data-toggle="popover" href="/theory/bibliography#abragam1961">[Abragam1961]</a>.</p>
<h2 id="ldaminushalf"><strong>ldaminushalf</strong><a class="headerlink" href="#ldaminushalf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> LDA minus half<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a LDA-1/2 calculation" data-toggle="popover" href="/topics/LDAminushalf">topic_LDAminushalf</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> <em>0<br />
*Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
test the use of LDA-1/2 on silicon." data-toggle="popover" href="/tests/v8/Input/t32.abi" target="_blank">t32.abi</a></li>
</ul>
</details>
<p>For each type of atom, gives whether a LDA-<span><span class="MathJax_Preview">{\frac{1}{2}}</span><script type="math/tex">{\frac{1}{2}}</script></span> calculation is to be performed.
<strong>ldaminushalf</strong> =0: the LDA-<span><span class="MathJax_Preview">\frac{1}{2}</span><script type="math/tex">\frac{1}{2}</script></span> approach is not used.
<strong>ldaminushalf</strong> =1: the LDA-<span><span class="MathJax_Preview">\frac{1}{2}</span><script type="math/tex">\frac{1}{2}</script></span> approach is used.</p>
<h2 id="lexexch"><strong>lexexch</strong><a class="headerlink" href="#lexexch" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> value of angular momentum L for EXact EXCHange<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> -1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/paw#useexexch">useexexch</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms per cell
Test computation of the local exact exchange (PBE0) in PAW." data-toggle="popover" href="/tests/v5/Input/t18.abi" target="_blank">t18.abi</a></li>
</ul>
</details>
<p>Give for each species the value of the angular momentum
on which to apply the exact exchange correction.</p>
<h2 id="lpawu"><strong>lpawu</strong><a class="headerlink" href="#lpawu" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> value of angular momentum L for PAW+U<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> <em>-1<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> == 1 or 2<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [62/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for SrVO3 using Hubard I code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="second run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_2.abi" target="_blank">tdftu_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="third run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_3.abi" target="_blank">tdftu_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Fourth run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_4.abi" target="_blank">tdftu_4.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni atom in a big box.
Test the use of the atvshift variable :
change the potential of the d orbitals." data-toggle="popover" href="/tests/v5/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni molecule in a big box.
Test the use of the atvshift variable
First dataset : no shift, the ten states number 9 to 18
come from the 3d atomic states, the state number 19 is a bonding 4s state.
States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1).
State number 18 is a 3d sigma antibonding state (m=0).
Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the
levels change by less than 0.0002 (and their energy decrease), except state number
9 (a 3d sigma bonding state (m=0)), that goes from -0.24020 to -0.23982 (+0.0004)
and state number 18, that goes from -0.15439 to 0.15399 (+0.0004).
Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials.
All the levels are affected (likely the m=1 and -1 orbitals adjust, and cause modification
of the potential), but the states 10, 11, 16, and 17 increase their energy, while the
other state see their energy decrease.
Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking
of the degeneracy.
This test was not easy to make portable. The problem lies in the fact that when the density
becomes negative, due to Bragg oscillations, the xc kernel can be extremely large, and when
use for the prediction of the residual of the forces, the differences between machines
can be extremely large. IN order to see this effect, put ecut 7 and npulayit 7 (its default value)." data-toggle="popover" href="/tests/v5/Input/t15.abi" target="_blank">t15.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
27-electron PAW pseudo (4f and 5d are explicitly treated : 4d10 4f7 5s2 5p6 (5d0) 6s2 )
Test of initialisation using occopt=1 (the default) with non-zero spinmagntarget,
and also metallic occopt. Also test pawxcdev=0" data-toggle="popover" href="/tests/v7/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to use usepawu=4
Test done in comparison to [[cite:Chen2016a]]." data-toggle="popover" href="/tests/v8/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t78.abi" target="_blank">t78.abi</a> &hellip;</li>
</ul>
</details>
<p>Give for each species the value of the angular momentum
 on which to apply the DFT+U correction.</p>
<ul>
<li>If equal to 1 (p-orbitals), 2 (d-orbitals)  or 3 (f-orbitals), values of <a class="wikilink codevar-wikilink" href="/variables/paw#upawu">upawu</a> and  <a class="wikilink codevar-wikilink" href="/variables/paw#jpawu">jpawu</a> are used in the calculation.</li>
<li>If equal to -1: do not apply DFT+U correction on the species.</li>
</ul>
<h2 id="mqgriddg"><strong>mqgriddg</strong><a class="headerlink" href="#mqgriddg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Maximum number of Q-wavevectors for the 1-dimensional GRID  for the Double Grid in PAW<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3001<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users
Silicon with few k-points and low cut-off" data-toggle="popover" href="/tests/v4/Input/t17.abi" target="_blank">t17.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Maximum number of wavevectors used to sample the local part of the potential,
in PAW. Actually referred to as mqgrid_vl internally. Should change name to
the latter. See also <a class="wikilink codevar-wikilink" href="/variables/dev#mqgrid">mqgrid</a>.</p>
<h2 id="ngfftdg"><strong>ngfftdg</strong><a class="headerlink" href="#ngfftdg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Grid points for Fast Fourier Transform: Double Grid<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [31/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LOBPCG, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over bands and spins:
npband*npfft*np_spkpt=2*1*2=4 processors.
In addition, we also test here various features of bandfft-kpt parallelisation
In particular, the bandpp, istwfk=2 and wfoptalg=14 variables." data-toggle="popover" href="/tests/mpiio/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/paral/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over bands and spins:
npband*npfft*np_spkpt=2*1*2=4 processors.
In addition, we also test here various features of bandfft-kpt parallelisation
In particular, the bandpp, istwfk=2 and wfoptalg=14 variables." data-toggle="popover" href="/tests/paral/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
</ul>
</details>
<p>This variable has the same meaning as ngfft (gives the size of fast Fourier
transform (fft) grid in three dimensions) but concerns the &ldquo;double grid&rdquo; only
used for PAW calculations.</p>
<h2 id="nucefg"><strong>nucefg</strong><a class="headerlink" href="#nucefg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> NUClear site Electric Field Gradient<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to calculate electric fields gradients and Mossbauer Fermi contact interaction" data-toggle="popover" href="/topics/EFG">topic_EFG</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite (a polymorph of SiO2)
Test PBEsol in the PAW formalism, using PAW datasets created with atompaw linked with libxc.
Note that the value of ixc is not present in the input file, but it is present in the ATOMPAW dataset (pspxc = -116133)" data-toggle="popover" href="/tests/libxc/Input/t10.abi" target="_blank">t10.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_1.abi" target="_blank">tnuc_1.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite, high-pressure polymorph of SiO2. LDA.
Computation of the electric field gradient at each atomic site.
This tests the implementation of the PAW-based
efg algorithm as outlined in Profeta, Mauri, and Pickard, J. Am. Chem. Soc.
125, 541-548 (2003). Coded by J. Zwanziger and M. Torrent." data-toggle="popover" href="/tests/v5/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite, high-pressure polymorph of SiO2. GGA (PBE).
Computation of the electric field gradient at each atomic site.
This tests the implementation of the PAW-based
efg algorithm as outlined in Profeta, Mauri, and Pickard, J. Am. Chem. Soc.
125, 541-548 (2003)." data-toggle="popover" href="/tests/v5/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Cu2O
Computation of the total energy and EFG tensors in DFT+U formalism
Note: Cu2O is a nonmagnetic insulator. However, DFT+U
as implemented requires nspden=2 in all cases." data-toggle="popover" href="/tests/v5/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite, high-pressure polymorph of SiO2. LDA.
Computation of the electric field gradient at each site using both PAW and
a simple point charge model. Coded and contributed by J. Zwanziger." data-toggle="popover" href="/tests/v5/Input/t35.abi" target="_blank">t35.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Electric field gradient of indium metal, body-centered tetragonal, included to
check EFG symmetry in this case." data-toggle="popover" href="/tests/v6/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Electric field gradients in ICl molecule, with and without spin orbit coupling." data-toggle="popover" href="/tests/v6/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>If nonzero, calculate the electric field gradient at each atomic site in the unit cell.
Values will be written to the main output file (search for Electric Field Gradient).
If nucefg=1, the electric field gradient in both atomic units and SI units is given,
showing separate contributions from the valence electrons, the ion cores, and the PAW reconstruction.
If nucefg=2, the quadrupole couplings to the nuclear electric quadrupole moments are reported as well,
and are based on the input values of <a class="wikilink codevar-wikilink" href="/variables/paw#quadmom">quadmom</a>.
If nucefg=3, then in addition to the nucefg=2 output, the EFGs are computed using an ionic point charge model.
This is useful for comparing the accurate PAW-based results to those of simple ion-only models.
Use of nucefg=3 requires that the variable <a class="wikilink codevar-wikilink" href="/variables/paw#ptcharge">ptcharge</a> be set as well.
The option nucefg is compatible with spin polarized calculations (see
<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>) and also DFT+U (see <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a>).</p>
<h2 id="nucfc"><strong>nucfc</strong><a class="headerlink" href="#nucfc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> NUClear site Fermi Contact term<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to calculate electric fields gradients and Mossbauer Fermi contact interaction" data-toggle="popover" href="/topics/EFG">topic_EFG</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite (a polymorph of SiO2)
Test PBEsol in the PAW formalism, using PAW datasets created with atompaw linked with libxc.
Note that the value of ixc is not present in the input file, but it is present in the ATOMPAW dataset (pspxc = -116133)" data-toggle="popover" href="/tests/libxc/Input/t10.abi" target="_blank">t10.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_2.abi" target="_blank">tnuc_2.abi</a>, <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_3.abi" target="_blank">tnuc_3.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite, high-pressure polymorph of SiO2. LDA.
Computation of the Fermi contact term at each atomic site.
Coded and contributed by J. Zwanziger." data-toggle="popover" href="/tests/v5/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, computation of Fermi contact term with two spin densities.
Coded and contributed by J. Zwanziger." data-toggle="popover" href="/tests/v5/Input/t36.abi" target="_blank">t36.abi</a></li>
</ul>
</details>
<ul>
<li>If set to 1, print the Fermi contact interaction at each nuclear site, that
  is, the electron density at each site. The result appears in the main output file
  (search for FC). Note that this calculation is different than what is done by cut3d,
  because it also computes the PAW on-site corrections in addition to the
  contribution from the valence pseudo-wavefunctions.</li>
</ul>
<h2 id="optdcmagpawu"><strong>optdcmagpawu</strong><a class="headerlink" href="#optdcmagpawu" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OPTion for Double-Counting MAGnetic term in PAW+U formalism<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1, <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> == 1 or 4, and <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> == 4<br />
<em>Added in version:</em> 9.8.2  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t78.abi" target="_blank">t78.abi</a></li>
</ul>
</details>
<p>This option is usefull only for tests and code comparisons. For magnetic computations (<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>==4),
it defines how the magnetism is treated in the double counting term in the PAW+U formalism.
Abinit versions before 9.8 correspond to  <strong>optdcmagpawu</strong> =1, without magnetism in the DC term,
while  <strong>optdcmagpawu</strong> =3 takes into account magnetism in the DC term, that is currently the default.</p>
<h2 id="pawcpxocc"><strong>pawcpxocc</strong><a class="headerlink" href="#pawcpxocc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - use ComPleX rhoij OCCupancies<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2 if <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 0 and <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a> &lt; 6 and <a class="wikilink codevar-wikilink" href="/variables/paw#pawspnorb">pawspnorb</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt;= 10 and (<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> !=1 or <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>!=2) and <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1,
1 otherwise.</p>
<p><em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a></li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using PAW, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the spin-orbit coupling
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)
Also tests spnorbscl and pawcpxocc variables reserved to exp. users." data-toggle="popover" href="/tests/v5/Input/t17.abi" target="_blank">t17.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test presence of nuclear magnetic dipole moments on atomic sites" data-toggle="popover" href="/tests/v7/Input/t32.abi" target="_blank">t32.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP" data-toggle="popover" href="/tests/v9/Input/t140.abi" target="_blank">t140.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nspinor 2" data-toggle="popover" href="/tests/v9/Input/t141.abi" target="_blank">t141.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nsppol 2" data-toggle="popover" href="/tests/v9/Input/t142.abi" target="_blank">t142.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism in metallic sodium" data-toggle="popover" href="/tests/v9/Input/t143.abi" target="_blank">t143.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP with discretized wavefunctions" data-toggle="popover" href="/tests/v9/Input/t144.abi" target="_blank">t144.abi</a></li>
</ul>
</details>
<p>The only possible values for  <strong>pawcpxocc</strong>  are 1 or 2.
When  <strong>pawcpxocc</strong>  == 1, &ldquo;direct&rdquo; decomposition of total energy cannot be
printed out.
When  <strong>pawcpxocc</strong>  == 2, PAW augmentation occupancies are treated as
COMPLEX; else they are considered as REAL.
This is needed when time-reversal symmetry is broken (typically when spin-
orbit coupling is activated).</p>
<p>Note for ground-state calculations (<a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 0):
The imaginary part of PAW augmentation occupancies is only used for the
computation of the total energy by &ldquo;direct scheme&rdquo;; this is only necessary
when SCF mixing on potential is chosen (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &lt;10).
When SCF mixing on density is chosen (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt;= 10), the &ldquo;direct&rdquo;
decomposition of energy is only printed out without being used. It is thus
possible to use  <strong>pawcpxocc</strong>  = 1 in the latter case.
In order to save CPU time, when molecular dynamics is selected (<a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a> &gt;= 6)
and SCF mixing done on density (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt;= 10),  <strong>pawcpxocc</strong>  = 2 is (by default) set to <strong>1</strong>.</p>
<h2 id="pawcross"><strong>pawcross</strong><a class="headerlink" href="#pawcross" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - add CROSS term in oscillator strengths<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> (<a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 3 or <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 4) and <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1245] in all abinit tests, [0/159] in abinit tutorials</summary></details>
<p>When <strong>pawcross=1</strong>, the overlap between the plane-wave part of one band and
the on-site part of an other is taken into account in the computation of the
oscillator strengths. Hence, the completeness of the on-site basis is no longer assumed.</p>
<h2 id="pawecutdg"><strong>pawecutdg</strong><a class="headerlink" href="#pawecutdg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - Energy CUToff for the Double Grid<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform numerically precise calculations with planewaves or projector- augmented waves and pseudopotentials" data-toggle="popover" href="/topics/Planewaves">topic_Planewaves</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -1<br />
<em>Comment:</em> pawecutdg MUST be specified for PAW calculations.<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [320/1245] in all abinit tests, [44/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H in isolated boundary conditions (plane waves, PAW).
Tests free boundary conditions Poisson solver for PAW." data-toggle="popover" href="/tests/bigdft/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiF. Interface with CC4S code with PAW pseudos" data-toggle="popover" href="/tests/gwr/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite (a polymorph of SiO2)
Test PBEsol in the PAW formalism, using PAW datasets created with atompaw linked with libxc.
Note that the value of ixc is not present in the input file, but it is present in the ATOMPAW dataset (pspxc = -116133)" data-toggle="popover" href="/tests/libxc/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell.
Testing temperature-dependent libxc functionals.
Several XC functionals, several electronic temperatures." data-toggle="popover" href="/tests/libxc/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Testing TB09 XC functional within PAW approach.
Cristalline silicon
Also testing the following variables:
- xc_taupos : filtering of the kinetic energy density
- getkden   : read KE density from previous dataset
- irdkden   : read KE density from an external file" data-toggle="popover" href="/tests/libxc/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over bands and spins:
npband*npfft*np_spkpt=2*1*2=4 processors.
In addition, we also test here various features of bandfft-kpt parallelisation
In particular, the bandpp, istwfk=2 and wfoptalg=14 variables." data-toggle="popover" href="/tests/mpiio/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-toggle="popover" href="/tests/paral/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-toggle="popover" href="/tests/paral/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-toggle="popover" href="/tests/paral/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaF Sodium Fluoride FCC (rocksalt structure) with 2 atoms per cell.
Test computation of the Berry phase in PAW." data-toggle="popover" href="/tests/seq/Input/tsv5_112.abi" target="_blank">tsv5_112.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with 2 atoms per cell.
Test computation of the Berry phase in PAW, with GGA functional.
WARNING : HAS BEEN TRANSFERRED TO tests/seq" data-toggle="popover" href="/tests/seq/Input/tsv5_113.abi" target="_blank">tsv5_113.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of forces in finite electric fields
(contributed by J. Zwanziger, adapted from efield tutorial.)
Cannot be executed with more than 1 MPI node." data-toggle="popover" href="/tests/seq/Input/tsv7_70.abi" target="_blank">tsv7_70.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Gold with one vacancy (107 atoms of gold)." data-toggle="popover" href="/tests/tutoparal/Input/tparal_bandpw_01.abi" target="_blank">tparal_bandpw_01.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wannier90 interface with NC pseudopotentials" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_4.abi" target="_blank">tw90_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="first run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_1.abi" target="_blank">tdftu_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="second run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_2.abi" target="_blank">tdftu_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="third run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_3.abi" target="_blank">tdftu_3.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1). Should give same results than v9[206]." data-toggle="popover" href="/tests/v10/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). Should give same results than v10[04]. PAW,istwfk=1" data-toggle="popover" href="/tests/v10/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test different ways to obtain the NiO antiferromagnetic structure" data-toggle="popover" href="/tests/v3/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to verify that different values
of input variable &#x27;ortalg&#x27; give the same results for
total energy. &#x27;ortalg&#x27; is use in the conjugate gradient
algorithm which solves, in the case of PAW calculations,
a generalized eigenproblem (H.|Psi&gt;=Lambda.S|Psi&gt;).
Three datasets are perfomed ; they must give the same
total energies values (when converged)." data-toggle="popover" href="/tests/v4/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to mesure the convergence of
the total energy versus the variable &#x27;ecut&#x27;.
6 datasets are performed with ecut varying from 8 Ha to 18 Ha
Cut-off for the fine grid (used to transfer data from spherical
meshes to FFt meshes) remain constant." data-toggle="popover" href="/tests/v4/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite differences (contributed by J. Zwanziger, adapted from efield tutorial).

MG: Very problematic in parallel (run get stuck!)" data-toggle="popover" href="/tests/v6/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield tutorial.)
Cannot be executed with more than 1 MPI node." data-toggle="popover" href="/tests/v6/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-toggle="popover" href="/tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiF. Optical properties within BSE and PAW (Haydock method)." data-toggle="popover" href="/tests/v67mbpt/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with PAW and nsppol = 2.
Use model dielectric function computed from AE PAW density (denfgr.F90)." data-toggle="popover" href="/tests/v67mbpt/Input/t29.abi" target="_blank">t29.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation
in (N,V,T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested
together with the three coordinate systems (primitive, normal mode, staging).
NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with
--- Pseudopotential description --" data-toggle="popover" href="/tests/v7/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-toggle="popover" href="/tests/v8/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Define the energy cut-off for the fine FFT grid (the &ldquo;double grid&rdquo;, that
allows one to transfer data from the normal, coarse, FFT grid to the spherical
grid around each atom).
 <strong>pawecutdg</strong>  must be larger or equal to <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>. If it is equal to it, then
no fine grid is used. The results are not very accurate, but the computations
proceed quite fast.
For typical PAW computations, where <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> is on the order of 15 Ha,
 <strong>pawecutdg</strong>  must be tested according to what you want to do. For
calculations that do not require a high accuracy (molecular dynamics for
instance) a value of 20 Ha is enough. For calculations that require a high
accuracy (response functions for instance) it should be on the order of 30 Ha.
Choosing a larger value should not increase the accuracy, but does not slow
down the computation either, only the memory. The choice made for this
variable DOES have a bearing on the numerical accuracy of the results, and, as
such, should be the object of a convergence study. The convergence test might
be made on the total energy or derived quantities, like forces, but also on
the two values of the &ldquo;Compensation charge inside spheres&rdquo;, a quantity written
in the log file.</p>
<h2 id="pawfatbnd"><strong>pawfatbnd</strong><a class="headerlink" href="#pawfatbnd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW: print band structure in the FAT-BaND representation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute atom-centered properties" data-toggle="popover" href="/topics/AtomCentered">topic_AtomCentered</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1245] in all abinit tests, [3/159] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_1.abi" target="_blank">tucalc_crpa_1.abi</a></li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a></li>
</ul>
</details>
<p>For Ground-State calculations using PAW and non self-consistent calculations only.
This option can be used to plot band structure. For each atom (specified by
<a class="wikilink codevar-wikilink" href="/variables/gstate#natsph">natsph</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#iatsph">iatsph</a>), each angular momentum, and each spin polarisation,
the band structure is written in files (such as e.g.
FATBANDS_at0001_Ni_is2_l2_m-1). Each file contains the eigenvalue, and the
contribution of angular momentum L, and projection of angular momentum M, (for
the corresponding wavefunction) to the PAW density inside the PAW sphere as a
function of the index of the k-point. The output can be readily plotted with
the software <a href="http://plasma-gate.weizmann.ac.il/Grace/">xmgrace</a> (e.g
xmgrace FATBANDS_at0001_Ni_is2_l2_m-1). Relevant values are:</p>
<ul>
<li>0: desactivated.</li>
<li>1: The fatbands are only resolved in L.</li>
<li>2: The fatbands are resolved in L and M.</li>
</ul>
<h2 id="pawlcutd"><strong>pawlcutd</strong><a class="headerlink" href="#pawlcutd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - L angular momentum used to CUT the development in moments of the Densities<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a></li>
</ul>
</details>
<p>The expansion of the densities in angular momenta is performed up to
l= <strong>pawlcutd</strong> .
Note that, for a given system, the maximum value of  <strong>pawlcutd</strong>  is
<strong>2*l_max</strong>, where l_max is the maximum l of the PAW partial waves basis.</p>
<p>The choice made for this variable DOES have a bearing on the numerical
accuracy of the results, and, as such, should be the object of a convergence
study. The convergence test might be made on the total energy or derived
quantities, like forces, but also on the two values of the &ldquo;Compensation
charge inside spheres&rdquo;, a quantity written in the log file.</p>
<h2 id="pawlmix"><strong>pawlmix</strong><a class="headerlink" href="#pawlmix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - maximum L used in the spherical part MIXing<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a></li>
</ul>
</details>
<p>The choice made for this variable determine how the spherical part of the
density is mixed during electronic iterations.</p>
<p>Only parts of rhoij quantities associated with l angular momenta up to
l=pawlmix are mixed. Other parts of augmentation occupancies are not included
in the mixing process.
This option is useful to save CPU time but DOES have a bearing on the
numerical accuracy of the results.</p>
<h2 id="pawmixdg"><strong>pawmixdg</strong><a class="headerlink" href="#pawmixdg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - MIXing is done (or not) on the (fine) Double Grid<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0 if <a class="wikilink codevar-wikilink" href="/variables/paral#npfft">npfft</a> == 1,
1 otherwise.</p>
<p><em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [15/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a></li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 4 procs.
test the automatic parallelisation when a processor is unoccupied." data-toggle="popover" href="/tests/paral/Input/t27.abi" target="_blank">t27.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to verify that different values
of input variable &#x27;ortalg&#x27; give the same results for
total energy. &#x27;ortalg&#x27; is use in the conjugate gradient
algorithm which solves, in the case of PAW calculations,
a generalized eigenproblem (H.|Psi&gt;=Lambda.S|Psi&gt;).
Three datasets are perfomed ; they must give the same
total energies values (when converged)." data-toggle="popover" href="/tests/v4/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to mesure the convergence of
the total energy versus the variable &#x27;ecut&#x27;.
6 datasets are performed with ecut varying from 8 Ha to 18 Ha
Cut-off for the fine grid (used to transfer data from spherical
meshes to FFt meshes) remain constant." data-toggle="popover" href="/tests/v4/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in arbitrary structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to test the differents mixing scheme in PAW formalism.
Different values of iscf, pawmixdg and pawoptmix are choosen.
Features tested:
- mixing on density or potential (mod(iscf,10))
- different mixing schemes (iscf)
- inclusion of spherical part in residual (pawoptmix)
- mixing on coarse or fine grid (pawmixdg)
- mixing factor for spherical part (pawsphmix)
All mixing schemes give the same total energy." data-toggle="popover" href="/tests/v4/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point.
Testing GS  PAW  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t94.abi" target="_blank">t94.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite, high-pressure polymorph of SiO2. LDA.
Computation of the electric field gradient at each atomic site.
This tests the implementation of the PAW-based
efg algorithm as outlined in Profeta, Mauri, and Pickard, J. Am. Chem. Soc.
125, 541-548 (2003). Coded by J. Zwanziger and M. Torrent." data-toggle="popover" href="/tests/v5/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite, high-pressure polymorph of SiO2. GGA (PBE).
Computation of the electric field gradient at each atomic site.
This tests the implementation of the PAW-based
efg algorithm as outlined in Profeta, Mauri, and Pickard, J. Am. Chem. Soc.
125, 541-548 (2003)." data-toggle="popover" href="/tests/v5/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Cu2O
Computation of the total energy and EFG tensors in DFT+U formalism
Note: Cu2O is a nonmagnetic insulator. However, DFT+U
as implemented requires nspden=2 in all cases." data-toggle="popover" href="/tests/v5/Input/t33.abi" target="_blank">t33.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with and without PAW XML data (FJollet)" data-toggle="popover" href="/tests/v7/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for PWPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t61.abi" target="_blank">t61.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for GPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t62.abi" target="_blank">t62.abi</a></li>
</ul>
</details>
<p>The choice made for this variable determines the grid on which the density (or
potential) is mixed during the SCF cycle.</p>
<p>If <strong>pawmixdg=1</strong> the density/potential is mixed in REAL space using the
fine FFT grid (defined by <a class="wikilink codevar-wikilink" href="/variables/paw#pawecutdg">pawecutdg</a> or <a class="wikilink codevar-wikilink" href="/variables/paw#ngfftdg">ngfftdg</a>).</p>
<p>If <strong>pawmixdg=0</strong> the density/potential is mixed in RECIPROCAL space using
the coarse FFT grid (defined by <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a>). Only components of the
coarse grid are mixed using the scheme defined by <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>; other components
are only precondionned by <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> and simply mixed.
This option is useful to save memory and does not affect numerical accuracy of
converged results. If <strong>pawmixdg=1</strong>, density and corresponding residual are
stored for previous iterations and are REAL arrays of size <a class="wikilink codevar-wikilink" href="/variables/internal#nfftdg">%nfftdg</a>. If
<strong>pawmixdg=0</strong>, density and corresponding residual are stored for previous
iterations and are COMPLEX arrays of size <a class="wikilink codevar-wikilink" href="/variables/internal#nfft">%nfft</a>. The memory saving is
particularly efficient when using the Pulay mixing (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> = 7 or 17).</p>
<p>In <strong>wavelet</strong> calculations <a class="wikilink codevar-wikilink" href="/variables/basic#usewvl">usewvl</a> = 1:</p>
<div class="codehilite"><pre><span></span><code>- pawmixdg is set to 1 by default.
- A value of 0 is not allowed.
- Density/potential is mixed in REAL space (Here only one grid is used).
</code></pre></div>

<h2 id="pawnhatxc"><strong>pawnhatxc</strong><a class="headerlink" href="#pawnhatxc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - Flag for exact computation of gradients of NHAT density in eXchange-Correlation.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a></li>
</ul>
</details>
<p>Relevant only when a GGA exchange-correlation functional is used.
When this flag is activated, the gradients of compensation charge density
(n_hat) are exactly computed (i.e. analytically); when it is deactivated, they
are computed with a numerical scheme in reciprocal space (which can produce
inaccurate results if the compensation charge density is highly localized).
As analytical treatment of compensation charge density gradients is CPU time
demanding, it is possible to bypass it with  <strong>pawnhatxc</strong>  = 0; but the numerical
accuracy can be affected by this choice. It is recommended to test the
validity of this approximation before use.</p>
<h2 id="pawnphi"><strong>pawnphi</strong><a class="headerlink" href="#pawnphi" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - Number of PHI angles used to discretize the sphere around each atom.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 13<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using OpenMP GPU.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t24.abi" target="_blank">t24.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with the same PAW atomic data, however defaulting to usexcnhat=0." data-toggle="popover" href="/tests/v9/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q=0.5 .
Works with pseudo Pseudodojo_paw_pbe_standard/Fe.xml , where usexcnhat=0 . See test v9#42 for the usexcnhat==1 case." data-toggle="popover" href="/tests/v9/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/v9/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ga75In25N, GGA, PAW.
Test correct treatment of primitive vectors that are slightly misaligned with cartesian axes.
Was mistreated by LibPAW prior to ABINITv9.2" data-toggle="popover" href="/tests/v9/Input/t190.abi" target="_blank">t190.abi</a></li>
</ul>
</details>
<p>Number of phi angles (longitude) used to discretize the data on the atomic
spheres. This discretization is completely defined by  <strong>pawnphi</strong>  and <a class="wikilink codevar-wikilink" href="/variables/paw#pawntheta">pawntheta</a>.</p>
<h2 id="pawntheta"><strong>pawntheta</strong><a class="headerlink" href="#pawntheta" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - Number of THETA angles used to discretize the sphere around each atom.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 12<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using OpenMP GPU.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t24.abi" target="_blank">t24.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with the same PAW atomic data, however defaulting to usexcnhat=0." data-toggle="popover" href="/tests/v9/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q=0.5 .
Works with pseudo Pseudodojo_paw_pbe_standard/Fe.xml , where usexcnhat=0 . See test v9#42 for the usexcnhat==1 case." data-toggle="popover" href="/tests/v9/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/v9/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ga75In25N, GGA, PAW.
Test correct treatment of primitive vectors that are slightly misaligned with cartesian axes.
Was mistreated by LibPAW prior to ABINITv9.2" data-toggle="popover" href="/tests/v9/Input/t190.abi" target="_blank">t190.abi</a></li>
</ul>
</details>
<p>Number of theta angles (latitude) used to discretize the data on the atomic
spheres. This discretization is completely defined by  <strong>pawntheta</strong>  and <a class="wikilink codevar-wikilink" href="/variables/paw#pawnphi">pawnphi</a>.</p>
<h2 id="pawnzlm"><strong>pawnzlm</strong><a class="headerlink" href="#pawnzlm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - only compute Non-Zero LM-moments of the contributions to the density from the spheres<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a></li>
</ul>
</details>
<p>Concerns the computation of the contributions to the density from the spheres
(named rho_1 - rho_tild_1).
If set to 0, all lm-moments of the sphere contributions to the density are
computed at each electronic iteration.
If set to 1, only non-zero lm-moments of the sphere contributions to the
density are computed at each electronic iteration (they are all computed at
the first iteration then only those found to be non-zero will be computed;
thus the first iteration is more cpu intensive)</p>
<h2 id="pawoptmix"><strong>pawoptmix</strong><a class="headerlink" href="#pawoptmix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - OPTion for the MIXing of the spherical part<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a></li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to verify that different values
of input variable &#x27;ortalg&#x27; give the same results for
total energy. &#x27;ortalg&#x27; is use in the conjugate gradient
algorithm which solves, in the case of PAW calculations,
a generalized eigenproblem (H.|Psi&gt;=Lambda.S|Psi&gt;).
Three datasets are perfomed ; they must give the same
total energies values (when converged)." data-toggle="popover" href="/tests/v4/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to mesure the convergence of
the total energy versus the variable &#x27;ecut&#x27;.
6 datasets are performed with ecut varying from 8 Ha to 18 Ha
Cut-off for the fine grid (used to transfer data from spherical
meshes to FFt meshes) remain constant." data-toggle="popover" href="/tests/v4/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in arbitrary structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to test the differents mixing scheme in PAW formalism.
Different values of iscf, pawmixdg and pawoptmix are choosen.
Features tested:
- mixing on density or potential (mod(iscf,10))
- different mixing schemes (iscf)
- inclusion of spherical part in residual (pawoptmix)
- mixing on coarse or fine grid (pawmixdg)
- mixing factor for spherical part (pawsphmix)
All mixing schemes give the same total energy." data-toggle="popover" href="/tests/v4/Input/t07.abi" target="_blank">t07.abi</a></li>
</ul>
</details>
<p>In the case of PAW computations, during the self-consistent cycle, ABINIT
mixes the density <span><span class="MathJax_Preview">\rho(r)= \tilde{\rho}(r) +\hat{\rho}(r)</span><script type="math/tex">\rho(r)= \tilde{\rho}(r) +\hat{\rho}(r)</script></span> and the occupancy matrix <span><span class="MathJax_Preview">\rho_{ij}</span><script type="math/tex">\rho_{ij}</script></span>. (<span><span class="MathJax_Preview">\tilde{\rho}(r)</span><script type="math/tex">\tilde{\rho}(r)</script></span> is
the pseudo density, <span><span class="MathJax_Preview">\hat{\rho}(r)</span><script type="math/tex">\hat{\rho}(r)</script></span> is the compensation charge density). It can be
redundant as <span><span class="MathJax_Preview">\rho_{ij}</span><script type="math/tex">\rho_{ij}</script></span> is contained in <span><span class="MathJax_Preview">\hat{\rho}(r)</span><script type="math/tex">\hat{\rho}(r)</script></span>.</p>
<ul>
<li>
<p>If <strong>pawoptmix</strong> =0:
ABINIT mixes <span><span class="MathJax_Preview">\rho(r)</span><script type="math/tex">\rho(r)</script></span> and <span><span class="MathJax_Preview">\rho_{ij}</span><script type="math/tex">\rho_{ij}</script></span> but the residual used to control the mixing
algorithm is only based on <span><span class="MathJax_Preview">\rho(r)</span><script type="math/tex">\rho(r)</script></span>.</p>
</li>
<li>
<p>If <strong>pawoptmix</strong> =1:
ABINIT mixes <span><span class="MathJax_Preview">\rho(r)</span><script type="math/tex">\rho(r)</script></span> and <span><span class="MathJax_Preview">\rho_{ij}</span><script type="math/tex">\rho_{ij}</script></span> and the residual used to control the mixing
algorithm is based on <span><span class="MathJax_Preview">\rho(r)</span><script type="math/tex">\rho(r)</script></span> and <span><span class="MathJax_Preview">\rho_{ij}</span><script type="math/tex">\rho_{ij}</script></span>.</p>
</li>
</ul>
<p>This has only an influence on the efficiency of the mixing algorithm.
In case of mixing problems, the first suggestion is to increase the size of the
history (see <a class="wikilink codevar-wikilink" href="/variables/dev#npulayit">npulayit</a>). Then it is also possible to play with the
parameters of the Kerker mixing: <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#diemac">diemac</a>, etc&hellip;</p>
<h2 id="pawoptosc"><strong>pawoptosc</strong><a class="headerlink" href="#pawoptosc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - OPTion for the computation of the OSCillator matrix elements<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-toggle="popover" href="/topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a Bethe-Salpeter calculation of neutral excitation energies and dielectric function" data-toggle="popover" href="/topics/BSE">topic_BSE</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-toggle="popover" href="/topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with PAW and nsppol = 2.
Use model dielectric function computed from AE PAW density (denfgr.F90)." data-toggle="popover" href="/tests/v67mbpt/Input/t29.abi" target="_blank">t29.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Only relevant for GW or Bethe-Salpeter calculations with PAW.
This variable defines the approach used for the evaluation of the oscillator
matrix elements within the PAW formalism. Possible values are 0,1,2.
If  <strong>pawoptosc</strong>  = 0 the code uses its internal default value (2 for SCREENING
calculations, 1 for SIGMA calculations, 2 for Bethe-Salpeter
If  <strong>pawoptosc</strong>  = 1 the matrix elements are computed with the expression given
by <a class="wikilink citation-wikilink" data-tippy-content="All-electron projector-augmented-wave $GW$ approximation: Application to the electronic properties of semiconductors" data-toggle="popover" href="/theory/bibliography#arnaud2000">[Arnaud2000]</a>. The equation is exact provided that the
set of PAW partial waves is complete.
If  <strong>pawoptosc</strong>  = 2 the matrix elements are computed with the approximated
expression proposed by <a class="wikilink citation-wikilink" data-tippy-content="Implementation and performance of the frequency-dependentGWmethod within the PAW framework" data-toggle="popover" href="/theory/bibliography#shishkin2006">[Shishkin2006]</a>.</p>
<h2 id="pawovlp"><strong>pawovlp</strong><a class="headerlink" href="#pawovlp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - spheres OVerLaP allowed (in percentage)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 5.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gold, 8 atom supercell, with PAW.
Test lotf_nitex, lotf_classic, lotf_version, lotf_nneigx.
These variables, concerning LOTF method, are taken into account only if the
enable_lotf=&quot;yes&quot; is used in configuration." data-toggle="popover" href="/tests/paral/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation
in (N,V,T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested
together with the three coordinate systems (primitive, normal mode, staging).
NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with
--- Pseudopotential description --" data-toggle="popover" href="/tests/v7/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-toggle="popover" href="/tests/v8/Input/t05.abi" target="_blank">t05.abi</a></li>
</ul>
</details>
<p>When PAW is activated, a localized atomic basis is added to describe wave
functions. Spheres around atoms are defined and they are IN PRINCIPLE not
allowed to overlap. However, a small overlap can be allowed without
compromising the accuracy of results. Be aware that too high overlaps can lead
to unphysical results.
With the <strong>pawovlp</strong> variable, the user can control the (voluminal) overlap
percentage allowed without stopping the execution.
<strong>pawovlp</strong> is the value (in percentage: 0&hellip;100%) obtained by dividing the
volume of the overlap of two spheres by the volume of the smallest sphere.
The following values are permitted for <strong>pawovlp</strong>:</p>
<ul>
<li><strong>pawovlp</strong> &lt; 0 &rarr; overlap is always allowed</li>
<li><strong>pawovlp</strong> = 0 &rarr; no overlap is allowed</li>
<li><strong>pawovlp</strong> &gt; 0 and &lt; 100 &rarr; overlap is allowed only if it is less than <strong>pawovlp</strong> %</li>
</ul>
<p>Note that ABINIT will not stop at the first time a too large overlap is identified, in case of <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a>/=0
or <a class="wikilink codevar-wikilink" href="/variables/rlx#imgmov">imgmov</a>/=0, but only at the second time in the same dataset. Indeed, such trespassing might only be transient.
However, a second trespassing in the same dataset, or if both <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a>=0 and <a class="wikilink codevar-wikilink" href="/variables/rlx#imgmov">imgmov</a>=0, will induce stop.</p>
<h2 id="pawprtden"><strong>pawprtden</strong><a class="headerlink" href="#pawprtden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW: PRinT total physical electron DENsity<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1245] in all abinit tests, [0/159] in abinit tutorials</summary></details>
<p><strong>Deprecated:</strong> See the <a class="wikilink codevar-wikilink" href="/variables/files#prtden">prtden</a>.</p>
<h2 id="pawprtdos"><strong>pawprtdos</strong><a class="headerlink" href="#pawprtdos" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW: PRinT partial DOS contributions<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic DOS and related topics" data-toggle="popover" href="/topics/ElecDOS">topic_ElecDOS</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute atom-centered properties" data-toggle="popover" href="/topics/AtomCentered">topic_AtomCentered</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> == 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PAW1 tutorial
Diamond at experimental volume
Computation of Density of States" data-toggle="popover" href="/tests/tutorial/Input/tpaw1_4.abi" target="_blank">tpaw1_4.abi</a></li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj to test restarxf -1" data-toggle="popover" href="/tests/v10/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj restarting from HIST file using restarxf -1" data-toggle="popover" href="/tests/v10/Input/t82.abi" target="_blank">t82.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>This input variable controls the computation and/or printing of contributions
to the PAW partial DOS in _DOS file(s):</p>
<ul>
<li>Plane-waves contribution</li>
</ul>
<p><span><span class="MathJax_Preview">+</span><script type="math/tex">+</script></span> &ldquo;on-site&rdquo; all-electron contribution (<span><span class="MathJax_Preview">\phi</span><script type="math/tex">\phi</script></span>)</p>
<p><span><span class="MathJax_Preview">-</span><script type="math/tex">-</script></span> &ldquo;on-site&rdquo; pseudo contribution (<span><span class="MathJax_Preview">\tilde{\phi}</span><script type="math/tex">\tilde{\phi}</script></span>).</p>
<p>If <strong>pawprtdos=0:</strong></p>
<ul>
<li>The 3 contributions are computed; only the total partial DOS is output in _DOS file.</li>
</ul>
<p>If <strong>pawprtdos=1:</strong></p>
<ul>
<li>The 3 contributions are computed and output in _DOS file.</li>
<li>In that case, integrated DOS is not output.</li>
</ul>
<p>If <strong>pawprtdos=2:</strong></p>
<ul>
<li>Only &ldquo;on-site&rdquo; all-electron contribution is computed and output in _DOS file.</li>
<li>This a (very) good approximation of total DOS, provided that (1) the PAW
  local basis is complete, (2) the electronic charge is mostly contained in PAW spheres.</li>
<li>In that case, the <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a> variable is automatically set to the PAW radius.</li>
</ul>
<h2 id="pawprtvol"><strong>pawprtvol</strong><a class="headerlink" href="#pawprtvol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW: PRinT VOLume<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [43/1245] in all abinit tests, [5/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for SrVO3 using Hubard I code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_1.abi" target="_blank">tucalc_crpa_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj to test restarxf -1" data-toggle="popover" href="/tests/v10/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj restarting from HIST file using restarxf -1" data-toggle="popover" href="/tests/v10/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT on Gd (f-orbitals) without spin-orbit coupling : compute occupations and energy." data-toggle="popover" href="/tests/v6/Input/t47.abi" target="_blank">t47.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v7/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/v7/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to use usepawu=4
Test done in comparison to [[cite:Chen2016a]]." data-toggle="popover" href="/tests/v8/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t78.abi" target="_blank">t78.abi</a> &hellip;</li>
</ul>
</details>
<p>Control print volume and debugging output for PAW in log file or standard
output. If set to 0, the print volume is at its minimum.
<strong>pawprtvol</strong> can have values from -3 to 3:</p>
<ul>
<li><strong>pawprtvol</strong> = -1 or 1: matrices <span><span class="MathJax_Preview">\rho_{ij}</span><script type="math/tex">\rho_{ij}</script></span> (atomic occupancies) and <span><span class="MathJax_Preview">D_{ij}</span><script type="math/tex">D_{ij}</script></span> (psp
  strength) are printed at each SCF cycle with details about their contributions.</li>
<li><strong>pawprtvol</strong> = -2 or 2: like -1 or 1 plus additional printing: moments of
  &ldquo;on-site&rdquo; densities, details about local exact exchange.</li>
<li><strong>pawprtvol</strong> = -3 or 3: like -2 or 2 plus additional printing: details about
  PAW+U, rotation matrices of spherical harmonics.</li>
</ul>
<p>When <strong>pawprtvol</strong> &gt;= 0, up to 12 components of <span><span class="MathJax_Preview">\rho_{ij}</span><script type="math/tex">\rho_{ij}</script></span> and <span><span class="MathJax_Preview">D_{ij}</span><script type="math/tex">D_{ij}</script></span> matrices for the
1<sup>st</sup> and last atom are printed.
When <strong>pawprtvol</strong> &lt; 0, all components of <span><span class="MathJax_Preview">\rho_{ij}</span><script type="math/tex">\rho_{ij}</script></span> and <span><span class="MathJax_Preview">D_{ij}</span><script type="math/tex">D_{ij}</script></span> matrices for all atoms are printed.</p>
<h2 id="pawprtwf"><strong>pawprtwf</strong><a class="headerlink" href="#pawprtwf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW: PRinT WaveFunctions<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a></li>
</ul>
</details>
<p>This input variable controls the output of the <strong>full</strong> PAW wave functions
including the on-site contributions inside each PAW sphere needed to
reconstruct the correct nodal shape in the augmentation region.
<strong>pawprtwf = 1</strong> causes the generation of a file _PAWAVES.nc containing the full wavefunctions
in <strong>real space</strong> on the fine FFT grid defined by <a class="wikilink codevar-wikilink" href="/variables/paw#pawecutdg">pawecutdg</a> or <a class="wikilink codevar-wikilink" href="/variables/paw#ngfftdg">ngfftdg</a>.</p>
<p>Limitations: At present (v8.0), <strong>pawprtwf = 1</strong> is not compatible with <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> =2 and parallel executions
Therefore the output of the _AE_WFK has to be done in sequential.
Moreover, in order to use this feature, one has to enable the support for netcdf at configure-time
as the _PAWAVES file is written using the NETCDF file format following the ETSF-IO
specifications for wavefunctions in real space.</p>
<p>If the code is run entirely in serial, additional output is made of various contributions to the all-electron
wavefunction. By default the full available set of bands and k-points are
output, but a single band and k-point index can be requested by using the
variables <a class="wikilink codevar-wikilink" href="/variables/dev#pawprt_b">pawprt_b</a> and <a class="wikilink codevar-wikilink" href="/variables/dev#pawprt_k">pawprt_k</a>.</p>
<h2 id="pawspnorb"><strong>pawspnorb</strong><a class="headerlink" href="#pawspnorb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - option for SPiN-ORBit coupling<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a spin-polarized calculation" data-toggle="popover" href="/topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> == 2,
0 otherwise.</p>
<p><em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [16/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a></li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with PAW and spin-orbit coupling. 2x2x2 K grid; low cut-off for test
Test paral_kgb==1 with MPI-FFT/spinor parallelization, the IO of the WFK file,
the output of potential files and the calculation of PJDOS in parallel
(PW term + on-site contributions)" data-toggle="popover" href="/tests/mpiio/Input/t28.abi" target="_blank">t28.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the parallelization over spinorial components of WF
Bi A7 structure (2 atoms, treated as semi-conductor),
using PAW, within LDA and spin-orbit coupling.
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)" data-toggle="popover" href="/tests/paral/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth atom, isolated, in a supercell - with and without spin-orbit coupling." data-toggle="popover" href="/tests/tutorial/Input/tspin_6.abi" target="_blank">tspin_6.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using PAW, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the spin-orbit coupling
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)
Also tests spnorbscl and pawcpxocc variables reserved to exp. users." data-toggle="popover" href="/tests/v5/Input/t17.abi" target="_blank">t17.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Electric field gradients in ICl molecule, with and without spin orbit coupling." data-toggle="popover" href="/tests/v6/Input/t49.abi" target="_blank">t49.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-toggle="popover" href="/tests/v7/Input/t82.abi" target="_blank">t82.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with the same PAW atomic data, however defaulting to usexcnhat=0." data-toggle="popover" href="/tests/v9/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW. Conventional cell, frozen phonon along 1 1 1
Test collinear treatment as well as non-collinear, with different starting spinat" data-toggle="popover" href="/tests/v9/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with the same PAW atomic data, and same usexcnhat=0 (default).
The total energy and stress change very little between all calculations. Good !
Note however that the SCF convergence is quite slow. Thus the good match was not obtained with
the initial value of nstep 12 (now nstep 30).
Also, note that the restart from a collinear calculation of a non-collinear calculation along z does not work well
with getwfk alone (DS3). After tuning the test, the use of getden -1 has been tried (in addition to getwfk -1),
and was observed to help significantly, although not being perfect as in DS2 or DS4.
Also, the portability of the restart is rather poor. This warrants further investigation." data-toggle="popover" href="/tests/v9/Input/t94.abi" target="_blank">t94.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nspinor 2" data-toggle="popover" href="/tests/v9/Input/t141.abi" target="_blank">t141.abi</a></li>
</ul>
</details>
<p>When PAW is activated, the <strong>spin-orbit coupling</strong> can be added without the
use of specific PAW datasets (pseudopotentials).
If  <strong>pawspnorb</strong>  = 1, spin-orbit will be added.
If the wavefunction is spinorial (that is, if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2), there is no
reason not to include the spin-orbit interaction, so that the default value of
 <strong>pawspnorb</strong>  becomes 1 when <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2.
Note that only the all-electron &ldquo;on-site&rdquo; contribution to the Hamiltonian is
taken into account; this is a very good approximation but requires the
following conditions to be fulfilled:</p>
<p>1- the  <span><span class="MathJax_Preview">\tilde{\phi}_{i}</span><script type="math/tex">\tilde{\phi}_{i}</script></span>  basis is complete enough</p>
<p>2- the electronic density is mainly contained in the PAW sphere</p>
<p>Also note that, when spin-orbit coupling is activated and there is some
magnetization <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 4, the time-reversal symmetry is broken.
The use of <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 1 or <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 2 is thus forbidden. It is advised to
use <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 3 (no symmetry used to generate k-points) or <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 4 (only
spatial symmetries used to generate k-points).
Be careful if you choose to use <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 0 (k-points given by hand); Time-
reversal symmetry has to be avoided.
An artificial scaling of the spin-orbit can be introduced thanks to the <a class="wikilink codevar-wikilink" href="/variables/paw#spnorbscl">spnorbscl</a> input variable.</p>
<h2 id="pawstgylm"><strong>pawstgylm</strong><a class="headerlink" href="#pawstgylm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - option for the STorage of G_l(r).YLM(r)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> = 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a></li>
</ul>
</details>
<p>When PAW is activated, the computation of compensation charge density (so
called &ldquo;hat&rdquo; density) requires the computation of <span><span class="MathJax_Preview">g_{l}(r).Y_{lm}(r)</span><script type="math/tex">g_{l}(r).Y_{lm}(r)</script></span> factors (and
cartesian derivatives) at each point of real space contained in PAW spheres.
The number of atoms, of (l,m) quantum numbers and the sharpness of the real
FFT grid can lead to a very big {<span><span class="MathJax_Preview">g_{l}.Y_{lm}</span><script type="math/tex">g_{l}.Y_{lm}</script></span>} datastructure. One can save memory
by putting  <strong>pawstgylm</strong>  = 0; but, in that case, <span><span class="MathJax_Preview">g_{l}(r).Y_{lm}(r)</span><script type="math/tex">g_{l}(r).Y_{lm}(r)</script></span> factors a re-
computed each time they are needed and CPU time increases.</p>
<p>Possible choices:</p>
<ul>
<li><strong>pawstgylm</strong>  = 0: <span><span class="MathJax_Preview">g_{l}(r).Y_{lm}(r)</span><script type="math/tex">g_{l}(r).Y_{lm}(r)</script></span> are not stored in memory and recomputed.</li>
<li><strong>pawstgylm</strong>  = 1: <span><span class="MathJax_Preview">g_{l}(r).Y_{lm}(r)</span><script type="math/tex">g_{l}(r).Y_{lm}(r)</script></span> are stored in memory.</li>
</ul>
<p>Note:
<span><span class="MathJax_Preview">g_{l}(r)</span><script type="math/tex">g_{l}(r)</script></span> are shape functions (analytically known)</p>
<p><span><span class="MathJax_Preview">Y_{lm}(r)</span><script type="math/tex">Y_{lm}(r)</script></span> are real spherical harmonics</p>
<h2 id="pawsushat"><strong>pawsushat</strong><a class="headerlink" href="#pawsushat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - SUSceptibility, inclusion of HAT (compensation charge) contribution<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1245] in all abinit tests, [0/159] in abinit tutorials</summary></details>
<p>Ground-State calculation only.
When a sophisticated preconditioning scheme is selected for the SCF cycle of a
Ground-State calculation (<a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> &gt; 0), the computation of the susceptibility
matrix is required several times during the cycle. This computation is
computer time consuming, especially &ndash; within PAW &ndash; because of the inclusion
of additional terms due to the compensation charge density. As only a crude
valuation of the susceptibilty matrix is needed (to evaluate a preconditioning
matrix), the compensation charge contribution can be neglected to save CPU
time (select  <strong>pawsushat</strong>  = 0). This approximation could be unfavourable in
some cases; in the latter, we advise to put  <strong>pawsushat</strong>  = 1.</p>
<p>Possible choices:</p>
<ul>
<li><strong>pawsushat</strong>  = 0: only plane-wave contribution to suscep. matrix is computed.</li>
<li><strong>pawsushat</strong>  = 1: the whole suscep. matrix (PW + PAW on-site) is computed.</li>
</ul>
<h2 id="pawusecp"><strong>pawusecp</strong><a class="headerlink" href="#pawusecp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - option for the USE of CPrj in memory (cprj=WF projected with NL projector)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a></li>
</ul>
</details>
<p>When PAW is activated, the computation of cprj arrays is memory and time consuming.
When  <strong>pawusecp</strong>  = 0, then the cprj are never kept in memory, they are
recomputed when needed (this is CPU-time consuming). When  <strong>pawusecp</strong>  = 1, then
the cprj are computed once and then kept in memory.
Change the value of the keyword only if you are an experienced user (developer).
Remember:</p>
<div>
<div class="MathJax_Preview"> cprj = \langle\tilde{\psi}_{m}.p_{i} \rangle </div>
<script type="math/tex; mode=display"> cprj = \langle\tilde{\psi}_{m}.p_{i} \rangle </script>
</div>
<p>with <span><span class="MathJax_Preview">\tilde{\psi}_{n}</span><script type="math/tex">\tilde{\psi}_{n}</script></span> is the wave function, and <span><span class="MathJax_Preview">p_{i}</span><script type="math/tex">p_{i}</script></span> the non-local projector.</p>
<p>For the time being, only activated for RF calculations.</p>
<h2 id="pawxcdev"><strong>pawxcdev</strong><a class="headerlink" href="#pawxcdev" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW - choice for eXchange-Correlation DEVelopment (spherical part)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [21/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
27-electron PAW pseudo (4f and 5d are explicitly treated : 4d10 4f7 5s2 5p6 (5d0) 6s2 )
Test of initialisation using occopt=1 (the default) with non-zero spinmagntarget,
and also metallic occopt. Also test pawxcdev=0" data-toggle="popover" href="/tests/v7/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of phonons and response to electric field within PAW and GGA (both q=0 and q/=0)
Test on AlAs structure; Ground state, DDK and Dielectric tensor are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters (ngkpt, ecut and pawecutdg)." data-toggle="popover" href="/tests/v8/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield)." data-toggle="popover" href="/tests/v8/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t84.abi" target="_blank">t84.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with the same PAW atomic data, however defaulting to usexcnhat=0." data-toggle="popover" href="/tests/v9/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q=0.5 .
Works with pseudo Pseudodojo_paw_pbe_standard/Fe.xml , where usexcnhat=0 . See test v9#42 for the usexcnhat==1 case." data-toggle="popover" href="/tests/v9/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/v9/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
</ul>
</details>
<ul>
<li>If set to 0, the exchange-correlation term in the spherical part of energy is totally computed on the angular mesh (time consuming but exact!)</li>
<li>If set to 1, the exchange-correlation term in the spherical part of energy is developed onto lm-moments at order 1</li>
<li>If set to 2, the exchange-correlation term in the spherical part of energy is developed onto lm-moments at order 2</li>
</ul>
<p>Be careful: Response function (DFPT) + PAW + GGA requires  <strong>pawxcdev</strong>  = 0. But if you plan to do DFPT calculations, it is better to use this option also in the preliminary ground state calculation.
However, if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 4 (non-collinear calculations) with GGA and <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a>/=0, one needs to use  <strong>pawxcdev</strong>  = 1.</p>
<h2 id="prtnabla"><strong>prtnabla</strong><a class="headerlink" href="#prtnabla" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRint NABLA<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, with PAW.
Test the IO routines with paral_kgb in [1, 0] and different combinations
of parameters (npfft, npband, np_spkpt).
Test the plane wave load balancing procedure (pw_unbal_thresh).
Test also the computation of PJDOS." data-toggle="popover" href="/tests/mpiio/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, with NC pseudo generated with oncvps-3.2.3.
Test the IO routines with paral_kgb in [1, 0] and different combinations
of parameters (npfft, npband, np_spkpt).
Test also prtdos (PJDOS) in parallel with MPI-FFT.
Similar to t26.in" data-toggle="popover" href="/tests/mpiio/Input/t27.abi" target="_blank">t27.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a conductivity calculation (test v5#t10)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 10.
It tests the following parts of the code:
optic_paw, optic_paw_core
Note that, in addition to the psp file, the core wave functions file is needed." data-toggle="popover" href="/tests/v5/Input/t09.abi" target="_blank">t09.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t101)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 101.
It tests the following parts of the code:
optic_paw, optic_paw_core, optic_paw_soc
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t100.abi" target="_blank">t100.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t102)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 103.
It tests the following parts of the code:
optic_paw_core
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t102.abi" target="_blank">t102.abi</a></li>
</ul>
</details>
<ul>
<li>If set to 1, calculate the matrix elements <Psi_n|-inabla|Psi_m> and write it in file _OPT to be read by the code conducti (see <a class="wikilink citation-wikilink" data-tippy-content="Calculations of the transport properties within the PAW formalism" data-toggle="popover" href="/theory/bibliography#mazevet2010">[Mazevet2010]</a>).</li>
</ul>
<h2 id="ptcharge"><strong>ptcharge</strong><a class="headerlink" href="#ptcharge" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PoinT CHARGEs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to calculate electric fields gradients and Mossbauer Fermi contact interaction" data-toggle="popover" href="/topics/EFG">topic_EFG</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> <em>0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#nucefg">nucefg</a>&gt;=3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite, high-pressure polymorph of SiO2. LDA.
Computation of the electric field gradient at each site using both PAW and
a simple point charge model. Coded and contributed by J. Zwanziger." data-toggle="popover" href="/tests/v5/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p>Array of point charges, in atomic units, of the nuclei. In the normal
  computation of electric field gradients (see <a class="wikilink codevar-wikilink" href="/variables/paw#nucefg">nucefg</a>) the ionic
  contribution is calculated from the core charges of the atomic sites. Thus
  for example in a PAW data set for oxygen where the core is <span><span class="MathJax_Preview">1s^{2}</span><script type="math/tex">1s^{2}</script></span>, the core
  charge is +6 (total nuclear charge minus core electron charge). In point
  charge models, which are much less accurate than PAW calculations, all atomic
  sites are treated as ions with charges determined by their valence states. In
  such a case oxygen almost always would have a point charge of -2. The present
  variable taken together with <a class="wikilink codevar-wikilink" href="/variables/paw#nucefg">nucefg</a> performs a full PAW computation of
  the electric field gradient and also a simple point charge computation. The
  user inputs whatever point charges he/she wishes for each atom type.</p>
<h2 id="quadmom"><strong>quadmom</strong><a class="headerlink" href="#quadmom" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> QUADrupole MOMents<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to calculate electric fields gradients and Mossbauer Fermi contact interaction" data-toggle="popover" href="/topics/EFG">topic_EFG</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> <em>0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#nucefg">nucefg</a>&gt;1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite (a polymorph of SiO2)
Test PBEsol in the PAW formalism, using PAW datasets created with atompaw linked with libxc.
Note that the value of ixc is not present in the input file, but it is present in the ATOMPAW dataset (pspxc = -116133)" data-toggle="popover" href="/tests/libxc/Input/t10.abi" target="_blank">t10.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_1.abi" target="_blank">tnuc_1.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite, high-pressure polymorph of SiO2. LDA.
Computation of the electric field gradient at each atomic site.
This tests the implementation of the PAW-based
efg algorithm as outlined in Profeta, Mauri, and Pickard, J. Am. Chem. Soc.
125, 541-548 (2003). Coded by J. Zwanziger and M. Torrent." data-toggle="popover" href="/tests/v5/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite, high-pressure polymorph of SiO2. GGA (PBE).
Computation of the electric field gradient at each atomic site.
This tests the implementation of the PAW-based
efg algorithm as outlined in Profeta, Mauri, and Pickard, J. Am. Chem. Soc.
125, 541-548 (2003)." data-toggle="popover" href="/tests/v5/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Cu2O
Computation of the total energy and EFG tensors in DFT+U formalism
Note: Cu2O is a nonmagnetic insulator. However, DFT+U
as implemented requires nspden=2 in all cases." data-toggle="popover" href="/tests/v5/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite, high-pressure polymorph of SiO2. LDA.
Computation of the electric field gradient at each site using both PAW and
a simple point charge model. Coded and contributed by J. Zwanziger." data-toggle="popover" href="/tests/v5/Input/t35.abi" target="_blank">t35.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Electric field gradient of indium metal, body-centered tetragonal, included to
check EFG symmetry in this case." data-toggle="popover" href="/tests/v6/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Electric field gradients in ICl molecule, with and without spin orbit coupling." data-toggle="popover" href="/tests/v6/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<ul>
<li>Array of quadrupole moments, in barns, of the nuclei. These values are used
  in conjunction with the electric field gradients computed with <a class="wikilink codevar-wikilink" href="/variables/paw#nucefg">nucefg</a> to
  calculate the quadrupole couplings in MHz, as well as the asymmetries. Note that
  the electric field gradient at a nuclear site is independent of the nuclear
  quadrupole moment, thus the quadrupole moment of a nucleus can be input as 0.</li>
</ul>
<h2 id="spnorbscl"><strong>spnorbscl</strong><a class="headerlink" href="#spnorbscl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SPin-ORBit SCaLing<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a spin-polarized calculation" data-toggle="popover" href="/topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0<br />
<em>Only relevant if:</em> ( <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#pawspnorb">pawspnorb</a> &gt;= 1) .or NC pseudos with SOC terms.<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Same as v9[207] but with npband=4. Compare chebfi2 with respect to other algorithms." data-toggle="popover" href="/tests/paral/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test local susceptibility from CTQMC at spin-orbit level. Not realistic" data-toggle="popover" href="/tests/paral/Input/t101.abi" target="_blank">t101.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using PAW, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the spin-orbit coupling
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)
Also tests spnorbscl and pawcpxocc variables reserved to exp. users." data-toggle="popover" href="/tests/v5/Input/t17.abi" target="_blank">t17.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the extension of the pspcod=8 input format to include
spin-orbit coupling with multiple non-local projectors and pseudized valence charge density
The relativistic extension is documented in the code package.
The Pt 5s and 5p semi-cores are treated as valence.
A complete description of the input format is avaiable in  doc/psp_infos/psp8_info.txt." data-toggle="popover" href="/tests/v7/Input/t17.abi" target="_blank">t17.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different versions of PAW+U formalism are tested.
Negative values of usepawu should give exactly the same results as with positive values.
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v9/Input/t79.abi" target="_blank">t79.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Same as t206 but with nspinor=2. Compare chebfi2 with respect to other algorithms." data-toggle="popover" href="/tests/v9/Input/t207.abi" target="_blank">t207.abi</a></li>
</ul>
</details>
<p>Scaling of the spin-orbit interaction. The default values (one) gives
the first-principles value, while other values are used for the analysis of the effect
of the spin-orbit interaction, but are not expected to correspond to any
physical situation.</p>
<p>Note that, starting with version 9.5.2, this option is also compatible with NC pseudos provided
the pseudopotential files include the SOC term.</p>
<h2 id="upawu"><strong>upawu</strong><a class="headerlink" href="#upawu" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> value of U for PAW+U<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> <em>0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [56/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for SrVO3 using Hubard I code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="second run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_2.abi" target="_blank">tdftu_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="third run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_3.abi" target="_blank">tdftu_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Fourth run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_4.abi" target="_blank">tdftu_4.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
27-electron PAW pseudo (4f and 5d are explicitly treated : 4d10 4f7 5s2 5p6 (5d0) 6s2 )
Test of initialisation using occopt=1 (the default) with non-zero spinmagntarget,
and also metallic occopt. Also test pawxcdev=0" data-toggle="popover" href="/tests/v7/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to use usepawu=4
Test done in comparison to [[cite:Chen2016a]]." data-toggle="popover" href="/tests/v8/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t78.abi" target="_blank">t78.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the value of the screened coulomb interaction between correlated
electrons corresponding to <a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a> for each species.
In the case where <a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a> =-1, the value is not used.
In the case of a GW calculation, the U interaction defined by  <strong>upawu</strong>  will
be REMOVED from the self energy. In particular, for G0 W0 calculations
(perturbative calculations), the energy eigenvalues obtained after an
underlying DFT+U calculation will be</p>
<div>
<div class="MathJax_Preview">E_{GW} = E_{DFT+U} + &lt; \phi | Self-energy - U | \phi&gt;</div>
<script type="math/tex; mode=display">E_{GW} = E_{DFT+U} + < \phi | Self-energy - U | \phi></script>
</div>
<p>Actually, in order to perform a GW @ DFT+U calculation, one should define the
same value of U in the self-energy calculation, than the one defined in the
DFT calculation. The easiest is actually to define the value of U for the
whole set of calculations (for the different datasets), including the
screening, even if the U value does not play explicitly a role in the
computation of the latter (well, the input wavefunctions will be different
anyhow).
It is possible to perform calculations of the type GW+<span><span class="MathJax_Preview">U^{'}</span><script type="math/tex">U^{'}</script></span> @ DFT+U, so
keeping a <span><span class="MathJax_Preview">U^{'}</span><script type="math/tex">U^{'}</script></span> interaction (usually smaller than the initial U) in the GW
calculation.
This value will be subtracted in the GW correction calculation, as outlined
above.
Explicitly, in order to do a calculation of a material with a DFT U value of
7.5 eV, followed by a GW calculation where there is a residual U value of 2
eV, one has to define:</p>
<div class="codehilite"><pre><span></span><code>  <span class="nv">upawu1</span>   <span class="mi">7</span>.<span class="mi">5</span> <span class="nv">eV</span>   <span class="o">!</span> <span class="nv">This</span> <span class="nv">is</span> <span class="k">for</span> <span class="nv">the</span> <span class="nv">DFT</span> <span class="nv">calculation</span>
...
<span class="nv">optdriver4</span>  <span class="mi">4</span>
<span class="nv">upawu4</span>   <span class="mi">5</span>.<span class="mi">5</span> <span class="nv">eV</span>   <span class="o">!</span> <span class="nv">This</span> <span class="nv">is</span> <span class="k">for</span> <span class="nv">the</span> <span class="nv">screening</span> <span class="nv">calculation</span>
</code></pre></div>

<h2 id="usedmatpu"><strong>usedmatpu</strong><a class="headerlink" href="#usedmatpu" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE of an initial Density MATrix in Paw+U<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [16/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a></li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="third run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_3.abi" target="_blank">tdftu_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Fourth run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_4.abi" target="_blank">tdftu_4.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U features.
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Antiferromagnetism and PAW+U
* Use of an initial and constant density matrix during the first SCF iterations" data-toggle="popover" href="/tests/v5/Input/t37.abi" target="_blank">t37.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT on Gd (f-orbitals) without spin-orbit coupling : compute occupations and energy." data-toggle="popover" href="/tests/v6/Input/t47.abi" target="_blank">t47.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test to use usepawu=4
Test done in comparison to [[cite:Chen2016a]]." data-toggle="popover" href="/tests/v8/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p>When  <strong>usedmatpu</strong> /=0, an initial density matrix (given by <a class="wikilink codevar-wikilink" href="/variables/paw#dmatpawu">dmatpawu</a>
keyword) is used and kept fixed during the first ABS( <strong>usedmatpu</strong> ) SCF steps.
This starting value of the density matrix can be useful to find the correct
ground state. Within DFT+U formalism, finding the minimal energy of the system
is tricky; thus it is advised to test several values of the initial density
matrix.
Note also that the density matrix has to respect some symmetry rules
determined by the space group. If the symmetry is not respected in the input,
the matrix is however automatically symmetrised.</p>
<p>The sign of  <strong>usedmatpu</strong>  has influence only when <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a> /= 0 (dynamics or relaxation):</p>
<ul>
<li>When  <strong>usedmatpu</strong> &gt;0, the density matrix is kept constant only at first ionic step</li>
<li>When  <strong>usedmatpu</strong> &lt;0, the density matrix is kept constant at each ionic step</li>
</ul>
<h2 id="useexexch"><strong>useexexch</strong><a class="headerlink" href="#useexexch" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE of EXact EXCHange<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms per cell
Test computation of the local exact exchange (PBE0) in PAW." data-toggle="popover" href="/tests/v5/Input/t18.abi" target="_blank">t18.abi</a></li>
</ul>
</details>
<p>When  <strong>useexexch</strong>  = 1, the hybrid functional PBE0 is used in PAW, inside PAW
spheres only, and only for correlated orbitals given by <a class="wikilink codevar-wikilink" href="/variables/paw#lexexch">lexexch</a>. To change
the ratio of exact exchange, see also <a class="wikilink codevar-wikilink" href="/variables/dev#exchmix">exchmix</a>.</p>
<h2 id="usepawu"><strong>usepawu</strong><a class="headerlink" href="#usepawu" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE PAW+U (spherical part)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a GW calculation, including self-consistency" data-toggle="popover" href="/topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-toggle="popover" href="/topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [62/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for SrVO3 using Hubard I code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="second run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_2.abi" target="_blank">tdftu_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="third run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_3.abi" target="_blank">tdftu_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Fourth run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_4.abi" target="_blank">tdftu_4.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni atom in a big box.
Test the use of the atvshift variable :
change the potential of the d orbitals." data-toggle="popover" href="/tests/v5/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni molecule in a big box.
Test the use of the atvshift variable
First dataset : no shift, the ten states number 9 to 18
come from the 3d atomic states, the state number 19 is a bonding 4s state.
States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1).
State number 18 is a 3d sigma antibonding state (m=0).
Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the
levels change by less than 0.0002 (and their energy decrease), except state number
9 (a 3d sigma bonding state (m=0)), that goes from -0.24020 to -0.23982 (+0.0004)
and state number 18, that goes from -0.15439 to 0.15399 (+0.0004).
Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials.
All the levels are affected (likely the m=1 and -1 orbitals adjust, and cause modification
of the potential), but the states 10, 11, 16, and 17 increase their energy, while the
other state see their energy decrease.
Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking
of the degeneracy.
This test was not easy to make portable. The problem lies in the fact that when the density
becomes negative, due to Bragg oscillations, the xc kernel can be extremely large, and when
use for the prediction of the residual of the forces, the differences between machines
can be extremely large. IN order to see this effect, put ecut 7 and npulayit 7 (its default value)." data-toggle="popover" href="/tests/v5/Input/t15.abi" target="_blank">t15.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
27-electron PAW pseudo (4f and 5d are explicitly treated : 4d10 4f7 5s2 5p6 (5d0) 6s2 )
Test of initialisation using occopt=1 (the default) with non-zero spinmagntarget,
and also metallic occopt. Also test pawxcdev=0" data-toggle="popover" href="/tests/v7/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to use usepawu=4
Test done in comparison to [[cite:Chen2016a]]." data-toggle="popover" href="/tests/v8/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t78.abi" target="_blank">t78.abi</a> &hellip;</li>
</ul>
</details>
<p>Must be non-zero if a DFT+U calculation is done, or if a GW calculation
following a DFT+U calculation is done (important!), or if a DMFT calculation is done..</p>
<ul>
<li>
<p>If set to 0, the DFT+U method is not used.</p>
</li>
<li>
<p>If the absolute value is set to 1, 2 or 4, the DFT+U method (cf <a class="wikilink citation-wikilink" data-tippy-content="Band theory and Mott insulators: Hubbard U instead of Stoner I" data-toggle="popover" href="/theory/bibliography#anisimov1991a">[Anisimov1991a]</a>) is used.
The full rotationally invariant formulation is used (see Eq. (3) of <a class="wikilink citation-wikilink" data-tippy-content="Density-functional theory and strong interactions: Orbital ordering in Mott-Hubbard insulators" data-toggle="popover" href="/theory/bibliography#liechtenstein1995">[Liechtenstein1995]</a>) for the interaction term of the energy.
Three choices are allowed concerning the double counting term:</p>
<ul>
<li>
<p>If abs( <strong>usepawu</strong> ) = 1 or 10, the Full Localized Limit (FLL) (or Atomic limit) double counting is used (cf Eq. (4) of <a class="wikilink citation-wikilink" data-tippy-content="Density-functional theory and strong interactions: Orbital ordering in Mott-Hubbard insulators" data-toggle="popover" href="/theory/bibliography#liechtenstein1995">[Liechtenstein1995]</a> or Eq. (8) of <a class="wikilink citation-wikilink" data-tippy-content="Local-density functional and on-site correlations: The electronic structure of La2CuO4 and LaCuO3" data-toggle="popover" href="/theory/bibliography#czyzyk1994">[Czyzyk1994]</a>).</p>
</li>
<li>
<p>If abs( <strong>usepawu</strong> ) = 2, the Around Mean Field (AMF) double counting is used (cf Eq. (7) of <a class="wikilink citation-wikilink" data-tippy-content="Local-density functional and on-site correlations: The electronic structure of La2CuO4 and LaCuO3" data-toggle="popover" href="/theory/bibliography#czyzyk1994">[Czyzyk1994]</a>). Not valid if nspinor=2.</p>
</li>
<li>
<p>If abs( <strong>usepawu</strong> ) = 4 or 14, the FLL double counting is used. However, and in comparison to usepaw=1, the calculation is done without
polarization in the exchange correlation functional (cf <a class="wikilink citation-wikilink" data-tippy-content="Density functional versus spin-density functional and the choice of correlated subspace in multivariable effective action theories of electronic structure" data-toggle="popover" href="/theory/bibliography#park2015">[Park2015]</a> and <a class="wikilink citation-wikilink" data-tippy-content="Spin-density functional theories and their $+U$ and $+J$ extensions: A comparative study of transition metals and transition metal oxides" data-toggle="popover" href="/theory/bibliography#chen2016a">[Chen2016a]</a>). In this case, one must use <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&lt;10.</p>
</li>
</ul>
</li>
</ul>
<p>For DMFT calculations <a class="wikilink codevar-wikilink" href="/variables/dev#usedmft">usedmft</a>=1, only  <strong>usepawu</strong> =10 or 14 is permitted. For other types of calculations, abs( <strong>usepawu</strong> )=10 or 14 cannot be used.
Positive and negative values of <a class="wikilink codevar-wikilink" href="/variables/dev#usedmft">usedmft</a>, only differ by their internal implementation. At some stage, only positive values will be used again.</p>
<p>If <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 4 (non-collinear calculations) with GGA, one needs to use <a class="wikilink codevar-wikilink" href="/variables/paw#pawxcdev">pawxcdev</a> = 1,
and either abs( <strong>usepawu</strong> )=0, 1, 4, 10 or 14.</p>
<p>If DFT+U is activated ( <strong>usepawu</strong> /=0), the <a class="wikilink codevar-wikilink" href="/variables/paw#lpawu">lpawu</a>, <a class="wikilink codevar-wikilink" href="/variables/paw#upawu">upawu</a> and
<a class="wikilink codevar-wikilink" href="/variables/paw#jpawu">jpawu</a> input variables are read.
The implementation is done inside PAW augmentation regions only (cf <a class="wikilink citation-wikilink" data-tippy-content="Implementation of the projector augmented-wave LDA+U method: Application to the electronic structure of NiO" data-toggle="popover" href="/theory/bibliography#bengone2000">[Bengone2000]</a>).
The initial density matrix can be given in the input file (see <a class="wikilink codevar-wikilink" href="/variables/paw#usedmatpu">usedmatpu</a>).
The expression of the density matrix is chosen thanks to <a class="wikilink codevar-wikilink" href="/variables/paw#dmatpuopt">dmatpuopt</a>.
In the case of a GW calculation on top of a DFT+U, the absence of definition
of a U value in the self-energy will LEAVE the underlying U from the DFT
calculation. Thus, the code will actually do a GW+U @ DFT+U calculation. Note
that the screening calculation will not be affected by the presence/absence of
a U value.
Actually, in order to perform a GW @ DFT+U calculation, one should define the
same value of U in the self-energy calculation, than the one defined in the
DFT calculation. The code will know that the interaction corresponding to that
value has to be SUBTRACTED inside the self-energy. The easiest is actually to
define the presence of U for the whole set of calculations (for the different
datasets), including the screening, even if the U value does not play
explicitly a role in the computation of the latter (well, the input
wavefunctions will be different anyhow).
It is possible to perform calculations of the type GW+<span><span class="MathJax_Preview">U^{'}</span><script type="math/tex">U^{'}</script></span> @ DFT+U, so
keeping a smaller U interaction in the GW calculation, by subtracting a
smaller U than the one used in the DFT calculation. See the description of the
<a class="wikilink codevar-wikilink" href="/variables/paw#upawu">upawu</a> input variable.</p>
<p>Suggested acknowledgment <a class="wikilink citation-wikilink" data-tippy-content="γ and β cerium: LDA+U calculations of ground-state parameters" data-toggle="popover" href="/theory/bibliography#amadon2008a">[Amadon2008a]</a>.</p>
<h2 id="usexcnhat"><strong>usexcnhat</strong><a class="headerlink" href="#usexcnhat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE eXchange-Correlation with NHAT (compensation charge density)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [26/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using OpenMP GPU.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/paral/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/paral/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/paral/Input/t95.abi" target="_blank">t95.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test presence of nuclear magnetic dipole moments on atomic sites" data-toggle="popover" href="/tests/v7/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with and without PAW XML data (FJollet)" data-toggle="popover" href="/tests/v7/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for PWPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t61.abi" target="_blank">t61.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/v8/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with the same PAW atomic data, however defaulting to usexcnhat=0." data-toggle="popover" href="/tests/v9/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q=0.5 .
Works with pseudo Pseudodojo_paw_pbe_standard/Fe.xml , where usexcnhat=0 . See test v9#42 for the usexcnhat==1 case." data-toggle="popover" href="/tests/v9/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/v9/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
</ul>
</details>
<p>This flag determines how the exchange-correlation terms are computed for the
pseudo-density.</p>
<ul>
<li>
<p>When <strong>usexcnhat</strong> = 0, the exchange-correlation potential does not include the
compensation charge density, i.e. <span><span class="MathJax_Preview">V_{xc}=V_{xc}(\tilde{n}_{core} + \tilde{n}_{valence})</span><script type="math/tex">V_{xc}=V_{xc}(\tilde{n}_{core} + \tilde{n}_{valence})</script></span>.</p>
</li>
<li>
<p>When <strong>usexcnhat</strong> = 1, the exchange-correlation potential includes the compensation
charge density, i.e. <span><span class="MathJax_Preview">V_{xc}=V_{xc}(\tilde{n}_{core} + \tilde{n}_{valence}+\hat{n})</span><script type="math/tex">V_{xc}=V_{xc}(\tilde{n}_{core} + \tilde{n}_{valence}+\hat{n})</script></span>.</p>
</li>
<li>
<p>When <strong>usexcnhat</strong> = -1,the value of <strong>usexcnhat</strong> is determined from the
reading of the PAW dataset file (pseudopotential file).</p>
</li>
</ul>
<p>When PAW datasets with different treatment of <span><span class="MathJax_Preview">V_{xc}</span><script type="math/tex">V_{xc}</script></span> are used in the same run, the code stops.</p>
<p>The difference between these treatments has been studied in detail in <a class="wikilink citation-wikilink" data-tippy-content="Electronic structure packages: Two implementations of the projector augmented wave (PAW) formalism" data-toggle="popover" href="/theory/bibliography#torrent2010">[Torrent2010]</a>.
The choice <strong>usexcnhat</strong> = 1 is implemented in VASP and QE, but <strong>usexcnhat</strong> = 0 is not available in these software (as of 2022).
However, in <a class="wikilink citation-wikilink" data-tippy-content="Electronic structure packages: Two implementations of the projector augmented wave (PAW) formalism" data-toggle="popover" href="/theory/bibliography#torrent2010">[Torrent2010]</a> several advantages of the choice <strong>usexcnhat</strong> = 0 are made clear.</p>
<p>The value <strong>usexcnhat</strong> = 0 corresponds to Bloechl form, see Eq.(2) of <a class="wikilink citation-wikilink" data-tippy-content="Electronic structure packages: Two implementations of the projector augmented wave (PAW) formalism" data-toggle="popover" href="/theory/bibliography#torrent2010">[Torrent2010]</a>.
The PAW atomic datasets from JTH table <a class="wikilink citation-wikilink" data-tippy-content="Generation of Projector Augmented-Wave atomic data: A 71 element validated table in the XML format" data-toggle="popover" href="/theory/bibliography#jollet2014">[Jollet2014]</a> yield <strong>usexcnhat</strong> = 0 by default,
and it is expected that all future versions of this table will also yield <strong>usexcnhat</strong> = 0 by default..
The value <strong>usexcnhat</strong> = 1 corresponds to Kresse form, see Eq.(3) of <a class="wikilink citation-wikilink" data-tippy-content="Electronic structure packages: Two implementations of the projector augmented wave (PAW) formalism" data-toggle="popover" href="/theory/bibliography#torrent2010">[Torrent2010]</a>.
With ABINIT, only the oldest PAW atomic datasets favour <strong>usexcnhat</strong> = 1.</p>
<p>Still, the ABINIT user has both options.</p>
                
                  
                
              

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/"
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../paral/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Parallelism
            </div>
          </div>
        </a>
      
      
        <a href="../dfpt/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              DFPT
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version b'10.2.3-dirty'</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "b'10.2.3-dirty'"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>