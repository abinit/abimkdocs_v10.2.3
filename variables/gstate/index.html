
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="gstate input variables">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/variables/gstate/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Ground-State - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gstate-input-variables" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ground-State
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Variables
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorial/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        Abitk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_15" type="checkbox" id="__nav_1_15" >
      
      <label class="md-nav__link" for="__nav_1_15">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_15">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        AtomCentered
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        CalcUJ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        GWR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        Install
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        NMR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" checked>
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Ground-State
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Ground-State
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#algalch" class="md-nav__link">
    algalch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auxc_ixc" class="md-nav__link">
    auxc_ixc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auxc_scal" class="md-nav__link">
    auxc_scal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boxcenter" class="md-nav__link">
    boxcenter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boxcutmin" class="md-nav__link">
    boxcutmin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellcharge" class="md-nav__link">
    cellcharge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#charge" class="md-nav__link">
    charge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chkexit" class="md-nav__link">
    chkexit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chkparal" class="md-nav__link">
    chkparal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chkprim" class="md-nav__link">
    chkprim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chksymbreak" class="md-nav__link">
    chksymbreak
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chksymtnons" class="md-nav__link">
    chksymtnons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chrgat" class="md-nav__link">
    chrgat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constraint_kind" class="md-nav__link">
    constraint_kind
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cprj_in_memory" class="md-nav__link">
    cprj_in_memory
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpuh" class="md-nav__link">
    cpuh
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpum" class="md-nav__link">
    cpum
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpus" class="md-nav__link">
    cpus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diecut" class="md-nav__link">
    diecut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diegap" class="md-nav__link">
    diegap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dielam" class="md-nav__link">
    dielam
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dielng" class="md-nav__link">
    dielng
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diemac" class="md-nav__link">
    diemac
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diemix" class="md-nav__link">
    diemix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diemixmag" class="md-nav__link">
    diemixmag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dosdeltae" class="md-nav__link">
    dosdeltae
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enunit" class="md-nav__link">
    enunit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expert_user" class="md-nav__link">
    expert_user
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extfpmd_nband" class="md-nav__link">
    extfpmd_nband
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extfpmd_nbcut" class="md-nav__link">
    extfpmd_nbcut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extfpmd_nbdbuf" class="md-nav__link">
    extfpmd_nbdbuf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fband" class="md-nav__link">
    fband
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fock_icutcoul" class="md-nav__link">
    fock_icutcoul
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fockdownsampling" class="md-nav__link">
    fockdownsampling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fockoptmix" class="md-nav__link">
    fockoptmix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyb_mixing" class="md-nav__link">
    hyb_mixing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyb_mixing_sr" class="md-nav__link">
    hyb_mixing_sr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyb_range_dft" class="md-nav__link">
    hyb_range_dft
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyb_range_fock" class="md-nav__link">
    hyb_range_fock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iatsph" class="md-nav__link">
    iatsph
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#icoulomb" class="md-nav__link">
    icoulomb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#icutcoul" class="md-nav__link">
    icutcoul
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iprcel" class="md-nav__link">
    iprcel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iqpt" class="md-nav__link">
    iqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ivalence" class="md-nav__link">
    ivalence
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ixcpositron" class="md-nav__link">
    ixcpositron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jellslab" class="md-nav__link">
    jellslab
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptbounds" class="md-nav__link">
    kptbounds
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptrlatt" class="md-nav__link">
    kptrlatt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptrlen" class="md-nav__link">
    kptrlen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magcon_lambda" class="md-nav__link">
    magcon_lambda
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magconon" class="md-nav__link">
    magconon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixalch" class="md-nav__link">
    mixalch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natsph" class="md-nav__link">
    natsph
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natsph_extra" class="md-nav__link">
    natsph_extra
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nbdbuf" class="md-nav__link">
    nbdbuf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nblock_lobpcg" class="md-nav__link">
    nblock_lobpcg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ndivk" class="md-nav__link">
    ndivk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ndivsm" class="md-nav__link">
    ndivsm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngfft" class="md-nav__link">
    ngfft
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngqpt" class="md-nav__link">
    ngqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nline" class="md-nav__link">
    nline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#npsp" class="md-nav__link">
    npsp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#npspalch" class="md-nav__link">
    npspalch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nqfd" class="md-nav__link">
    nqfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nqpt" class="md-nav__link">
    nqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nshiftq" class="md-nav__link">
    nshiftq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nspden" class="md-nav__link">
    nspden
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nspinor" class="md-nav__link">
    nspinor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntypalch" class="md-nav__link">
    ntypalch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntyppure" class="md-nav__link">
    ntyppure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nucdipmom" class="md-nav__link">
    nucdipmom
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nwfshist" class="md-nav__link">
    nwfshist
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#occ" class="md-nav__link">
    occ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optdriver" class="md-nav__link">
    optdriver
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optstress" class="md-nav__link">
    optstress
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#posdoppler" class="md-nav__link">
    posdoppler
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#positron" class="md-nav__link">
    positron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#posnstep" class="md-nav__link">
    posnstep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#posocc" class="md-nav__link">
    posocc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postoldfe" class="md-nav__link">
    postoldfe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postoldff" class="md-nav__link">
    postoldff
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prt_lorbmag" class="md-nav__link">
    prt_lorbmag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtdensph" class="md-nav__link">
    prtdensph
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtebands" class="md-nav__link">
    prtebands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qpt" class="md-nav__link">
    qpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qptnrm" class="md-nav__link">
    qptnrm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qptopt" class="md-nav__link">
    qptopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qptrlatt" class="md-nav__link">
    qptrlatt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ratsm" class="md-nav__link">
    ratsm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ratsph" class="md-nav__link">
    ratsph
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ratsph_extra" class="md-nav__link">
    ratsph_extra
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rcut" class="md-nav__link">
    rcut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rmm_diis" class="md-nav__link">
    rmm_diis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rmm_diis_savemem" class="md-nav__link">
    rmm_diis_savemem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scphon_supercell" class="md-nav__link">
    scphon_supercell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scphon_temp" class="md-nav__link">
    scphon_temp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shiftq" class="md-nav__link">
    shiftq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slabwsrad" class="md-nav__link">
    slabwsrad
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slabzbeg" class="md-nav__link">
    slabzbeg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slabzend" class="md-nav__link">
    slabzend
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slk_rankpp" class="md-nav__link">
    slk_rankpp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#so_psp" class="md-nav__link">
    so_psp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spinat" class="md-nav__link">
    spinat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stmbias" class="md-nav__link">
    stmbias
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supercell_latt" class="md-nav__link">
    supercell_latt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symafm" class="md-nav__link">
    symafm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timopt" class="md-nav__link">
    timopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tl_nprccg" class="md-nav__link">
    tl_nprccg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tl_radius" class="md-nav__link">
    tl_radius
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tphysel" class="md-nav__link">
    tphysel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tsmear" class="md-nav__link">
    tsmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useextfpmd" class="md-nav__link">
    useextfpmd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usekden" class="md-nav__link">
    usekden
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vacuum" class="md-nav__link">
    vacuum
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vacwidth" class="md-nav__link">
    vacwidth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vcutgeo" class="md-nav__link">
    vcutgeo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wfinit" class="md-nav__link">
    wfinit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wfk_task" class="md-nav__link">
    wfk_task
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wfmix" class="md-nav__link">
    wfmix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wtq" class="md-nav__link">
    wtq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_bigdft_comp" class="md-nav__link">
    wvl_bigdft_comp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_crmult" class="md-nav__link">
    wvl_crmult
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_frmult" class="md-nav__link">
    wvl_frmult
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_ngauss" class="md-nav__link">
    wvl_ngauss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_nprccg" class="md-nav__link">
    wvl_nprccg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xredsph_extra" class="md-nav__link">
    xredsph_extra
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/basepar/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/ucalc_crpa/" class="md-nav__link">
        cRPA U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lruj/" class="md-nav__link">
        Linear Response U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr_intro/" class="md-nav__link">
        GWR_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr1/" class="md-nav__link">
        GWR1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lw_quad/" class="md-nav__link">
        quadrupoles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_tdep_legacy/" class="md-nav__link">
        eph_tdep_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        Troubleshooting (old-dokuwiki)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        Tuning (old-dokuwiki)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#algalch" class="md-nav__link">
    algalch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auxc_ixc" class="md-nav__link">
    auxc_ixc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auxc_scal" class="md-nav__link">
    auxc_scal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boxcenter" class="md-nav__link">
    boxcenter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boxcutmin" class="md-nav__link">
    boxcutmin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellcharge" class="md-nav__link">
    cellcharge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#charge" class="md-nav__link">
    charge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chkexit" class="md-nav__link">
    chkexit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chkparal" class="md-nav__link">
    chkparal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chkprim" class="md-nav__link">
    chkprim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chksymbreak" class="md-nav__link">
    chksymbreak
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chksymtnons" class="md-nav__link">
    chksymtnons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chrgat" class="md-nav__link">
    chrgat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constraint_kind" class="md-nav__link">
    constraint_kind
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cprj_in_memory" class="md-nav__link">
    cprj_in_memory
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpuh" class="md-nav__link">
    cpuh
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpum" class="md-nav__link">
    cpum
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpus" class="md-nav__link">
    cpus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diecut" class="md-nav__link">
    diecut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diegap" class="md-nav__link">
    diegap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dielam" class="md-nav__link">
    dielam
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dielng" class="md-nav__link">
    dielng
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diemac" class="md-nav__link">
    diemac
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diemix" class="md-nav__link">
    diemix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diemixmag" class="md-nav__link">
    diemixmag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dosdeltae" class="md-nav__link">
    dosdeltae
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enunit" class="md-nav__link">
    enunit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expert_user" class="md-nav__link">
    expert_user
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extfpmd_nband" class="md-nav__link">
    extfpmd_nband
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extfpmd_nbcut" class="md-nav__link">
    extfpmd_nbcut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extfpmd_nbdbuf" class="md-nav__link">
    extfpmd_nbdbuf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fband" class="md-nav__link">
    fband
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fock_icutcoul" class="md-nav__link">
    fock_icutcoul
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fockdownsampling" class="md-nav__link">
    fockdownsampling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fockoptmix" class="md-nav__link">
    fockoptmix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyb_mixing" class="md-nav__link">
    hyb_mixing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyb_mixing_sr" class="md-nav__link">
    hyb_mixing_sr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyb_range_dft" class="md-nav__link">
    hyb_range_dft
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyb_range_fock" class="md-nav__link">
    hyb_range_fock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iatsph" class="md-nav__link">
    iatsph
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#icoulomb" class="md-nav__link">
    icoulomb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#icutcoul" class="md-nav__link">
    icutcoul
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iprcel" class="md-nav__link">
    iprcel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iqpt" class="md-nav__link">
    iqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ivalence" class="md-nav__link">
    ivalence
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ixcpositron" class="md-nav__link">
    ixcpositron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jellslab" class="md-nav__link">
    jellslab
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptbounds" class="md-nav__link">
    kptbounds
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptrlatt" class="md-nav__link">
    kptrlatt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptrlen" class="md-nav__link">
    kptrlen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magcon_lambda" class="md-nav__link">
    magcon_lambda
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magconon" class="md-nav__link">
    magconon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixalch" class="md-nav__link">
    mixalch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natsph" class="md-nav__link">
    natsph
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natsph_extra" class="md-nav__link">
    natsph_extra
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nbdbuf" class="md-nav__link">
    nbdbuf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nblock_lobpcg" class="md-nav__link">
    nblock_lobpcg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ndivk" class="md-nav__link">
    ndivk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ndivsm" class="md-nav__link">
    ndivsm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngfft" class="md-nav__link">
    ngfft
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngqpt" class="md-nav__link">
    ngqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nline" class="md-nav__link">
    nline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#npsp" class="md-nav__link">
    npsp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#npspalch" class="md-nav__link">
    npspalch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nqfd" class="md-nav__link">
    nqfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nqpt" class="md-nav__link">
    nqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nshiftq" class="md-nav__link">
    nshiftq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nspden" class="md-nav__link">
    nspden
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nspinor" class="md-nav__link">
    nspinor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntypalch" class="md-nav__link">
    ntypalch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntyppure" class="md-nav__link">
    ntyppure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nucdipmom" class="md-nav__link">
    nucdipmom
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nwfshist" class="md-nav__link">
    nwfshist
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#occ" class="md-nav__link">
    occ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optdriver" class="md-nav__link">
    optdriver
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optstress" class="md-nav__link">
    optstress
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#posdoppler" class="md-nav__link">
    posdoppler
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#positron" class="md-nav__link">
    positron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#posnstep" class="md-nav__link">
    posnstep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#posocc" class="md-nav__link">
    posocc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postoldfe" class="md-nav__link">
    postoldfe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postoldff" class="md-nav__link">
    postoldff
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prt_lorbmag" class="md-nav__link">
    prt_lorbmag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtdensph" class="md-nav__link">
    prtdensph
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtebands" class="md-nav__link">
    prtebands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qpt" class="md-nav__link">
    qpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qptnrm" class="md-nav__link">
    qptnrm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qptopt" class="md-nav__link">
    qptopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qptrlatt" class="md-nav__link">
    qptrlatt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ratsm" class="md-nav__link">
    ratsm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ratsph" class="md-nav__link">
    ratsph
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ratsph_extra" class="md-nav__link">
    ratsph_extra
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rcut" class="md-nav__link">
    rcut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rmm_diis" class="md-nav__link">
    rmm_diis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rmm_diis_savemem" class="md-nav__link">
    rmm_diis_savemem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scphon_supercell" class="md-nav__link">
    scphon_supercell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scphon_temp" class="md-nav__link">
    scphon_temp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shiftq" class="md-nav__link">
    shiftq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slabwsrad" class="md-nav__link">
    slabwsrad
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slabzbeg" class="md-nav__link">
    slabzbeg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slabzend" class="md-nav__link">
    slabzend
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slk_rankpp" class="md-nav__link">
    slk_rankpp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#so_psp" class="md-nav__link">
    so_psp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spinat" class="md-nav__link">
    spinat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stmbias" class="md-nav__link">
    stmbias
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supercell_latt" class="md-nav__link">
    supercell_latt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symafm" class="md-nav__link">
    symafm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timopt" class="md-nav__link">
    timopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tl_nprccg" class="md-nav__link">
    tl_nprccg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tl_radius" class="md-nav__link">
    tl_radius
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tphysel" class="md-nav__link">
    tphysel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tsmear" class="md-nav__link">
    tsmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useextfpmd" class="md-nav__link">
    useextfpmd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usekden" class="md-nav__link">
    usekden
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vacuum" class="md-nav__link">
    vacuum
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vacwidth" class="md-nav__link">
    vacwidth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vcutgeo" class="md-nav__link">
    vcutgeo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wfinit" class="md-nav__link">
    wfinit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wfk_task" class="md-nav__link">
    wfk_task
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wfmix" class="md-nav__link">
    wfmix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wtq" class="md-nav__link">
    wtq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_bigdft_comp" class="md-nav__link">
    wvl_bigdft_comp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_crmult" class="md-nav__link">
    wvl_crmult
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_frmult" class="md-nav__link">
    wvl_frmult
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_ngauss" class="md-nav__link">
    wvl_ngauss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_nprccg" class="md-nav__link">
    wvl_nprccg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xredsph_extra" class="md-nav__link">
    xredsph_extra
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/variables/gstate.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->
<h1 id="gstate-input-variables">gstate input variables<a class="headerlink" href="#gstate-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
gstate input variables to be used in the input file for the abinit executable.</p>
<h2 id="algalch"><strong>algalch</strong><a class="headerlink" href="#algalch" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ALGorithm for generating ALCHemical pseudopotentials<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the types of atoms that form the system" data-toggle="popover" href="/topics/AtomTypes">topic_AtomTypes</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a>)<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a> * 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms (well, with no mixing, just for a test)
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
The first psp is Si, the second one is Ge, but the
mixing coefficients are 1.0 and 0.0 .
See test 4 of v2, except with alchemy." data-toggle="popover" href="/tests/v3/Input/t92.abi" target="_blank">t92.abi</a></li>
</ul>
</details>
<p>Used for the generation of alchemical pseudopotentials, that is, when
<a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a> is non-zero.</p>
<p>Give the algorithm to be used to generate the <a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a> alchemical
potentials from the different <a class="wikilink codevar-wikilink" href="/variables/gstate#npspalch">%npspalch</a> pseudopotentials dedicated to this use.</p>
<p>Presently, <strong>algalch</strong> can only have the value 1, that is:</p>
<ul>
<li>the local potentials are mixed, thanks to the <a class="wikilink codevar-wikilink" href="/variables/gstate#mixalch">mixalch</a> mixing coefficients</li>
<li>the form factors of the non-local projectors are all preserved,
    and all considered to generate the alchemical potential</li>
<li>the scalar coefficients of the non-local projectors are multiplied by the
    proportion of the corresponding type of atom that is present in <a class="wikilink codevar-wikilink" href="/variables/gstate#mixalch">mixalch</a></li>
<li>the characteristic radius for the core charge is a linear combination of the characteristic radii
    of the core charges, build with the <a class="wikilink codevar-wikilink" href="/variables/gstate#mixalch">mixalch</a> mixing coefficients</li>
<li>the core charge function <span><span class="MathJax_Preview">f(r/r_c)</span><script type="math/tex">f(r/r_c)</script></span> is a linear combination of the core charge functions,
    build with the <a class="wikilink codevar-wikilink" href="/variables/gstate#mixalch">mixalch</a> mixing coefficients</li>
</ul>
<p>Later, other algorithms for the mixing might be included.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note that alchemical mixing cannot be used with PAW.</p>
</div>
<h2 id="auxc_ixc"><strong>auxc_ixc</strong><a class="headerlink" href="#auxc_ixc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> AUxiliary XC functional for hybrid functional, IXC number<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with auxiliary XC functional." data-toggle="popover" href="/tests/v7/Input/t67.abi" target="_blank">t67.abi</a></li>
</ul>
</details>
<p>Specification of an auxiliary exchange-correlation functional, thanks to its
<a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a> value, to possibly replace the heavy evaluation of an hybrid
functional at specific occasions, e.g. when the Fock operator is frozen during
the self-consistent cycle, thanks to <a class="wikilink codevar-wikilink" href="/variables/gstate#fockoptmix">fockoptmix</a> == 11, or when evaluating
the correction to forces due to the density residual. This auxiliary exchange-
correlation functional might be rescaled, thanks to <a class="wikilink codevar-wikilink" href="/variables/gstate#auxc_scal">auxc_scal</a> when
<a class="wikilink codevar-wikilink" href="/variables/gstate#fockoptmix">fockoptmix</a> == 11. If <a class="wikilink codevar-wikilink" href="/variables/gw#gwcalctyp">gwcalctyp</a> == 5, 15 or 25, <em>auxc_ixc</em> refers to
<a class="wikilink codevar-wikilink" href="/variables/gw#ixc_sigma">ixc_sigma</a> instead of <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>.</p>
<h2 id="auxc_scal"><strong>auxc_scal</strong><a class="headerlink" href="#auxc_scal" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> AUxiliary XC functional for hybrid functional- SCALing factor<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with auxiliary XC functional." data-toggle="popover" href="/tests/v7/Input/t67.abi" target="_blank">t67.abi</a></li>
</ul>
</details>
<p>Possible scaling factor for the auxiliary exchange-correlation functional
defined by <a class="wikilink codevar-wikilink" href="/variables/gstate#auxc_ixc">auxc_ixc</a> that has the goal to replace the Fock operator or
hybrid functional when <a class="wikilink codevar-wikilink" href="/variables/gstate#fockoptmix">fockoptmix</a> == 11.</p>
<p>The default value 1.0 corresponds to the unmodified xc functional. When the
auxiliary functional is used to replace the hybrid functional in SCF loops, a
value of 1.5 has been observed to speed up somehow the convergence.</p>
<h2 id="boxcenter"><strong>boxcenter</strong><a class="headerlink" href="#boxcenter" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BOX CENTER<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform time-dependent density-functional theory calculations of neutral excitation energies" data-toggle="popover" href="/topics/TDDFT">topic_TDDFT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0.5, 0.5, 0.5]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [11/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 system.
Excited state computation, using LDA/TDLDA" data-toggle="popover" href="/tests/tutorial/Input/ttddft_1.abi" target="_blank">ttddft_1.abi</a></li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Excited states of the Mg atom, with (ixc=1, spin-polarized Teter functional).
Use the multi-dataset mode.
Can be compared with the results in Vasiliev et al, PRL 82, 1919 (1999).
With the values acell 18, ecut 3.5, nband2 10, the present
test generates KS diff=3.46eV, TDLDA(1S1P)=4.48eV, TDLDA(1S3P)=2.81eV
With the values acell 22, ecut 3.5, nband2 22, ABINIT
generates KS diff=3.40eV , TDLDA(1S1P)=4.35eV, TDLDA(1S3P)=2.77eV
Vasiliev gets KS diff=3.39eV, TDLDA(1S1P)=4.34eV, TDLDA(1S3P)=2.79eV" data-toggle="popover" href="/tests/v1/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as test 69, but with another xc functional (ixc=7, PW92 LSD)
With the values acell 18, ecut 3.5, nband2 10, the present
test generates KS diff=3.46eV, TDLDA(1S1P)=4.45eV, TDLDA(1S3P)=2.84eV" data-toggle="popover" href="/tests/v1/Input/t70.abi" target="_blank">t70.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
(HeH)+ in a big box. Computation of excitation energies in TDDFT,
in the following approximations : TDxOEP/xOEP, TDLDA/xOEP,
BPG hybrid/xOEP." data-toggle="popover" href="/tests/v2/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
(HeH)+ in a big box. Computation of oscillator strengths,
in the TDxOEP/xOEP approximation. Use a different geometry
than in test 42 of test/v2.
The Thomas-Reiche-Kuhn sum rule (sum of oscillator strengths
should be the number of electrons, that is, two in this case)
should be valid, since
we are using local pseudopotentials. However, the number
of bands needed to get it is huge :
nbands     sum rule
20         1.34   (present case)
30         1.45
40         1.61
60         1.68
80         1.74
100        1.77
120        1.82
160        1.88
200        1.90
240        1.92" data-toggle="popover" href="/tests/v3/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule non-spin-polarized, in a big box.
Compute excitation energies, as well as Cauchy
coefficients. The Cauchy (-2) coefficient
is the low-frequency optical polarisability.
The present test uses a small box (6x5x5 Angstrom),
a small energy cut-off (25 Ha), and only
12 states. Two different exchange-correlation
functionals are treated : ixc=1 (Teter93),
and ixc=7 (PW92).
Experimental values are taken from Goerling at al,
J. Chem. Phys. 110, 2785 (1999)).
Experimental values for the singlet excitation
energies are :
1pi_g 9.31eV  1sig_u- 9.92eV  1del_u 10.27eV
The present test gives
1pi_g 9.47eV  1sig_u- 9.91eV  1del_u 10.45eV
With a larger box (8x7x7)
1pi_g 9.33eV  1sig_u- 9.84eV  1del_u 10.38eV
With a larger cutoff (60Ha)
1pi_g 9.38eV  1sig_u- 9.77eV  1del_u 10.31eV
With a larger number of states (30)
1pi_g 9.44eV  1sig_u- 9.91eV  1del_u 10.45eV
Experimental values for the Cauchy coefficients are:
(These values should be updated, the real ones
are smaller by a few percent, because a
buffer has been introduced in tddft.f)
(-2) 11.74au, (-4) 30.11au, (-6) 101.8au
The present test gives
(-2) 8.012au, (-4) 27.83au, (-6) 108.4au
With a larger box (8x7x7)
(-2) 7.112au, (-4) 25.51au, (-6) 102.2au
With a larger cutoff (60Ha)
(-2) 7.717au, (-4) 26.87au, (-6) 104.6au
With a larger number of states (30)
(-2) 11.70au, (-4) 34.56au, (-6) 123.3au
(The larger number of states is important to give
reasonable values ...)
Experimental values for the triplet excitation
energies are :
3pi_g 7.75eV  3sig_u+ 8.04eV  3del_u 8.88eV 3sig_u- 9.67eV 3pi_u 11.19eV
The present test gives
3pi_g 7.83eV  3sig_u+ 8.11eV  3del_u 9.06eV 3sig_u- 9.91eV 3pi_u 10.91eV
With a larger box (8x7x7)
3pi_g 7.70eV  3sig_u+ 8.13eV  3del_u 9.04eV 3sig_u- 9.85eV 3pi_u 10.71eV
With a larger cutoff (60Ha)
3pi_g 7.73eV  3sig_u+ 7.88eV  3del_u 8.88eV 3sig_u- 9.77eV 3pi_u 10.44eV
With a larger number of states (30)
3pi_g 7.83eV  3sig_u+ 8.04eV  3del_u 9.04eV 3sig_u- 9.91eV 3pi_u 10.90eV
Note that the use of the PW92 functional instead of the
Teter93 functional does not affect the singlet values,
but have some effects on the triplet values:
they change from
3pi_g 7.83eV  3sig_u+ 8.11eV  3del_u 9.06eV 3sig_u- 9.91eV 3pi_u 10.91eV
to
3pi_g 7.85eV  3sig_u+ 8.16eV  3del_u 9.08eV 3sig_u- 9.91eV 3pi_u 10.93eV
In the Goerling paper, still another functional was used,
the Vosko-Wilk-Nussair one,
whose spin dependence is not very accurate, hence the large
differences for the triplet states.
When this functional will be coded in ABINIT, it will be
worth to complete the present test." data-toggle="popover" href="/tests/v3/Input/t55.abi" target="_blank">t55.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule non-spin-polarized, but treated with nsppol=2, in a big box.
Similar to test 55 of tests/v3. There should be only
small numerical differences with respect to datasets 1 and 2 of this test,
due to the fact that the tetragonal symmetry was here slightly broken
for sake of portability of the automatic test.
Note however that the singlet and triplet states cannot be disentagled,
so one gets a big list of excitations, the merge of singlet and triplet
excitations." data-toggle="popover" href="/tests/v5/Input/t61.abi" target="_blank">t61.abi</a></li>
</ul>
</details>
<p>Defines the center of the box, in reduced coordinates. At present, this
information is only used in the case of Time-Dependent DFT computation of the
oscillator strength. One must take <em>boxcenter</em> such as to be roughly the center
of the cluster or molecule. The default is sensible when the vacuum
surrounding the cluster or molecule has xred 0 or 1. On the contrary, when the
cluster or molecule is close to the origin, it is better to take <em>boxcenter</em> = [0.0, 0.0, 0.0].</p>
<h2 id="boxcutmin"><strong>boxcutmin</strong><a class="headerlink" href="#boxcutmin" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BOX CUT-off MINimum<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform numerically precise calculations with planewaves or projector- augmented waves and pseudopotentials" data-toggle="popover" href="/topics/Planewaves">topic_Planewaves</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [29/1245] in all abinit tests, [10/159] in abinit tutorials</summary><ul>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
GWR calculations for crystalline alpha-quartz.Test g/tau parallelism." data-toggle="popover" href="/tests/paral/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with GWR code.
Test symmetrization with time-reversal and umklapp g0 vectors
as well as parallelization over k/g/tau." data-toggle="popover" href="/tests/paral/Input/t79.abi" target="_blank">t79.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_5.abi" target="_blank">teph4mob_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_6.abi" target="_blank">teph4mob_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_7.abi" target="_blank">teph4mob_7.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="No description available" data-toggle="popover" href="/tests/v3/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
Finite-difference runs with strain component 1 (1def) is computed
DFPT is computed
Comparaison with Finite Diferrences give excellent agreement ~1e-5%
DFPT is computed with usexcnhat==0 (Just for test)" data-toggle="popover" href="/tests/v7/Input/t95.abi" target="_blank">t95.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with FIRE (ionmov 15)" data-toggle="popover" href="/tests/v8/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GS calculation with the CG + RMM-DIIS eigensolver and NC pseudos" data-toggle="popover" href="/tests/v9/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal self-energy matrix elements in LiF." data-toggle="popover" href="/tests/v9/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
</ul>
</details>
<p>The box cutoff ratio is the ratio between the radius of the G-sphere that can be inserted in the FFT box (see <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a>)
and the G-sphere used to represent the wavefunctions as computed from the input <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>.
In order for the density to be exact (in the case of the plane wave part, not the PAW on-site terms),
this ratio should be <strong>at least two</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If one uses a smaller ratio (e.g. 1.5), one will gain speed at the price of accuracy.
Keep in mind that using a value of  <strong>boxcutmin</strong>  too close to 1 may lead to runtime errors in the FFT routines
so a value larger than 1.1 is strongly recommended.</p>
</div>
<p>It should also be stressed that the quality of the forces is affected by the value of  <strong>boxcutmin</strong> .
The default value (2.0) is OK for ground state calculations and structural relaxations.
On the contrary, the computations of vibrational frequencies based on finite-difference methods such as those
implemented by <a href="https://atztogo.github.io/phonopy/">phonopy</a>  turn out to be rather sensitive to the quality of the forces.
Tests have shown that, for particular systems, <a href="https://atztogo.github.io/phonopy/">phonopy</a>  calculations require a larger  <strong>boxcutmin</strong>  (e.g. 3.0)
to reproduce the DFPT results.
The optimal value of  <strong>boxcutmin</strong>  likely depends on the pseudopotentials and the system under investigation, yet
this is something worth keeping in mind.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Prior to v8.9, the use of boxcutmin for DFPT calculations was forbidden.
However, after testing, it was seen that
the deterioration in phonon band structures could be alleviated to a large extent by the imposition
of the Acoustic Sum Rule <a class="wikilink codevar-wikilink" href="/variables/dfpt#asr">asr</a>.</p>
</div>
<h2 id="cellcharge"><strong>cellcharge</strong><a class="headerlink" href="#cellcharge" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CELL CHARGE<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to treat adequately the Coulomb interaction, especially in charged cells," data-toggle="popover" href="/topics/Coulomb">topic_Coulomb</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/rlx#nimage">nimage</a>)<br />
<em>Default value:</em> <em>0<br />
*Added in version:</em> v9.3.4  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [13/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydronium ion + NH3 molecule
Ground state calculation
keeping O and H atoms fixed" data-toggle="popover" href="/tests/tutoparal/Input/timages_01.abi" target="_blank">timages_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydronium ion + NH3 molecule
Ground state calculation
keeping O and H atoms fixed" data-toggle="popover" href="/tests/tutoparal/Input/timages_02.abi" target="_blank">timages_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydronium ion + NH3 molecule
String method
Moving the proton from H2O to NH3
keeping O and H atoms fixed" data-toggle="popover" href="/tests/tutoparal/Input/timages_03.abi" target="_blank">timages_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydronium ion + NH3 molecule
String method
Moving the proton from H2O to NH3
keeping O and H atoms fixed" data-toggle="popover" href="/tests/tutoparal/Input/timages_04.abi" target="_blank">timages_04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test at the fixed, symmetric geometry, for reference. Of course, the cell is not primitive.

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_01.abi" target="_blank">tpsic_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test at a set of decreasing I-I interatomic distances

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_02.abi" target="_blank">tpsic_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test starts from a reasonable I-I interatomic distance, and search for the optimized polaron geometry, without constraint.

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_03.abi" target="_blank">tpsic_03.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
(HeH)+ in a big box. Computation of excitation energies in TDDFT,
in the following approximations : TDxOEP/xOEP, TDLDA/xOEP,
BPG hybrid/xOEP." data-toggle="popover" href="/tests/v2/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
(HeH)+ in a big box. Computation of oscillator strengths,
in the TDxOEP/xOEP approximation. Use a different geometry
than in test 42 of test/v2.
The Thomas-Reiche-Kuhn sum rule (sum of oscillator strengths
should be the number of electrons, that is, two in this case)
should be valid, since
we are using local pseudopotentials. However, the number
of bands needed to get it is huge :
nbands     sum rule
20         1.34   (present case)
30         1.45
40         1.61
60         1.68
80         1.74
100        1.77
120        1.82
160        1.88
200        1.90
240        1.92" data-toggle="popover" href="/tests/v3/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NH3 and NH2-CH3 molecules , supercell geometry
Show the computations needed to obtain the differential
pseudopotentials PseudosTM_pwteter/7n.pspnc (just usual atomic configuration)
and 7n.1s_psp.mod (with a hole in state 1s).
The differential core-level shift is obtained by comparing
difference in the total energies of the NH3 molecule with both pseudopotentials
with the one of the NH2CH3 molecule :
0.41522 Ha for the NH3 molecule
0.41768 Ha for the NH2-CH3 molecule, making for a shift of 2.46 mHa=0.0669 eV
due to the replacement of one H atom of the NH3 molecule by a CH3 group.
Note that these are completely non converged values. Parameters
like ecut and acell should be the subject of a convergence study.
For applications of this technique, see
Rignanese GM et al, Phys. Rev. Lett. 79, 5174 (1997),
or Travaly Y et al, Phys. Rev. B 61, 7716 (2000)." data-toggle="popover" href="/tests/v5/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Charged (He dimer)+, with bare pseudopotential. ixc=7
Compute Raman intensity, showing essentially perfect agreement
between DFPT and finite-differences, when the number of k points
is extended to infinity.
The present test use ngkpt 10 1 1 , like the previous one.
Going to ngkpt 80 1 1 gives
Finite-differences: 0.022275
The DFPT with ngkpt 320 1 1 gives 0.022279 .
(To obtain the finite-difference results, one has to reactivate the dtset 15 case)
Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-toggle="popover" href="/tests/v6/Input/t67.abi" target="_blank">t67.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiH rocksalt structure with a negative lithium vacancy
test thee potential alignement usepotzero=0,1" data-toggle="popover" href="/tests/v7/Input/t26.abi" target="_blank">t26.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing." data-toggle="popover" href="/tests/v9/Input/t22.abi" target="_blank">t22.abi</a></li>
</ul>
</details>
<p>Used to establish charge balance between the number of electrons filling the
bands and the nominal charge associated with the atomic cores.
The code adds up the number of valence electrons provided by the
pseudopotentials of each type (call this &ldquo;zval&rdquo;), then add  <strong>cellcharge</strong> , to get
the number of electrons per unit cell, <a class="wikilink codevar-wikilink" href="/variables/internal#nelect">%nelect</a>.
Then, if <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> is positive, the code adds up the band occupancies (given in
array <a class="wikilink codevar-wikilink" href="/variables/gstate#occ">occ</a>) for all bands at each k point, then multiplies by the k point
weight <a class="wikilink codevar-wikilink" href="/variables/basic#wtk">wtk</a> at each k point. Call this sum &ldquo;nelect_occ&rdquo; (for the number of
electrons from occupation numbers). It is then required that: nelect_occ = <a class="wikilink codevar-wikilink" href="/variables/internal#nelect">%nelect</a>.
To treat a neutral system, which is desired in nearly all cases, one must use
 <strong>cellcharge</strong>  = 0. To treat a system missing one electron per unit cell, set  <strong>cellcharge</strong>  = +1.</p>
<p><strong>cellcharge</strong>  superceeds the old <a class="wikilink codevar-wikilink" href="/variables/gstate#charge">charge</a> input variable, whose name was rather unspecific.</p>
<p>When there are several images,  <strong>cellcharge</strong>  might depend on the image number, but ONLY
when <a class="wikilink codevar-wikilink" href="/variables/rlx#imgmov">imgmov</a>=6 and <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>=0 or 2. In the checking routine, <a class="wikilink codevar-wikilink" href="/variables/internal#nelect">%nelect</a> is considered
separately for each image, while in the remaining of the code, <a class="wikilink codevar-wikilink" href="/variables/internal#nelect">%nelect</a>(1) is propagated,
so that <a class="wikilink codevar-wikilink" href="/variables/internal#nelect">%nelect</a> is still a scalar. This is consistent with the pSIC algorithm,
see <a class="wikilink citation-wikilink" data-tippy-content="Variational polaron self-interaction corrected total-energy functional for charge excitations in insulators" data-toggle="popover" href="/theory/bibliography#sadigh2015">[Sadigh2015]</a> and <a class="wikilink citation-wikilink" data-tippy-content="Erratum: Variational polaron self-interaction-corrected total-energy functional for charge excitations in insulators [Phys. Rev. B 92, 075202 (2015)]" data-toggle="popover" href="/theory/bibliography#sadigh2015a">[Sadigh2015a]</a>.</p>
<h2 id="charge"><strong>charge</strong><a class="headerlink" href="#charge" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CHARGE<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to treat adequately the Coulomb interaction, especially in charged cells," data-toggle="popover" href="/topics/Coulomb">topic_Coulomb</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9, obsolete  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [66/1245] in all abinit tests, [12/159] in abinit tutorials</summary><ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-toggle="popover" href="/tests/paral/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-toggle="popover" href="/tests/paral/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-toggle="popover" href="/tests/paral/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydronium ion + NH3 molecule
Ground state calculation
keeping O and H atoms fixed" data-toggle="popover" href="/tests/tutoparal/Input/timages_01.abi" target="_blank">timages_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydronium ion + NH3 molecule
Ground state calculation
keeping O and H atoms fixed" data-toggle="popover" href="/tests/tutoparal/Input/timages_02.abi" target="_blank">timages_02.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlP in hypothetical wurzite (hexagonal) structure
Response function calculation for:
* rigid-atom elastic tensor
* rigid-atom piezoelectric tensor
* interatomic force constants at gamma
* Born effective charges" data-toggle="popover" href="/tests/tutorespfn/Input/telast_2.abi" target="_blank">telast_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Finite difference calculation of the Born effective charges of AlP" data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_1.abi" target="_blank">tpolarization_1.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
Print the charge density that corresponds to optimized
interatomic distance." data-toggle="popover" href="/tests/tutorial/Input/tbase1_4.abi" target="_blank">tbase1_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H6 Supercell
Generates a 6 atom Hydrogen supercell with the multiplicity of 1:2:3 (x:y:z)
Produces a WFK file to be analyzed with fold2bloch" data-toggle="popover" href="/tests/tutorial/Input/tfold2bloch_1.abi" target="_blank">tfold2bloch_1.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si crystal (diamond structure), 2 atoms per unit cell.
Computation of responses to atomic displacements
and homogeneous electric field at Gamma,
giving access to the dynamical matrix at q(0 0 0), including
its non-analytical behaviour (effective charges
do not vanish completely due to lack of convergence),
the associated phonon frequencies, and the macroscopic
dielectric constant.
(see test.si.gamma of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for GaAs (zinc-blende).
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 32. The chosen grid (too coarse, though) has only two
special q points : 1/4 1/4 1/4 and 1/4 1/2 1/2 (in reduced coordinates).
The Gamma point is also needed, especially for the computation of
dielectric matric and effective charges, needed to get the asymptotic
behaviour of the interatomic force constants. To generate
the different responses, the following steps are followed,
with each of them corresponding to a different dataset (the multi-dataset
mode allows to have only one input file) :
1) ground state calculation, with a k-point sampling in the irreducible
Brillouin zone only;
2) using the density of 1), computation of the wavefunctions for the
grid of k-points in the full Brillouin zone; (not really needed in v3.0)
3) computation of the ddk response, in preparation to the electric field
response ;
4) computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
5) using the density of 1), computation of the GS wavefunctions
at k+q where q is 1/4 1/4 1/4 ;
6) computation of the dynamical matrix at 1/4 1/4 1/4 ;
7) using the density of 1), computation of the GS wavefunctions
at k+q where q is 1/4 1/2 1/2 ;
8) computation of the dynamical matrix at 1/4 1/2 1/2 ." data-toggle="popover" href="/tests/v2/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (non-spin-polarized, non-linear XC core correction, GGA)
Computation of forces in the GGA, and comparison with a finite
difference of energy.
The direct computation of force (dataset 2) gives 0.627251486 Ha/Bohr
A simple finite-difference estimation (dataset 1 and 3) gives
0.627251265 Ha/Bohr. The agreement can be improved if a better
finite-difference estimation is used." data-toggle="popover" href="/tests/v2/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
(HeH)+ in a big box. Computation of oscillator strengths,
in the TDxOEP/xOEP approximation. Use a different geometry
than in test 42 of test/v2.
The Thomas-Reiche-Kuhn sum rule (sum of oscillator strengths
should be the number of electrons, that is, two in this case)
should be valid, since
we are using local pseudopotentials. However, the number
of bands needed to get it is huge :
nbands     sum rule
20         1.34   (present case)
30         1.45
40         1.61
60         1.68
80         1.74
100        1.77
120        1.82
160        1.88
200        1.90
240        1.92" data-toggle="popover" href="/tests/v3/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BaO crystal.
Computation of band-by-band decomposition of Born effective charges.
Also, computation of the electronic localization tensor,
and its band-by-band decomposition." data-toggle="popover" href="/tests/v3/Input/t77.abi" target="_blank">t77.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in BCC structure. Low cut-offs and few k-points.
This test is done within GGA and (ferro-)magnetism in PAW formalism.
The same job is done twice with two differents PAW datasets.
First PAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed analytically.
SecondPAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed numerically." data-toggle="popover" href="/tests/v4/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
5-atom Al slab, with three vacuum layers.
First, converge the wavefunctions, then compute the
STM charge density below and above the Fermi energy, within a 2eV range.
Also compute band-by-band decomposition of STM charge density below the Fermi energy, within a 2eV range." data-toggle="popover" href="/tests/v4/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate both DEN and PAWDEN files for silicon. Note that in the PAW case, DEN files
include the valence density and compensation charge, while PAWDEN files include the
valence and on-site corrections, but not the compensation charge. Therefore, DEN files are
needed for further computations, while PAWDEN files are useful for visualization, AIM, and other
post-processing of the density.
PAW AE DEN not compatible with parallelization over atoms." data-toggle="popover" href="/tests/v5/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-toggle="popover" href="/tests/v5/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite differences (contributed by J. Zwanziger, adapted from efield tutorial).

MG: Very problematic in parallel (run get stuck!)" data-toggle="popover" href="/tests/v6/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield tutorial.)
Cannot be executed with more than 1 MPI node." data-toggle="popover" href="/tests/v6/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Charged (He dimer)+, with bare pseudopotential. ixc=7
Compute Raman intensity, showing essentially perfect agreement
between DFPT and finite-differences, when the number of k points
is extended to infinity.
The present test use ngkpt 10 1 1 , like the previous one.
Going to ngkpt 80 1 1 gives
Finite-differences: 0.022275
The DFPT with ngkpt 320 1 1 gives 0.022279 .
(To obtain the finite-difference results, one has to reactivate the dtset 15 case)
Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-toggle="popover" href="/tests/v6/Input/t67.abi" target="_blank">t67.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Nickel ferromagnetic fcc structure with an ONCVPSP pseudo containing valence density.
We test several improvements that are available when the NC file contains the PS valence charge.
More specifically, we test the initialization of the density from atomic quantities (initro.F90),
the correction to the forces due to the residuals and the extrapolation of the density
for structural relaxations (well, xred is fixed by symmetry).
We also test the treatment of the core charge in G-space in the case of GS calculations
By default, abinit handles XCCC in real space, here we use nc_xccc_gspace==1 to treat it
in G-space using the same approach as the one used in PAW." data-toggle="popover" href="/tests/v7/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the extension of the pspcod=8 input format to include
spin-orbit coupling with multiple non-local projectors and pseudized valence charge density
The relativistic extension is documented in the code package.
The Pt 5s and 5p semi-cores are treated as valence.
A complete description of the input format is avaiable in  doc/psp_infos/psp8_info.txt." data-toggle="popover" href="/tests/v7/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation with constrained charges
Constrain the charge around atom 1 to the value 0.5, then work with both atoms and larger spheres

For dataset 2, the derivative wrt the constraint, the derivative of the total energy with respect to atomic displacement
and the stress calculations have been checked, as follows.

Initially, the total energy is -0.99164352451, the target charge is 0.5, and the gradient wrt the charge is computed -0.58356219787.
Changing the target charge by +0.001 gives etotal -0.99222576777
Changing the target charge by -0.001 gives etotal -0.99105864425
Finite-difference gives -0.5835617, in excellent agreement for that level of methodology.

For atom 1, dE/dtau (=-force in reduced coordinate) is computed 8.330114676.
Changing the atomic position of the first atom from -1.1 to -1.10015
gives etotal -0.99172669330, to -1.09985 gives etotal -0.99156009221, delivering 8.330054.
The result of a similar finite-difference estimation with twice bigger values gives 8.329896.
Combining both results to eliminate the quadratic error gives 8.330107, with an agreement of 5 digits with dE/dtau.

The stress is computed 2.755820639e-4 .
Multiplying both acell and xcart by 1.001 gives etotal -0.99122698240.
Multiplying both acell and xcart by 0.999 gives etotal -0.99205366103.
The derivative of total energy wrt to strain is thus 0.41333932. Dividing by the unit cell volume (1500) gives 2.75559e-4 ,
in excellent agreement for that level of methodology." data-toggle="popover" href="/tests/v8/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
Check jointly the charge and vector magnetization constraints, with differing vector orientations." data-toggle="popover" href="/tests/v8/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>The  <strong>charge</strong>  input variable is obsolete, and has been replaced by <a class="wikilink codevar-wikilink" href="/variables/gstate#cellcharge">cellcharge</a>.
It is still read during a transitional period, likely up to the end of v9 life cycle.</p>
<h2 id="chkexit"><strong>chkexit</strong><a class="headerlink" href="#chkexit" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CHecK whether the user want to EXIT<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms)." data-toggle="popover" href="/tests/v4/Input/t97.abi" target="_blank">t97.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom." data-toggle="popover" href="/tests/v8/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom along one direction." data-toggle="popover" href="/tests/v8/Input/t22.abi" target="_blank">t22.abi</a></li>
</ul>
</details>
<p>If  <strong>chkexit</strong>  is 1 or 2, ABINIT will check whether the user wants to
interrupt the run (using the keyword &ldquo;exit&rdquo; on the top of the input file or
creating a file named &ldquo;abinit.exit&rdquo;: see the end of section 3.2
of the <a class="wikilink user-guide-wikilink" href="/guide/abinit#parameters">abinit help file</a>).</p>
<ul>
<li>0 &rarr; the check is not performed at all</li>
<li>1 &rarr; the check is not performed frequently (after each SCF step)</li>
<li>2 &rarr; the check is performed frequently (after a few bands, at each k point)</li>
</ul>
<p>In all cases, the check is performed at most every 2 seconds of CPU time.</p>
<h2 id="chkparal"><strong>chkparal</strong><a class="headerlink" href="#chkparal" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CHecK whether the PARALelism is adequate<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic_parallelism</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: GW band gap with vertex corrections in W; Gygi-Baldereschi aux function" data-toggle="popover" href="/tests/v67mbpt/Input/t36.abi" target="_blank">t36.abi</a></li>
</ul>
</details>
<p>Not all parallelism types or level are allowed or simply relevant for the different <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> values in ABINIT.
It has been observed that some users do not understand well their relation. In particular, their expectation of the adequacy
of some parallelism for some <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> value was not correct, with a large loss of computing resources.
Indeed, if the user does not sufficiently understand the parallelism in ABINIT, huge amount of ressources might be spend
when they are booked for a run that cannot use these.
Accordingly, the user might blame ABINIT for being slow while the user has simply not activated
the relevant parallelism, or activated an irrelevant parallelism.</p>
<p>However, if the user correctly understand the parallelism,
it might be more convenient to leave in the input file irrelevant variables. This is especially the case for high-throughput calculations
driven by workflows developed for earlier versions of ABINIT.</p>
<p>The default value of  <strong>chkparal</strong> , will enforce some basic relevance of the input variables related to parallelism,
thus hopefully preventing some users to loose computing power.</p>
<p>The following relevances and adequacies are checked at present if  <strong>chkparal</strong> =1 :
the input variable <a class="wikilink codevar-wikilink" href="/variables/paral#autoparal">autoparal</a> is relevant only for <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=1 calculations (ground-state);
the input variable <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> is relevant only for <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=1 calculations (ground-state) or for <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=66 (Laczos-Sternheimer GW).</p>
<p>The relevance of <a class="wikilink codevar-wikilink" href="/variables/paral#paral_atom">paral_atom</a> or <a class="wikilink codevar-wikilink" href="/variables/paral#paral_rf">paral_rf</a> or <a class="wikilink codevar-wikilink" href="/variables/paral#gwpara">gwpara</a> is not checked at present. The default values should not yield loss of computing power.</p>
<h2 id="chkprim"><strong>chkprim</strong><a class="headerlink" href="#chkprim" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CHecK whether the cell is PRIMitive<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to specify the unit cell" data-toggle="popover" href="/topics/UnitCell">topic_UnitCell</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to use the symetry information to build the system from the irreducible part of the primitive cell" data-toggle="popover" href="/topics/SmartSymm">topic_SmartSymm</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [85/1245] in all abinit tests, [8/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for real space computation (using a wavelet based poisson solver),
no forces, just an H atom in an empty box. The cut-off is unrealistic. This
test tests the following part of the code :
* psp spline generation for real space ;
* local part of potential from pseudo ;
* ion-ion interaction computation (instead of Ewald) ;
* Hartree potential with Poisson&#x27;s solver." data-toggle="popover" href="/tests/bigdft/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H in isolated boundary conditions (plane waves, NC).
Similar to t20.in but check that non cubic boxs can be used with equivalent x, y and z directions." data-toggle="popover" href="/tests/bigdft/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon solid, experimental lattice parameter.
Realistic parameters are used (ecut=20, ngkpt=2x2x2 shifted 4 times, but centered on Gamma).
Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
The LDA gap is observed at Gamma : 8.071 eV, is in reasonable agreement with the gap from the TB paper PRL 102, 226401 (2009),
where it is mentioned to be 8.16 eV.
The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV.
The reading of the kinetic energy density, to start a non-SCF calculation is not yet implemented,
as of ABINITv6.12.0 .
This test was used to examine the speed of the convergence in case of elongated cells, up to 16 atoms.
The mGGA convergence was found to be similar to the LDA convergence.
Also, test non-self-consistent mGGA calculation, with reading of the previously produced _DEN and _KDEN files." data-toggle="popover" href="/tests/libxc/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, conventional cell. Test of downsampling for HSE06, PBE0, HSE03.
2x2x2 for the k point grid in the FBZ
1x1x1 for the k point grid for the Fock operator in the FBZ
The results can be directly compared with those of the test libxc#72, which use
a primitive cell, instead of the conventional one here.
The k point sampling (and down sampling) perfectly match.
The observed difference is only due to the differing xc correlation real space sampling.
Of course, the total energy from the present test is to be divided by 4, to find a total energy per atom.
The results are, in Ha/atom (present test for conventional cell / previous for primitive cell / difference):
LDA    -2.075 716 / -2.075 718 / 0.000 002
HSE06  -2.095 513 / -2.095 539 / 0.000 026
PBE0   -2.081 192 / -2.081 193 / 0.000 001
HSE03  -2.123 089 / -2.123 117 / 0.000 028
The real space grid sampling cannot appear at the level of the Fock operator,
that is completely formulated in reciprocal space. The real space functional
from HSE06 and HSE03 is apparently more affected by the real space sampling than
the one from LDA and PBE0 ..." data-toggle="popover" href="/tests/libxc/Input/t73.abi" target="_blank">t73.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, conventional cell. Test of downsampling for PBE0.
Examine grids whose density of points increase by steps of 2.
Results for the full set (including datasets 24 to 27, not allowed by default)
etotal22   -8.4795130935E+00
etotal23   -8.3994691038E+00
etotal24   -8.2706392613E+00
etotal25   -8.3398116419E+00
etotal26   -8.3799857985E+00
etotal27   -8.3581360592E+00
etotal28   -8.3742420892E+00
Note that dataset 23 corresponds to a non-symmetris 4 point grid. So, it is not expected to perform well,
but is included for testing purposes only.
Interestingly, the dataset 25 performs apparently better than the dataset 26." data-toggle="popover" href="/tests/paral/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, conventional cell. Test of downsampling for PBE0.
Examine grids whose density of points increase by steps of 2.
Results for the full set (including datasets 24 to 27, not allowed by default)
etotal22   -8.4795130935E+00
etotal23   -8.3994691038E+00
etotal24   -8.2706392613E+00
etotal25   -8.3398116419E+00
etotal26   -8.3799857985E+00
etotal27   -8.3581360592E+00
etotal28   -8.3742420892E+00
Note that dataset 23 corresponds to a non-symmetris 4 point grid. So, it is not expected to perform well,
but is included for testing purposes only.
Interestingly, the dataset 25 performs apparently better than the dataset 26." data-toggle="popover" href="/tests/paral/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, conventional cell. Test of downsampling for PBE0.
Examine grids whose density of points increase by steps of 2.
Results for the full set (including datasets 24 to 27, not allowed by default)
etotal22   -8.4795130935E+00
etotal23   -8.3994691038E+00
etotal24   -8.2706392613E+00
etotal25   -8.3398116419E+00
etotal26   -8.3799857985E+00
etotal27   -8.3581360592E+00
etotal28   -8.3742420892E+00
Note that dataset 23 corresponds to a non-symmetris 4 point grid. So, it is not expected to perform well,
but is included for testing purposes only.
Interestingly, the dataset 25 performs apparently better than the dataset 26." data-toggle="popover" href="/tests/paral/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test at the fixed, symmetric geometry, for reference. Of course, the cell is not primitive.

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_01.abi" target="_blank">tpsic_01.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum

A first step in the determination of the surface energy of aluminum :
changing the orientation of the cell." data-toggle="popover" href="/tests/tutorial/Input/tbase4_4.abi" target="_blank">tbase4_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Second step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, &quot;conventional&quot; scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_2.abi" target="_blank">tpositron_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Third step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, self-consistent scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_3.abi" target="_blank">tpositron_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crazy orthorhombic 16-atoms Si cell. Test the symmetrizer.
Long test for all possible orientations and origin choices.
Dataset 1-6 : space group origin choice 1
Dataset 7-12 : space group origin choice 2
Dataset 1,7; 2,8; 3,9; 4,10; 5,11; and 6,12 all the possible orientations.
Note : since the sets of atoms generated for different orientations
are not equivalent, the final energies also differ." data-toggle="popover" href="/tests/v1/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Al2O3 cell in rhombohedric cell with different axes.
Dataset 1 : Rhombohedral axes; full set of symmetries and full set of atoms
Dataset 2 : Rhombohedral axes; irreducible unit cell and space group
Dataset 3 : Hexagonal axes; irreducible unit cell and space group
Dataset 4 : Hexagonal axes; full unit cell and space group
The results are equivalent for Dataset 1 and 2 and Dataset 3 and 4." data-toggle="popover" href="/tests/v1/Input/t96.abi" target="_blank">t96.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj to test restarxf -1" data-toggle="popover" href="/tests/v10/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj restarting from HIST file using restarxf -1" data-toggle="popover" href="/tests/v10/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test different additional features of the symmetry finder :
- handling non-primitive cells
- handling glide planes
- handling screw axes" data-toggle="popover" href="/tests/v2/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Space group number 225 : FCC Aluminum, in both conventional and
primitive unit cells." data-toggle="popover" href="/tests/v2/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Space group number 139 : elongated aluminum, BCT" data-toggle="popover" href="/tests/v2/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
H diatomic molecule in the antiferromagnetic regime.
Different data sets.
Test Shubnikov symmetries." data-toggle="popover" href="/tests/v3/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H, compressed simple cubic, frozen-phonon calculations corresponding
to test 72. No linear XC core correction.
The total energy of the quadruple cell is -2.2457924013451 Ha,
in excellent agreement with the result of test 72.
The frozen-phonon (from forces) calculation of the 2DTE for the q(1/2 0 0)
case gives 2.0769790d-2 . A better finite-difference scheme, using
a doubled displacement to cancel the finite-difference error, gives
2.076834d-2.
The frozen-phonon (from forces) calculation of the 2DTE for the q(1/4 0 0)
case gives 1.105321d-2 . A better finite-difference scheme, using
a doubled displacement to cancel the finite-difference error, gives
1.105275d-2 ." data-toggle="popover" href="/tests/v3/Input/t73.abi" target="_blank">t73.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al FCC, in conventional cell (4 atoms/cell).
Preparation of the positron calculation, test#96." data-toggle="popover" href="/tests/v4/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Al FCC, in conventional cell (4 atoms/cell).
Positron calculation : lifetime and decay rate." data-toggle="popover" href="/tests/v4/Input/t96.abi" target="_blank">t96.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test a fake antiferromagnetic Fe crystal :
recognition of symmetries when there is a small set of non-magnetic
atoms, and a larger set of antiferromagnetic atoms.
There was a bug in pre-4.5.3 versions." data-toggle="popover" href="/tests/v4/Input/t99.abi" target="_blank">t99.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a conductivity calculation (test v5#t10)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 10.
It tests the following parts of the code:
optic_paw, optic_paw_core
Note that, in addition to the psp file, the core wave functions file is needed." data-toggle="popover" href="/tests/v5/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth, rhombohedral, two atoms per unit cell
Scalar relativistic.
Relax four different images, using the steepest descent algorithm." data-toggle="popover" href="/tests/v6/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Boron, 32 atoms - Thomas-Fermi method (without orbitals)
Test the temperature-dependent XC functional (ixc=50)
(Ichimaru et al Phys. Rep. 149, 91-205 (1987)
Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-toggle="popover" href="/tests/v7/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the electron-positron Doppler broadening
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Computes the positron lifetime and well as the electron-positron
pairs momentum distributions, after the SCF iterations." data-toggle="popover" href="/tests/v7/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, ground state WF" data-toggle="popover" href="/tests/v8/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=2" data-toggle="popover" href="/tests/v8/Input/t73.abi" target="_blank">t73.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>If the symmetry finder is used (see <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a>), a non-zero value of  <strong>chkprim</strong> 
will make the code stop if a non-primitive cell is used. If  <strong>chkprim</strong>  = 0, a
warning is issued, but the run does not stop.</p>
<p>If you are generating the atomic and cell geometry using <a class="wikilink codevar-wikilink" href="/variables/geo#spgroup">spgroup</a>, you
might generate a PRIMITIVE cell using <a class="wikilink codevar-wikilink" href="/variables/geo#brvltt">brvltt</a> = -1.</p>
<h2 id="chksymbreak"><strong>chksymbreak</strong><a class="headerlink" href="#chksymbreak" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CHecK SYMmetry BREAKing<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [103/1245] in all abinit tests, [10/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure writting the KB form factors to output. This is a two data set run,
the first dataset being a ground state calculation and the writes the WFs + KB form factors" data-toggle="popover" href="/tests/etsf_io/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon solid, experimental lattice parameter.
Realistic parameters are used (ecut=20, ngkpt=2x2x2 shifted 4 times, but centered on Gamma).
Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
The LDA gap is observed at Gamma : 8.071 eV, is in reasonable agreement with the gap from the TB paper PRL 102, 226401 (2009),
where it is mentioned to be 8.16 eV.
The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV.
The reading of the kinetic energy density, to start a non-SCF calculation is not yet implemented,
as of ABINITv6.12.0 .
This test was used to examine the speed of the convergence in case of elongated cells, up to 16 atoms.
The mGGA convergence was found to be similar to the LDA convergence.
Also, test non-self-consistent mGGA calculation, with reading of the previously produced _DEN and _KDEN files." data-toggle="popover" href="/tests/libxc/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the string method within parallelization over images
Inspired by test v6#22.
Hydrogen diatomic molecule in a cell, close to BCC
7 images, exploring the transition path.
Three datasets, testing each value of prtvolimg.
Processors distribution automatically determined:" data-toggle="popover" href="/tests/paral/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the string method within parallelization over images
Inspired by test v6#22.
Hydrogen diatomic molecule in a cell, close to BCC
7 images, exploring the transition path.
Three datasets, testing each value of prtvolimg.
Processors distribution automatically determined:" data-toggle="popover" href="/tests/paral/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the string method within parallelization over images
Inspired by test v6#22.
Hydrogen diatomic molecule in a cell, close to BCC
7 images, exploring the transition path.
Three datasets, testing each value of prtvolimg.
Processors distribution automatically determined:" data-toggle="popover" href="/tests/paral/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant by two different techniques" data-toggle="popover" href="/tests/seq/Input/tsv3_05.abi" target="_blank">tsv3_05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CrystallIne AlAs
first three runs are for calculation of ground state at finite electric field
the fourth run gets the gs wavefunction and then do response calculation
the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-toggle="popover" href="/tests/seq/Input/tsv4_80.abi" target="_blank">tsv4_80.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-toggle="popover" href="/tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-toggle="popover" href="/tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Convergence of the number of bands in the transition space." data-toggle="popover" href="/tests/tutorial/Input/tbs_3.abi" target="_blank">tbs_3.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si diamond. Usual geometry, psps. Low ecut (3 Ha)
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed). Then, non-self-consistent
calculation for k points that have special
istwfk values, for further analysis by cut3d in the next tests." data-toggle="popover" href="/tests/v3/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in HCP structure. Low cut-offs and few k-points.
This test is done within GGA and no magnetism in PAW formalism.
The same job is done twice with two differents values of mkmem." data-toggle="popover" href="/tests/v4/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si/Ge heterojunction : 4 layer each. Output the density and potential.
Prepare the macroaverage analysis, see next tests." data-toggle="popover" href="/tests/v4/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure
Compute the polarization along strings
of k-points parallel to the primitive vectors of the reciprocal
lattice. The Berry phase calculations are performed
in three different datasets. For each datatset, ABINIT writes
the polarization in reduced coordinates to a DDB." data-toggle="popover" href="/tests/v4/Input/t72.abi" target="_blank">t72.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms per cell
Test computation of the local exact exchange (PBE0) in PAW." data-toggle="popover" href="/tests/v5/Input/t18.abi" target="_blank">t18.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of berrystep
Al-As cristal, zinc-blende structure
Compute the polarization along strings
of k-points parallel to the primitive vectors of the reciprocal
lattice, and using multiple step berry phase calculation.
(Tests 21-30 are related to geometry optimization, molecular dynamics, etc)

Cannot be executed in parallel:
chkint_prt: ERROR -
Context : the value of the variable nproc is 2.
The value of the input variable berrystep is 5, while it must be
equal to 1" data-toggle="popover" href="/tests/v6/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen diatomic molecule in a cell, close to BCC
Test the string method : 6 images, exploring the transition
path. Similar to test 22 (but with string)." data-toggle="popover" href="/tests/v6/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock
(only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-toggle="popover" href="/tests/v67mbpt/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-toggle="popover" href="/tests/v67mbpt/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-toggle="popover" href="/tests/v67mbpt/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test to use usepawu=4
Test done in comparison to [[cite:Chen2016a]]." data-toggle="popover" href="/tests/v8/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, ground state WF" data-toggle="popover" href="/tests/v8/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests various usepawu on Fe. usepaw=X should give the same result than usepawu=-X." data-toggle="popover" href="/tests/v9/Input/t78.abi" target="_blank">t78.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions." data-toggle="popover" href="/tests/wannier90/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
</ul>
</details>
<p>This variable governs the behaviour of the code when there is a potential
source of symmetry breaking related to the k point grid.</p>
<p>When <strong>chksymbreak</strong> = 1, the code stops if
the k point grid is non-symmetric, in case <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> =1, 2, or 4.
Also, the code stops if <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> is not 1, 2 or 4.</p>
<p>Note that the check is disabled when the number of k-points in the BZ is greater than <span><span class="MathJax_Preview">40^3</span><script type="math/tex">40^3</script></span>.</p>
<p>When <strong>chksymbreak</strong> = 0, there is no such check.</p>
<p>Explanation:
In the ground-state calculation, such breaking of the symmetry is usually
harmless. However, if the user is doing a calculation of phonons using DFPT
(<a class="wikilink codevar-wikilink" href="/variables/dfpt#rfphon">rfphon</a> = 1), the convergence with respect to the number of k points will be
worse with a non-symmetric grid than with a symmetric one.</p>
<p>So, it was decided to warn the user about such problem already at
the level of the ground state calculations, although such warning might be irrelevant.</p>
<p>Concerning the values of <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a>, usage of values other then 1, 2, or 4 can hardly be understood,
as it will yield in many cases a non-homogeneous or non-symmetric k point grid.
So, it is usually an error of the user.</p>
<p>If you encounter a problem outlined above, you have some choices: change your
k point grid, to make it more symmetric, and/or respect <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a>=1, 2, or 4, or ignore the problem, and set <strong>chksymbreak</strong> = 0.</p>
<h2 id="chksymtnons"><strong>chksymtnons</strong><a class="headerlink" href="#chksymtnons" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CHecK SYMmetry of TNONS<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> 9.2.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [74/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LOBPCG, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/paral/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy
Determination of the surface energy of aluminum :
convergence with respect to the number of vacuum layers." data-toggle="popover" href="/tests/tutorial/Input/tbase4_7.abi" target="_blank">tbase4_7.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy

Determination of the surface energy of aluminum :
convergence with respect to the number of vacuum layers." data-toggle="popover" href="/tests/tutorial/Input/tbase4_8.abi" target="_blank">tbase4_8.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.
Double-loop over acell and ecut using series" data-toggle="popover" href="/tests/v1/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.
Double-loop over acell and ecut using metacharacters only." data-toggle="popover" href="/tests/v1/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Al2O3 cell in rhombohedric cell with different axes.
Dataset 1 : Rhombohedral axes; full set of symmetries and full set of atoms
Dataset 2 : Rhombohedral axes; irreducible unit cell and space group
Dataset 3 : Hexagonal axes; irreducible unit cell and space group
Dataset 4 : Hexagonal axes; full unit cell and space group
The results are equivalent for Dataset 1 and 2 and Dataset 3 and 4." data-toggle="popover" href="/tests/v1/Input/t96.abi" target="_blank">t96.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 diatomic molecule. Spin-polarized (ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=1 (Teter LSDA)
From dataset 2 and 3, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 10.88934274 Ha, while the direct computation,
in dataset 4 gives 10.88933963 Ha .

Cannot be executed in parallel

chkinp: Checking input parameters for consistency, jdtset= 3.

--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number :
1 The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential version
of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v3/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 diatomic molecule. Spin-polarized (ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=7 (Perdew-Wang 92 LSDA)
From dataset 2 and 3, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 10.88283478 Ha, while the direct computation,
in dataset 4 gives 10.882832 Ha .

Cannot be executed in parallel
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v3/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 diatomic molecule. Spin-polarized (anti-ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=1 (Teter LSDA)
From datasets 3 and 4, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 6.283100652 Ha, while the direct computation,
without using Shubnikov symmetries, gives
6.282967527 Ha." data-toggle="popover" href="/tests/v3/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
5-atom Al slab, with three vacuum layers.
First, converge the wavefunctions, then compute the
STM charge density below and above the Fermi energy, within a 2eV range.
Also compute band-by-band decomposition of STM charge density below the Fermi energy, within a 2eV range." data-toggle="popover" href="/tests/v4/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 diatomic molecule. Spin-polarized (ferromagnetic).
Test the Wu-Cohen GGA functional.
Similar to Test v3#49
Direct calculation of the gradient with respect
to reduced coordinates gives  0.344935232634 Ha
while finite differences gives :
with delta(xred)=0.002,  0.34493521   Ha

Cannot be executed in parallel
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential version
of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v5/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BeH spin-polarized, in a supercell
Test the spin-polarized TDDFT implementation.
nband 20 , ecut 8 , acell 14 14 14 .
For the first two excitations, one finds :
2.40967E+00 eV , doubly degenerate  (Pi excitation)
3.94165E+00 eV  (Sigma+ excitation)
They come mainly from the 2nd occupied Kohn-Sham state, spin up.
The third excitation, at 5.11592E+00 eV (Sigma+ excitation) comes mainly from
the 1st occupied Kohn-Sham state, spin down.
Then, come excitations that are in the continuum, or close to it
(depending on the parameters of the calculation), so, harder to converge,
In order to have a calculation converged
at the level of 0.1 eV, one needs parameters like
nband 40 , ecut 10 , acell 30.
In that case, the three above-mentioned excitations become
2.388 eV (Pi), 4.432 eV (Sigma+), 5.357 eV (Sigma+).
In this case, the latter is no more the third excitation, as other ones,
coupled to the vacuum have a lower energy.
These numbers can be compared to the values given by
J. Guan, ME Casida, DR Salahub, J. of Mol. Structure - Theochem 527,
229, Sp. Iss. SI (2000) :
2.391 eV (1Pi), 4.593 eV (2Sigma+), 5.418 eV (5Sigma+),
and to the experimental values (see the above paper)
2.56 eV/2.484 eV , 5.51 eV , 6.71 eV." data-toggle="popover" href="/tests/v5/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Delocalized internals test. Si diamond bulk with displaced atom
Unconverged in all variables" data-toggle="popover" href="/tests/v6/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon. Diamond structure.
Quick test of the use of datasets with a numbering beyond 1000 (the last one is 1022).
(Tests 35-40 are for response-function)" data-toggle="popover" href="/tests/v6/Input/t34.abi" target="_blank">t34.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test of velocity verlet integrator" data-toggle="popover" href="/tests/v8/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation with constrained charges
Constrain the charge around atom 1 to the value 0.5, then work with both atoms and larger spheres

For dataset 2, the derivative wrt the constraint, the derivative of the total energy with respect to atomic displacement
and the stress calculations have been checked, as follows.

Initially, the total energy is -0.99164352451, the target charge is 0.5, and the gradient wrt the charge is computed -0.58356219787.
Changing the target charge by +0.001 gives etotal -0.99222576777
Changing the target charge by -0.001 gives etotal -0.99105864425
Finite-difference gives -0.5835617, in excellent agreement for that level of methodology.

For atom 1, dE/dtau (=-force in reduced coordinate) is computed 8.330114676.
Changing the atomic position of the first atom from -1.1 to -1.10015
gives etotal -0.99172669330, to -1.09985 gives etotal -0.99156009221, delivering 8.330054.
The result of a similar finite-difference estimation with twice bigger values gives 8.329896.
Combining both results to eliminate the quadratic error gives 8.330107, with an agreement of 5 digits with dE/dtau.

The stress is computed 2.755820639e-4 .
Multiplying both acell and xcart by 1.001 gives etotal -0.99122698240.
Multiplying both acell and xcart by 0.999 gives etotal -0.99205366103.
The derivative of total energy wrt to strain is thus 0.41333932. Dividing by the unit cell volume (1500) gives 2.75559e-4 ,
in excellent agreement for that level of methodology." data-toggle="popover" href="/tests/v8/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>This variable governs the behaviour of the code when there is a potential
symmetry breaking, related to the presence
of non-symmorphic translations not leaving the FFT exchange-correlation grid invariant.</p>
<p>When <strong>chksymtnons</strong> = 1, the code stops if
the non-symmorphic translation part of the symmetry operations has components that are not zero,
or simple fractions with 2, 3, 4, 5, 6, 8, 9, 10 or 12 as denominators. Also, suggestions
to bypass the problem are made in the output file.</p>
<p>When <strong>chksymtnons</strong> = 2, the code makes similar check, but does not stop after providing
in the output file suggestions to bypass the problem.</p>
<p>When <strong>chksymtnons</strong> = 3, the code acts as with <strong>chksymtnons</strong> = 1, but then generates a FFT grid which is
left invariant under the action of the spatial symmetry operations, which might enlarge it.
In case of Constrained DFT calculations (see <a class="wikilink codevar-wikilink" href="/variables/gstate#constraint_kind">constraint_kind</a>), only <strong>chksymtnons</strong> = 3 or <strong>chksymtnons</strong> = 0 are allowed.</p>
<p>When <strong>chksymtnons</strong> = 0, the code skips the check.</p>
<p>Explanation:
In ground-state or DFPT calculations, such breaking of the symmetry is harmless.
However, for a GW, BSE or cDFT calculation, the presence of non-symmorphic translations
that are not coherent with the FFT grid will cause problems (e.g. enormous memory reservation, inducing segfault, or lack of convergence).</p>
<p>For cDFT calculations, the local integral of magnetization or charge is evaluated in real space, on the FFT grid. So, if
the grids are locally different for two atoms related by symmetry (so in principle equivalent), there is a incoherency, that might induce
lack of convergence.</p>
<p>In the GW or BSE parts of ABINIT, one needs to reconstruct the wavefunctions in the full Brillouin zone
for calculating both the polarizability and the self-energy. The wavefunctions
in the full Brillouin zone are obtained from the irreducible wedge by applying
the symmetry operations of the space group of the crystal. In the present
implementation, the symmetrisation of the wavefunctions is done in real space
on the FFT mesh that, therefore, has to be coherent both with the rotational
part as well as with the fractional translation of each symmetry operation. If
the condition above (2, 3, 4, 5, 6, 7, 8, 9, 10, or 12 as denominator) is not met,
the GW/BSE code will not be able to find a symmetry preserving FFT mesh.</p>
<p>So, it was decided to warn the user about such problem already at
the level of the ground-state calculations, although such warning might be irrelevant.</p>
<p>If you encounter the problem outlined above, you have two choices: change your
atomic positions (translate them) such that the origin appears as the most
symmetric point; or ignore the problem, and set <strong>chksymtnons</strong> = 2 or 0 (only the latter for cDFT)..
If <strong>chksymtnons</strong> = 2, ABINIT makes a suggestion of a possible global translation,
and corresponding translated atomic positions.</p>
<h2 id="chrgat"><strong>chrgat</strong><a class="headerlink" href="#chrgat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CHARGE of the AToms<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation within constrained DFT" data-toggle="popover" href="/topics/ConstrainedDFT">topic_ConstrainedDFT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> [ <a class="wikilink codevar-wikilink" href="/variables/geo#natrd">natrd</a> ] if <a class="wikilink codevar-wikilink" href="/variables/geo#natrd">natrd</a>&lt;<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>,
[ <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a> ] otherwise.</p>
<p><em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation with constrained charges
Constrain the charge around atom 1 to the value 0.5, then work with both atoms and larger spheres

For dataset 2, the derivative wrt the constraint, the derivative of the total energy with respect to atomic displacement
and the stress calculations have been checked, as follows.

Initially, the total energy is -0.99164352451, the target charge is 0.5, and the gradient wrt the charge is computed -0.58356219787.
Changing the target charge by +0.001 gives etotal -0.99222576777
Changing the target charge by -0.001 gives etotal -0.99105864425
Finite-difference gives -0.5835617, in excellent agreement for that level of methodology.

For atom 1, dE/dtau (=-force in reduced coordinate) is computed 8.330114676.
Changing the atomic position of the first atom from -1.1 to -1.10015
gives etotal -0.99172669330, to -1.09985 gives etotal -0.99156009221, delivering 8.330054.
The result of a similar finite-difference estimation with twice bigger values gives 8.329896.
Combining both results to eliminate the quadratic error gives 8.330107, with an agreement of 5 digits with dE/dtau.

The stress is computed 2.755820639e-4 .
Multiplying both acell and xcart by 1.001 gives etotal -0.99122698240.
Multiplying both acell and xcart by 0.999 gives etotal -0.99205366103.
The derivative of total energy wrt to strain is thus 0.41333932. Dividing by the unit cell volume (1500) gives 2.75559e-4 ,
in excellent agreement for that level of methodology." data-toggle="popover" href="/tests/v8/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
Check jointly the charge and vector magnetization constraints, with differing vector orientations." data-toggle="popover" href="/tests/v8/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2 with sphere overlap
DS2 Constrains the collinear magnetization around atom 1 to be +0.70 and around atom 2 to be -0.70
DS3 Constrains the collinear magnetization around atom 1 to be +0.70 and around atom 2 to be -0.70, and the total charge of both to be 0.00.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.70 and around atom 2 to be -0.70. Same result as DS2.
DS5 and DS6 are not really useful, simply sanity checks for imposition of axis or direction of magnetization for collinear magnetism" data-toggle="popover" href="/tests/v8/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction.
Case where the spheres overlap
Interestingly, in the case where only the magnitude of the magnetization on the second atom is fixed,
without fixing its charge, the optimal configuration gives a 90 degree difference of magnetization direction for both atoms.
It would be interesting to understand the meaning of such results, and see whether one is not in a local minimum.
A full mapping of the energy as a function of both magnitude and direction of the magnetization of the second atom would be interesting ..." data-toggle="popover" href="/tests/v8/Input/t29.abi" target="_blank">t29.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a></li>
</ul>
</details>
<p>Gives the target integrated charge in case of constrained DFT calculations, see <a class="wikilink codevar-wikilink" href="/variables/gstate#constraint_kind">constraint_kind</a>.
Given in atomic unit of charge (=minus the charge of the electron).
Note that this number is the net positive charge inside the sphere: one subtract from the
nucleus charge <a class="wikilink codevar-wikilink" href="/variables/internal#ziontypat">%ziontypat</a> the integrated valence electron density in a sphere defined by <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a>.
The latter has indeed a negative value. Note that if the sphere radius <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a> is not sufficiently large,
the amount of electrons will be smaller than expected based on chemical intuition. This means that there
is in this case a bias toward too positive integrated charges. By contrast, if the sphere radius is too large,
the spheres will overlap, and the electrons in the interatomic region will be double counted.</p>
<h2 id="constraint_kind"><strong>constraint_kind</strong><a class="headerlink" href="#constraint_kind" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CONSTRAINT KIND in constrained DFT<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation within constrained DFT" data-toggle="popover" href="/topics/ConstrainedDFT">topic_ConstrainedDFT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt; 1 and <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &lt; 10 and <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a> /= 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [12/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation with constrained charges
Constrain the charge around atom 1 to the value 0.5, then work with both atoms and larger spheres

For dataset 2, the derivative wrt the constraint, the derivative of the total energy with respect to atomic displacement
and the stress calculations have been checked, as follows.

Initially, the total energy is -0.99164352451, the target charge is 0.5, and the gradient wrt the charge is computed -0.58356219787.
Changing the target charge by +0.001 gives etotal -0.99222576777
Changing the target charge by -0.001 gives etotal -0.99105864425
Finite-difference gives -0.5835617, in excellent agreement for that level of methodology.

For atom 1, dE/dtau (=-force in reduced coordinate) is computed 8.330114676.
Changing the atomic position of the first atom from -1.1 to -1.10015
gives etotal -0.99172669330, to -1.09985 gives etotal -0.99156009221, delivering 8.330054.
The result of a similar finite-difference estimation with twice bigger values gives 8.329896.
Combining both results to eliminate the quadratic error gives 8.330107, with an agreement of 5 digits with dE/dtau.

The stress is computed 2.755820639e-4 .
Multiplying both acell and xcart by 1.001 gives etotal -0.99122698240.
Multiplying both acell and xcart by 0.999 gives etotal -0.99205366103.
The derivative of total energy wrt to strain is thus 0.41333932. Dividing by the unit cell volume (1500) gives 2.75559e-4 ,
in excellent agreement for that level of methodology." data-toggle="popover" href="/tests/v8/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
Check jointly the charge and vector magnetization constraints, with differing vector orientations." data-toggle="popover" href="/tests/v8/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction" data-toggle="popover" href="/tests/v8/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2 with sphere overlap
DS2 Constrains the collinear magnetization around atom 1 to be +0.70 and around atom 2 to be -0.70
DS3 Constrains the collinear magnetization around atom 1 to be +0.70 and around atom 2 to be -0.70, and the total charge of both to be 0.00.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.70 and around atom 2 to be -0.70. Same result as DS2.
DS5 and DS6 are not really useful, simply sanity checks for imposition of axis or direction of magnetization for collinear magnetism" data-toggle="popover" href="/tests/v8/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction.
Case where the spheres overlap
Interestingly, in the case where only the magnitude of the magnetization on the second atom is fixed,
without fixing its charge, the optimal configuration gives a 90 degree difference of magnetization direction for both atoms.
It would be interesting to understand the meaning of such results, and see whether one is not in a local minimum.
A full mapping of the energy as a function of both magnitude and direction of the magnetization of the second atom would be interesting ..." data-toggle="popover" href="/tests/v8/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization." data-toggle="popover" href="/tests/v8/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization.
At present DS31 and DS32 do not work as expected ..." data-toggle="popover" href="/tests/v8/Input/t96.abi" target="_blank">t96.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization.
At present DS21, 31 and 32 do not work as expected. Hence the huge tolerance." data-toggle="popover" href="/tests/v8/Input/t97.abi" target="_blank">t97.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a></li>
</ul>
</details>
<p>If  <strong>constraint_kind</strong>  is non-zero for at least one type of atom,
the constrained DFT algorithm is activated.
 <strong>constraint_kind</strong>  defines, for each type of atom, the kind of constraint(s) imposed by constrained DFT.
When  <strong>constraint_kind</strong>  is zero for an atom type, there is not constraint applied to this atom type.
Otherwise, different constraints can be imposed on the total charge (ion+electronic) and/or magnetization, computed
inside a sphere of radius <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a>, possibly smeared within a width <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsm">ratsm</a>.
Such integrated ion+electronic charge might be imposed to be equal to <a class="wikilink codevar-wikilink" href="/variables/gstate#chrgat">chrgat</a>, while the magnetization might be compared to <a class="wikilink codevar-wikilink" href="/variables/gstate#spinat">spinat</a>.
The first digit of  <strong>constraint_kind</strong>  defines the constraint on the charge, while the second digit defines the constraint on the
magnetization.</p>
<p>When  <strong>constraint_kind</strong>  is 10 or above, the charge constraint will be imposed.</p>
<p>When  <strong>constraint_kind</strong> =1 or 11, the exact value (vector in the non-collinear case, amplitude and sign in the collinear case) of the magnetization is constrained;
When  <strong>constraint_kind</strong> =2 or 12, only the magnetization axis is constrained (only meaningful in the non-collinear case, albeit allowed);
When  <strong>constraint_kind</strong> =3 or 13, only the magnetization magnitude is constrained.
When  <strong>constraint_kind</strong> =4 or 14, only the magnetization direction is constrained (only meaningful in the non-collinear case, not allowed in the collinear case);</p>
<p>For the algorithm, see <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation within constrained DFT" data-toggle="popover" href="/topics/ConstrainedDFT">topic_ConstrainedDFT</a>. It makes important use of the potential residual,
so the algorithm works only with <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> between 2 and 9.
The balance between the potential residual, and the density/magnetization constraint is governed by <a class="wikilink codevar-wikilink" href="/variables/gstate#magcon_lambda">magcon_lambda</a>. The spherical integral is governed by <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsm">ratsm</a>.</p>
<p>Note that while a spherical integral around an atom might reasonably well capture the magnetization of an atom within a solid or within a molecule,
 so that the sum of such magnetizations might be reasonably close to the total magnetization of the solid,
such a procedure hardly gives the total charge of the solid: the space between the spheres is too large when the spheres do not overlap,
while overlapping spheres will not deliver the correct total charge of the system.</p>
<p>Note that  <strong>constraint_kind</strong>  defines constraints for types of atoms, not for specific atoms.
Atoms of the same type are supposed to incur the same constraint.
If the user wants to impose different constraints on atoms of the same type (in principle), it is possible (and easy) to pretend
that they belong to different types, even if the same pseudopotential file is used for these atoms. There is an example
in test <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation with constrained charges
Constrain the charge around atom 1 to the value 0.5, then work with both atoms and larger spheres

For dataset 2, the derivative wrt the constraint, the derivative of the total energy with respect to atomic displacement
and the stress calculations have been checked, as follows.

Initially, the total energy is -0.99164352451, the target charge is 0.5, and the gradient wrt the charge is computed -0.58356219787.
Changing the target charge by +0.001 gives etotal -0.99222576777
Changing the target charge by -0.001 gives etotal -0.99105864425
Finite-difference gives -0.5835617, in excellent agreement for that level of methodology.

For atom 1, dE/dtau (=-force in reduced coordinate) is computed 8.330114676.
Changing the atomic position of the first atom from -1.1 to -1.10015
gives etotal -0.99172669330, to -1.09985 gives etotal -0.99156009221, delivering 8.330054.
The result of a similar finite-difference estimation with twice bigger values gives 8.329896.
Combining both results to eliminate the quadratic error gives 8.330107, with an agreement of 5 digits with dE/dtau.

The stress is computed 2.755820639e-4 .
Multiplying both acell and xcart by 1.001 gives etotal -0.99122698240.
Multiplying both acell and xcart by 0.999 gives etotal -0.99205366103.
The derivative of total energy wrt to strain is thus 0.41333932. Dividing by the unit cell volume (1500) gives 2.75559e-4 ,
in excellent agreement for that level of methodology." data-toggle="popover" href="/tests/v8/Input/t24.abi" target="_blank">v8[24]</a>, the hydrogen dimer, where the charge around the first atom is constrained, and the charge around the second atom is left free.</p>
<p>Similarly, ABINIT is more careful about the control of symmetry: supposing that two atoms are related by some symmetry, then ABINIT
generates a FFT grid that is invariant under that symmetry, unless this additional constraint on the FFT grid is explicitly suppressed by the user.
In this respect, the default value of <a class="wikilink codevar-wikilink" href="/variables/gstate#chksymtnons">chksymtnons</a> is not allowed, but <a class="wikilink codevar-wikilink" href="/variables/gstate#chksymtnons">chksymtnons</a> must be equal to 3 (with the generation of a symmetric FFT grid) or 0.</p>
<p>The difference between  <strong>constraint_kind</strong> =4 or 14 and  <strong>constraint_kind</strong> =2 or 12 lies in the fact that  <strong>constraint_kind</strong> =2 or 12 will consider similarly
a magnetization vector and its opposite, as this constraint is just alignment on an axis, while  <strong>constraint_kind</strong> =4 or 14 enforces that
the scalar product of the target magnetization direction (normalized vector) and the actual optimized magnetization direction (normalized vector) is positive.</p>
<p>Incidentally, <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a>==4 is not allowed in the present implementation of constrained DFT because the motion of atoms and simultaneous computation of constraints would be difficult to handle.</p>
<h2 id="cprj_in_memory"><strong>cprj_in_memory</strong><a class="headerlink" href="#cprj_in_memory" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> C-PRoJectors IN MEMORY<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em>   </p>
<details class="note"><summary>Test list (click to open). Moderately used, [21/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare xg_nonlop_option=0 and 1 (chebfi2 only). PAW,istwfk=1,npband=4" data-toggle="popover" href="/tests/paral/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). NC,istwfk&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t37.abi" target="_blank">t37.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). Should give same results than v10[04]. PAW,istwfk=1" data-toggle="popover" href="/tests/v10/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk=1,nsppol=2." data-toggle="popover" href="/tests/v10/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,nspinor=2" data-toggle="popover" href="/tests/v10/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different nloc_alg options give the correct energy.
Case istwfk=1." data-toggle="popover" href="/tests/v9/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different nloc_alg options give the correct energy.
Case istwfk&gt;=2." data-toggle="popover" href="/tests/v9/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces and stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t73.abi" target="_blank">t73.abi</a> &hellip;</li>
</ul>
</details>
<p>For systems with many atoms, non-local operations are the most time-consuming part of the computation.
The non-local contribution of the wavefunction <span><span class="MathJax_Preview">\psi</span><script type="math/tex">\psi</script></span> to the energy writes:</p>
<div>
<div class="MathJax_Preview"> E_{non-local} = \sum_a\sum_{i,j} &lt;\psi|p_{a,i}&gt; e_{a,ij} &lt;p_{a,j}|\psi&gt; </div>
<script type="math/tex; mode=display"> E_{non-local} = \sum_a\sum_{i,j} <\psi|p_{a,i}> e_{a,ij} <p_{a,j}|\psi> </script>
</div>
<p>and the Hamiltonian applied to a wavefunction is:</p>
<div>
<div class="MathJax_Preview"> H_{non-local}|\psi&gt; = \sum_a\sum_{ij} |p_{a,i}&gt; D_{a,ij} &lt;p_{a,i}|\psi&gt; </div>
<script type="math/tex; mode=display"> H_{non-local}|\psi> = \sum_a\sum_{ij} |p_{a,i}> D_{a,ij} <p_{a,i}|\psi> </script>
</div>
<p>The index &ldquo;a&rdquo; stands for atoms (<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>), while &ldquo;i&rdquo; and &ldquo;j&rdquo; indices run over the set of available projectors in the pseudo-potential.
<span><span class="MathJax_Preview">e_{a,ij}</span><script type="math/tex">e_{a,ij}</script></span> and <span><span class="MathJax_Preview">D_{a,ij}</span><script type="math/tex">D_{a,ij}</script></span> are scalars.
In the PAW formalism (<a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> = 1), the overlap operator has the same structure than <span><span class="MathJax_Preview">H_{non-local}</span><script type="math/tex">H_{non-local}</script></span>.
Introducing the &ldquo;cprj&rdquo; coefficients:</p>
<div>
<div class="MathJax_Preview"> cprj(a,i) = &lt;p_{a,i}|\psi&gt; </div>
<script type="math/tex; mode=display"> cprj(a,i) = <p_{a,i}|\psi> </script>
</div>
<p>the energy writes:</p>
<div>
<div class="MathJax_Preview"> E_{non-local} = \sum_a\sum_{ij} \left(cprj(a,i)\right)^* e_{a,ij} cprj(a,j) </div>
<script type="math/tex; mode=display"> E_{non-local} = \sum_a\sum_{ij} \left(cprj(a,i)\right)^* e_{a,ij} cprj(a,j) </script>
</div>
<p>and the Hamiltonian becomes:</p>
<div>
<div class="MathJax_Preview"> H_{non-local}|\psi&gt; = \sum_a\sum_{i,j} |p_{a,i}&gt; D_{a,ij} cprj(a,j) </div>
<script type="math/tex; mode=display"> H_{non-local}|\psi> = \sum_a\sum_{i,j} |p_{a,i}> D_{a,ij} cprj(a,j) </script>
</div>
<p>With  <strong>cprj_in_memory</strong>  = 0, &ldquo;cprj&rdquo; coefficients are computed on-the-fly in many parts of the code, including ground-state computations.
If  <strong>cprj_in_memory</strong>  = 1, &ldquo;cprj&rdquo; coefficients are computed and stored in memory at the diagonalization step. This option is available only for LOBPCG (<a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a>=114) and Chebyshev filtering (<a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a>=111).
If  <strong>cprj_in_memory</strong>  = 2, &ldquo;cprj&rdquo; coefficients are stored in memory during the whole computation, and they evolve as the wavefunctions do. This feature is available only for <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a>=10.</p>
<p><strong>cprj_in_memory</strong>  &gt; 0 is expected to be faster than  <strong>cprj_in_memory</strong>  = 0 for big systems (many atoms and/or many bands).</p>
<p>For now,  <strong>cprj_in_memory</strong>  = 1 is implemented only in the following context:</p>
<ul>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 0 : ground-state computation. If optdriver/=0,  <strong>cprj_in_memory</strong>  is set to 0 automatically.</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a> = 10,114 or 111 : using Congugate Gradient algorithm (PAW only), LOBPCG (PAW or NC) or Chebyshev filtering (PAW or NC)</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/gstate#rmm_diis">rmm_diis</a> = 0 : without the use of rmm_diis algorithm</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/ffield#berryopt">berryopt</a> = 0 : without finite electric-field</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> = 0 : without Fock exchange term in the functional</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/gstate#nucdipmom">nucdipmom</a> = 0 : without nuclear dipolar moments</p>
</li>
</ul>
<p>For  <strong>cprj_in_memory</strong>  = 2, see <a class="wikilink codevar-wikilink" href="/variables/dev#cprj_update_lvl">cprj_update_lvl</a> for a fine tuning of &ldquo;cprj&rdquo; updates (i.e. when they are computed directly from wavefunctions).</p>
<h2 id="cpuh"><strong>cpuh</strong><a class="headerlink" href="#cpuh" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CPU time limit in Hours<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a>, <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#cpum">cpum</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#cpus">cpus</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1245] in all abinit tests, [0/159] in abinit tutorials</summary></details>
<p>Only one of the three real parameters <a class="wikilink codevar-wikilink" href="/variables/gstate#cpus">cpus</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#cpum">cpum</a> and  <strong>cpuh</strong>  can be
defined in the input file to set up a CPU time limit. When the job reaches
that limit, it will try to end smoothly. However, note that this might still
take some time. If the user want a firm CPU time limit, the present parameter
must be reduced sufficiently. Intuition about the actual margin to be taken
into account should come with experience.
A zero value has no action of the job.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One can pass the timelimit to abinit via the command line option:</p>
<div class="codehilite"><pre><span></span><code>abinit --timelimit hours:minutes:seconds
</code></pre></div>

<p>This approach is much more powerful especially when the job must be submitted
to the queue via a submission script e.g. a Slurm script.
In this case, indeed, one can define a shell variable for the time limit
and use this variable to pass the time limit to Slurm and Abinit at the same time.</p>
<p>Use <code>abinit --help</code> for further information.</p>
</div>
<h2 id="cpum"><strong>cpum</strong><a class="headerlink" href="#cpum" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CPU time limit in Minutes<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a>, <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#cpuh">cpuh</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#cpus">cpus</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1245] in all abinit tests, [0/159] in abinit tutorials</summary></details>
<p>Only one of the three real parameters <a class="wikilink codevar-wikilink" href="/variables/gstate#cpus">cpus</a>,  <strong>cpum</strong>  and <a class="wikilink codevar-wikilink" href="/variables/gstate#cpuh">cpuh</a> can be
defined in the input file to set up a CPU time limit. When the job reaches
that limit, it will try to end smoothly. However, note that this might still
take some time. If the user want a firm CPU time limit, the present parameter
must be reduced sufficiently. Intuition about the actual margin to be taken
into account should come with experience.
A zero value has no action of the job.</p>
<h2 id="cpus"><strong>cpus</strong><a class="headerlink" href="#cpus" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CPU time limit in seconds<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a>, <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#cpuh">cpuh</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#cpum">cpum</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Gold with one vacancy (107 atoms of gold)." data-toggle="popover" href="/tests/tutoparal/Input/tparal_bandpw_01.abi" target="_blank">tparal_bandpw_01.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Au linear chain. Test the output of a launch.dat file for WanT
Note: the file that is produced is not tested,
Only the usual output file of ABINIT.
Want output does not support MPI with ncpus &gt; 1." data-toggle="popover" href="/tests/v4/Input/t89.abi" target="_blank">t89.abi</a></li>
</ul>
</details>
<p>Only one of the three real parameters  <strong>cpus</strong> , <a class="wikilink codevar-wikilink" href="/variables/gstate#cpum">cpum</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#cpuh">cpuh</a> can be
defined in the input file to set up a CPU time limit. When the job reaches
that limit, it will try to end smoothly. However, note that this might still
take some time. If the user want a firm CPU time limit, the present parameter
must be reduced sufficiently. Intuition about the actual margin to be taken
into account should come with experience.
A zero value has no action of the job.</p>
<h2 id="diecut"><strong>diecut</strong><a class="headerlink" href="#diecut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DIElectric matrix energy CUToff<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2.2<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [13/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al2 molecule, inversion point shifted from the origin, ixc=0,
kpt=1/4 1/4 1/4, nsym=4.
Large number of bands (20 instead of 3).
8 first SCF steps with simple mixing algorithm, mixing factor 1/5.
Slow convergence.
Computation of the hermitian dielectric matrix at the 8th step.
The inverse of the dielectric matrix is then used as preconditioning.
A factor of 20 is gained on each step. Largest eigenvalue value of the
dielectric matrix is 5.712 (a mixing factor of 1/3 would have
been enough, but 1/5 is faster). A second eigenvalue is close : 5.531 ." data-toggle="popover" href="/tests/v1/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized. ixc=0. 7 states for each spin.
First, converge using mixing factor, then evaluate RPA dielectric
matrix, and use it for convergence." data-toggle="popover" href="/tests/v1/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as case 53, but exchange-correlation included. The convergence
is not as good as in case 53, but still much better than simple mixing." data-toggle="popover" href="/tests/v1/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab : 5 layers of Mo + 3 layers of vacuum, ixc=0 .
Central layer is slightly displaced, to break the symmetry.
Metallic occupation numbers.
Only 20 bands, while at least 15 are needed.
Use iscf=2, start with default metallic preconditioner,
damped (diemix=0.5d0). A factor of 2 is gained
at each iteration. Then evaluate RPA matrix eigenvalues
using the extrapolation, and including the metallic correction.
Largest are 3.2541E+01  1.2089E+01  6.1305E+00 .
Then, uses the dielectric matrix preconditioning to converge.
No damping is needed.
A factor of about 10 is gained at each iteration on average." data-toggle="popover" href="/tests/v1/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Again Molybdenum slab, with ixc=1. 3 k-points.
20 bands. Use iprcel=45 for SCF cycle.
toldff=5.0d-5 is reached in only 8 cycles.
With iscf=5, it is reached in 10 cycles." data-toggle="popover" href="/tests/v1/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Same as test 57, but with mkmem=0." data-toggle="popover" href="/tests/v1/Input/t58.abi" target="_blank">t58.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as test 57, but with iprcel=55 (RPA dielectric matrix)" data-toggle="popover" href="/tests/v1/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as test 57, but with ixc=1, and iprcel=65 (electronic dielectric matrix)" data-toggle="popover" href="/tests/v1/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as test 57, but with ixc=7, and iprcel=65 (electronic dielectric matrix)" data-toggle="popover" href="/tests/v1/Input/t73.abi" target="_blank">t73.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivatives of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector, as well as to an homogeneous
electric field. The computed derivatives include the
mixed derivative wrt the two perturbations.
(see test.si.elfd of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=5
and non-linear XC core correction.
Computation of the second derivatives of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.si.core0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t08.abi" target="_blank">t08.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a></li>
</ul>
</details>
<p>Kinetic energy cutoff that controls the number of planewaves used to represent
the dielectric matrix:
<span><span class="MathJax_Preview">(1/2) [ 2 \pi \GG_{diel,max}]^2</span><script type="math/tex">(1/2) [ 2 \pi \GG_{diel,max}]^2</script></span> = <strong>diecut</strong>  with <span><span class="MathJax_Preview">\GG_{diel,max}</span><script type="math/tex">\GG_{diel,max}</script></span> being the maximum
length of the reciprocal space planewave wavevectors for the dielectric matrix.
Can be specified in Ha (the default), Ry, eV or Kelvin, since  <strong>diecut</strong>  has
the <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics. (1 Ha = 27.2113845 eV)
All planewaves inside this &ldquo;basis sphere&rdquo; centered at <span><span class="MathJax_Preview">\GG</span><script type="math/tex">\GG</script></span>=0 are included in the
basis. This is useful only when <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> &gt; =21, which means that a
preconditioning scheme based on the dielectric matrix is used.</p>
<p>NOTE: a negative  <strong>diecut</strong>  will define the same dielectric basis sphere as
the corresponding positive value, but the FFT grid will be identical to the
one used for the wavefunctions. The much smaller FFT grid, used when
 <strong>diecut</strong>  is positive, gives exactly the same results.</p>
<p>No meaning for RF calculations yet.</p>
<h2 id="diegap"><strong>diegap</strong><a class="headerlink" href="#diegap" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DIElectric matrix GAP<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al2 molecule, inversion point shifted from the origin, ixc=0,
kpt=1/4 1/4 1/4, nsym=4.
Large number of bands (20 instead of 3).
8 first SCF steps with simple mixing algorithm, mixing factor 1/5.
Slow convergence.
Computation of the hermitian dielectric matrix at the 8th step.
The inverse of the dielectric matrix is then used as preconditioning.
A factor of 20 is gained on each step. Largest eigenvalue value of the
dielectric matrix is 5.712 (a mixing factor of 1/3 would have
been enough, but 1/5 is faster). A second eigenvalue is close : 5.531 ." data-toggle="popover" href="/tests/v1/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized. ixc=0. 7 states for each spin.
First, converge using mixing factor, then evaluate RPA dielectric
matrix, and use it for convergence." data-toggle="popover" href="/tests/v1/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as case 53, but exchange-correlation included. The convergence
is not as good as in case 53, but still much better than simple mixing." data-toggle="popover" href="/tests/v1/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab : 5 layers of Mo + 3 layers of vacuum, ixc=0 .
Central layer is slightly displaced, to break the symmetry.
Metallic occupation numbers.
Only 20 bands, while at least 15 are needed.
Use iscf=2, start with default metallic preconditioner,
damped (diemix=0.5d0). A factor of 2 is gained
at each iteration. Then evaluate RPA matrix eigenvalues
using the extrapolation, and including the metallic correction.
Largest are 3.2541E+01  1.2089E+01  6.1305E+00 .
Then, uses the dielectric matrix preconditioning to converge.
No damping is needed.
A factor of about 10 is gained at each iteration on average." data-toggle="popover" href="/tests/v1/Input/t55.abi" target="_blank">t55.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivatives of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector, as well as to an homogeneous
electric field. The computed derivatives include the
mixed derivative wrt the two perturbations.
(see test.si.elfd of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=5
and non-linear XC core correction.
Computation of the second derivatives of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.si.core0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t08.abi" target="_blank">t08.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a></li>
</ul>
</details>
<p>Gives a rough estimation of the dielectric gap between the highest energy
level computed in the run, and the set of bands not represented. Used to
extrapolate dielectric matrix when <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> &gt;= 21.
Can be specified in Ha (the default), Ry, eV or Kelvin, since  <strong>diegap</strong>  has
the <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics (1 Ha = 27.2113845 eV).</p>
<p>No meaning for RF calculations yet.</p>
<h2 id="dielam"><strong>dielam</strong><a class="headerlink" href="#dielam" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DIElectric matrix LAMbda<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.5<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> &gt;= 21<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al2 molecule, inversion point shifted from the origin, ixc=0,
kpt=1/4 1/4 1/4, nsym=4.
Large number of bands (20 instead of 3).
8 first SCF steps with simple mixing algorithm, mixing factor 1/5.
Slow convergence.
Computation of the hermitian dielectric matrix at the 8th step.
The inverse of the dielectric matrix is then used as preconditioning.
A factor of 20 is gained on each step. Largest eigenvalue value of the
dielectric matrix is 5.712 (a mixing factor of 1/3 would have
been enough, but 1/5 is faster). A second eigenvalue is close : 5.531 ." data-toggle="popover" href="/tests/v1/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized. ixc=0. 7 states for each spin.
First, converge using mixing factor, then evaluate RPA dielectric
matrix, and use it for convergence." data-toggle="popover" href="/tests/v1/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as case 53, but exchange-correlation included. The convergence
is not as good as in case 53, but still much better than simple mixing." data-toggle="popover" href="/tests/v1/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab : 5 layers of Mo + 3 layers of vacuum, ixc=0 .
Central layer is slightly displaced, to break the symmetry.
Metallic occupation numbers.
Only 20 bands, while at least 15 are needed.
Use iscf=2, start with default metallic preconditioner,
damped (diemix=0.5d0). A factor of 2 is gained
at each iteration. Then evaluate RPA matrix eigenvalues
using the extrapolation, and including the metallic correction.
Largest are 3.2541E+01  1.2089E+01  6.1305E+00 .
Then, uses the dielectric matrix preconditioning to converge.
No damping is needed.
A factor of about 10 is gained at each iteration on average." data-toggle="popover" href="/tests/v1/Input/t55.abi" target="_blank">t55.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivatives of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector, as well as to an homogeneous
electric field. The computed derivatives include the
mixed derivative wrt the two perturbations.
(see test.si.elfd of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=5
and non-linear XC core correction.
Computation of the second derivatives of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.si.core0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t08.abi" target="_blank">t08.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a></li>
</ul>
</details>
<p>Gives the amount of occupied states with mean energy given by the highest
level computed in the run, included in the extrapolation of the dielectric matrix.</p>
<p>No meaning for RF calculations yet.</p>
<h2 id="dielng"><strong>dielng</strong><a class="headerlink" href="#dielng" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> model DIElectric screening LeNGth<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0774841<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [73/1245] in all abinit tests, [28/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-toggle="popover" href="/tests/libxc/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-toggle="popover" href="/tests/libxc/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation HSE with the GW code.
The Fock exchange mixing parameter is tunable." data-toggle="popover" href="/tests/libxc/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-toggle="popover" href="/tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-toggle="popover" href="/tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-toggle="popover" href="/tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : print the pwfn.data file,
for use in a subsequent run of the CASINO code." data-toggle="popover" href="/tests/seq/Input/tsv4_90.abi" target="_blank">tsv4_90.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparatory steps for computing phonon-limited mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_1.abi" target="_blank">teph4mob_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Generation of WFK files on dense k-meshes to prepare mobility calculations" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_4.abi" target="_blank">teph4mob_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline AlAs : computation of the total energy" data-toggle="popover" href="/tests/tutorespfn/Input/trf1_1.abi" target="_blank">trf1_1.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ytterbium, fcc structure, one atom per primitive cell,
similar to test #4 of built-in, except that nstep=1, and
the pseudopotential differs :
format 5, translated from PseudosTM_pwteter/70yb.pspnc (format 1).
The translation slightly changes the result, at the level of 2 microHa." data-toggle="popover" href="/tests/v1/Input/t38.abi" target="_blank">t38.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Yb (1 atom per unit cell),
using a l=3 psp with s local part.
Crazy cut-off and number of k points.
Shows that the derivative of the eigenenergies
with respect to the wavevector can be obtained
both by finite differences and analytical means
(from a preliminary computation in the
treatment of the ddk perturbation).
For the (0.25,0.25,0.25) k point,
the tenth band eigenvalue is -3.01209 eV.
Going to the (0.251,0.251,0.251) k point
it becomes -3.00562 eV, with finite-difference
estimation of the derivative with respect
to ONE wavevector change (all three
components changed) being 0.00647 eV/0.001/3=2.157 eV
This value is unchanged when using the
data at the (0.253,0.253,0.253) k point.
The analytical value is 2.15566 eV." data-toggle="popover" href="/tests/v3/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="No description available" data-toggle="popover" href="/tests/v3/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl FCC crystal, with low cut-off, and 32 k points.
Prepare the Hirshfeld density analysis." data-toggle="popover" href="/tests/v3/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a DDB file generating run which prepares for the calculation #70.
The material is Crystalline AlAs (face-center cubic), with ecut=3 Hartree.
Response function calculations are with respect to electric field, strain,
and displacement." data-toggle="popover" href="/tests/v4/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms)." data-toggle="popover" href="/tests/v4/Input/t97.abi" target="_blank">t97.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon to test the CP2K pseudopotential implementation with
the new pseudo type: pspcod 10 (same formalism as HGH pseudopotentials, pspcod 3).
Same input file as t35.in of tests/tutorial, the only difference is that
in the test the used pseudo is taken from the CP2K library.
(http://cvs.berlios.de/cgi-bin/viewcvs.cgi/cp2k/potentials/Goedecker/abinit/)
The bandstructure is in agreement with that calculated in the tutorial
example with the pspcod=1 pseudopotential." data-toggle="popover" href="/tests/v5/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Computation of the non-self-consistent kinetic energy at fixed density." data-toggle="popover" href="/tests/v5/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
One-shot GW calculations within the PAW formalism" data-toggle="popover" href="/tests/v5/Input/t66.abi" target="_blank">t66.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
HI 8 molecule per cell, the cell is triclinic (has to change tolsym as default is too permissive)
Prepare the density for the next Bader analysis." data-toggle="popover" href="/tests/v6/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon. Diamond structure.
Quick test of the use of datasets with a numbering beyond 1000 (the last one is 1022).
(Tests 35-40 are for response-function)" data-toggle="popover" href="/tests/v6/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 Molecule in a small box
Second-order eigenvalue calculation using a small number of bands, testing bdeigrf." data-toggle="popover" href="/tests/v6/Input/t61.abi" target="_blank">t61.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the WFK, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-toggle="popover" href="/tests/v67mbpt/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
RPA correlation energy calculation in Si:
using exact or numerical integration over the coupling constant, using extrapolar trick or not,
using the full or long-range only Coulomb interaction" data-toggle="popover" href="/tests/v67mbpt/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: G0W0 @ scPBE0-1/3 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scPBE0 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scPBE0-1/3 level, the Kohn-Sham basis delivers 8.101 eV,
while the plane wave basis delivers 8.122 eV.
At the G0W0-scPBE0-1/3 level, the Kohn-Sham basis delivers 7.638 eV,
while the plane wave basis delivers 7.659 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
4.4126 from scPBE0-1/3(KS) and 4.4105 from scPBE0-1/3(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
In this case, one used the PBE0 functional (ixc_sigma=41 or ixc_sigma=-406,
of even isc_sigma=42 with hyb_mixing=0.25 - all the cases were checked).
At the PBE level, the (KS) band gap was 5.661 eV,
At the scPBE0 level, the Kohn-Sham basis delivered 7.882 eV,
while the plane wave basis delivered 7.884 eV.
At the G0W0-scPBE0 level, the Kohn-Sham basis delivered 7.820 eV,
while the plane wave basis delivered 7.827 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
4.483 from scPBE0(KS) and 4.490 from scPBE0(planewaves)." data-toggle="popover" href="/tests/v7/Input/t68.abi" target="_blank">t68.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom." data-toggle="popover" href="/tests/v8/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom along one direction." data-toggle="popover" href="/tests/v8/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-toggle="popover" href="/tests/v9/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as t33.out but reading some checkpoint (i.e. 1, 2, and 5) files" data-toggle="popover" href="/tests/v9/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW 1RDM update BUT using only Sigma_X (not including Sigma_c term)." data-toggle="popover" href="/tests/v9/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
</ul>
</details>
<p>Used for screening length (in Bohr) of the model dielectric function, diagonal
in reciprocal space. By default, given in Bohr atomic units (1
Bohr=0.5291772108 Angstrom), although Angstrom can be specified, if preferred,
since  <strong>dielng</strong>  has the <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a> characteristics.
This model dielectric function is as follows (<span><span class="MathJax_Preview">{\bf K}</span><script type="math/tex">{\bf K}</script></span> being a wavevector):</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\epsilon({\bf K}) = \frac{ 1 +  **dielng** ^2 {\bf K}^2 }{ \left( 1/[[diemac]] +  **dielng** ^2 {\bf K}^2  \right) [[diemix]] } \nonumber
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\epsilon({\bf K}) = \frac{ 1 +  **dielng** ^2 {\bf K}^2 }{ \left( 1/[[diemac]] +  **dielng** ^2 {\bf K}^2  \right) [[diemix]] } \nonumber
\end{equation}</script>
</div>
<p>The inverse of this model dielectric function will be applied to the residual,
to give the preconditioned change of potential. Right at <span><span class="MathJax_Preview">{\bf K}</span><script type="math/tex">{\bf K}</script></span>=0, <span><span class="MathJax_Preview">\epsilon({\bf K})</span><script type="math/tex">\epsilon({\bf K})</script></span> is imposed to be 1.</p>
<p>If the preconditioning were perfect, the change of potential would lead to an
exceedingly fast solution of the self-consistency problem (two or three
steps). The present model dielectric function is excellent for rather
homogeneous unit cells.
When <span><span class="MathJax_Preview">{\bf K}</span><script type="math/tex">{\bf K}</script></span>-&gt;0, it tends to the macroscopic dielectric constant, eventually
divided by the mixing factor <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> (or <a class="wikilink codevar-wikilink" href="/variables/gstate#diemixmag">diemixmag</a>  for magnetization).
For metals, simply put <a class="wikilink codevar-wikilink" href="/variables/gstate#diemac">diemac</a> to a very large value (<span><span class="MathJax_Preview">10^6</span><script type="math/tex">10^6</script></span> is OK)
The screening length  <strong>dielng</strong>  governs the length scale to go from the
macroscopic regime to the microscopic regime, where it is known that the
dielectric function should tend to 1. It is on the order of 1 Bohr for metals
with medium density of states at the Fermi level, like Molybdenum, and for
Silicon. For metals with a larger DOS at the Fermi level (like Iron), the
screening will be more effective, so that  <strong>dielng</strong>  has to be decreased by a factor of 2-4.
This works for GS and RF calculations.</p>
<h2 id="diemac"><strong>diemac</strong><a class="headerlink" href="#diemac" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> model DIElectric MACroscopic constant<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1000000.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [578/1245] in all abinit tests, [58/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for real space computation (using a wavelet based poisson solver),
no forces, just an H atom in an empty box. The cut-off is unrealistic. This
test tests the following part of the code :
* psp spline generation for real space ;
* local part of potential from pseudo ;
* ion-ion interaction computation (instead of Ewald) ;
* Hartree potential with Poisson&#x27;s solver." data-toggle="popover" href="/tests/bigdft/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H in isolated boundary conditions (plane waves, NC).
Similar to t20.in but check that non cubic boxs can be used with equivalent x, y and z directions." data-toggle="popover" href="/tests/bigdft/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
KSS file generation for silicon with a different number of bands in the KSS
computation compared to ground-state." data-toggle="popover" href="/tests/etsf_io/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in a box..
Test of prtvol = -2, so stop after init, and echo in a NETCDF file." data-toggle="popover" href="/tests/etsf_io/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LOBPCG, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure" data-toggle="popover" href="/tests/psml/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure" data-toggle="popover" href="/tests/psml/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-toggle="popover" href="/tests/tutoparal/Input/tmbt_1.abi" target="_blank">tmbt_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test at the fixed, symmetric geometry, for reference. Of course, the cell is not primitive.

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_01.abi" target="_blank">tpsic_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test at a set of decreasing I-I interatomic distances

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_02.abi" target="_blank">tpsic_02.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated like a metal (there is a degeneracy at the Fermi level),
occopt=4 and tsmear=0.04 , with nsppol=2 .
Use spinat to polarize the molecule at start.
Gives total energy of -32.09317 Hartree
This test can be used to check the accuracy of stresses in the
spin-polarized case. Setting acell(1:2) to 7.005 and 6.995
gives ETOT -32.090846193972 and -32.095501753750,
ucvol  441.63023 and 440.37023
so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03,
to be compared with sigma(1)=3.6949713786E-03
and sigma(2)=3.6949681083E-03 from the present test
(the degeneracy is slightly lifted because of incomplete convergence,
using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both
sigma values)." data-toggle="popover" href="/tests/v1/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated as a spin-polarized molecule, with fixed occupation
numbers (occopt=2), with nsppol=2 . Gives total energy of -32.09792 Hartree" data-toggle="popover" href="/tests/v1/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom (see below). Treated without any XC energy (ixc=0).
The total energy is -1.9442 Ha.
10.-20. Isolated Helium atom tests.
These tests exercise different xc functionals, in the spin-unpolarized case.
The helium atom is isolated in a box of size 5x5x5, with one
special point (1/4 1/4 1/4), 200 Ha cut-off, used with
a potential close to the bare He potential
(erfc with 0.001 bohr decay length). Errors due to the smallness
of the supercell size are on the order of 1 mHa, as well as those
due to the representation of the Coulomb potential by a erfc function.
The remaining is due to finiteness of the basis set.
The estimation of the latter errors is presented in the test_cases
17 and 18. In all these tests, intxc=0." data-toggle="popover" href="/tests/v1/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2, and preceeding test,
but use the full XC PBE functional.
Also, tolvrs is better.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.81162533 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.81213804 Ha
with delta(xred)=0.0001, 188.81175352 Ha .
Combining the results gives 188.81162525 Ha." data-toggle="popover" href="/tests/v3/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen dimer in a big cell.
Produce different files (_DEN, _POT, _VHXC, _VHA), for subsequent analysis by CUT3D (see next run).
Note the following values, that will allow to check the correctness of the subsequent analysis :
Kinetic energy  =  1.02998395409183E+00
Hartree energy  =  8.05073794254872E-01
Loc. psp. energy= -2.53949740885919E+00
Band energy (Ha)=  -7.2732761066E-01
Also, the mean of the Vxc potential is announced to be
Average Vxc (hartree)=  -0.05293" data-toggle="popover" href="/tests/v6/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom.
Treated with GGA C09x exchange functional (ixc=24).
The total energy is -0.429523 Ha.
Also additional tests concerning the kinetic energy density calculation,
the gradient of electronic density calculation and
the Laplacian of electronic density calculation are performed.
Test taken from v1/t21.in." data-toggle="popover" href="/tests/v6/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the WFK, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-toggle="popover" href="/tests/v67mbpt/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-toggle="popover" href="/tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test generation of k-point mesh with kptrlatt and shiftk.
version 8.0.8b was stopping at the level of the parser." data-toggle="popover" href="/tests/v8/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (spin-polarized, non-linear XC core correction, LDA)
Fixed occupation numbers. The parameters have been artifically tuned
with the goal to find a small system that reproduces the typical 1D-configuration coordinate diagram,
with a first total energy curve that shows a minimum, a second (different occupations) total energy curve
that shows a slightly higher minimum, at a slightly larger interatomic distance, and then the two total energy curves
cross at an even slightly larger interatomic distance.
This system will be used as a test bed for the next tests" data-toggle="popover" href="/tests/v8/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (spin-polarized, non-linear XC core correction, LDA)
Test the input variable imgwfstor.
In itimimage=2, the SCF cycle and the Broyden optimization are indeed immediately fulfilled." data-toggle="popover" href="/tests/v8/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 06 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 08 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. PAW. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 10 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>A rough knowledge of the macroscopic dielectric constant  <strong>diemac</strong>  of the
system is a useful help to speed-up the SCF procedure: a model dielectric
function, see the keyword <a class="wikilink codevar-wikilink" href="/variables/gstate#dielng">dielng</a>, is used for that purpose. It is
especially useful for speeding up the treatment of rather homogeneous unit cells.</p>
<p>Some hint:
The value of  <strong>diemac</strong>  should usually be bigger than 1.0, on physical grounds.</p>
<ul>
<li>For metals, simply put  <strong>diemac</strong>  to a very large value (the default <span><span class="MathJax_Preview">10^6</span><script type="math/tex">10^6</script></span> is OK)</li>
<li>For silicon, use 12.0. A similar value is likely to work well for other semiconductors</li>
<li>For wider gap insulators, use 2.0 &hellip; 4.0</li>
<li>For molecules in an otherwise empty big box, try 1.5 &hellip; 3.0</li>
</ul>
<p>Systems that combine a highly polarisable part and some vacuum are rather
badly treated by the model dielectric function. One has to use the
&ldquo;extrapolar&rdquo; technique, activated by the input variable <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a>.
In sufficiently homogeneous systems, you might have to experiment a bit to
find the best  <strong>diemac</strong> . If you let  <strong>diemac</strong>  to its default value, you
might even never obtain the self-consistent convergence!
For response function calculations, use the same values as for GS. The
improvement in speed can be considerable for small (but non-zero) values of the wavevector.</p>
<h2 id="diemix"><strong>diemix</strong><a class="headerlink" href="#diemix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> model DIElectric MIXing factor<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0 if <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 0 or <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> !=0,
0.7 if <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 or <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> == 0,
None otherwise.</p>
<p><em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> &gt;= 0.0 and <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> &lt;=  1.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [236/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for real space computation (using a wavelet based poisson solver),
no forces, just an H atom in an empty box. The cut-off is unrealistic. This
test tests the following part of the code :
* psp spline generation for real space ;
* local part of potential from pseudo ;
* ion-ion interaction computation (instead of Ewald) ;
* Hartree potential with Poisson&#x27;s solver." data-toggle="popover" href="/tests/bigdft/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in a box..
Test of prtvol = -2, so stop after init, and echo in a NETCDF file." data-toggle="popover" href="/tests/etsf_io/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule NON-spin-polarized, in a big box, without tetragonal symmetry, in order to avoid
spurious degeneracy effects coupled to occupation numbers rapidly changing.
GPU
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization." data-toggle="popover" href="/tests/gpu_omp/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 system.
Excited state computation, using LDA/TDLDA" data-toggle="popover" href="/tests/tutorial/Input/ttddft_1.abi" target="_blank">ttddft_1.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated like a metal (there is a degeneracy at the Fermi level),
occopt=4 and tsmear=0.04 , with nsppol=2 .
Use spinat to polarize the molecule at start.
Gives total energy of -32.09317 Hartree
This test can be used to check the accuracy of stresses in the
spin-polarized case. Setting acell(1:2) to 7.005 and 6.995
gives ETOT -32.090846193972 and -32.095501753750,
ucvol  441.63023 and 440.37023
so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03,
to be compared with sigma(1)=3.6949713786E-03
and sigma(2)=3.6949681083E-03 from the present test
(the degeneracy is slightly lifted because of incomplete convergence,
using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both
sigma values)." data-toggle="popover" href="/tests/v1/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated as a spin-polarized molecule, with fixed occupation
numbers (occopt=2), with nsppol=2 . Gives total energy of -32.09792 Hartree" data-toggle="popover" href="/tests/v1/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom (see below). Treated without any XC energy (ixc=0).
The total energy is -1.9442 Ha.
10.-20. Isolated Helium atom tests.
These tests exercise different xc functionals, in the spin-unpolarized case.
The helium atom is isolated in a box of size 5x5x5, with one
special point (1/4 1/4 1/4), 200 Ha cut-off, used with
a potential close to the bare He potential
(erfc with 0.001 bohr decay length). Errors due to the smallness
of the supercell size are on the order of 1 mHa, as well as those
due to the representation of the Coulomb potential by a erfc function.
The remaining is due to finiteness of the basis set.
The estimation of the latter errors is presented in the test_cases
17 and 18. In all these tests, intxc=0." data-toggle="popover" href="/tests/v1/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
(see test.si.chain of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2, and preceeding test,
but use the full XC PBE functional.
Also, tolvrs is better.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.81162533 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.81213804 Ha
with delta(xred)=0.0001, 188.81175352 Ha .
Combining the results gives 188.81162525 Ha." data-toggle="popover" href="/tests/v3/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to mesure the convergence of
the total energy versus the variable &#x27;ecut&#x27;.
6 datasets are performed with ecut varying from 8 Ha to 18 Ha
Cut-off for the fine grid (used to transfer data from spherical
meshes to FFt meshes) remain constant." data-toggle="popover" href="/tests/v4/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in arbitrary structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to test the differents mixing scheme in PAW formalism.
Different values of iscf, pawmixdg and pawoptmix are choosen.
Features tested:
- mixing on density or potential (mod(iscf,10))
- different mixing schemes (iscf)
- inclusion of spherical part in residual (pawoptmix)
- mixing on coarse or fine grid (pawmixdg)
- mixing factor for spherical part (pawsphmix)
All mixing schemes give the same total energy." data-toggle="popover" href="/tests/v4/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
One He atom in a big simple cubic box
Compute the DOS using the tetrahedron method.
Also compute the partial DOS.
There is a quite surprising feature of this very simple DOS,
that might seem to be due to a bug, but is NOT one.
Indeed, the obtained DOS is not continuous (vizualize the result
of DATASET 2):  at two energies, there is a small, but sizeable
jump. This feature is associated with a rather sparse sampling
of the Brillouin zone. Indeed, some of the tetrahedra have
three corners with perfectly identical energies. Such
a set of corners belong to two different tetrahedra.
If there is not an equal slope of energy when moving away from
each sides of the triangles, in the different tetrahedra,
the DOS is discontinuous at the energy of the three shared corners.
(explanation found by M. Verstraete)" data-toggle="popover" href="/tests/v4/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni atom in a big box.
Test the use of the atvshift variable :
change the potential of the d orbitals." data-toggle="popover" href="/tests/v5/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni molecule in a big box.
Test the use of the atvshift variable
First dataset : no shift, the ten states number 9 to 18
come from the 3d atomic states, the state number 19 is a bonding 4s state.
States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1).
State number 18 is a 3d sigma antibonding state (m=0).
Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the
levels change by less than 0.0002 (and their energy decrease), except state number
9 (a 3d sigma bonding state (m=0)), that goes from -0.24020 to -0.23982 (+0.0004)
and state number 18, that goes from -0.15439 to 0.15399 (+0.0004).
Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials.
All the levels are affected (likely the m=1 and -1 orbitals adjust, and cause modification
of the potential), but the states 10, 11, 16, and 17 increase their energy, while the
other state see their energy decrease.
Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking
of the degeneracy.
This test was not easy to make portable. The problem lies in the fact that when the density
becomes negative, due to Bragg oscillations, the xc kernel can be extremely large, and when
use for the prediction of the residual of the forces, the differences between machines
can be extremely large. IN order to see this effect, put ecut 7 and npulayit 7 (its default value)." data-toggle="popover" href="/tests/v5/Input/t15.abi" target="_blank">t15.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom.
Treated with GGA C09x exchange functional (ixc=24).
The total energy is -0.429523 Ha.
Also additional tests concerning the kinetic energy density calculation,
the gradient of electronic density calculation and
the Laplacian of electronic density calculation are performed.
Test taken from v1/t21.in." data-toggle="popover" href="/tests/v6/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom.
Treated with GGA C09x exchange functional (ixc=24).
The total energy is -2.7881 Ha.
Test taken from v1/t10.in." data-toggle="popover" href="/tests/v6/Input/t13.abi" target="_blank">t13.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Boron, 32 atoms - Thomas-Fermi method (without orbitals)
Test the temperature-dependent XC functional (ixc=50)
(Ichimaru et al Phys. Rep. 149, 91-205 (1987)
Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-toggle="popover" href="/tests/v7/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom." data-toggle="popover" href="/tests/v8/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom along one direction." data-toggle="popover" href="/tests/v8/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiH molecule
test the use of spatial chemical potential. The molecule starts aligned along the x direction,
while the Li chemical potential pulls the Li nucleus.
The z coordinate of the molecule is changed from 0 to 5 Bohr.
There is a linear part to the chemical potential.
The energy and force should be the same in datasets 11 to 15 (without chemical potentiel).
One sees that this is not completely the case.
The force along z vanishes in these cases, because the translational invariance is imposed by ABINIT.
In datasets 21 to 23, the energy should increase linearly, and the force along z should be non-zero and constant.
Small fluctuations are observed.
Dataset 24 and 25 corresponds to the cubic part of the chemical potential.
Dataset 26 places the molecule at a symmetric value of z. The total energy should be the same as with dataset 11, 16, or 21." data-toggle="popover" href="/tests/v8/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different versions of PAW+U formalism are tested.
Negative values of usepawu should give exactly the same results as with positive values.
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v9/Input/t79.abi" target="_blank">t79.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Copper atom isolated in a box, mGGA Norm conserving
Tests the reading of the upf2 potential, and inputs related to the model core kinetic energy density, then their usage.
nc_xccc_gspace 0 calculates model core contribution in real space, and is much cleaner (0 kinE and density outside NLCC radius)
Density (+kinE) mixing works much better than potential mixing: in the vacuum the mGGA potential is very sensitive" data-toggle="popover" href="/tests/v9/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for the printing of the local orbital magnetic moment
of NiO (fcc supercell with 2 Ni and 2 O atoms).
Cut-off and k-points are unrealistic.
Works only in the case of PAW and DFT+U" data-toggle="popover" href="/tests/v9/Input/t112.abi" target="_blank">t112.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives overall factor of the preconditioned residual density/potential to be
transferred in the SCF cycle.
It should be between 0.0 and 1.0.</p>
<p>If the model dielectric function were perfect,  <strong>diemix</strong>  should be 1.0. By
contrast, if the model dielectric function does nothing (when <a class="wikilink codevar-wikilink" href="/variables/gstate#diemac">diemac</a> = 1.0
or <a class="wikilink codevar-wikilink" href="/variables/gstate#dielng">dielng</a> is larger than the size of the cell),  <strong>diemix</strong>  can be used to
damp the amplifying factor inherent to the SCF loop.
For molecules, a value on the order 0.5 or 0.33 is rather usual.
When mod(<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>,10)=3, 4,5 or 7,  <strong>diemix</strong>  is only important at the few
first iterations when anharmonic effects are important, since these schemes
compute their own mixing factor for self-consistency.
Also note that a different value of diemix can be used for the magnetization (see <a class="wikilink codevar-wikilink" href="/variables/gstate#diemixmag">diemixmag</a>).</p>
<h2 id="diemixmag"><strong>diemixmag</strong><a class="headerlink" href="#diemixmag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> model DIElectric MIXing factor for the MAGgnetization<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a spin-polarized calculation" data-toggle="popover" href="/topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> if 70 &lt; <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> &lt; 80,
<a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> if <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> == 0,
<a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> if <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&lt;10,
-<a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [15/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a></li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized. ixc=0. 7 states for each spin.
First, converge using mixing factor, then evaluate RPA dielectric
matrix, and use it for convergence." data-toggle="popover" href="/tests/v1/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as case 53, but exchange-correlation included. The convergence
is not as good as in case 53, but still much better than simple mixing." data-toggle="popover" href="/tests/v1/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, ground state WF" data-toggle="popover" href="/tests/v8/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=2" data-toggle="popover" href="/tests/v8/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=3" data-toggle="popover" href="/tests/v8/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, electric field perturbation with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, electric field perturbation with ixcrot=2" data-toggle="popover" href="/tests/v8/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, electric field perturbation with ixcrot=3" data-toggle="popover" href="/tests/v8/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, atomic perturbation with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, atomic perturbation with ixcrot=2" data-toggle="popover" href="/tests/v8/Input/t79.abi" target="_blank">t79.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, atomic perturbation with ixcrot=3" data-toggle="popover" href="/tests/v8/Input/t80.abi" target="_blank">t80.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test for the printing of the local orbital magnetic moment
of NiO (fcc supercell with 2 Ni and 2 O atoms).
Cut-off and k-points are unrealistic.
Works only in the case of PAW and DFT+U" data-toggle="popover" href="/tests/v9/Input/t112.abi" target="_blank">t112.abi</a></li>
</ul>
</details>
<p>Gives overall factor of the preconditioned residual magnetization/magnetic
field to be transferred in the SCF cycle (see <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> for further
information).
For the time being, apply only when the SCF mixing is done on the density (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt; =10).</p>
<p>A negative value of  <strong>diemixmag</strong>  means that magnetization is only preconditioned
by ABS( <strong>diemixmag</strong> ), without the use of any preconditioner.</p>
<p>When SCF cycle has some difficulties to converge, changing the value of
 <strong>diemixmag</strong>  can have a positive effect.
In particular  <strong>diemixmag</strong>  = -4 is a good choice (i.e.  <strong>diemixmag</strong>  = 4, no other
preconditioner on magnetization).</p>
<h2 id="dosdeltae"><strong>dosdeltae</strong><a class="headerlink" href="#dosdeltae" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DOS DELTA in Energy<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic DOS and related topics" data-toggle="popover" href="/topics/ElecDOS">topic_ElecDOS</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
2 Silicon atoms, in a diamond structure.
Test the computation of the DOS, using the linear tetrahedron method." data-toggle="popover" href="/tests/v3/Input/t46.abi" target="_blank">t46.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a></li>
</ul>
</details>
<p>Defines the linear grid resolution (energy increment) to be used for the
computation of the Density-Of-States, when <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> is non-zero.
If  <strong>dosdeltae</strong>  is set to zero (the default value), the actual increment is
0.001 Ha if <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> = 1 or 4 (smearing technique), and the much smaller value 0.00005 Ha if
<a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> = 2, 3 or 5 (tetrahedron technique). This different default value arises because the
smearing technique gives a quite smooth DOS, while the DOS
from the tetrahedron method is rapidly varying.</p>
<h2 id="enunit"><strong>enunit</strong><a class="headerlink" href="#enunit" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ENergy UNITs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the output of computed quantities" data-toggle="popover" href="/topics/Output">topic_Output</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [259/1245] in all abinit tests, [14/159] in abinit tutorials</summary><ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as 03 but run with newer Troullier-Martins psp
with core density PseudosTM_pwteter/14si.pspnc.  Start from wf.03 and run irdwfk=1.
Also iterated to convergence." data-toggle="popover" href="/tests/fast/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LOBPCG, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock with time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock without time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Oxygen atom
Test a few functionals for which HGH pseudopotentials are available (from M. Krack),
that are present also in the lib XC, but not in the native ABINIT set of functionals." data-toggle="popover" href="/tests/libxc/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Argon solid, experimental lattice parameter.
Realistic parameters are used (ecut=20, ngkpt=2x2x2 shifted 4 times, but centered on Gamma).
Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
The LDA gap is observed at Gamma : 8.071 eV, is in reasonable agreement with the gap from the TB paper PRL 102, 226401 (2009),
where it is mentioned to be 8.16 eV.
The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV.
The reading of the kinetic energy density, to start a non-SCF calculation is not yet implemented,
as of ABINITv6.12.0 .
This test was used to examine the speed of the convergence in case of elongated cells, up to 16 atoms.
The mGGA convergence was found to be similar to the LDA convergence.
Also, test non-self-consistent mGGA calculation, with reading of the previously produced _DEN and _KDEN files." data-toggle="popover" href="/tests/libxc/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Testing TB09 XC functional within PAW approach.
Cristalline silicon
Also testing the following variables:
- xc_taupos : filtering of the kinetic energy density
- getkden   : read KE density from previous dataset
- irdkden   : read KE density from an external file" data-toggle="popover" href="/tests/libxc/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test Wannier90 interface with NC pseudopotentials" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_4.abi" target="_blank">tw90_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_6.abi" target="_blank">tw90_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Z2Pack (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tz2_2.abi" target="_blank">tz2_2.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon

Computation of the band structure.
First, a SCF density computation, then a non-SCF band structure calculation." data-toggle="popover" href="/tests/tutorial/Input/tbase3_5.abi" target="_blank">tbase3_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum
Create the WFK file for the GW calculation." data-toggle="popover" href="/tests/tutorial/Input/tgw2_1.abi" target="_blank">tgw2_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum:
create the screening file" data-toggle="popover" href="/tests/tutorial/Input/tgw2_2.abi" target="_blank">tgw2_2.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
Compares with frozen-phonon calculations. Examine two cases:
varying occupation numbers, and fixed occupation numbers.
A. Varying occupation numbers (occopt=4):
RF calculation in dataset 5 gives
2DE equal to -3.812577 Ha, while finite difference of &quot;TOTAL&quot;
energy (datasets 6 and 7, including entropy term) gives -3.812230 Ha
(the agreement could be better with better finite difference)
B. Fixed occupation numbers (occopt=2):
RF calculation in dataset 8 gives
2DE equal to +5.431807 Ha, while finite difference of total
energy (no entropy term is present with occopt=2) gives +5.431857 Ha
(the agreement could be better with better finite difference)" data-toggle="popover" href="/tests/v2/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Helium q close to Gamma, along Gamma-H
There is a problem with kptopt=1 or 3 for the NSC step." data-toggle="popover" href="/tests/v2/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 28. The chosen grid (too coarse, though) is
(0 0 0), (1/4 1/4 0), (1/2 1/2 0), (1/2 0 0),
(1/2 1/4 1/4), (1/2 -1/4 1/4)  (in reduced coordinates).
The ecut and nkpt parameters are really too low (see test 28),
but parameters suitable for physical results (see test 29)
are also provided in the input files." data-toggle="popover" href="/tests/v2/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Yb (1 atom per unit cell),
using a l=3 psp with s local part.
Crazy cut-off and number of k points.
Shows that the derivative of the eigenenergies
with respect to the wavevector can be obtained
both by finite differences and analytical means
(from a preliminary computation in the
treatment of the ddk perturbation).
For the (0.25,0.25,0.25) k point,
the tenth band eigenvalue is -3.01209 eV.
Going to the (0.251,0.251,0.251) k point
it becomes -3.00562 eV, with finite-difference
estimation of the derivative with respect
to ONE wavevector change (all three
components changed) being 0.00647 eV/0.001/3=2.157 eV
This value is unchanged when using the
data at the (0.253,0.253,0.253) k point.
The analytical value is 2.15566 eV." data-toggle="popover" href="/tests/v3/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
Compares with frozen-phonon calculations.
Similar to test v2 #11, except use of PBE GGA.
Examine two cases:
varying occupation numbers, and fixed occupation numbers.
A. Varying occupation numbers (occopt=4):
RF calculation in dataset 5 gives
2DE equal to -4.053115 Ha, while finite difference of &quot;TOTAL&quot;
energy (datasets 6 and 7, including entropy term) gives -4.0475002 Ha.
This is fair, BUT it does not improve with a better
finite-difference, so there is a problem.
B. Fixed occupation numbers (occopt=2):
RF calculation in dataset 8 gives
2DE equal to +5.394365 Ha, while finite difference of total
energy (no entropy term is present with occopt=2) gives +5.3998556 Ha
This is fair, BUT it does not improve with a better
finite-difference, so there is a problem.
Then, in dataset 11, compute phonon frequencies at Gamma
of the doubled cell. The 2DTE is 10.7997781 Ha, which
corresponds to 5.3998890 Ha, so in much better agreement
with the frozen-phonon calculation.
TO BE UNDERSTOOD ..." data-toggle="popover" href="/tests/v3/Input/t18.abi" target="_blank">t18.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen dimer in a big cell.
Produce different files (_DEN, _POT, _VHXC, _VHA), for subsequent analysis by CUT3D (see next run).
Note the following values, that will allow to check the correctness of the subsequent analysis :
Kinetic energy  =  1.02998395409183E+00
Hartree energy  =  8.05073794254872E-01
Loc. psp. energy= -2.53949740885919E+00
Band energy (Ha)=  -7.2732761066E-01
Also, the mean of the Vxc potential is announced to be
Average Vxc (hartree)=  -0.05293" data-toggle="popover" href="/tests/v6/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon. Diamond structure.
Quick test of the use of datasets with a numbering beyond 1000 (the last one is 1022).
(Tests 35-40 are for response-function)" data-toggle="popover" href="/tests/v6/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
Warning : only valid for Gamma, AND the temperature-dependent shifts must be averaged
over degenerate states." data-toggle="popover" href="/tests/v6/Input/t37.abi" target="_blank">t37.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the WFK, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-toggle="popover" href="/tests/v67mbpt/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the extension of the pspcod=8 input format to include
spin-orbit coupling with multiple non-local projectors.  The
band structure of fcc Pt is computed at Gamma, X, and L.
The pseudopotential used in the test is generated by the open-source
ONCVPSP code, which is available at www.mat-simresearch.com, and
described in D. R. Hamann, Phys. Rev. B 88, 085177 (2013).
The relativistic extension is documented in the code package.
The Pt 5s and 5p semi-cores are treated as valence, and the band
structure is well-converged at the ecut used in the test (20 Ha).
A complete description of the input format is avaiable in
doc/psp_infos/psp8_info.txt." data-toggle="popover" href="/tests/v7/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Random stopping power within RPA and TD-LDA" data-toggle="popover" href="/tests/v7/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiH rocksalt structure with a negative lithium vacancy
test thee potential alignement usepotzero=0,1" data-toggle="popover" href="/tests/v7/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with FIRE (ionmov 15)" data-toggle="popover" href="/tests/v8/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t101)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 101.
It tests the following parts of the code:
optic_paw, optic_paw_core, optic_paw_soc
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t100.abi" target="_blank">t100.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t102)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 103.
It tests the following parts of the code:
optic_paw_core
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t102.abi" target="_blank">t102.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-toggle="popover" href="/tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>Governs the units to be used for output of eigenvalues (and if any, phonon frequencies)</p>
<ul>
<li>0  &rarr; print eigenvalues in hartree;</li>
<li>1  &rarr; print eigenvalues in eV;</li>
<li>2  &rarr; print eigenvalues in both hartree and eV.</li>
</ul>
<p>If phonon frequencies are to be computed:</p>
<ul>
<li>0  &rarr;  phonon frequencies in Hartree and cm-1;</li>
<li>1  &rarr;  phonon frequencies in eV and THz;</li>
<li>2  &rarr;  phonon frequencies in hartree, eV, cm-1, Thz and Kelvin.</li>
</ul>
<h2 id="expert_user"><strong>expert_user</strong><a class="headerlink" href="#expert_user" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EXPERTise of the USER<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the unit cell" data-toggle="popover" href="/topics/UnitCell">topic_UnitCell</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to use the symetry information to build the system from the irreducible part of the primitive cell" data-toggle="popover" href="/topics/SmartSymm">topic_SmartSymm</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a geometry optimization" data-toggle="popover" href="/topics/GeoOpt">topic_GeoOpt</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.2.2  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
InN non-primitive cell, doubled wurtzite, rather inaccurate rprimd and xred.
Test disabling all checks and fixes of atomic positions or cell parameters. Otherwise, similar to v9#17" data-toggle="popover" href="/tests/v9/Input/t19.abi" target="_blank">t19.abi</a></li>
</ul>
</details>
<p>If set to 0, the checking provided by ABINIT is maximum (default values of <a class="wikilink codevar-wikilink" href="/variables/gstate#chkprim">chkprim</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#chksymbreak">chksymbreak</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#chksymtnons">chksymtnons</a>, <a class="wikilink codevar-wikilink" href="/variables/rlx#chkdilatmx">chkdilatmx</a>,
<a class="wikilink codevar-wikilink" href="/variables/gstate#chkparal">chkparal</a>).
If non-zero (up to three), the above-mentioned checking input variables are all disabled (set to zero)
although it is still possible to activate particular tests by specifying input variables directly in the input file.
In the future, the level three will always be the maximum allowed value, with all checks set to zero,
while a more refined behaviour might be implemented for  <strong>expert_user</strong> ==1 or 2).</p>
<h2 id="extfpmd_nband"><strong>extfpmd_nband</strong><a class="headerlink" href="#extfpmd_nband" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EXTended FPMD: Number of Bands<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to enable the Extended FPMD method for high temperature simulations" data-toggle="popover" href="/topics/ExtFPMD">topic_ExtFPMD</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 10.1.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Check Extended FPMD routines with low number of bands for
Aluminum FCC lattice at high temperature." data-toggle="popover" href="/tests/v9/Input/t92.abi" target="_blank">t92.abi</a></li>
</ul>
</details>
<p>Specifies the number of bands to use for extended First-Principles Molecular Dynamics contributions when using <a class="wikilink codevar-wikilink" href="/variables/gstate#useextfpmd">useextfpmd</a> = 5.
This acts like <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> for a conventional calculation. <strong>extfpmd_nband</strong> must be sufficiently high
so that its occupancy is close to zero. Extended FPMD contributions will be computed from <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> to  <strong>extfpmd_nband</strong> .</p>
<p><strong>extfpmd_nband</strong> must be greater than <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.</p>
<h2 id="extfpmd_nbcut"><strong>extfpmd_nbcut</strong><a class="headerlink" href="#extfpmd_nbcut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EXTended FPMD: Number of Bands at CUT<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to enable the Extended FPMD method for high temperature simulations" data-toggle="popover" href="/topics/ExtFPMD">topic_ExtFPMD</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 25<br />
<em>Added in version:</em> 9.5.2  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Check Extended FPMD routines with low number of bands for
Aluminum FCC lattice at high temperature." data-toggle="popover" href="/tests/v9/Input/t92.abi" target="_blank">t92.abi</a></li>
</ul>
</details>
<p>Specifies the number of bands to use when averaging over last bands to get the
energy shift when <a class="wikilink codevar-wikilink" href="/variables/gstate#useextfpmd">useextfpmd</a> = 2 or 3.</p>
<p><strong>extfpmd_nbcut</strong> must be less than or equal to <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.</p>
<h2 id="extfpmd_nbdbuf"><strong>extfpmd_nbdbuf</strong><a class="headerlink" href="#extfpmd_nbdbuf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EXTended FPMD: Number of BanDs for the BUFfer<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to enable the Extended FPMD method for high temperature simulations" data-toggle="popover" href="/topics/ExtFPMD">topic_ExtFPMD</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.9.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Check Extended FPMD routines with low number of bands for
Aluminum FCC lattice at high temperature." data-toggle="popover" href="/tests/v9/Input/t92.abi" target="_blank">t92.abi</a></li>
</ul>
</details>
<p>Specifies the number of bands to use for the buffer when <a class="wikilink codevar-wikilink" href="/variables/gstate#useextfpmd">useextfpmd</a> /= 0.
Among the total number of bands <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, last  <strong>extfpmd_nbdbuf</strong>  bands
occupation will be set to 0, and ExtFPMD model will take charge of computing
electronic contributions starting from <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> -  <strong>extfpmd_nbdbuf</strong> .</p>
<p>In some cases, setting this input variable to a positive number can solve
convergency problems due to high variations of electron density within the SCF
cycle.</p>
<p><strong>extfpmd_nbdbuf</strong> must be less than or equal to <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.</p>
<h2 id="fband"><strong>fband</strong><a class="headerlink" href="#fband" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Factor for the number of BANDs<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify bands and occupation numbers, for metals or insulators" data-toggle="popover" href="/topics/BandOcc">topic_BandOcc</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.125 if <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> == 1,
0.5 if <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> &gt; 2,
0.0 if <a class="wikilink codevar-wikilink" href="/variables/basic#usewvl">usewvl</a> == 1,
0.0 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=6 and tsmear=0.05.
Designed to test the treatment of metals,
with the Gaussian-Hermite smearing of Methfessel and Paxton.
Also test the use of fband instead of nband." data-toggle="popover" href="/tests/v1/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the geometry builder :
- H2O molecule repeated four times, with rotations and translations
- Si (100) unreconstructed surface : 2*2*2 objects of eight atoms
- 16 H atoms at the bottom
This test is not realistic (it would take too much time)." data-toggle="popover" href="/tests/v1/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the geometry builder, and the non-ordering of atoms  :
Same thing as test 42, but with an other order for the input of atoms.
Also permutes objects a and b , to check whether everything is OK." data-toggle="popover" href="/tests/v1/Input/t43.abi" target="_blank">t43.abi</a></li>
</ul>
</details>
<p>Governs the number of bands to be used in the code in the case the parameter
<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> is not defined in the input file (which means that <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> is not
equal to 0 or 2).</p>
<p>In case  <strong>fband</strong>  is 0.0, the code computes from the pseudopotential files
and the geometry data contained in the input file, the number of electrons
present in the system. Then, it computes the minimum number of bands that can
accommodate them, and use that value for <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.</p>
<p>In case  <strong>fband</strong>  differs from zero, other bands will be added, just larger
than  <strong>fband</strong>  times the number of atoms. This parameter is not echoed in the
top of the main output file, but only the parameter <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> that it allowed
to compute. It is also not present in the dtset array (no internal).
The default values are chosen such as to give naturally some conduction bands.
This improves the robustness of the code, since this allows one to identify lack
of convergence coming from (near-)degeneracies at the Fermi level. In the
metallic case, the number of bands generated might be too small if the
smearing factor is large. The occupation numbers of the higher bands should be
small enough such as to neglect higher bands. It is difficult to automate
this, so a fixed default value has been chosen.</p>
<h2 id="fock_icutcoul"><strong>fock_icutcoul</strong><a class="headerlink" href="#fock_icutcoul" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the CUT-off for COULomb interaction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to treat adequately the Coulomb interaction, especially in charged cells," data-toggle="popover" href="/topics/Coulomb">topic_Coulomb</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1245] in all abinit tests, [0/159] in abinit tutorials</summary></details>
<p>!!!Under development!!!
Electronic structure calculations for isolated systems, 1D and 2D systems
present a slow convergence with respect to the size of the supercell due to the
long ranged Coulomb interaction and the high degree of non-locality of the
operators involved. Thus, restricting the range of the Coulomb interaction,
in order to prevent supercell images to interact can significantly speed-up
convergence, or even can make convergence happen. Also, even in the ground-state
case, a cut-off Coulomb interaction might prove useful.</p>
<p><strong>fock_icutcoul</strong>  defines the particular expression to be used for the Fock
operator in reciprocal space (see <a class="wikilink codevar-wikilink" href="/variables/gstate#icutcoul">icutcoul</a> for the Hartree contributions to ground state calculations,
and <a class="wikilink codevar-wikilink" href="/variables/gw#gw_icutcoul">gw_icutcoul</a> for the corresponding treatment in GW calculations).</p>
<p>The choice of  <strong>fock_icutcoul</strong>  depends on the
dimensionality and the character of the XC functional used (or otherwise the
presence of the exclusive treatment of the short-range exchange interaction).
Possible values of  <strong>fock_icutcoul</strong>  are from 0 to 5, but currently are available
options 0 and 5. Option 5 is hard coded as the method to be applied to HSE functionals.</p>
<p>Like for <a class="wikilink codevar-wikilink" href="/variables/gstate#icutcoul">icutcoul</a>, for 1-dimensional and 2-dimensional systems, the geometry of the system has to be specified explicitly.
This is done thanks to <a class="wikilink codevar-wikilink" href="/variables/gstate#vcutgeo">vcutgeo</a>. For 0-, 1- and 2-dimensional systems, a cut-off length has to be provided, thanks to <a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a>.</p>
<ul>
<li>0 &rarr; Sphere (molecules, but also 3D-crystals, see below). See <a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a>.</li>
<li>1 &rarr; (W.I.P.) cylinder (nanowires, nanotubes). See <a class="wikilink codevar-wikilink" href="/variables/gstate#vcutgeo">vcutgeo</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a>.</li>
<li>2 &rarr; (W.I.P) Surface. See <a class="wikilink codevar-wikilink" href="/variables/gstate#vcutgeo">vcutgeo</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a>.</li>
<li>3 &rarr; (W.I.P) 3D crystal (Coulomb interaction without cut-off).</li>
<li>4 &rarr; (W.I.P.)ERF, long-range only Coulomb interaction.</li>
<li>5 &rarr; ERFC, short-range only Coulomb interaction (e.g. as used in the HSE functional).</li>
</ul>
<p>Note that Spencer and Alavi showed that the
spherical cutoff can efficiently be used also for 3D systems <a class="wikilink citation-wikilink" data-tippy-content="Efficient calculation of the exact exchange energy in periodic systems using a truncated Coulomb potential" data-toggle="popover" href="/theory/bibliography#spencer2008">[Spencer2008]</a>.
In the latter case, use a negative value for the cutoff radius of the sphere (<a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a>&lt;0),
which is automatically calculated so that the volume enclosed in the sphere is
equal to the volume of the solid.</p>
<h2 id="fockdownsampling"><strong>fockdownsampling</strong><a class="headerlink" href="#fockdownsampling" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FOCK operator, k-grid DOWNSAMPLING<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell. Test of downsampling for HSE06, PBE0, HSE03.
2x2x2 with 4 shifts for the k point grid in the FBZ
1x1x1 with 4 shifts for the k point grid for the Fock operator in the FBZ
Testing of many hybrid functionals (variations of the hyb_* input variables),
Tests were performed with a k-point grid 16x16x16 (without additional shift),
to try to recover the nice behaviour of the HSE03 with down sampling
shown in Marsman et al JPCM 20, 064201 (2008), Fig. 1 (there, the reference was 24x24x24)
In all the cases (HSE03 libxc, HSE03 VASP, HSE06 - even clearing the issue with the definition of HSE03 dataset 4&amp;5)
the downsampling does NOT perform well ..." data-toggle="popover" href="/tests/libxc/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, conventional cell. Test of downsampling for HSE06, PBE0, HSE03.
2x2x2 for the k point grid in the FBZ
1x1x1 for the k point grid for the Fock operator in the FBZ
The results can be directly compared with those of the test libxc#72, which use
a primitive cell, instead of the conventional one here.
The k point sampling (and down sampling) perfectly match.
The observed difference is only due to the differing xc correlation real space sampling.
Of course, the total energy from the present test is to be divided by 4, to find a total energy per atom.
The results are, in Ha/atom (present test for conventional cell / previous for primitive cell / difference):
LDA    -2.075 716 / -2.075 718 / 0.000 002
HSE06  -2.095 513 / -2.095 539 / 0.000 026
PBE0   -2.081 192 / -2.081 193 / 0.000 001
HSE03  -2.123 089 / -2.123 117 / 0.000 028
The real space grid sampling cannot appear at the level of the Fock operator,
that is completely formulated in reciprocal space. The real space functional
from HSE06 and HSE03 is apparently more affected by the real space sampling than
the one from LDA and PBE0 ..." data-toggle="popover" href="/tests/libxc/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell. Test of downsampling for HSE06, PBE0, HSE03.
Testing of many hybrid functionals (variations of the hyb_* input variables).
See more information in test libxc#72. The present test differs by the use of a
different pseudopotential, that includes a non-linear core correction." data-toggle="popover" href="/tests/libxc/Input/t74.abi" target="_blank">t74.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, conventional cell. Test of downsampling for PBE0.
Examine grids whose density of points increase by steps of 2.
Results for the full set (including datasets 24 to 27, not allowed by default)
etotal22   -8.4795130935E+00
etotal23   -8.3994691038E+00
etotal24   -8.2706392613E+00
etotal25   -8.3398116419E+00
etotal26   -8.3799857985E+00
etotal27   -8.3581360592E+00
etotal28   -8.3742420892E+00
Note that dataset 23 corresponds to a non-symmetris 4 point grid. So, it is not expected to perform well,
but is included for testing purposes only.
Interestingly, the dataset 25 performs apparently better than the dataset 26." data-toggle="popover" href="/tests/paral/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, conventional cell. Test of downsampling for PBE0.
Examine grids whose density of points increase by steps of 2.
Results for the full set (including datasets 24 to 27, not allowed by default)
etotal22   -8.4795130935E+00
etotal23   -8.3994691038E+00
etotal24   -8.2706392613E+00
etotal25   -8.3398116419E+00
etotal26   -8.3799857985E+00
etotal27   -8.3581360592E+00
etotal28   -8.3742420892E+00
Note that dataset 23 corresponds to a non-symmetris 4 point grid. So, it is not expected to perform well,
but is included for testing purposes only.
Interestingly, the dataset 25 performs apparently better than the dataset 26." data-toggle="popover" href="/tests/paral/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, conventional cell. Test of downsampling for PBE0.
Examine grids whose density of points increase by steps of 2.
Results for the full set (including datasets 24 to 27, not allowed by default)
etotal22   -8.4795130935E+00
etotal23   -8.3994691038E+00
etotal24   -8.2706392613E+00
etotal25   -8.3398116419E+00
etotal26   -8.3799857985E+00
etotal27   -8.3581360592E+00
etotal28   -8.3742420892E+00
Note that dataset 23 corresponds to a non-symmetris 4 point grid. So, it is not expected to perform well,
but is included for testing purposes only.
Interestingly, the dataset 25 performs apparently better than the dataset 26." data-toggle="popover" href="/tests/paral/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, conventional cell. Test of downsampling for PBE0.
Examine grids whose density of points increase by steps of 2.
Results for the full set (including datasets 24 to 27, not allowed by default)
etotal22   -8.4795130935E+00
etotal23   -8.3994691038E+00
etotal24   -8.2706392613E+00
etotal25   -8.3398116419E+00
etotal26   -8.3799857985E+00
etotal27   -8.3581360592E+00
etotal28   -8.3742420892E+00
Note that dataset 23 corresponds to a non-symmetris 4 point grid. So, it is not expected to perform well,
but is included for testing purposes only.
Interestingly, the dataset 25 performs apparently better than the dataset 26." data-toggle="popover" href="/tests/paral/Input/t09.abi" target="_blank">t09.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of HF in PAW" data-toggle="popover" href="/tests/v7/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and PAW" data-toggle="popover" href="/tests/v7/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with RMM-DIIS and NC psps
The energy computation is not variational. While residm and vres2 converge
quite fast, the total energy convergence is lagging behind ..." data-toggle="popover" href="/tests/v7/Input/t72.abi" target="_blank">t72.abi</a></li>
</ul>
</details>
<p>The k wavevector grid used to compute the Fock operator in the full Brillouin
Zone might be a subset of the full Brillouin Zone of the k point grid used for
the wavefunctions (see <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> for its definition).  <strong>fockdownsampling</strong> 
allows one to define such a reduced set of k wavevectors, yielding a
significant speed up at the expense (possibly) of accuracy. The final grid has
<a class="wikilink codevar-wikilink" href="/variables/basic#nkpthf">nkpthf</a> k points, with coordinates <a class="wikilink codevar-wikilink" href="/variables/internal#kptns_hf">%kptns_hf</a>.</p>
<p>In the simplest case, the three values of  <strong>fockdownsampling</strong>  are equal, and
simply gives the factor by which the initial k point grid will be downsampled
along every direction. If  <strong>fockdownsampling</strong>  is 3*1, the sampling for the
Fock operator is the same as the sampling for the wavefunctions. If
 <strong>fockdownsampling</strong>  is 3*2 the sampling will have 8 times less k points.
Conventionally, if  <strong>fockdownsampling</strong>  is 3*0, then the Fock operator is
obtained solely from the Gamma point. Also, as soon as  <strong>fockdownsampling</strong>  is
not 3*1 or 3*0, the k point grid from which a subset will be taken is obtained
by imposing <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> = 1.</p>
<p>A more accurate description is now given, as one can achieve a better control
than described above, with differing values of  <strong>fockdownsampling</strong>  and also
with negative numbers. One starts from the k point grid defined by
<a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>, with <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> = 1. The absolute value of each of the three
numbers of  <strong>fockdownsampling</strong>  is used to sample the corresponding axis (in
reduced coordinate), as described above. Moreover, the obtained k grid might
even be further downsampled by specifying negative numbers: if all three are
negative, one further downsamples each 2x2x2 subset of k points by taking its
FCC subset (so, 4 points instead of 8); if two are negative, one downsamples
each 2x2x2 subset of k points by taking its BCC subset (so, 2 points instead
of 8); is only one is negative, then the two other axes are sampled using a
face-centered sampling. Finally, some of the values might be taken as 0, in
which case the corresponding direction is sampled by only one layer of points
(if two are zero, a line of points is obtained).</p>
<h2 id="fockoptmix"><strong>fockoptmix</strong><a class="headerlink" href="#fockoptmix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FOCK operator: OPTions for MIXing<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Helium atom in a box. NC, only local potential (too smooth to reproduce experiment).
Simple system for testing Hartree-Fock and the SCF algorithms with OpenMP GPU. Start from PBE." data-toggle="popover" href="/tests/gpu_omp/Input/t29.abi" target="_blank">t29.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with auxiliary XC functional." data-toggle="popover" href="/tests/v7/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and NC psps" data-toggle="popover" href="/tests/v7/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and PAW" data-toggle="popover" href="/tests/v7/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with RMM-DIIS and NC psps
The energy computation is not variational. While residm and vres2 converge
quite fast, the total energy convergence is lagging behind ..." data-toggle="popover" href="/tests/v7/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Helium atom in a box. NC, only local potential (too smooth to reproduce experiment).
Simple system for testing Hartree-Fock and the SCF algorithms. Start from PBE." data-toggle="popover" href="/tests/v7/Input/t73.abi" target="_blank">t73.abi</a></li>
</ul>
</details>
<p>Governs the mixing algorithm at the level of the Fock operator, i.e. how to
mix it, and how the underlying SCF calculation is to be performed. It is the
most relevant when the Fock operator is not updated at each SCF step (<a class="wikilink codevar-wikilink" href="/variables/dev#nnsclohf">nnsclohf</a>/=0).</p>
<p>The last digit of  <strong>fockoptmix</strong>  governs what happens at the level of the SCF
algorithm, when the Fock operator is updated.</p>
<ol>
<li>If  <strong>fockoptmix</strong>  == 0: the SCF algorithm is not restarted
  (it continues to use the previous potential/density pairs without worrying).</li>
<li>If  <strong>fockoptmix</strong>  == 1: the SCF algorithm is restarted (the previous potential/density pairs are discarded).</li>
</ol>
<p>The second-to-last (tens) digit governs the possible modification of the XC
functional inside the SCF loop to take into account the lack of update of the
Fock operator. Irrelevant when the unit digit is 0. If the value 1 is used
(so, e.g.  <strong>fockoptmix</strong>  == 11), an auxiliary xc functional is used inside the
SCF loop, for a frozen ACE Fock operator. This auxiliary functional is
specified thanks to <a class="wikilink codevar-wikilink" href="/variables/gstate#auxc_ixc">auxc_ixc</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#auxc_scal">auxc_scal</a>.</p>
<p>The third-to-last (hundreds) digit governs the mixing of the Fock operator
itself with its previous occurrences. Irrelevant when the unit digit is 0.</p>
<h2 id="hyb_mixing"><strong>hyb_mixing</strong><a class="headerlink" href="#hyb_mixing" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> HYBrid MIXING coefficient for unscreened fock operator<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -999.0<br />
<em>Comment:</em> With the default, <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_mixing">hyb_mixing</a> is initialized from <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>.<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation HSE with the GW code.
The Fock exchange mixing parameter is tunable." data-toggle="popover" href="/tests/libxc/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell. Test of downsampling for HSE06, PBE0, HSE03.
2x2x2 with 4 shifts for the k point grid in the FBZ
1x1x1 with 4 shifts for the k point grid for the Fock operator in the FBZ
Testing of many hybrid functionals (variations of the hyb_* input variables),
Tests were performed with a k-point grid 16x16x16 (without additional shift),
to try to recover the nice behaviour of the HSE03 with down sampling
shown in Marsman et al JPCM 20, 064201 (2008), Fig. 1 (there, the reference was 24x24x24)
In all the cases (HSE03 libxc, HSE03 VASP, HSE06 - even clearing the issue with the definition of HSE03 dataset 4&amp;5)
the downsampling does NOT perform well ..." data-toggle="popover" href="/tests/libxc/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell. Test of downsampling for HSE06, PBE0, HSE03.
Testing of many hybrid functionals (variations of the hyb_* input variables).
See more information in test libxc#72. The present test differs by the use of a
different pseudopotential, that includes a non-linear core correction." data-toggle="popover" href="/tests/libxc/Input/t74.abi" target="_blank">t74.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: G0W0 @ scPBE0-1/3 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scPBE0 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scPBE0-1/3 level, the Kohn-Sham basis delivers 8.101 eV,
while the plane wave basis delivers 8.122 eV.
At the G0W0-scPBE0-1/3 level, the Kohn-Sham basis delivers 7.638 eV,
while the plane wave basis delivers 7.659 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
4.4126 from scPBE0-1/3(KS) and 4.4105 from scPBE0-1/3(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
In this case, one used the PBE0 functional (ixc_sigma=41 or ixc_sigma=-406,
of even isc_sigma=42 with hyb_mixing=0.25 - all the cases were checked).
At the PBE level, the (KS) band gap was 5.661 eV,
At the scPBE0 level, the Kohn-Sham basis delivered 7.882 eV,
while the plane wave basis delivered 7.884 eV.
At the G0W0-scPBE0 level, the Kohn-Sham basis delivered 7.820 eV,
while the plane wave basis delivered 7.827 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
4.483 from scPBE0(KS) and 4.490 from scPBE0(planewaves)." data-toggle="popover" href="/tests/v7/Input/t68.abi" target="_blank">t68.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: PAW hybrid functionals: PBE, PBE0 with vanishing alpha (=PBE), PBE0, PBE0 with manually tuned alpha =0.25" data-toggle="popover" href="/tests/v9/Input/t120.abi" target="_blank">t120.abi</a></li>
</ul>
</details>
<p>Mixing coefficient for the unscreened Fock operator in case of hybrid
functionals. Hartree-Fock corresponds to 1.0, PBE0 to 0.25, and B3LYP to 0.2.</p>
<p>ABINIT knows the correct value from <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>. Experts might nevertheless tune this mixing coefficient.</p>
<h2 id="hyb_mixing_sr"><strong>hyb_mixing_sr</strong><a class="headerlink" href="#hyb_mixing_sr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> HYBrid MIXING coefficient for Short-Range screened fock operator<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -999.0<br />
<em>Comment:</em> With the default, <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_mixing_sr">hyb_mixing_sr</a> is initialized from <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>.<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation HSE with the GW code.
The Fock exchange mixing parameter is tunable." data-toggle="popover" href="/tests/libxc/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell. Test of downsampling for HSE06, PBE0, HSE03.
2x2x2 with 4 shifts for the k point grid in the FBZ
1x1x1 with 4 shifts for the k point grid for the Fock operator in the FBZ
Testing of many hybrid functionals (variations of the hyb_* input variables),
Tests were performed with a k-point grid 16x16x16 (without additional shift),
to try to recover the nice behaviour of the HSE03 with down sampling
shown in Marsman et al JPCM 20, 064201 (2008), Fig. 1 (there, the reference was 24x24x24)
In all the cases (HSE03 libxc, HSE03 VASP, HSE06 - even clearing the issue with the definition of HSE03 dataset 4&amp;5)
the downsampling does NOT perform well ..." data-toggle="popover" href="/tests/libxc/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell. Test of downsampling for HSE06, PBE0, HSE03.
Testing of many hybrid functionals (variations of the hyb_* input variables).
See more information in test libxc#72. The present test differs by the use of a
different pseudopotential, that includes a non-linear core correction." data-toggle="popover" href="/tests/libxc/Input/t74.abi" target="_blank">t74.abi</a></li>
</ul>
</details>
<p>Mixing coefficient for the screened Fock operator in case of hybrid
functionals. HSE has 0.25.</p>
<p>ABINIT knows the correct value from <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>. Experts might nevertheless tune
this mixing coefficient.</p>
<h2 id="hyb_range_dft"><strong>hyb_range_dft</strong><a class="headerlink" href="#hyb_range_dft" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> HYBrid RANGE for the DFT leftover from the screened fock operator<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -999.0 or <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_fock">hyb_range_fock</a> if it is defined by the user<br />
<em>Comment:</em> With the default=-999.0, <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_dft">hyb_range_dft</a> is initialized from <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>.<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell. Test of downsampling for HSE06, PBE0, HSE03.
2x2x2 with 4 shifts for the k point grid in the FBZ
1x1x1 with 4 shifts for the k point grid for the Fock operator in the FBZ
Testing of many hybrid functionals (variations of the hyb_* input variables),
Tests were performed with a k-point grid 16x16x16 (without additional shift),
to try to recover the nice behaviour of the HSE03 with down sampling
shown in Marsman et al JPCM 20, 064201 (2008), Fig. 1 (there, the reference was 24x24x24)
In all the cases (HSE03 libxc, HSE03 VASP, HSE06 - even clearing the issue with the definition of HSE03 dataset 4&amp;5)
the downsampling does NOT perform well ..." data-toggle="popover" href="/tests/libxc/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell. Test of downsampling for HSE06, PBE0, HSE03.
Testing of many hybrid functionals (variations of the hyb_* input variables).
See more information in test libxc#72. The present test differs by the use of a
different pseudopotential, that includes a non-linear core correction." data-toggle="popover" href="/tests/libxc/Input/t74.abi" target="_blank">t74.abi</a></li>
</ul>
</details>
<p>Range of the DFT leftover from the screened Fock operator in case of hybrid
functionals (actually, coefficient of the distance appearing in the erf
function, thus it has the dimension of an inverse distance).</p>
<p>As described in the LibXC sources (and copied in the ABINIT doc, see
<a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a> = -428), there is a mess due to an error in the original publication.
ABINIT knows the LibXC value from <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>, that might not agree with the
definitions from other codes. Usually,  <strong>hyb_range_dft</strong>  is the same as
<a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_fock">hyb_range_fock</a>, see the latter for the different values. However, there is
a noticeable exception, the HSE03 from the original paper (not the HSE03 from VASP),
for which  <strong>hyb_range_dft</strong>  = 0.188988 while <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_fock">hyb_range_fock</a> = 0.106066.</p>
<h2 id="hyb_range_fock"><strong>hyb_range_fock</strong><a class="headerlink" href="#hyb_range_fock" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> HYBrid RANGE for the screened FOCK operator<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -999.0 or <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_dft">hyb_range_dft</a> if it is defined by the user<br />
<em>Comment:</em> With the default=-999.0, <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_fock">hyb_range_fock</a> is initialized from <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>.<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell. Test of downsampling for HSE06, PBE0, HSE03.
2x2x2 with 4 shifts for the k point grid in the FBZ
1x1x1 with 4 shifts for the k point grid for the Fock operator in the FBZ
Testing of many hybrid functionals (variations of the hyb_* input variables),
Tests were performed with a k-point grid 16x16x16 (without additional shift),
to try to recover the nice behaviour of the HSE03 with down sampling
shown in Marsman et al JPCM 20, 064201 (2008), Fig. 1 (there, the reference was 24x24x24)
In all the cases (HSE03 libxc, HSE03 VASP, HSE06 - even clearing the issue with the definition of HSE03 dataset 4&amp;5)
the downsampling does NOT perform well ..." data-toggle="popover" href="/tests/libxc/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell. Test of downsampling for HSE06, PBE0, HSE03.
Testing of many hybrid functionals (variations of the hyb_* input variables).
See more information in test libxc#72. The present test differs by the use of a
different pseudopotential, that includes a non-linear core correction." data-toggle="popover" href="/tests/libxc/Input/t74.abi" target="_blank">t74.abi</a></li>
</ul>
</details>
<p>Range of the screened Fock operator in case of hybrid functionals (actually,
coefficient of the distance appearing in the erf function, thus it has the
dimension of an inverse distance).</p>
<p>As described in the LibXC sources (and copied in the ABINIT doc, see
<a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a> = -428), there is a mess due to an error in the original publication.
ABINIT knows the LibXC value from <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>, that might not agree with the
definitions from other codes. Usually, <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_dft">hyb_range_dft</a> is the same as
 <strong>hyb_range_fock</strong> , with one exception explained in <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_dft">hyb_range_dft</a>.
The HSE06 value from LibCX is 0.11, the one of Quantum Espresso is 0.106, the one of
VASP is 0.105835 (=0.2 <span><span class="MathJax_Preview">\AA^{-1}</span><script type="math/tex">\AA^{-1}</script></span>).
The HSE03 value from LibCX is 0.106066 (<span><span class="MathJax_Preview">=0.15/\sqrt{2})</span><script type="math/tex">=0.15/\sqrt{2})</script></span>), the one of VASP is
0.1587531 (=0.3 <span><span class="MathJax_Preview">\AA^{-1}</span><script type="math/tex">\AA^{-1}</script></span>).</p>
<h2 id="iatsph"><strong>iatsph</strong><a class="headerlink" href="#iatsph" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Index for the ATomic SPHeres of the atom-projected density-of-states<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic DOS and related topics" data-toggle="popover" href="/topics/ElecDOS">topic_ElecDOS</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute atom-centered properties" data-toggle="popover" href="/topics/AtomCentered">topic_AtomCentered</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/gstate#natsph">natsph</a>)<br />
<em>Default value:</em> [ 1 &hellip; <a class="wikilink codevar-wikilink" href="/variables/gstate#natsph">natsph</a> ]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> == 3 or 4 or <a class="wikilink codevar-wikilink" href="/variables/paw#pawfatbnd">pawfatbnd</a> in [1,2]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [9/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, with PAW.
Test the IO routines with paral_kgb in [1, 0] and different combinations
of parameters (npfft, npband, np_spkpt).
Test the plane wave load balancing procedure (pw_unbal_thresh).
Test also the computation of PJDOS." data-toggle="popover" href="/tests/mpiio/Input/t26.abi" target="_blank">t26.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PAW1 tutorial
Diamond at experimental volume
Computation of Density of States" data-toggle="popover" href="/tests/tutorial/Input/tpaw1_4.abi" target="_blank">tpaw1_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe fcc structure with two atoms per unit cell for test of antiferromagnetic
This is the simplest fcc structure compatible with a X point spiral" data-toggle="popover" href="/tests/tutorial/Input/tspin_3.abi" target="_blank">tspin_3.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
One He atom in a big simple cubic box
Compute the DOS using the tetrahedron method.
Also compute the partial DOS.
There is a quite surprising feature of this very simple DOS,
that might seem to be due to a bug, but is NOT one.
Indeed, the obtained DOS is not continuous (vizualize the result
of DATASET 2):  at two energies, there is a small, but sizeable
jump. This feature is associated with a rather sparse sampling
of the Brillouin zone. Indeed, some of the tetrahedra have
three corners with perfectly identical energies. Such
a set of corners belong to two different tetrahedra.
If there is not an equal slope of energy when moving away from
each sides of the triangles, in the different tetrahedra,
the DOS is discontinuous at the energy of the three shared corners.
(explanation found by M. Verstraete)" data-toggle="popover" href="/tests/v4/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the computation of the partial DOS, using the linear tetrahedron method.
2 Silicon atoms, in a diamond structure." data-toggle="popover" href="/tests/v4/Input/t38.abi" target="_blank">t38.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Density from test 105 is read; then a non self-consistent calculation
is done and the m-decomposed LDOS on the first atom is printed out.
The BCC structure is slightly distorted, in order to decrease the symmetry
and the degeneracies, and allow better portability.
(perhaps PROCAR file could be tested again)." data-toggle="popover" href="/tests/v9/Input/t108.abi" target="_blank">t108.abi</a></li>
</ul>
</details>
<p><strong>iatsph</strong>  gives the number of the <a class="wikilink codevar-wikilink" href="/variables/gstate#natsph">natsph</a> atoms around which the sphere
for atom-projected density-of-states will be build, in the <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> = 3 or 4 cases.
The radius of these spheres is given by <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a>.
If <a class="wikilink codevar-wikilink" href="/variables/paw#pawfatbnd">pawfatbnd</a> = 1 or 2, it gives the number of the <a class="wikilink codevar-wikilink" href="/variables/gstate#natsph">natsph</a> atoms around
which atom-projected band structure will be built.</p>
<h2 id="icoulomb"><strong>icoulomb</strong><a class="headerlink" href="#icoulomb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Index for the COULOMB treatment<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to treat adequately the Coulomb interaction, especially in charged cells," data-toggle="popover" href="/topics/Coulomb">topic_Coulomb</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [33/1245] in all abinit tests, [9/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a> &hellip;</li>
</ul>
</details>
<p>Defines the type of computation (reciprocal space or real space) used for Hartree potential, local part of
pseudo-potential and ion-ion interaction:</p>
<ul>
<li><strong>icoulomb</strong>  = 0: usual reciprocal space computation, using <a class="wikilink codevar-wikilink" href="/variables/gstate#icutcoul">icutcoul</a>, <a class="wikilink codevar-wikilink" href="/variables/gw#gw_icutcoul">gw_icutcoul</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#fock_icutcoul">fock_icutcoul</a>
to define the Hartree potential, and using Ewald correction.</li>
<li><strong>icoulomb</strong>  = 1: free boundary conditions are used when the Hartree potential is computed,
    real space expressions of pseudo-potentials are involved (restricted to GTH pseudo-potentials)
    and simple coulomb interaction gives the ion-ion energy. The wavelet Coulomb solver is used in this case.</li>
</ul>
<h2 id="icutcoul"><strong>icutcoul</strong><a class="headerlink" href="#icutcoul" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the CUT-off for COULomb interaction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to treat adequately the Coulomb interaction, especially in charged cells," data-toggle="popover" href="/topics/Coulomb">topic_Coulomb</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [77/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code and energy-only self-consistency" data-toggle="popover" href="/tests/gwr/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: G0W0 @ scHSE06 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scHSE06 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scHSE06 level, the Kohn-Sham basis delivers 6.834 eV,
while the plane wave basis delivers 6.850 eV.
At the G0W0-scHSE06 level, the Kohn-Sham basis delivers 7.314 eV,
while the plane wave basis delivers 7.344 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
5.8309 from scHSE06(KS) and 5.8202 from scHSE06(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
At the PBE level, the (KS) band gap was 5.661 eV,
At the scHSE06 level, the Kohn-Sham basis delivered 7.340 eV,
while the plane wave basis delivered 7.341 eV.
At the G0W0-scHSE06 level, the Kohn-Sham basis delivered 7.806 eV,
while the plane wave basis delivered 7.807 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
5.033 from scHSE06(KS) and 5.032 from scHSE06(planewaves)." data-toggle="popover" href="/tests/libxc/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: G0W0 @ scHSE06 calculation. Monitor the direct gap at Gamma.
The pseudopotential includes a non-linear XC core correction." data-toggle="popover" href="/tests/libxc/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-toggle="popover" href="/tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-toggle="popover" href="/tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-toggle="popover" href="/tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-toggle="popover" href="/tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Convergence of the number of bands in the transition space." data-toggle="popover" href="/tests/tutorial/Input/tbs_3.abi" target="_blank">tbs_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
BS run: convergence in ecuteps" data-toggle="popover" href="/tests/tutorial/Input/tbs_4.abi" target="_blank">tbs_4.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-toggle="popover" href="/tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-toggle="popover" href="/tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-toggle="popover" href="/tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-toggle="popover" href="/tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-toggle="popover" href="/tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-toggle="popover" href="/tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-toggle="popover" href="/tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-toggle="popover" href="/tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-toggle="popover" href="/tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the 0D and 2D Coulomb cut-off functionality
in the ground state  for graphene." data-toggle="popover" href="/tests/v9/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
h-BN single layer using 2D cut-off method of Beigi :
compute the first order derivative of the total energy
With delta(xred)=0.0002, one gets delta(etot)/delta(xred)=-0,0050208160
With delta(xred)=0.0001, one gets delta(etot)/delta(xred)=-0,0050213750
The combination of both results, in a higher-order finite difference
formula gives -0,0050215613 . The direct computation of forces
at the target geometry gives -0,0050217263 when converged values are used.
The agreement falls within (6) digits of the finite-difference result." data-toggle="popover" href="/tests/v9/Input/t132.abi" target="_blank">t132.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-toggle="popover" href="/tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>Electronic structure calculations for isolated systems, 1D and 2D systems
present a slow convergence with respect to the size of the supercell due to the
long ranged Coulomb interaction and the high degree of non-locality of the
operators involved. Thus, restricting the range of the Coulomb interaction,
in order to prevent supercell images to interact can significantly speed-up
convergence, or even can make convergence happen. Also, even in the ground-state
case, a cut-off Coulomb interaction might prove useful.</p>
<p><strong>icutcoul</strong>  defines the particular expression to be used for the Coulomb-like terms
in reciprocal space in ground-state calculations. See <a class="wikilink codevar-wikilink" href="/variables/gw#gw_icutcoul">gw_icutcoul</a> for GW calculationts,
and <a class="wikilink codevar-wikilink" href="/variables/gstate#fock_icutcoul">fock_icutcoul</a> for the Fock-like terms in ground-state calculations -e.g. using hybrid functionals-.</p>
<p>The choice of  <strong>icutcoul</strong>  depends on the dimensionality
of the system. Possible values of  <strong>icutcoul</strong>  are from 0 to 5.
For 1-dimensional and 2-dimensional systems, the geometry of the system (along which directions the cell is to be periodically repeated,
along which ones the system is finite)
has to be specified explicitly.
This is done thanks to <a class="wikilink codevar-wikilink" href="/variables/gstate#vcutgeo">vcutgeo</a>. For 0-, 1- and 2-dimensional systems, a cut-off length might be provided, depending
on the methodology, thanks to <a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a>.</p>
<ul>
<li>0 &rarr; Sphere (molecules, but also 3D-crystals, see below). See <a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a>.</li>
<li>1 &rarr; (W.I.P.) cylinder (nanowires, nanotubes). See <a class="wikilink codevar-wikilink" href="/variables/gstate#vcutgeo">vcutgeo</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a>.</li>
<li>2 &rarr; Surface. See <a class="wikilink codevar-wikilink" href="/variables/gstate#vcutgeo">vcutgeo</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a>.</li>
<li>3 &rarr; 3D crystal (Coulomb interaction without cut-off).</li>
<li>4 &rarr; ERF, long-range only Coulomb interaction.</li>
<li>5 &rarr; ERFC, short-range only Coulomb interaction (e.g. as used in the HSE functional). (W.I.P.)</li>
</ul>
<p>Note that Spencer and Alavi showed that the
spherical cutoff can efficiently be used also for 3D systems <a class="wikilink citation-wikilink" data-tippy-content="Efficient calculation of the exact exchange energy in periodic systems using a truncated Coulomb potential" data-toggle="popover" href="/theory/bibliography#spencer2008">[Spencer2008]</a>.
In the latter case, use a negative value for the cutoff radius of the sphere (<a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a>&lt;0),
which is automatically calculated so that the volume enclosed in the sphere is
equal to the volume of the solid.</p>
<h2 id="iprcel"><strong>iprcel</strong><a class="headerlink" href="#iprcel" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for PReConditioning of ELectron response<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [27/1245] in all abinit tests, [3/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for real space computation (using a wavelet based poisson solver),
no forces, just an H atom in an empty box. The cut-off is unrealistic. This
test tests the following part of the code :
* psp spline generation for real space ;
* local part of potential from pseudo ;
* ion-ion interaction computation (instead of Ewald) ;
* Hartree potential with Poisson&#x27;s solver." data-toggle="popover" href="/tests/bigdft/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H in isolated boundary conditions (plane waves, NC).
Similar to t20.in but check that non cubic boxs can be used with equivalent x, y and z directions." data-toggle="popover" href="/tests/bigdft/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy
Determination of the surface energy of aluminum :
convergence with respect to the number of vacuum layers." data-toggle="popover" href="/tests/tutorial/Input/tbase4_7.abi" target="_blank">tbase4_7.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy

Determination of the surface energy of aluminum :
convergence with respect to the number of vacuum layers." data-toggle="popover" href="/tests/tutorial/Input/tbase4_8.abi" target="_blank">tbase4_8.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al2 molecule, inversion point shifted from the origin, ixc=0,
kpt=1/4 1/4 1/4, nsym=4.
Large number of bands (20 instead of 3).
8 first SCF steps with simple mixing algorithm, mixing factor 1/5.
Slow convergence.
Computation of the hermitian dielectric matrix at the 8th step.
The inverse of the dielectric matrix is then used as preconditioning.
A factor of 20 is gained on each step. Largest eigenvalue value of the
dielectric matrix is 5.712 (a mixing factor of 1/3 would have
been enough, but 1/5 is faster). A second eigenvalue is close : 5.531 ." data-toggle="popover" href="/tests/v1/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized. ixc=0. 7 states for each spin.
First, converge using mixing factor, then evaluate RPA dielectric
matrix, and use it for convergence." data-toggle="popover" href="/tests/v1/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as case 53, but exchange-correlation included. The convergence
is not as good as in case 53, but still much better than simple mixing." data-toggle="popover" href="/tests/v1/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivatives of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector, as well as to an homogeneous
electric field. The computed derivatives include the
mixed derivative wrt the two perturbations.
(see test.si.elfd of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=5
and non-linear XC core correction.
Computation of the second derivatives of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.si.core0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
5-atom Al slab, with three vacuum layers.
First, converge the wavefunctions, then compute the
STM charge density below and above the Fermi energy, within a 2eV range.
Also compute band-by-band decomposition of STM charge density below the Fermi energy, within a 2eV range." data-toggle="popover" href="/tests/v4/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Extrapolar approximation for GW calculations on metals. Norm-conserving.
PRB 78, 085125 (2008)" data-toggle="popover" href="/tests/v5/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for rsprc preconditionner (not already effective)
simple scf calculation
following part of the code are tested:
04rsprc/prcrscgres.F90
01cg/*" data-toggle="popover" href="/tests/v5/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for rsprc preconditionner (not already effective)
simple scf calculation
following part of the code are tested:
04rsprc/prcrscgres2.F90
01cg/*" data-toggle="popover" href="/tests/v5/Input/t74.abi" target="_blank">t74.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Used when <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt; 0, to define the SCF preconditioning scheme. Potential-
based preconditioning schemes for the SCF loop (electronic part) are still a
subject of active research. The present parameter (electronic part) describes
the way the change of potential is derived from the residual.
The possible values of  <strong>iprcel</strong>  correspond to:</p>
<ul>
<li>0 &rarr; model dielectric function described by <a class="wikilink codevar-wikilink" href="/variables/gstate#diemac">diemac</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#dielng">dielng</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a>.</li>
<li>larger or equal to 21 &rarr; will compute the dielectric matrix according to <a class="wikilink codevar-wikilink" href="/variables/gstate#diecut">diecut</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#dielam">dielam</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#diegap">diegap</a>. This methodology is described in <a class="wikilink citation-wikilink" data-tippy-content="Preconditioning of self-consistent-field cycles in density-functional theory: The extrapolar method" data-toggle="popover" href="/theory/bibliography#anglade2008">[Anglade2008]</a>.</li>
<li>Between 21 and 29 &rarr; for the first few steps uses the same as option 0 then compute RPA dielectric function, and use it as such.</li>
<li>Between 31 and 39 &rarr; for the first few steps uses the same as option 0 then compute RPA dielectric function, and use it, with the mixing factor <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a>.</li>
<li>Between 41 and 49 &rarr; compute the RPA dielectric matrix at the first step, and recompute it at a later step, and take into account the mixing factor <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a>.</li>
<li>Between 51 and 59 &rarr; same as between 41 and 49, but compute the RPA dielectric matrix by another mean</li>
<li>Between 61 and 69 &rarr; same as between 41 and 49, but compute the electronic dielectric matrix instead of the RPA one.</li>
<li>Between 71 and 78 &rarr; STILL UNDER DEVELOPMENT &ndash; NOT USABLE; Use the modified Kerker preconditioner with a real-space formulation (basic formulation is shown at <a class="wikilink codevar-wikilink" href="/variables/gstate#dielng">dielng</a>). The dielectric matrix is approximated thanks to <a class="wikilink codevar-wikilink" href="/variables/gstate#diemac">diemac</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#dielng">dielng</a>. Note that <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> is also used.</li>
<li>79 &rarr; STILL UNDER DEVELOPMENT &ndash; NOT USABLE; same as previous but with an alternate algorithm.</li>
<li>141 to 169 &rarr; same as Between 41 and 69 (but, the dielectric matrix is also recomputed every iprcel modulo 10 step).</li>
</ul>
<p>The computation of the dielectric matrix (for 0 [100]&lt;  <strong>iprcel</strong>  &lt; 70 [100])
is based on the <strong>extrapolar</strong> approximation, see <a class="wikilink citation-wikilink" data-tippy-content="Preconditioning of self-consistent-field cycles in density-functional theory: The extrapolar method" data-toggle="popover" href="/theory/bibliography#anglade2008">[Anglade2008]</a>. This approximation can be tuned
with <a class="wikilink codevar-wikilink" href="/variables/gstate#diecut">diecut</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#dielam">dielam</a>, and <a class="wikilink codevar-wikilink" href="/variables/gstate#diegap">diegap</a>. Yet its accuracy mainly depends
on the number of conduction bands included in the system. Having 2 to 10 empty
bands in the calculation is usually enough (use <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>).</p>
<p>NOTES:</p>
<ul>
<li>The step at which the dielectric matrix is computed or recomputed is determined by modulo( <strong>iprcel</strong> ,10). The recomputation happens just once in the calculation for  <strong>iprcel</strong>   &lt; 100.</li>
<li>For non-homogeneous relatively large cells  <strong>iprcel</strong>  = 45 will likely give a large improvement over  <strong>iprcel</strong>  = 0.</li>
<li>In case of PAW and  <strong>iprcel</strong>  &gt; 0, see <a class="wikilink codevar-wikilink" href="/variables/paw#pawsushat">pawsushat</a> input variable. By default, an approximation (which can be suppressed) is done for the computation of susceptibility matrix.</li>
<li>For extremely large inhomogeneous cells where computation of the full dielectric matrix takes too many weeks, 70 &lt;  <strong>iprcel</strong>  &lt; 80 is advised.</li>
<li>For <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2 or <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2 with metallic <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>, only <strong>mod(iprcel,100)</strong> &lt;50 is allowed.</li>
<li>No meaning for RF calculations yet.</li>
<li>The exchange term in the full dielectric matrix diverges for vanishing densities. Therefore the values of  <strong>iprcel</strong>  beyond 60 must not be used for cells containing vacuum, unless ones computes this matrix for every step ( <strong>iprcel</strong>  = 161).</li>
</ul>
<h2 id="iqpt"><strong>iqpt</strong><a class="headerlink" href="#iqpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Index for QPoinT generation<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT calculations" data-toggle="popover" href="/topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [12/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
the sequence of datasets makes the ground states and
all of the explicit perturbations of the single
Al atom in all directions, for the irreducible
qpoints in a 2x2x2 grid.
Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_1.abi" target="_blank">teph_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline AlAs : computation of the phonon spectrum" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_2.abi" target="_blank">trf2_2.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through qptrlatt.
Otherwise, similar to Tv2#26 and Tv6#78." data-toggle="popover" href="/tests/v6/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through ngqpt and nshiftq.
Otherwise, similar to Tv2#26" data-toggle="popover" href="/tests/v6/Input/t78.abi" target="_blank">t78.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed." data-toggle="popover" href="/tests/v7/Input/t55.abi" target="_blank">t55.abi</a></li>
</ul>
</details>
<p>Only used if <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a> = 1, and <a class="wikilink codevar-wikilink" href="/variables/gstate#qptopt">qptopt</a> = 1 to 4.</p>
<p>Defines the index of the Q point to be selected in the list of q points
generated by <a class="wikilink codevar-wikilink" href="/variables/gstate#ngqpt">ngqpt</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#qptrlatt">qptrlatt</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#nshiftq">nshiftq</a>, and <a class="wikilink codevar-wikilink" href="/variables/gstate#shiftq">shiftq</a>.</p>
<p>If  <strong>iqpt</strong>  = 0, then the q point is Gamma (0 0 0).</p>
<p>The usual working mode is to define a series of values for  <strong>iqpt</strong> , starting
with  <strong>iqpt</strong>  = 0 or 1 (so through the definition of <strong>iqpt:</strong> ), and increasing
it by one for each dataset (thanks to <strong>iqpt+</strong> ).</p>
<h2 id="ivalence"><strong>ivalence</strong><a class="headerlink" href="#ivalence" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Index of the highest VALENCE band<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify bands and occupation numbers, for metals or insulators" data-toggle="popover" href="/topics/BandOcc">topic_BandOcc</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a Δ-SCF calculation of neutral excitations" data-toggle="popover" href="/topics/DeltaSCF">topic_DeltaSCF</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of various XC functionals for the response functions
(thus, the XC kernel is also tested).
The test includes 3 different functionals:
1) Perdew-Zunger: ixc=2 and ixc=-001009
2) PBE: ixc=11 and ixc=-101130
3) Perdew-Wang92: ixc=7, ixc=-001012, and ixc=-001013
The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent
unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting
some lines indicated by GMR.
Note that the underlying FFT grid does not have the symmetry of the
lattice." data-toggle="popover" href="/tests/libxc/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of the Perdew-Zunger XC functionals for the response functions
(thus, the XC kernel is also tested) in PAW." data-toggle="popover" href="/tests/libxc/Input/t82.abi" target="_blank">t82.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
2 Silicon atoms, in a diamond structure.
Test the computation of occopt 9." data-toggle="popover" href="/tests/v9/Input/t91.abi" target="_blank">t91.abi</a></li>
</ul>
</details>
<p>Only used if [[occopt] = 9.</p>
<p>When <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>==9, the lowest  <strong>ivalence</strong>  bands are considered to be
valence bands and <a class="wikilink codevar-wikilink" href="/variables/gstate#nqfd">nqfd</a> holes are constrained to exist in them.
Accordingly, higher energy bands (with index &gt;=  <strong>ivalence</strong>  + 1) are
considered to be conduction bands, and <a class="wikilink codevar-wikilink" href="/variables/gstate#nqfd">nqfd</a> electrons are constrained there.
See <a class="wikilink citation-wikilink" data-tippy-content="Photoinduced Phase Transitions in Ferroelectrics" data-toggle="popover" href="/theory/bibliography#paillard2019">[Paillard2019]</a> for more details about the general method implemented.</p>
<h2 id="ixcpositron"><strong>ixcpositron</strong><a class="headerlink" href="#ixcpositron" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for the eXchange-Correlation applied to the electron-POSITRON interaction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a calculation with a positron in the system." data-toggle="popover" href="/topics/positron">topic_positron</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Comment:</em> (Teter parameterization). However, if all the pseudopotentials have the same value of pspxc, the initial value of ixc will be that common value<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#positron">positron</a>/=0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
First step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_1.abi" target="_blank">tpositron_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Second step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, &quot;conventional&quot; scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_2.abi" target="_blank">tpositron_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Third step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, self-consistent scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_3.abi" target="_blank">tpositron_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Fourth step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, relaxation effect" data-toggle="popover" href="/tests/tutorial/Input/tpositron_4.abi" target="_blank">tpositron_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Fifth step of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_5.abi" target="_blank">tpositron_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Sixth step (part 1) of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW - 12 valence electrons
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_6.abi" target="_blank">tpositron_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Sixth step (part 2) of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW - 12 valence electrons
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_7.abi" target="_blank">tpositron_7.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al FCC, in conventional cell (4 atoms/cell).
Positron calculation : lifetime and decay rate." data-toggle="popover" href="/tests/v4/Input/t96.abi" target="_blank">t96.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the electron-positron Doppler broadening
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Computes the positron lifetime and well as the electron-positron
pairs momentum distributions, after the SCF iterations." data-toggle="popover" href="/tests/v7/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p>Relevant only when <a class="wikilink codevar-wikilink" href="/variables/gstate#positron">positron</a>/=0.
Define the type of electron-positron correlation that is used in case of a
electron-positron two-component DFT calculation.
Define also the analytical formula of the enhancement factor used to compute
the electron-positron annihilation rate:</p>
<p>Electron-positron correlation functional:</p>
<ul>
<li>ixcpositron=1: LDA zero positron density limit parametrized by
Arponen &amp; Pajanne and provided by Boronski &amp; Nieminen <a class="wikilink citation-wikilink" data-tippy-content="Electron liquid in collective description. III. Positron annihilation" data-toggle="popover" href="/theory/bibliography#arponen1979a">[Arponen1979a]</a>,<a class="wikilink citation-wikilink" data-tippy-content="Electron-positron density-functional theory" data-toggle="popover" href="/theory/bibliography#boronski1986">[Boronski1986]</a></li>
<li>ixcpositron=11: LDA zero positron density limit parametrized by
Arponen &amp; Pajanne and fitted by Sterne &amp; Kaiser <a class="wikilink citation-wikilink" data-tippy-content="Electron liquid in collective description. III. Positron annihilation" data-toggle="popover" href="/theory/bibliography#arponen1979a">[Arponen1979a]</a>,<a class="wikilink citation-wikilink" data-tippy-content="First-principles calculation of positron lifetimes in solids" data-toggle="popover" href="/theory/bibliography#sterne1991">[Sterne1991]</a></li>
<li>ixcpositron=2: LDA electron-positron correlation provided by
Puska, Seitsonen, and Nieminen <a class="wikilink citation-wikilink" data-tippy-content="Electron liquid in collective description. III. Positron annihilation" data-toggle="popover" href="/theory/bibliography#arponen1979a">[Arponen1979a]</a>,<a class="wikilink citation-wikilink" data-tippy-content="Electron-positron Car-Parrinello methods: Self-consistent treatment of charge densities and ionic relaxations" data-toggle="popover" href="/theory/bibliography#puska1995">[Puska1995]</a></li>
<li>ixcpositron=3: GGA zero positron density limit parametrized by
Arponen &amp; Pajanne and provided by Boronski &amp; Nieminen <a class="wikilink citation-wikilink" data-tippy-content="Electron liquid in collective description. III. Positron annihilation" data-toggle="popover" href="/theory/bibliography#arponen1979a">[Arponen1979a]</a>,<a class="wikilink citation-wikilink" data-tippy-content="Electron-positron density-functional theory" data-toggle="popover" href="/theory/bibliography#boronski1986">[Boronski1986]</a>,<a class="wikilink citation-wikilink" data-tippy-content="Gradient correction for positron states in solids" data-toggle="popover" href="/theory/bibliography#barbiellini1995">[Barbiellini1995]</a></li>
<li>ixcpositron=31: GGA zero positron density limit parametrized
by Arponen &amp; Pajanne and fitted by Sterne &amp; Kaiser <a class="wikilink citation-wikilink" data-tippy-content="Electron liquid in collective description. III. Positron annihilation" data-toggle="popover" href="/theory/bibliography#arponen1979a">[Arponen1979a]</a>,<a class="wikilink citation-wikilink" data-tippy-content="First-principles calculation of positron lifetimes in solids" data-toggle="popover" href="/theory/bibliography#sterne1991">[Sterne1991]</a>,<a class="wikilink citation-wikilink" data-tippy-content="Gradient correction for positron states in solids" data-toggle="popover" href="/theory/bibliography#barbiellini1995">[Barbiellini1995]</a></li>
</ul>
<p>Annihilation rate enhancement factor:</p>
<ul>
<li>ixcpositron=1: Boronski and Nieminen full modelisation and RPA limit <a class="wikilink citation-wikilink" data-tippy-content="Electron liquid in collective description. III. Positron annihilation" data-toggle="popover" href="/theory/bibliography#arponen1979a">[Arponen1979a]</a></li>
<li>ixcpositron=11: Sterne and Kaiser <a class="wikilink citation-wikilink" data-tippy-content="Electron-positron density-functional theory" data-toggle="popover" href="/theory/bibliography#boronski1986">[Boronski1986]</a></li>
<li>ixcpositron=2: Puska, Seitsonen and Nieminen <a class="wikilink citation-wikilink" data-tippy-content="First-principles calculation of positron lifetimes in solids" data-toggle="popover" href="/theory/bibliography#sterne1991">[Sterne1991]</a></li>
<li>ixcpositron=3: Boronski and Nieminen full modelisation and RPA limit <a class="wikilink citation-wikilink" data-tippy-content="Electron liquid in collective description. III. Positron annihilation" data-toggle="popover" href="/theory/bibliography#arponen1979a">[Arponen1979a]</a>, with GGA corrections</li>
<li>ixcpositron=31: Sterne and Kaiser <a class="wikilink citation-wikilink" data-tippy-content="Electron-positron density-functional theory" data-toggle="popover" href="/theory/bibliography#boronski1986">[Boronski1986]</a>, with GGA corrections</li>
</ul>
<h2 id="jellslab"><strong>jellslab</strong><a class="headerlink" href="#jellslab" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> include a JELLium SLAB in the cell<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform some artificial modifications of the physics" data-toggle="popover" href="/topics/Artificial">topic_Artificial</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk jellium (the slab fills up the entire cell): computation of the total
energy. Tested 3 Wigner-Seitz radii: 1.5, 2 (~aluminum), 4. For each
Wigner-Seitz radius the energy per particle agrees with that analytically
calculated using the Teter-Pade functional form.
The number of k points has been much reduced, for the purpose of the automatic testing." data-toggle="popover" href="/tests/v5/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium slab (50 jellium/ 50 vacuum) with Wigner-Seitz radius=4.
Computation of the total energy
The number of k points has been much reduced" data-toggle="popover" href="/tests/v5/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium thin slab with Wigner-Seitz radius=2.56 (~copper) + 1 Na adatom.
Computation of the total energy and force on the Na atom. Its position
with respect to the slab already is the equilibrium position so the
calculation should use only one optimization step." data-toggle="popover" href="/tests/v5/Input/t58.abi" target="_blank">t58.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium thin slab with Wigner-Seitz radius=2.56 (~copper) + 1 Na adatom.
Computation of the total energy at the Na equilibrium distance from the
jellium edge and two other ones, slightly farther and slightly closer.
The total energies should indicate as more stable the equilibrium distance.
The number of k points has been much reduced" data-toggle="popover" href="/tests/v5/Input/t59.abi" target="_blank">t59.abi</a></li>
</ul>
</details>
<p>If set to 1, a slab of uniform positive background charge density, that is, a
jellium slab, is included in the calculation cell. A portion of the unit cell
is filled with such positive charge density distribution which is equal to a
bulk-mean value <span><span class="MathJax_Preview">n_{bulk}</span><script type="math/tex">n_{bulk}</script></span> between two edges and zero in the vacuum region if present.
For the sake of convenience the unit cell is supposed to have the third
crystal primitive lattice vector orthogonal to the other ones so that the
portion of the cell filled by the jellium slab can be defined through its edges along z.
The bulk-mean positive charge density is fixed by the input variable
<a class="wikilink codevar-wikilink" href="/variables/gstate#slabwsrad">slabwsrad</a>, while the position of the slab edges along z is defined through
the input variables <a class="wikilink codevar-wikilink" href="/variables/gstate#slabzbeg">slabzbeg</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#slabzend">slabzend</a>.</p>
<h2 id="kptbounds"><strong>kptbounds</strong><a class="headerlink" href="#kptbounds" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K PoinT BOUNDarieS<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,abs(<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>)+1))<br />
<em>Default value:</em> None<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [19/1245] in all abinit tests, [8/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-toggle="popover" href="/tests/libxc/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_1.abi" target="_blank">tucalc_crpa_1.abi</a></li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_6.abi" target="_blank">tw90_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Z2Pack (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tz2_2.abi" target="_blank">tz2_2.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon

Computation of the band structure.
First, a SCF density computation, then a non-SCF band structure calculation." data-toggle="popover" href="/tests/tutorial/Input/tbase3_5.abi" target="_blank">tbase3_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H6 Supercell
Generates a 6 atom Hydrogen supercell with the multiplicity of 1:2:3 (x:y:z)
Produces a WFK file to be analyzed with fold2bloch" data-toggle="popover" href="/tests/tutorial/Input/tfold2bloch_1.abi" target="_blank">tfold2bloch_1.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Molybdenum. Test the k point generator : Monkhorst-Pack
grid, then band structure." data-toggle="popover" href="/tests/v2/Input/t43.abi" target="_blank">t43.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Au linear chain. Test the output of a launch.dat file for WanT
Note: the file that is produced is not tested,
Only the usual output file of ABINIT.
Want output does not support MPI with ncpus &gt; 1." data-toggle="popover" href="/tests/v4/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon to test the CP2K pseudopotential implementation with
the new pseudo type: pspcod 10 (same formalism as HGH pseudopotentials, pspcod 3).
Same input file as t35.in of tests/tutorial, the only difference is that
in the test the used pseudo is taken from the CP2K library.
(http://cvs.berlios.de/cgi-bin/viewcvs.cgi/cp2k/potentials/Goedecker/abinit/)
The bandstructure is in agreement with that calculated in the tutorial
example with the pspcod=1 pseudopotential." data-toggle="popover" href="/tests/v5/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgB2, space group P6/m m m (#191); Bravais hP (primitive hexag.)
GS calculation followed by a band structure calculation in which the
k-path is automatically defined via the ndivsm input variable.
The third dataset tests the calculation and the output of the Fermi surface (prtfsurf=1)
in the Xcrysden format." data-toggle="popover" href="/tests/v6/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon. Diamond structure.
Quick test of the use of datasets with a numbering beyond 1000 (the last one is 1022).
(Tests 35-40 are for response-function)" data-toggle="popover" href="/tests/v6/Input/t34.abi" target="_blank">t34.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a></li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a></li>
</ul>
</details>
<p>It is used to generate the circuit to be followed by the band structure, when
<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> is negative (it is not read if <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> is zero or positive).</p>
<p>There are abs(<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>) segments to be defined, each of which starting from
the end point of the preceeding one. Thus, the number of points to be input is
abs(<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>)+1. They form a circuit starting at
 <strong>kptbounds</strong> (1:3,1)/<a class="wikilink codevar-wikilink" href="/variables/basic#kptnrm">kptnrm</a> and ending at
 <strong>kptbounds</strong> (1:3,abs(<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>)+1)/<a class="wikilink codevar-wikilink" href="/variables/basic#kptnrm">kptnrm</a>. The number of divisions of
each segment can be defined either using the array <a class="wikilink codevar-wikilink" href="/variables/gstate#ndivk">ndivk</a> or the variable
<a class="wikilink codevar-wikilink" href="/variables/gstate#ndivsm">ndivsm</a> (preferred) that just defines the number of divisions for the smallest segment.</p>
<p>As for <a class="wikilink codevar-wikilink" href="/variables/basic#kpt">kpt</a>,  <strong>kptbounds</strong>  is specified using the primitive vectors in
reciprocal space. If your Bravais lattice is simple, then it should be quite
easy to find the coordinates of the end points. On the other hand, for
centered, body-centered, face-centered, hexagonal, and rhombohedral Bravais
lattice, the conversion might be more difficult. See the description of
<a class="wikilink codevar-wikilink" href="/variables/basic#kpt">kpt</a> for an explanation of how to convert data from the &ldquo;conventional&rdquo;
cartesian coordinates to the primitive vectors in the reciprocal space. In
order to help a bit, we list below a series of typical values, for the FCC,
BCC, hexagonal and rhombohedral Bravais lattices. Note: all the data below
are given in dimensionless units; they have to be rescaled by the actual
lengths defined by the <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a> values. However,  <strong>kptbounds</strong>  values can be
used as such, if the values of <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a> given below are adopted.</p>
<p>A. <strong>FCC lattice</strong></p>
<p>Suppose the primitive vectors in real space are given by</p>
<div class="codehilite"><pre><span></span><code>  rprim   0 1 1    1 0 1    1 1 0
</code></pre></div>

<p>or</p>
<div class="codehilite"><pre><span></span><code>  rprim   0 1/2 1/2    1/2 0 1/2    1/2 1/2 0
</code></pre></div>

<p>(these two possibilities only differ by a scaling factor, irrelevant for the
definition of the k points in the primitive vectors in reciprocal space).
Then, the reciprocal primitive vectors (in conventional cartesian coordinates) are</p>
<div class="codehilite"><pre><span></span><code>  (-1/2 1/2 1/2), (1/2 -1/2 1/2), (1/2 1/2 -1/2)
</code></pre></div>

<p>or</p>
<div class="codehilite"><pre><span></span><code>  (-1 1 1), (1 -1 1), (1 1 -1)
</code></pre></div>

<p>and, in both cases, the coordinates of several special points with respect to
primitive vectors in reciprocal space are</p>
<div class="codehilite"><pre><span></span><code>  X (0   1/2 1/2)   (conventional cartesian coordinate 1/2 0 0)
  X&#39;(1/2 1/2 1  )   (conventional cartesian coordinate 1/2 1/2 0)  (an other instance of X, in another Brillouin zone)
  L (1/2 1/2 1/2)   (conventional cartesian coordinate  1/4 1/4 1/4)
  L&#39;(1/2 0   0  )   (conventional cartesian coordinate -1/4 1/4 1/4) (an other instance of L, on another face of the BZ)
  W (1/4 1/2 3/4)   (conventional cartesian coordinate 1/2 1/4 0)
  U (1/4 5/8 5/8)   (conventional cartesian coordinate 1/2 1/8 1/8)
  K (3/8 3/8 3/4)   (conventional cartesian coordinate 3/8 3/8 0)
</code></pre></div>

<p>Note that K is actually equivalent to U, by spatial and translational
symmetry. So, if you want to specify a typical circuit, the following might do
the work: L-Gamma-X-W-K,U-L-W-X-K,U-Gamma with</p>
<div class="codehilite"><pre><span></span><code>  kptbounds  1/2 0 0  0 0 0  0 1/2 1/2  1/4 1/2 3/4  3/8 3/8 3/4  1/2 1/2 1/2  1/4 1/2 3/4  1/2 1/2 1  3/8 3/8 3/4  0 0 0
</code></pre></div>

<p>The lengths of segments (this information is useful to draw the band
structure, with the correct relative scale between special points) can be
found using the conventional cartesian coordinates:</p>
<p><span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(L-Gamma)=<span><span class="MathJax_Preview">\sqrt{3}/4=</span><script type="math/tex">\sqrt{3}/4=</script></span>0.433&hellip; \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(Gamma-X)=<span><span class="MathJax_Preview">1/2</span><script type="math/tex">1/2</script></span>=0.5 \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(X-W)=<span><span class="MathJax_Preview">1/4</span><script type="math/tex">1/4</script></span>=0.25 \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(W-K)=<span><span class="MathJax_Preview">\sqrt{2}/8</span><script type="math/tex">\sqrt{2}/8</script></span>=0.177&hellip; \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(K-L)=<span><span class="MathJax_Preview">\sqrt{6}/8</span><script type="math/tex">\sqrt{6}/8</script></span>=0.306&hellip; \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(L-W)=<span><span class="MathJax_Preview">\sqrt{2}/4</span><script type="math/tex">\sqrt{2}/4</script></span>=0.354&hellip; \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(W-X)=<span><span class="MathJax_Preview">1/4</span><script type="math/tex">1/4</script></span>=0.25 \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(X-K)=<span><span class="MathJax_Preview">\sqrt{2}/8</span><script type="math/tex">\sqrt{2}/8</script></span>=0.177&hellip; \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(K-Gamma)=<span><span class="MathJax_Preview">3\sqrt{2}/8</span><script type="math/tex">3\sqrt{2}/8</script></span>=0.530&hellip; \n</p>
<p>B. <strong>BCC lattice</strong></p>
<p>Suppose the primitive vectors in real space are given by</p>
<div class="codehilite"><pre><span></span><code>  rprim  -1 1 1    1 -1 1    1 1 -1
</code></pre></div>

<p>(as for the FCC lattice, there is a scale invariance). Then, the reciprocal
primitive vectors (in conventional cartesian coordinates) are (0 &frac12; &frac12;),
(&frac12; 0 &frac12;), and (&frac12; &frac12; 0) and the coordinates of several special points
with respect to primitive vectors in reciprocal space are</p>
<div class="codehilite"><pre><span></span><code>  H (-1/2 1/2 1/2)   (conventional cartesian coordinate 1/2 0 0)
  N ( 0   0   1/2)   (conventional cartesian coordinate 1/4 1/4 0)
  P ( 1/4 1/4 1/4)   (conventional cartesian coordinate 1/4 1/4 1/4)
</code></pre></div>

<p>So, if you want to specify a typical circuit, the following might do the work: Gamma-H-N-Gamma-P-N-P-H</p>
<div class="codehilite"><pre><span></span><code>  kptbounds  0 0 0  -1/2 1/2 1/2  0 0 1/2  0 0 0   1/4 1/4 1/4  0 0 1/2  1/4 1/4 1/4  -1/2 1/2 1/2
</code></pre></div>

<p>The lengths of segments (this information is useful to draw the band
structure, with the correct relative scale between special points) can be
found using the conventional cartesian coordinates:</p>
<p><span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(Gamma-H)=<span><span class="MathJax_Preview">1/2</span><script type="math/tex">1/2</script></span>=0.5 \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(H-N)=<span><span class="MathJax_Preview">\sqrt{2}/4</span><script type="math/tex">\sqrt{2}/4</script></span>=0.354&hellip; \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(N-Gamma)=<span><span class="MathJax_Preview">\sqrt{2}/4</span><script type="math/tex">\sqrt{2}/4</script></span>=0.354&hellip; \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(Gamma-P)=<span><span class="MathJax_Preview">\sqrt{3}/4</span><script type="math/tex">\sqrt{3}/4</script></span>=0.433&hellip; \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(P-N)=<span><span class="MathJax_Preview">1/4</span><script type="math/tex">1/4</script></span>=0.25 \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(N-P)=<span><span class="MathJax_Preview">1/4</span><script type="math/tex">1/4</script></span>=0.25 \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(P-H)=<span><span class="MathJax_Preview">\sqrt{3}/4</span><script type="math/tex">\sqrt{3}/4</script></span>=0.433&hellip; \n</p>
<p>C. <strong>Hexagonal lattices</strong></p>
<p>Suppose the primitive vectors in real space are given by</p>
<div class="codehilite"><pre><span></span><code>  rprim  1 0 0    -1/2 sqrt(0.75) 0    0 0 1
</code></pre></div>

<p>The coordinates of several special points with respect to primitive vectors in
reciprocal space are</p>
<div class="codehilite"><pre><span></span><code>  M (1/2 0 0) or (0 1/2 0) or (-1/2 1/2 0)
  L (1/2 0 1/2) or (0 1/2 1/2) or (-1/2 1/2 1/2)
  K (1/3 1/3 0) or (2/3 -1/3 0) or (-1/3 2/3 0)
  H (1/3 1/3 1/2) or (2/3 -1/3 1/2) or (-1/3 2/3 1/2)
  A (0 0 1/2)
</code></pre></div>

<p>So, if you want to specify a typical circuit, the following
might do the work: K-Gamma-M-K-H-A-L-H-L-M-Gamma-A</p>
<div class="codehilite"><pre><span></span><code>  kptbounds  1/3 1/3 0  0 0 0  1/2 0 0  1/3 1/3 0  1/3 1/3 1/2  0 0 1/2  1/2 0 1/2  1/3 1/3 1/2  1/2 0 1/2  1/2 0 0  0 0 0  0 0 1/2
</code></pre></div>

<p>In order to find the lengths of segments (this information is useful to draw
the band structure, with the correct relative scale between special points)
one needs to know the a and c lattice parameters. Also, in what follows, we
omit the 2<span><span class="MathJax_Preview">\pi</span><script type="math/tex">\pi</script></span> factor sometimes present in the definition of the reciprocal
space vectors. The reciprocal vectors are <span><span class="MathJax_Preview">(1/a\: 1/(\sqrt{3}a)\: 0)</span><script type="math/tex">(1/a\: 1/(\sqrt{3}a)\: 0)</script></span>, <span><span class="MathJax_Preview">(0\: 2/(\sqrt{3}a)\: 0)</span><script type="math/tex">(0\: 2/(\sqrt{3}a)\: 0)</script></span>,
 <span><span class="MathJax_Preview">(0\: 0\: 1/c)</span><script type="math/tex">(0\: 0\: 1/c)</script></span>. The lengths of the above-mentioned segments can
be computed as:</p>
<p><span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(K-Gamma)=<span><span class="MathJax_Preview">2/(3a)</span><script type="math/tex">2/(3a)</script></span>=0.666&hellip;/a \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(Gamma-M)=<span><span class="MathJax_Preview">1/(\sqrt{3}a)</span><script type="math/tex">1/(\sqrt{3}a)</script></span>=0.577&hellip;/a \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(M-K)=<span><span class="MathJax_Preview">1/(3a)</span><script type="math/tex">1/(3a)</script></span>=0.333&hellip;/a \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(K-H)=<span><span class="MathJax_Preview">1/(2c)</span><script type="math/tex">1/(2c)</script></span>=0.5&hellip;/c \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(H-A)=<span><span class="MathJax_Preview">2/(3a)</span><script type="math/tex">2/(3a)</script></span>=0.666&hellip;/a \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(A-L)=<span><span class="MathJax_Preview">1/(\sqrt{3}a)</span><script type="math/tex">1/(\sqrt{3}a)</script></span>=0.577&hellip;/a \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(L-H)=<span><span class="MathJax_Preview">1/(3a)</span><script type="math/tex">1/(3a)</script></span>=0.333&hellip;/a \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(H-L)=<span><span class="MathJax_Preview">1/(3a)</span><script type="math/tex">1/(3a)</script></span>=0.333&hellip;/a \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(L-M)=<span><span class="MathJax_Preview">1/(2c)</span><script type="math/tex">1/(2c)</script></span>=0.5&hellip;/c \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(M-Gamma)=<span><span class="MathJax_Preview">1/(\sqrt{3}a)</span><script type="math/tex">1/(\sqrt{3}a)</script></span>=0.577&hellip;/a \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(Gamma-A)=<span><span class="MathJax_Preview">1/(2c)</span><script type="math/tex">1/(2c)</script></span>=0.5&hellip;/c \n</p>
<p>D. <strong>Rhombohedral lattices</strong></p>
<p>Rhombohedral lattices are characterised by two parameters, the length of the
primitive vectors, that we will denote a0, and the angle they form, <span><span class="MathJax_Preview">\gamma</span><script type="math/tex">\gamma</script></span>.
These can be directly input of ABINIT, as <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#angdeg">angdeg</a></p>
<p>This will generate the primitive vectors in real space, with</p>
<div class="codehilite"><pre><span></span><code>  acell a0 a0 a0    and      rprim  a 0 c    -a/2 a*sqrt(0.75) c    -a/2 -a*sqrt(0.75) c
</code></pre></div>

<p>with,</p>
<ul>
<li><span><span class="MathJax_Preview">a^2+c^2=1</span><script type="math/tex">a^2+c^2=1</script></span>,</li>
<li><span><span class="MathJax_Preview">a^2=2/3(1-\cos(\gamma))</span><script type="math/tex">a^2=2/3(1-\cos(\gamma))</script></span>,</li>
<li><span><span class="MathJax_Preview">c^2=1/3(1+2\cos(\gamma))</span><script type="math/tex">c^2=1/3(1+2\cos(\gamma))</script></span>,</li>
<li><span><span class="MathJax_Preview">(a/c)^2=2(1-\cos(\gamma))/(1+2\cos(\gamma))</span><script type="math/tex">(a/c)^2=2(1-\cos(\gamma))/(1+2\cos(\gamma))</script></span>, and also</li>
<li><span><span class="MathJax_Preview">\cos(\gamma)=(1-(a/c)^2/2)/(1+(a/c)^2)</span><script type="math/tex">\cos(\gamma)=(1-(a/c)^2/2)/(1+(a/c)^2)</script></span>.</li>
</ul>
<p>Alternatively, these values of <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>
might directly be the input of ABINIT (then, the balance of the scaling factor
might be adjusted between <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>).</p>
<p>Unlike for the simple cubic, FCC, BCC, hexagonal (and some other) Bravais
lattice, the topology of the Brillouin zone will depend on the <span><span class="MathJax_Preview">\gamma</span><script type="math/tex">\gamma</script></span> (or <span><span class="MathJax_Preview">a/c</span><script type="math/tex">a/c</script></span>)
value. We give below information concerning the case when <span><span class="MathJax_Preview">\cos(\gamma)</span><script type="math/tex">\cos(\gamma)</script></span> is
positive, that is, <span><span class="MathJax_Preview">(a/c)^2</span><script type="math/tex">(a/c)^2</script></span> lower than 2.</p>
<p>The coordinates of several special points with respect to primitive vectors in
reciprocal space will not depend on the <span><span class="MathJax_Preview">a/c</span><script type="math/tex">a/c</script></span> ratio, but some others will depend
on it. So, some care has to be exercised. Notations for the Brillouin Zone
special points are the same as in <a class="wikilink citation-wikilink" data-tippy-content="First-principles study of As, Sb, and Bi electronic properties" data-toggle="popover" href="/theory/bibliography#gonze1990">[Gonze1990]</a>.</p>
<div class="codehilite"><pre><span></span><code>  L (1/2 0 0) or (0 1/2 0) or (0 0 1/2) (or with negative signs)
  T (1/2 1/2 1/2)
  X (1/2 1/2 0) or (1/2 0 1/2) or (0 1/2 1/2) (or with separate negative signs)
  W (5/6 - (a/c)^2/6, 1/2, 1/6 + (a/c)^2/6 ) = (1 0 -1)*(1-(a/c)^2/2)/3 + (1 1 1)/2
  U ( (1+(a/c)^2)/6, (8-(a/c)^2)/12, (8-(a/c)^2)/12 ) = (-1 1/2 1/2)*(1-(a/c)^2/2)/3 + (1 1 1)/2
  K (1 0 -1)*(1+(a/c)^2/4)/3
</code></pre></div>

<p>So, if you want to specify a typical circuit, the following might do the work
(the representative points on lines of symmetry are indicated - there are
sometimes more than one way to go from one point to another): X-V-K-Sigma-
Gamma-Lambda-T-Q-W-Y-L-sigma-Gamma-sigma-X. The suggestion is to sample this
path with the following coordinates for the special points X, Gamma, T, L, Gamma, X:</p>
<div class="codehilite"><pre><span></span><code>  kptbounds  1/2 0 -1/2   0 0 0    1/2 1/2 1/2  1 1/2 0   1 0 0  1 1/2 1/2
</code></pre></div>

<p>In order to find the lengths of segments (this information is useful to draw
the band structure, with the correct relative scale between special points)
one needs to know the a and c lattice parameters. Also, in what follows, we
omit the <span><span class="MathJax_Preview">2\pi</span><script type="math/tex">2\pi</script></span> factor sometimes present in the definition of the reciprocal
space vectors. The reciprocal vectors are <span><span class="MathJax_Preview">( 2/(3a)\: 0\: 1/(3c) )</span><script type="math/tex">( 2/(3a)\: 0\: 1/(3c) )</script></span>, <span><span class="MathJax_Preview">( -1/(3a)\:
1/(\sqrt{3}a)\: 1/(3c) )</span><script type="math/tex">( -1/(3a)\:
1/(\sqrt{3}a)\: 1/(3c) )</script></span>, <span><span class="MathJax_Preview">( -1/(3a)\: -1/(\sqrt{3}a)\: 1/(3c) )</span><script type="math/tex">( -1/(3a)\: -1/(\sqrt{3}a)\: 1/(3c) )</script></span>. The lengths of the
above-mentioned segments can be computed as:</p>
<p><span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(X-Gamma)=<span><span class="MathJax_Preview">2/(\sqrt{3}a)</span><script type="math/tex">2/(\sqrt{3}a)</script></span>=1.155&hellip;/a \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(K-Gamma)=<span><span class="MathJax_Preview">4(1+(a/c)^2/4)/(3\sqrt{3}a)</span><script type="math/tex">4(1+(a/c)^2/4)/(3\sqrt{3}a)</script></span> \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(Gamma-T)=<span><span class="MathJax_Preview">1/(2c)</span><script type="math/tex">1/(2c)</script></span> \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(T-L)=<span><span class="MathJax_Preview">2/(\sqrt{3}a)</span><script type="math/tex">2/(\sqrt{3}a)</script></span>=1.155&hellip;/a \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(T-W)=<span><span class="MathJax_Preview">4(1-(a/c)^2/2)/(3\sqrt{3}a)</span><script type="math/tex">4(1-(a/c)^2/2)/(3\sqrt{3}a)</script></span> \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(L-Gamma)=<span><span class="MathJax_Preview">\sqrt{4/(a^2)+1/(c^2)}/3</span><script type="math/tex">\sqrt{4/(a^2)+1/(c^2)}/3</script></span> \n
<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>(Gamma-X)=<span><span class="MathJax_Preview">2\sqrt{1/(a^2)+1/(c^2)}/3</span><script type="math/tex">2\sqrt{1/(a^2)+1/(c^2)}/3</script></span> \n</p>
<h2 id="kptrlatt"><strong>kptrlatt</strong><a class="headerlink" href="#kptrlatt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K - PoinTs grid: Real space LATTice<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,3)<br />
<em>Default value:</em> <em>0<br />
*The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [69/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/paral/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline AlAs : computation of the total energy" data-toggle="popover" href="/tests/tutorespfn/Input/trf1_1.abi" target="_blank">trf1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline AlAs : computation of the total energy
and forces in a distorted geometry" data-toggle="popover" href="/tests/tutorespfn/Input/trf1_2.abi" target="_blank">trf1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline AlAs : computation of the second derivative of the total energy" data-toggle="popover" href="/tests/tutorespfn/Input/trf1_3.abi" target="_blank">trf1_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : computation of the total energy
Convergence with respect to the number of k points." data-toggle="popover" href="/tests/tutorial/Input/tbase3_3.abi" target="_blank">tbase3_3.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Helium q close to Gamma, along Gamma-H
There is a problem with kptopt=1 or 3 for the NSC step." data-toggle="popover" href="/tests/v2/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tin in the diamond structure, with 2 special points
Test the effect of spin-orbit coupling, especially the
electronic structure.
Degeneracies at Gamma are correct !
(note that ecut and nkpt are too low for quantitative accuracy)
Without spin-orbit (in eV), dataset 4:
-8.82682  1.26955 (x3) 1.30262 3.45296 (x3)
With spin-orbit (in eV), dataset 6:
-8.82682  0.75225      1.30262 1.50965 (x2) 3.07128 3.62556 (x2)" data-toggle="popover" href="/tests/v2/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Nb BCC along the Gamma-H direction
Remnant of the bug search of winter 2000-2001." data-toggle="popover" href="/tests/v2/Input/t99.abi" target="_blank">t99.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test different ways to obtain the NiO antiferromagnetic structure" data-toggle="popover" href="/tests/v3/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a DDB file generating run which prepares for the calculation #70.
The material is Crystalline AlAs (face-center cubic), with ecut=3 Hartree.
Response function calculations are with respect to electric field, strain,
and displacement." data-toggle="popover" href="/tests/v4/Input/t69.abi" target="_blank">t69.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms per cell
Test computation of the local exact exchange (PBE0) in PAW." data-toggle="popover" href="/tests/v5/Input/t18.abi" target="_blank">t18.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ga Al(1-x) Asx
Test of alchemical calculations with images.
Mostly checking the treatment of input variables and their echo.
(Tests 30-36 are more slots for testing the ground state)" data-toggle="popover" href="/tests/v6/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrO2 FCC (fluorite structure).
Compute the phonon frequencies at the X point.
This worked correctly before 5.2.4, but then, an erroneous bug fix (correcting v5#21) was introduced.
Final (correct) fixing in v6.0.4.
(Contributed by I. Lukacevic, trying to reproduce results by Detraux et al 1997)" data-toggle="popover" href="/tests/v6/Input/t36.abi" target="_blank">t36.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test new integration method and grid options for the integral
along the imaginary axis in contour deformation calculations." data-toggle="popover" href="/tests/v67mbpt/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fake c-face-centered orthorhombic lattice
This test checks the capability of ABINIT to treat homogeneous sets of shiftk values, and to recover the correct kptrlen value" data-toggle="popover" href="/tests/v7/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test generation of k-point mesh with kptrlatt and shiftk.
version 8.0.8b was stopping at the level of the parser." data-toggle="popover" href="/tests/v8/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO polaron effective mass along different direction: 100,110,111.
Frohlich ZPR is also computed.
Method available only for cubic materials." data-toggle="popover" href="/tests/v9/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different versions of PAW+U formalism are tested.
Negative values of usepawu should give exactly the same results as with positive values.
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v9/Input/t79.abi" target="_blank">t79.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test various values of nbdbuf with lobpcg (114)." data-toggle="popover" href="/tests/v9/Input/t201.abi" target="_blank">t201.abi</a> &hellip;</li>
</ul>
</details>
<p>This input variable is used only when <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> is positive. It partially
defines the k point grid. The other piece of information is contained in
<a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>.  <strong>kptrlatt</strong>  cannot be used together with <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>.</p>
<p>The values  <strong>kptrlatt</strong> (1:3,1),  <strong>kptrlatt</strong> (1:3,2),  <strong>kptrlatt</strong> (1:3,3) are the
coordinates of three vectors in real space, expressed in the <a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>
coordinate system (reduced coordinates). They define a super-lattice in real
space. The k point lattice is the reciprocal of this super-lattice, possibly shifted (see <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>).</p>
<p>If neither <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> nor  <strong>kptrlatt</strong>  are defined, ABINIT will automatically
generate a set of k point grids, and select the best combination of
 <strong>kptrlatt</strong>  and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> that allows one to reach a sufficient value of
<a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlen">kptrlen</a>. See this latter variable for a complete description of this procedure.</p>
<h2 id="kptrlen"><strong>kptrlen</strong><a class="headerlink" href="#kptrlen" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K - PoinTs grid: Real space LENgth<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 30.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the mechanism for checking the presence of vacuum.
Use H2 molecule, placed in a big box." data-toggle="popover" href="/tests/v2/Input/t58.abi" target="_blank">t58.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2D hexagonal lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t61.abi" target="_blank">t61.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2D square lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2D 4 point symmetry: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2D rectangular lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2D centered lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t65.abi" target="_blank">t65.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2D oblique lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3D cP lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3D cF lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3D cI lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3D tP lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3D tI lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3D hR lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3D hP lattice: test the sets of k points generated automatically" data-toggle="popover" href="/tests/v2/Input/t73.abi" target="_blank">t73.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test new integration method and grid options for the integral
along the imaginary axis in contour deformation calculations." data-toggle="popover" href="/tests/v67mbpt/Input/t22.abi" target="_blank">t22.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Fake c-face-centered orthorhombic lattice
This test checks the capability of ABINIT to treat homogeneous sets of shiftk values, and to recover the correct kptrlen value" data-toggle="popover" href="/tests/v7/Input/t14.abi" target="_blank">t14.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization." data-toggle="popover" href="/tests/v8/Input/t95.abi" target="_blank">t95.abi</a></li>
</ul>
</details>
<p>This input variable is used only when <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> is positive and non-zero.</p>
<p>Preliminary explanation:
The k point lattice defined by <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> is used to perform
integrations of periodic quantities in the Brillouin Zone, like the density or
the kinetic energy. One can relate the error made by replacing the continuous
integral by a sum over k point lattice to the Fourier transform of the
periodic quantity. Erroneous contributions will appear only for the vectors in
real space that belong to the reciprocal of the k point lattice, except the
origin. Moreover, the expected size of these contributions usually decreases
exponentially with the distance. So, the length of the smallest of these real
space vectors is a measure of the accuracy of the k point grid.</p>
<p>When either <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> is defined,  <strong>kptrlen</strong>  is not used as
an input variable, but the length of the smallest vector will be placed in
this variable, and echoed in the output file.</p>
<p>On the other hand, when neither <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> nor <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> are defined, ABINIT
will automatically generate a large set of possible k point grids, and select
among this set, the grids that give a length of smallest vector LARGER than
 <strong>kptrlen</strong> , and among these grids, the one that, when used with <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 1,
reduces to the smallest number of k points. Note that this procedure can be
time-consuming. It is worth doing it once for a given unit cell and set of
symmetries, but not use this procedure by default. The best is then to set
<a class="wikilink codevar-wikilink" href="/variables/files#prtkpt">prtkpt</a> = 1, in order to get a detailed analysis of the set of grids.</p>
<p>If some layer of vacuum is detected in the unit cell (see the input variable
<a class="wikilink codevar-wikilink" href="/variables/gstate#vacuum">vacuum</a>), the computation of  <strong>kptrlen</strong>  will ignore the dimension related
to the direction perpendicular to the vacuum layer, and generate a bi-
dimensional k point grid. If the system is confined in a tube, a one-
dimensional k point grid will be generated. For a cluster, this procedure will
only generate the Gamma point.</p>
<h2 id="magcon_lambda"><strong>magcon_lambda</strong><a class="headerlink" href="#magcon_lambda" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MAGnetization CONstraint LAMBDA parameter<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation with constrained atomic magnetic moments" data-toggle="popover" href="/topics/MagMom">topic_MagMom</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.01<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [13/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation with constrained charges
Constrain the charge around atom 1 to the value 0.5, then work with both atoms and larger spheres

For dataset 2, the derivative wrt the constraint, the derivative of the total energy with respect to atomic displacement
and the stress calculations have been checked, as follows.

Initially, the total energy is -0.99164352451, the target charge is 0.5, and the gradient wrt the charge is computed -0.58356219787.
Changing the target charge by +0.001 gives etotal -0.99222576777
Changing the target charge by -0.001 gives etotal -0.99105864425
Finite-difference gives -0.5835617, in excellent agreement for that level of methodology.

For atom 1, dE/dtau (=-force in reduced coordinate) is computed 8.330114676.
Changing the atomic position of the first atom from -1.1 to -1.10015
gives etotal -0.99172669330, to -1.09985 gives etotal -0.99156009221, delivering 8.330054.
The result of a similar finite-difference estimation with twice bigger values gives 8.329896.
Combining both results to eliminate the quadratic error gives 8.330107, with an agreement of 5 digits with dE/dtau.

The stress is computed 2.755820639e-4 .
Multiplying both acell and xcart by 1.001 gives etotal -0.99122698240.
Multiplying both acell and xcart by 0.999 gives etotal -0.99205366103.
The derivative of total energy wrt to strain is thus 0.41333932. Dividing by the unit cell volume (1500) gives 2.75559e-4 ,
in excellent agreement for that level of methodology." data-toggle="popover" href="/tests/v8/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
Check jointly the charge and vector magnetization constraints, with differing vector orientations." data-toggle="popover" href="/tests/v8/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction" data-toggle="popover" href="/tests/v8/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2 with sphere overlap
DS2 Constrains the collinear magnetization around atom 1 to be +0.70 and around atom 2 to be -0.70
DS3 Constrains the collinear magnetization around atom 1 to be +0.70 and around atom 2 to be -0.70, and the total charge of both to be 0.00.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.70 and around atom 2 to be -0.70. Same result as DS2.
DS5 and DS6 are not really useful, simply sanity checks for imposition of axis or direction of magnetization for collinear magnetism" data-toggle="popover" href="/tests/v8/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction.
Case where the spheres overlap
Interestingly, in the case where only the magnitude of the magnetization on the second atom is fixed,
without fixing its charge, the optimal configuration gives a 90 degree difference of magnetization direction for both atoms.
It would be interesting to understand the meaning of such results, and see whether one is not in a local minimum.
A full mapping of the energy as a function of both magnitude and direction of the magnetization of the second atom would be interesting ..." data-toggle="popover" href="/tests/v8/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization." data-toggle="popover" href="/tests/v8/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization.
At present DS31 and DS32 do not work as expected ..." data-toggle="popover" href="/tests/v8/Input/t96.abi" target="_blank">t96.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization.
At present DS21, 31 and 32 do not work as expected. Hence the huge tolerance." data-toggle="popover" href="/tests/v8/Input/t97.abi" target="_blank">t97.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a></li>
</ul>
</details>
<p>This variable gives the amplitude of the penalty function imposed on the
magnetization vectors on each atom (turned on with flag variable
<a class="wikilink codevar-wikilink" href="/variables/gstate#magconon">magconon</a>=1 to 3). Typical values for  <strong>magcon_lambda</strong>  are 0.001 to 0.1. The SCF convergence
will be difficult if  <strong>magcon_lambda</strong>  is too large. If  <strong>magcon_lambda</strong>  is too small, the
penalty will not be very effective and it will give magnetization not close
to the desired <a class="wikilink codevar-wikilink" href="/variables/gstate#spinat">spinat</a> target. In case of convergence problem, it can help
to start with a small value of  <strong>magcon_lambda</strong>  and to increase it by reading the
wavefunction obtained with a lower  <strong>magcon_lambda</strong>  value. See variable <a class="wikilink codevar-wikilink" href="/variables/gstate#magconon">magconon</a> for more details.</p>
<h2 id="magconon"><strong>magconon</strong><a class="headerlink" href="#magconon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> turn MAGnetization CONstraint ON<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation with constrained atomic magnetic moments" data-toggle="popover" href="/topics/MagMom">topic_MagMom</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a></li>
</ul>
</details>
<p>Turns on the imposition of a constraint on the magnetization, using a penalty function. For
each atom, the magnetization is calculated in a sphere (radius <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a>) and
a penalty function is applied to bring it to the input values of <a class="wikilink codevar-wikilink" href="/variables/gstate#spinat">spinat</a>.
The constraint can be either on the direction/axis only ( <strong>magconon</strong>  = 1) or on the full
vector ( <strong>magconon</strong>  = 2). The penalty function has an amplitude
<a class="wikilink codevar-wikilink" href="/variables/gstate#magcon_lambda">magcon_lambda</a> that should be neither too big (bad or impossible convergence) nor too small (no effect).
The penalty function is documented in <a class="wikilink citation-wikilink" data-tippy-content="Constrained density functional for noncollinear magnetism" data-toggle="popover" href="/theory/bibliography#ma2015">[Ma2015]</a> as being a Lagrange
approach, which is a misnomer for the algorithm that they describe. It has the drawback of being unable to deliver
the exact sought value for the magnetization. So, the true Lagrange approach has to be preferred, except for testing purposes.
This is provided by the algorithm governed by the input variable <a class="wikilink codevar-wikilink" href="/variables/gstate#constraint_kind">constraint_kind</a>, which is actually also much more flexible
than the implementation corresponding to  <strong>magconon</strong> .</p>
<p>Final subtlety: when  <strong>magconon</strong>  = 1, if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>==2 (collinear case), then the direction of magnetization is constraint (positive or negative along z),
while if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>==4, then the axis of magnetization is constraint (the actual direction is not imposed, both directions are equivalent). This might be
confusing.</p>
<h2 id="mixalch"><strong>mixalch</strong><a class="headerlink" href="#mixalch" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MIXing coefficients for ALCHemical potentials<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">EVOLVING</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the types of atoms that form the system" data-toggle="popover" href="/topics/AtomTypes">topic_AtomTypes</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/gstate#npspalch">%npspalch</a>,<a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a>)<br />
<em>Default value:</em> None<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms (well, with no mixing, just for a test)
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
The first psp is Si, the second one is Ge, but the
mixing coefficients are 1.0 and 0.0 .
See test 4 of v2, except with alchemy." data-toggle="popover" href="/tests/v3/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Ge, the second one is Si, but the
mixing coefficients are 0.0 and 1.0 .
See previous test, except GS only, and the two atoms are switched." data-toggle="popover" href="/tests/v3/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Si, the second one is Si, the
mixing coefficients are 0.2 and 0.8 , then, in a second
dataset, they are 0.5 and 0.5 .
Should give same numerical results as the previous test." data-toggle="popover" href="/tests/v3/Input/t94.abi" target="_blank">t94.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Si, the second one is Ge, the
mixing coefficients are 0.2 and 0.8, then
0.5 and 0.5 , then 0.001 and 0.999 ." data-toggle="popover" href="/tests/v3/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Si, the second one is Ge, the
mixing coefficients are 0.5 and 0.5 . The
pseudopotentials differ from the ones of test #93 ." data-toggle="popover" href="/tests/v3/Input/t96.abi" target="_blank">t96.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fake MoSixO(1-x) molecule along the diagonal of a cube,
using alchemical pseudopotentials.
Si and O are not isovalent, so might not be
physically meaningful.
4 pairs of mixing coefficients are studied, including
one for which the occupation numbers becomes fractionary." data-toggle="popover" href="/tests/v3/Input/t97.abi" target="_blank">t97.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth atom, isolated, in a supercell.
Try alchemical pseudopotentials with spin-orbit.
Spinor calculation (nspinor=2, nspden=1, nsppol=1)
Metallic occupations.
Also compare the halved spin-orbit interaction alchemical mixing
with a pseudopotential directly prepared with halved spin-orbit interaction.
The agreement is perfect." data-toggle="popover" href="/tests/v5/Input/t44.abi" target="_blank">t44.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ga Al(1-x) Asx
Test of alchemical calculations with images.
Mostly checking the treatment of input variables and their echo.
(Tests 30-36 are more slots for testing the ground state)" data-toggle="popover" href="/tests/v6/Input/t28.abi" target="_blank">t28.abi</a></li>
</ul>
</details>
<p>Used for the generation of alchemical pseudoatoms, that is, when <a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a> is non-zero.</p>
<p>This array gives, for each type of alchemical pseudo-atom (there are
<a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a> such pseudoatoms), the mixing coefficients of the basic
<a class="wikilink codevar-wikilink" href="/variables/gstate#npspalch">%npspalch</a> pseudopotentials for alchemical use. For each type of alchemical
pseudoatom, the sum of the mixing coefficients must equal 1.</p>
<p>The actual use of the mixing coefficients is defined by the input variable
<a class="wikilink codevar-wikilink" href="/variables/gstate#algalch">algalch</a>. Note that the masses of the atoms, <a class="wikilink codevar-wikilink" href="/variables/rlx#amu">amu</a> are also mixed
according to the value of  <strong>mixalch</strong> , by default.</p>
<p>Example 1. Suppose that we want to describe Ba(0.25) Sr(0.75) Ti O<span><span class="MathJax_Preview">_3</span><script type="math/tex">_3</script></span>.
The input variables related to the construction of the alchemical Ba(0.25)
Sr(0.75) potential will be:</p>
<div class="codehilite"><pre><span></span><code>  <span class="nv">npsp</span>   <span class="mi">4</span>                 <span class="o">!</span> <span class="mi">4</span> <span class="nv">pseudopotentials</span> <span class="nv">should</span> <span class="nv">be</span> <span class="nv">read</span>.
  <span class="nv">znucl</span>  <span class="mi">8</span> <span class="mi">40</span> <span class="mi">56</span> <span class="mi">38</span>        <span class="o">!</span> <span class="nv">The</span> <span class="nv">nuclear</span> <span class="nv">charges</span>. <span class="nv">Note</span> <span class="nv">that</span> <span class="nv">the</span> <span class="nv">two</span>
                           <span class="o">!</span> <span class="nv">atoms</span> <span class="nv">whose</span> <span class="nv">pseudopotentials</span> <span class="nv">are</span> <span class="nv">to</span> <span class="nv">be</span> <span class="nv">mixed</span>
                           <span class="o">!</span> <span class="nv">are</span> <span class="nv">mentioned</span> <span class="nv">at</span> <span class="nv">the</span> <span class="k">end</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">series</span>.
  <span class="nv">ntypat</span>  <span class="mi">3</span>                <span class="o">!</span> <span class="nv">There</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">three</span> <span class="nv">types</span> <span class="nv">of</span> <span class="nv">atoms</span>.
  <span class="nv">ntypalch</span>   <span class="mi">1</span>             <span class="o">!</span> <span class="nv">One</span> <span class="nv">pseudoatom</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">alchemical</span>.
                           <span class="o">!</span> <span class="nv">Hence</span>, <span class="nv">there</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">ntyppure</span><span class="o">=</span><span class="mi">2</span> <span class="nv">pure</span> <span class="nv">pseudo</span><span class="o">-</span><span class="nv">atoms</span>,
                           <span class="o">!</span> <span class="nv">with</span> <span class="nv">znucl</span> <span class="mi">8</span> <span class="ss">(</span><span class="nv">O</span><span class="ss">)</span> <span class="nv">and</span> <span class="mi">40</span> <span class="ss">(</span><span class="nv">Ti</span><span class="ss">)</span>, <span class="nv">corresponding</span> <span class="nv">to</span>
                           <span class="o">!</span> <span class="nv">the</span> <span class="nv">two</span> <span class="nv">first</span> <span class="nv">pseudopotentials</span>. <span class="nv">Out</span> <span class="nv">of</span> <span class="nv">the</span>
                           <span class="o">!</span> <span class="nv">four</span> <span class="nv">pseudopotentials</span>, <span class="nv">npspalch</span><span class="o">=</span><span class="mi">2</span> <span class="nv">are</span> <span class="nv">left</span>
                           <span class="o">!</span> <span class="k">for</span> <span class="nv">alchemical</span> <span class="nv">purposes</span>, <span class="nv">with</span> <span class="nv">znucl</span> <span class="mi">56</span> <span class="ss">(</span><span class="nv">Ba</span><span class="ss">)</span>
                           <span class="o">!</span> <span class="nv">and</span> <span class="mi">38</span> <span class="ss">(</span><span class="nv">Sr</span><span class="ss">)</span>.
  <span class="nv">mixalch</span>    <span class="mi">0</span>.<span class="mi">25</span>  <span class="mi">0</span>.<span class="mi">75</span>    <span class="o">!</span> <span class="k">For</span> <span class="nv">that</span> <span class="nv">unique</span> <span class="nv">pseudo</span><span class="o">-</span><span class="nv">atom</span> <span class="nv">to</span> <span class="nv">be</span>
                           <span class="o">!</span> <span class="nv">generated</span>, <span class="nv">here</span> <span class="nv">are</span> <span class="nv">the</span> <span class="nv">mixing</span> <span class="nv">coefficients</span>,
                           <span class="o">!</span> <span class="nv">to</span> <span class="nv">be</span> <span class="nv">used</span> <span class="nv">to</span> <span class="nv">combine</span> <span class="nv">the</span> <span class="nv">Ba</span> <span class="nv">and</span> <span class="nv">Sr</span> <span class="nv">pseudopotentials</span>.
</code></pre></div>

<p>Example 2. More complicated, and illustrate some minor drawback of the design
of input variables. Suppose that one wants to generate Al(0.25)Ga(0.75)
As(0.10)Sb(0.90).
The input variables will be:</p>
<div class="codehilite"><pre><span></span><code>  <span class="nv">npsp</span>  <span class="mi">4</span>                  <span class="o">!</span> <span class="mi">4</span> <span class="nv">pseudopotentials</span> <span class="nv">should</span> <span class="nv">be</span> <span class="nv">read</span>
  <span class="nv">znucl</span>  <span class="mi">13</span> <span class="mi">31</span> <span class="mi">33</span> <span class="mi">51</span>       <span class="o">!</span> <span class="nv">The</span> <span class="nv">atomic</span> <span class="nv">numbers</span>. <span class="nv">All</span> <span class="nv">pseudopotentials</span>
                           <span class="o">!</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">used</span> <span class="k">for</span> <span class="nv">some</span> <span class="nv">alchemical</span> <span class="nv">purpose</span>
  <span class="nv">ntypat</span>  <span class="mi">2</span>                <span class="o">!</span> <span class="nv">There</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">two</span> <span class="nv">types</span> <span class="nv">of</span> <span class="nv">atoms</span>.
  <span class="nv">ntypalch</span>   <span class="mi">2</span>             <span class="o">!</span> <span class="nv">None</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">atoms</span> <span class="nv">will</span> <span class="nv">be</span> <span class="s2">&quot;</span><span class="s">pure</span><span class="s2">&quot;</span>.
                           <span class="o">!</span> <span class="nv">Hence</span>, <span class="nv">there</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">npspalch</span><span class="o">=</span><span class="mi">4</span> <span class="nv">pseudopotentials</span>
                           <span class="o">!</span>  <span class="nv">to</span> <span class="nv">be</span> <span class="nv">used</span> <span class="k">for</span> <span class="nv">alchemical</span> <span class="nv">purposes</span>.
  <span class="nv">mixalch</span>    <span class="mi">0</span>.<span class="mi">25</span>  <span class="mi">0</span>.<span class="mi">75</span> <span class="mi">0</span>.<span class="mi">0</span>  <span class="mi">0</span>.<span class="mi">0</span>   <span class="o">!</span> <span class="nv">This</span> <span class="nv">array</span> <span class="nv">is</span> <span class="nv">a</span> <span class="ss">(</span><span class="mi">4</span>,<span class="mi">2</span><span class="ss">)</span> <span class="nv">array</span>, <span class="nv">arranged</span> <span class="nv">in</span> <span class="nv">the</span>
             <span class="mi">0</span>.<span class="mi">0</span>   <span class="mi">0</span>.<span class="mi">0</span>  <span class="mi">0</span>.<span class="mi">1</span>  <span class="mi">0</span>.<span class="mi">9</span>   <span class="o">!</span> <span class="nv">usual</span> <span class="nv">Fortran</span> <span class="nv">order</span>.
</code></pre></div>

<p>Minor drawback: one should not forget to fill  <strong>mixalch</strong>  with the needed
zero&rsquo;s, in this later case.</p>
<p>In most cases, the use of  <strong>mixalch</strong>  will be as a static (non-evolving)
variable. However, the possibility to have different values of  <strong>mixalch</strong>  for
different images has been coded. A population of cells with different atomic
characteristics can thus be considered, and can be made to evolve, e.g. with a
genetic algorithm (not coded in v7.0.0 though). There is one restriction to
this possibility: the value of <a class="wikilink codevar-wikilink" href="/variables/internal#ziontypat">%ziontypat</a> for the atoms that are mixed
should be identical.</p>
<h2 id="natsph"><strong>natsph</strong><a class="headerlink" href="#natsph" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of ATomic SPHeres for the atom-projected density-of-states<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic DOS and related topics" data-toggle="popover" href="/topics/ElecDOS">topic_ElecDOS</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute atom-centered properties" data-toggle="popover" href="/topics/AtomCentered">topic_AtomCentered</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a><br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> == 3 or 4 or <a class="wikilink codevar-wikilink" href="/variables/paw#pawfatbnd">pawfatbnd</a> in [1,2]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, with PAW.
Test the IO routines with paral_kgb in [1, 0] and different combinations
of parameters (npfft, npband, np_spkpt).
Test the plane wave load balancing procedure (pw_unbal_thresh).
Test also the computation of PJDOS." data-toggle="popover" href="/tests/mpiio/Input/t26.abi" target="_blank">t26.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PAW1 tutorial
Diamond at experimental volume
Computation of Density of States" data-toggle="popover" href="/tests/tutorial/Input/tpaw1_4.abi" target="_blank">tpaw1_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe fcc structure with two atoms per unit cell for test of antiferromagnetic
This is the simplest fcc structure compatible with a X point spiral" data-toggle="popover" href="/tests/tutorial/Input/tspin_3.abi" target="_blank">tspin_3.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the computation of the partial DOS, using the linear tetrahedron method.
2 Silicon atoms, in a diamond structure." data-toggle="popover" href="/tests/v4/Input/t38.abi" target="_blank">t38.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Density from test 105 is read; then a non self-consistent calculation
is done and the m-decomposed LDOS on the first atom is printed out.
The BCC structure is slightly distorted, in order to decrease the symmetry
and the degeneracies, and allow better portability.
(perhaps PROCAR file could be tested again)." data-toggle="popover" href="/tests/v9/Input/t108.abi" target="_blank">t108.abi</a></li>
</ul>
</details>
<p><strong>natsph</strong>  gives the number of atoms around which the sphere for atom-projected
density-of-states will be built, in the <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> = 3 or 4 case. The
indices of these atoms are given by <a class="wikilink codevar-wikilink" href="/variables/gstate#iatsph">iatsph</a>. The radius of these spheres is given by <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a>.
If <a class="wikilink codevar-wikilink" href="/variables/paw#pawfatbnd">pawfatbnd</a> = 1 or 2, it gives the number of atoms around which atom-projected
band structure will be built (the indices of these atoms are given by <a class="wikilink codevar-wikilink" href="/variables/gstate#iatsph">iatsph</a>).</p>
<h2 id="natsph_extra"><strong>natsph_extra</strong><a class="headerlink" href="#natsph_extra" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of ATomic SPHeres for the l-projected density-of-states in EXTRA set<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute atom-centered properties" data-toggle="popover" href="/topics/AtomCentered">topic_AtomCentered</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> == 3 or 4 or <a class="wikilink codevar-wikilink" href="/variables/paw#pawfatbnd">pawfatbnd</a> in [1,2]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a></li>
</ul>
</details>
<p><strong>natsph_extra</strong>  gives the number of extra spheres for which the angular-
momentum-projected density-of-states will be built, in the <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> = 3 or 4 case.
The radius of these spheres is given by <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph_extra">ratsph_extra</a>. This simulates the
STS signal for an STM tip atom placed at the sphere position, according to the
chemical nature of the tip (s- p- d- wave etc&hellip;).
If <a class="wikilink codevar-wikilink" href="/variables/paw#pawfatbnd">pawfatbnd</a> = 1 or 2, it gives the number of spheres in which <span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>-projected
band structure will be built.
The position of the spheres is given by the <a class="wikilink codevar-wikilink" href="/variables/gstate#xredsph_extra">xredsph_extra</a> variable.</p>
<h2 id="nbdbuf"><strong>nbdbuf</strong><a class="headerlink" href="#nbdbuf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of BanDs for the BUFfer<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to specify bands and occupation numbers, for metals or insulators" data-toggle="popover" href="/topics/BandOcc">topic_BandOcc</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2*<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> if <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 0 and <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&lt;0,
2*<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> if <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 1 and 3&lt;=<a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>&lt;= 8,
0 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [241/1245] in all abinit tests, [22/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2O in isolated boundary conditions (plane waves, NC), try tu use Damiens Poisson cutoff.
Water molecule with HGH pseudo-potentials. This checks that a negative
value in rhor will not make the Poisson solver crashes on XC computation." data-toggle="popover" href="/tests/bigdft/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
Run non-scf (iscf=-2) on 2 special points by reading t5o_DEN.
Eigenvalues should now agree among 05, 06, and 08, except that 08 will
include some unoccupied bands." data-toggle="popover" href="/tests/fast/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Run non-scf (iscf=-2) for Gamma, X, L band structure for Si." data-toggle="popover" href="/tests/fast/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as 11 but with mkmem = 0, mffmem=0 (out-of-core)." data-toggle="popover" href="/tests/fast/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule NON-spin-polarized, in a big box, without tetragonal symmetry, in order to avoid
spurious degeneracy effects coupled to occupation numbers rapidly changing.
GPU
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization." data-toggle="popover" href="/tests/gpu_omp/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite (a polymorph of SiO2)
Test PBEsol in the PAW formalism, using PAW datasets created with atompaw linked with libxc.
Note that the value of ixc is not present in the input file, but it is present in the ATOMPAW dataset (pspxc = -116133)" data-toggle="popover" href="/tests/libxc/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule non-spin-polarized, in a big box.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with underconverged ecut (ecut 18) and box size (5 4 4 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation  (ecut 18, 5 4 4 box) : 1.101, 1.084, 1.085 Angstrom
Better  calculation  (ecut 22, 6 5 5 box) : 1.102, 1.086, 1.086 Angstrom
ABINIT Arnardi report (ecut acell unknown): 1.103, 1.091, 1.092 Angstrom
VASP Arnardi report (ecut acell unknown)  : 1.103, 1.089,  NA   Angstrom
Experimental : 1.098 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule spin-polarized, in a big box.
Norm conserving : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with underconverged ecut (ecut 15) and box size (4 3 3 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation  (ecut 13, 5 4 4 box) : 1.138, 1.130, 1.131 Angstrom
Better  calculation  (ecut 18, 7 6 6 box) : 1.135, 1.124, 1.125 Angstrom
ABINIT Arnardi report (ecut acell unknown): 1.136, 1.124, 1.124 Angstrom
VASP Arnardi report (ecut acell unknown)  : 1.136, 1.124,  NA   Angstrom
Experimental : 1.120 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t68.abi" target="_blank">t68.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs linear response with NC. Test the parallelisation on perturbations" data-toggle="popover" href="/tests/mpiio/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GaAs linear response with NC. Test the parallelisation on perturbations" data-toggle="popover" href="/tests/mpiio/Input/t69.abi" target="_blank">t69.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-toggle="popover" href="/tests/tutoparal/Input/tmbt_1.abi" target="_blank">tmbt_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_6.abi" target="_blank">tw90_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Z2Pack (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tz2_2.abi" target="_blank">tz2_2.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-toggle="popover" href="/tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections
Dataset 1: ground state calculation to get the density
Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ
Dataset 3: calculation of the screening (epsilon^-1 matrix for W)
Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)" data-toggle="popover" href="/tests/tutorial/Input/tgw1_1.abi" target="_blank">tgw1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections
Dataset 1: ground state calculation
Dataset 2: calculation of the WFK file for only Gamma point
Dataset 3: calculation of the screening (epsilon^-1 matrix for W)" data-toggle="popover" href="/tests/tutorial/Input/tgw1_2.abi" target="_blank">tgw1_2.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs crystal (zinc-blende structure), 2 atoms per unit cell.
Computation of responses to atomic displacements
with X-point wavevector, giving the dynamical matrix and
the associated phonon frequencies.
Can be compared to the test gaas.x of RESPFN, provided
the cut-off energy is changed (here 3Ha, in RESPFN, 6Ha)." data-toggle="popover" href="/tests/v2/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
Compares with frozen-phonon calculations. Examine two cases:
varying occupation numbers, and fixed occupation numbers.
A. Varying occupation numbers (occopt=4):
RF calculation in dataset 5 gives
2DE equal to -3.812577 Ha, while finite difference of &quot;TOTAL&quot;
energy (datasets 6 and 7, including entropy term) gives -3.812230 Ha
(the agreement could be better with better finite difference)
B. Fixed occupation numbers (occopt=2):
RF calculation in dataset 8 gives
2DE equal to +5.431807 Ha, while finite difference of total
energy (no entropy term is present with occopt=2) gives +5.431857 Ha
(the agreement could be better with better finite difference)" data-toggle="popover" href="/tests/v2/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 28. The chosen grid (too coarse, though) is
(0 0 0), (1/4 1/4 0), (1/2 1/2 0), (1/2 0 0),
(1/2 1/4 1/4), (1/2 -1/4 1/4)  (in reduced coordinates).
The ecut and nkpt parameters are really too low (see test 28),
but parameters suitable for physical results (see test 29)
are also provided in the input files." data-toggle="popover" href="/tests/v2/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
Compares with frozen-phonon calculations.
Similar to test v2 #11, except use of PBE GGA.
Examine two cases:
varying occupation numbers, and fixed occupation numbers.
A. Varying occupation numbers (occopt=4):
RF calculation in dataset 5 gives
2DE equal to -4.053115 Ha, while finite difference of &quot;TOTAL&quot;
energy (datasets 6 and 7, including entropy term) gives -4.0475002 Ha.
This is fair, BUT it does not improve with a better
finite-difference, so there is a problem.
B. Fixed occupation numbers (occopt=2):
RF calculation in dataset 8 gives
2DE equal to +5.394365 Ha, while finite difference of total
energy (no entropy term is present with occopt=2) gives +5.3998556 Ha
This is fair, BUT it does not improve with a better
finite-difference, so there is a problem.
Then, in dataset 11, compute phonon frequencies at Gamma
of the doubled cell. The 2DTE is 10.7997781 Ha, which
corresponds to 5.3998890 Ha, so in much better agreement
with the frozen-phonon calculation.
TO BE UNDERSTOOD ..." data-toggle="popover" href="/tests/v3/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-toggle="popover" href="/tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-toggle="popover" href="/tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. Generate the data for optic (linear and non-linear coefficients).
to be analysed in the test 57." data-toggle="popover" href="/tests/v4/Input/t56.abi" target="_blank">t56.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-toggle="popover" href="/tests/v5/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Al2 molecule in a big box. Treat 8 bands, occupied using occopt=4.
Compare tolrff and toldff stopping criteria" data-toggle="popover" href="/tests/v5/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule non-spin-polarized, but treated with nsppol=2, in a big box.
Similar to test 55 of tests/v3. There should be only
small numerical differences with respect to datasets 1 and 2 of this test,
due to the fact that the tetragonal symmetry was here slightly broken
for sake of portability of the automatic test.
Note however that the singlet and triplet states cannot be disentagled,
so one gets a big list of excitations, the merge of singlet and triplet
excitations." data-toggle="popover" href="/tests/v5/Input/t61.abi" target="_blank">t61.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-toggle="popover" href="/tests/v6/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for simple cubic Ti crystal, for reference purposes (conventional = primitive unit cell for symmetry ops)" data-toggle="popover" href="/tests/v6/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Read in Silane positions and znucl from an .xyz format file t10.in.xyz
Demonstrates the use of the xyzfile input variable" data-toggle="popover" href="/tests/v6/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a non-ordered set of atoms. Norm-conserving case.
Similar to v6#97." data-toggle="popover" href="/tests/v67mbpt/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Silicon, DDK computation to prepare &#x27;optic&#x27;" data-toggle="popover" href="/tests/v7/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. Generate the data for optic (linear and non-linear coefficients).
to be analysed in the test 48 (Fortran files) and test 49 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v7/Input/t47.abi" target="_blank">t47.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed." data-toggle="popover" href="/tests/v7/Input/t55.abi" target="_blank">t55.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test printing out the full perturbed wavefunction" data-toggle="popover" href="/tests/v8/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparatory run for the calculation of the Fan-Migdal + Debye-Waller self-energy
C in diamond structure. Very rough 2x2x2 q-point grid (3 qpoints); low ecut." data-toggle="popover" href="/tests/v8/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 48, 49 and 50." data-toggle="popover" href="/tests/v8/Input/t47.abi" target="_blank">t47.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 06 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 08 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. PAW. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 10 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
</ul>
</details>
<p><strong>nbdbuf</strong>  gives the number of bands, the highest in energy, that, among the
<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> bands, are to be considered as part of a buffer.
A negative value (between -1 and -100) is interpreted as percentage of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> (added in v9). The value -101 is special, as described below.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The default value is usually too small, especially when performing GS NSCF calculations.
In this case, it is strongly recommended to specify nbdbuf in the input and increase <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> accordingly.
For small systems (e.g. Silicon), nbdbuf = 4 is OK so using <code>nband 12 and nbdbuf = 4</code>
will give a band structure with the first 8 bands converged within <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>.
For more complex systems and/or GS NSCF calculations with many empty states, one usually needs
to increase  <strong>nbdbuf</strong> , let&rsquo;s say 10% of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.
This can be easily achieved by using a negative value e.g.: nbdbuf -10 means 10% of nband.</p>
</div>
<p>This concept is useful in three situations: in non-self-consistent calculations, for the
determination of the convergence tolerance; for response functions of metals,
to avoid instabilities, and also when finite electric fields or non-linear
responses (with electric field perturbations) are considered. For the two
first, the need of a buffer is a natural requirement of the problem, so that
the default value is changed to 2 automatically, as explained in the
following. The third case is only for implementation convenience.</p>
<p>In non-self-consistent GS calculations (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&lt;0), the highest levels might
be difficult to converge, if they are degenerate with another level, that does
not belong to the set of bands treated. Then, it might take extremely long to
reach <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>, although the other bands are already extremely well-converged,
and the energy of the highest bands (whose residual are not yet
good enough), is also rather well converged.</p>
<p>In response to this problem, for non-zero  <strong>nbdbuf</strong> , the largest residual
(residm), to be later compared with <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>, will be computed only in the
set of non-buffer bands (this modification applies for non-self-consistent as
well as self-consistent calculation, for GS as well as RF calculations).
For a GS calculation, with <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&lt;0, supposing  <strong>nbdbuf</strong>  is not initialized
in the input file, then ABINIT will overcome the default  <strong>nbdbuf</strong>  value, and
automatically set  <strong>nbdbuf</strong>  to 2.</p>
<p>In metallic RF calculations, in the conjugate gradient optimisation of first-order wavefunctions,
there is an instability situation when the q wavevector
of the perturbation brings the eigenenergy of the highest treated band at some
k-point higher than the lowest untreated eigenenergy at some k+q point. If one
accepts a buffer of frozen states, this instability can be made to disappear.
Frozen states receive automatically a residual value of -0.1
For a RF calculation, with 3 &lt;= <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> &lt;= 7, supposing  <strong>nbdbuf</strong>  is not
initialized in the input file, then ABINIT will overcome the default
 <strong>nbdbuf</strong>  value, and automatically set  <strong>nbdbuf</strong>  to 2. This value might be
too low in some cases.</p>
<p>Also, the number of active bands, in all cases, is imposed to be at least 1,
irrespective of the value of  <strong>nbdbuf</strong> .</p>
<p>With  <strong>nbdbuf</strong>  = -101, the bands in the buffer are automatically defined through their occupancies.
The convergence criteria is normally <span><span class="MathJax_Preview">resid &lt; tolwfr</span><script type="math/tex">resid < tolwfr</script></span>, which means that the squared band residual should be lower than <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>.
With  <strong>nbdbuf</strong>  = -101, the convergence criteria becomes : <span><span class="MathJax_Preview">resid * occ &lt; tolwfr</span><script type="math/tex">resid * occ < tolwfr</script></span>, where <span><span class="MathJax_Preview">occ</span><script type="math/tex">occ</script></span> is the band occupancy.
In that case, bands with null occupation numbers are completely ignored and bands with partial band occupancies are converged according to a modified criteria, equal to <span><span class="MathJax_Preview">tolwfr/occ</span><script type="math/tex">tolwfr/occ</script></span>.
This functionality is still experimental and has not been tested on many systems yet.</p>
<p>At last, we note that the convergence criteria for the diagonalization algorithm (see <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr_diago">tolwfr_diago</a>) is also affected by  <strong>nbdbuf</strong> .</p>
<h2 id="nblock_lobpcg"><strong>nblock_lobpcg</strong><a class="headerlink" href="#nblock_lobpcg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of BLOCKs in the LOBPCG algorithm<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a> = 4, 14, or 114<br />
<em>Added in version:</em> v9.11.6  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [19/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu/Input/t04.abi" target="_blank">t04.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). NC,istwfk&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t37.abi" target="_blank">t37.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk=1,npkpt=2,npband=2" data-toggle="popover" href="/tests/paral/Input/t39.abi" target="_blank">t39.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,nspinor=2,npband=4" data-toggle="popover" href="/tests/paral/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t48.abi" target="_blank">t48.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). NC,istwfk&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t49.abi" target="_blank">t49.abi</a></li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). Should give same results than v10[04]. PAW,istwfk=1" data-toggle="popover" href="/tests/v10/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk=1,nsppol=2." data-toggle="popover" href="/tests/v10/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,nspinor=2" data-toggle="popover" href="/tests/v10/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1" data-toggle="popover" href="/tests/v10/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). Should give same results than v10[04]. NC,istwfk=1" data-toggle="popover" href="/tests/v10/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). NC,istwfk&gt;1" data-toggle="popover" href="/tests/v10/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1" data-toggle="popover" href="/tests/v10/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). NC,istwfk&gt;1" data-toggle="popover" href="/tests/v10/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2) for cell optimization. PAW,istwfk=1." data-toggle="popover" href="/tests/v10/Input/t19.abi" target="_blank">t19.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test various values of nbdbuf with lobpcg (114)." data-toggle="popover" href="/tests/v9/Input/t201.abi" target="_blank">t201.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolwfr_diago with lobpcg (114)." data-toggle="popover" href="/tests/v9/Input/t202.abi" target="_blank">t202.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Simple input (from fast/t03) to test nblock_lobpcg variable" data-toggle="popover" href="/tests/v9/Input/t205.abi" target="_blank">t205.abi</a></li>
</ul>
</details>
<p>This variable controls the number of blocks in the LOBPCG algorithm.
It has to be a divisor of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.
Contrary to the simple conjugate gradient, which is a band-by-band algorithm, LOBPCG can work on blocks of wavefunctions.
This is partly why LOBPCG is more robust and efficient, especially for systems with many atoms.
The size of a block is <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> / <strong>nblock_lobpcg</strong>.
Blocks are treated sequentially, starting from the block of bands with the lowest eigenvalues up to the block of bands with the highest eigenvalues.</p>
<p>With the default value, all bands are included in a single block (<strong>nblock_lobpcg</strong>=1), but it is very likely not the most efficient solution.
To increase the number of blocks (which decreases the block size) can be interesting as:</p>
<ul>
<li>it decreases the time spend in every LOBPCG call (a part of the work to be done on each block is proportional to (blocksize)^3).</li>
<li>it decreases the memory footprint, as the size of many work arrays is proportional to the block size.</li>
</ul>
<p>However, to increase the number of blocks has some drawbacks:</p>
<ul>
<li>it decreases the algorithm robustness, so difficult systems may not converge. To use one block is the most robust choice.</li>
<li>it decreases the convergence rate, so either more steps (see <a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a>) are needed to converge, or more &ldquo;lines&rdquo; are needed (see <a class="wikilink codevar-wikilink" href="/variables/gstate#nline">nline</a>).</li>
<li>when used in a parallel computation, it decreases the scalability, so less cores can be used efficiently.</li>
</ul>
<p>A first try could be <strong>nblock_lobpcg</strong>=4.
If possible one can slightly adapt <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> in order to be a multiple of <strong>nblock_lobpcg</strong>.</p>
<p>When use with <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a>=1, the bands of a block are distributed among <a class="wikilink codevar-wikilink" href="/variables/paral#npband">npband</a> MPI processes.
So <a class="wikilink codevar-wikilink" href="/variables/paral#npband">npband</a> has to be a divisor of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> / <strong>nblock_lobpcg</strong> and <a class="wikilink codevar-wikilink" href="/variables/paral#bandpp">bandpp</a> is internally set to <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> / (<strong>nblock_lobpcg</strong> * <a class="wikilink codevar-wikilink" href="/variables/paral#npband">npband</a>).
<strong>nblock_lobpcg</strong> and <a class="wikilink codevar-wikilink" href="/variables/paral#bandpp">bandpp</a> cannot be used simultaneously, one should prefer <strong>nblock_lobpcg</strong>.</p>
<h2 id="ndivk"><strong>ndivk</strong><a class="headerlink" href="#ndivk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of DIVisions of K lines<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (abs(<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>))<br />
<em>Default value:</em> None<br />
<em>Comment:</em> Will be generated automatically from <a class="wikilink codevar-wikilink" href="/variables/gstate#ndivsm">ndivsm</a> if the latter is defined, which is much more convenient.<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> &lt; 0<br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#ndivsm">ndivsm</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [11/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_1.abi" target="_blank">tucalc_crpa_1.abi</a></li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H6 Supercell
Generates a 6 atom Hydrogen supercell with the multiplicity of 1:2:3 (x:y:z)
Produces a WFK file to be analyzed with fold2bloch" data-toggle="popover" href="/tests/tutorial/Input/tfold2bloch_1.abi" target="_blank">tfold2bloch_1.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Molybdenum. Test the k point generator : Monkhorst-Pack
grid, then band structure." data-toggle="popover" href="/tests/v2/Input/t43.abi" target="_blank">t43.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Au linear chain. Test the output of a launch.dat file for WanT
Note: the file that is produced is not tested,
Only the usual output file of ABINIT.
Want output does not support MPI with ncpus &gt; 1." data-toggle="popover" href="/tests/v4/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon to test the CP2K pseudopotential implementation with
the new pseudo type: pspcod 10 (same formalism as HGH pseudopotentials, pspcod 3).
Same input file as t35.in of tests/tutorial, the only difference is that
in the test the used pseudo is taken from the CP2K library.
(http://cvs.berlios.de/cgi-bin/viewcvs.cgi/cp2k/potentials/Goedecker/abinit/)
The bandstructure is in agreement with that calculated in the tutorial
example with the pspcod=1 pseudopotential." data-toggle="popover" href="/tests/v5/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon. Diamond structure.
Quick test of the use of datasets with a numbering beyond 1000 (the last one is 1022).
(Tests 35-40 are for response-function)" data-toggle="popover" href="/tests/v6/Input/t34.abi" target="_blank">t34.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a></li>
</ul>
</details>
<p>Gives the number of divisions of each of the segments of the band structure,
whose path is determined by <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#kptbounds">kptbounds</a>. In this case, the
absolute value of <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> is the number of such segments.</p>
<p>For example, suppose that the number of segment is just one (<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = -1), a
value  <strong>ndivk</strong>  = 4 will lead to the computation of points with relative
coordinates 0.0, 0.25, 0.5, 0.75 and 1.0, along the segment in consideration.</p>
<p>Now, suppose that there are two segments (<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = -2), with  <strong>ndivk</strong> (1)=4
and  <strong>ndivk</strong> (2)=2, the computation of the eigenvalues will be done at 7
points, 5 belonging to the first segment, with relative coordinates 0.0, 0.25,
0.5, 0.75 and 1.0, the last one being also the starting point of the next
segment, for which two other points must be computed, with relative
coordinates 0.5 and 1.0.</p>
<p>It is easy to compute disconnected circuits (non-chained segments), by
separating the circuits with the value  <strong>ndivk</strong>  = 1 for the intermediate
segment connecting the end of one circuit with the beginning of the next one
(in which case no intermediate point is computed along this segment).</p>
<p>Alternatively it is possible to generate automatically the array  <strong>ndivk</strong>  by
just specifying the number of divisions for the smallest segment. See the
related input variable <a class="wikilink codevar-wikilink" href="/variables/gstate#ndivsm">ndivsm</a>. This is much more convenient than using  <strong>ndivk</strong> .</p>
<h2 id="ndivsm"><strong>ndivsm</strong><a class="headerlink" href="#ndivsm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of DIVisions for the SMallest segment<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> None<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [11/1245] in all abinit tests, [5/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-toggle="popover" href="/tests/libxc/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_6.abi" target="_blank">tw90_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Z2Pack (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tz2_2.abi" target="_blank">tz2_2.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="ZPR computation at the Gamma point for MgO." data-toggle="popover" href="/tests/tutorespfn/Input/teph4zpr_4.abi" target="_blank">teph4zpr_4.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon

Computation of the band structure.
First, a SCF density computation, then a non-SCF band structure calculation." data-toggle="popover" href="/tests/tutorial/Input/tbase3_5.abi" target="_blank">tbase3_5.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgB2, space group P6/m m m (#191); Bravais hP (primitive hexag.)
GS calculation followed by a band structure calculation in which the
k-path is automatically defined via the ndivsm input variable.
The third dataset tests the calculation and the output of the Fermi surface (prtfsurf=1)
in the Xcrysden format." data-toggle="popover" href="/tests/v6/Input/t14.abi" target="_blank">t14.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon linewidths and e-ph coupling parameter lambda." data-toggle="popover" href="/tests/v7/Input/t88.abi" target="_blank">t88.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-toggle="popover" href="/tests/v8/Input/t44.abi" target="_blank">t44.abi</a></li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a></li>
</ul>
</details>
<p>This variable defines the number of divisions used to sample the smallest
segment of the circuit employed in a band structure calculations (see related
input variables <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#kptbounds">kptbounds</a>). If  <strong>ndivsm</strong>  is given in the
input file, there is no need to specify the number of divisions to be used for
the other segments. Indeed <a class="wikilink codevar-wikilink" href="/variables/gstate#ndivk">ndivk</a> is automatically calculated inside the
code in order to generate a path where the number of divisions in each segment
is proportional to the length of the segment itself. This option is activated
only when <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> is negative. In this case, the absolute value of
<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> is the number of such segments.</p>
<h2 id="ngfft"><strong>ngfft</strong><a class="headerlink" href="#ngfft" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Grid points for Fast Fourier Transform<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform numerically precise calculations with planewaves or projector- augmented waves and pseudopotentials" data-toggle="popover" href="/topics/Planewaves">topic_Planewaves</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Comment:</em> (automatic selection of optimal values)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [85/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as 05 but with ecut raised, reading wf.13 to start. Tests boxcut&lt;2." data-toggle="popover" href="/tests/fast/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test is due to Z. Levine. It is a run on Si with the bond center
at the origin. Also write density and potential with prtden=9 and prtpot=2 ." data-toggle="popover" href="/tests/fast/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LOBPCG, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 10 special points, occopt=7 and tsmear=0.05 .
Start from the wavefunctions of case 4, reformatted by case 6.
Ask to compute the DOS. See the WARNING described in case 6.
Cannot use more that 2 processors due to t04.abi" data-toggle="popover" href="/tests/v1/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H atom (spin-unpolarized in a medium size cubic box, k=0 0 0 similar to test 1 of fast)
Using multi-dataset mode, examine the following combinations of
fftalg and istwfk : (112,2),(112,1),(111,1),(111,2),(110,2),(110,1),
(100,1), then compute the energy with nstep=0 for (112,2) and (112,1).
Then again SCF test for (400,1), (401,1), (402,1).
For the second dataset, reads the wavefunctions of the first dataset." data-toggle="popover" href="/tests/v1/Input/t87.abi" target="_blank">t87.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
Compares with frozen-phonon calculations.
Similar to test v2 #11, except use of PBE GGA.
Examine two cases:
varying occupation numbers, and fixed occupation numbers.
A. Varying occupation numbers (occopt=4):
RF calculation in dataset 5 gives
2DE equal to -4.053115 Ha, while finite difference of &quot;TOTAL&quot;
energy (datasets 6 and 7, including entropy term) gives -4.0475002 Ha.
This is fair, BUT it does not improve with a better
finite-difference, so there is a problem.
B. Fixed occupation numbers (occopt=2):
RF calculation in dataset 8 gives
2DE equal to +5.394365 Ha, while finite difference of total
energy (no entropy term is present with occopt=2) gives +5.3998556 Ha
This is fair, BUT it does not improve with a better
finite-difference, so there is a problem.
Then, in dataset 11, compute phonon frequencies at Gamma
of the doubled cell. The 2DTE is 10.7997781 Ha, which
corresponds to 5.3998890 Ha, so in much better agreement
with the frozen-phonon calculation.
TO BE UNDERSTOOD ..." data-toggle="popover" href="/tests/v3/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms (well, with no mixing, just for a test)
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
The first psp is Si, the second one is Ge, but the
mixing coefficients are 1.0 and 0.0 .
See test 4 of v2, except with alchemy." data-toggle="popover" href="/tests/v3/Input/t92.abi" target="_blank">t92.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation with the GGA
Note that this test and the following one, 59,
address more advanced features of strain perturbation than the ones
going with number 60 to 79, and were developed later, but were
placed here for convenience).
AlAs in the zincblende structure, with a choice of
pseudopotenials that include model core charges.  In the LDA, the
strain perturbation simply introduces perturbing charge densities
leading to perturbing first-order potentials in a straightforward
manner.  (This perturbation does act differently on the valence
and model core charges.)   The GGA is a non-trivial extension,
since strain perturbs the gradient operator itself.  This test
is a symmetrized and stripped-down version of a test case used in
development which yielded agreement between such RF calculations
and numerical derivatives of GS stresses and forces to 1.e-8 to
1.e-9 atomic units for the elastic tensor and intenal strain
coupling parameters.  Acheiving this agreement does require forcing
a considerably more dense fft grid than the default which is
accepted here. (ngfft= 50 50 50 was used.)  While only the PBE GGA
is tested here, all forms present in Abinit should give comparably
accurate results." data-toggle="popover" href="/tests/v4/Input/t58.abi" target="_blank">t58.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
One-shot GW calculations within the PAW formalism" data-toggle="popover" href="/tests/v5/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the size of fast Fourier transform (FFT) grid in three dimensions. Each
number must be composed of the factors 2, 3, and 5 to be consistent with the
radices available in our FFT.</p>
<p>If no  <strong>ngfft</strong>  is provided or if  <strong>ngfft</strong>  is set to 0 0 0, the code will automatically
provide an optimal set of  <strong>ngfft</strong>  values, based on <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>
(see also <a class="wikilink codevar-wikilink" href="/variables/gstate#boxcutmin">boxcutmin</a> for speed/accuracy concerns).
This is the recommended procedure, of course.
The total number of FFT points is the product:  <strong>ngfft</strong> (1) x  <strong>ngfft</strong> (2) x  <strong>ngfft</strong> (3)=<a class="wikilink codevar-wikilink" href="/variables/internal#nfft">%nfft</a>.</p>
<p>When  <strong>ngfft</strong>  is made smaller than recommended values (e.g. by setting
<a class="wikilink codevar-wikilink" href="/variables/gstate#boxcutmin">boxcutmin</a> to a value smaller than 2.0 or by setting  <strong>ngfft</strong>  manually),
the code runs faster and the equations in effect are approximated by a low
pass Fourier filter. The code reports to standard output (unit 06) a parameter
&ldquo;boxcut&rdquo; which is the smallest ratio of the FFT box side to the <span><span class="MathJax_Preview">\GG</span><script type="math/tex">\GG</script></span> vector basis
sphere diameter. When boxcut is less than 2 the Fourier filter approximation
is being used. When boxcut gets less than about 1.5 the approximation may be
too severe for realistic results and should be tested against larger values of
 <strong>ngfft</strong> . When boxcut is larger than 2,  <strong>ngfft</strong>  could be reduced without
loss of accuracy. In this case, the small variations that are observed are
solely due to the xc quadrature, that may be handled with <a class="wikilink codevar-wikilink" href="/variables/dev#intxc">intxc</a> = 1 to even
reduce this effect.</p>
<p>Internally,  <strong>ngfft</strong>  is an array of size 18. The present components are
stored in  <strong>ngfft</strong> (1:3), while</p>
<ul>
<li><strong>ngfft</strong> (4:6) contains slightly different (larger) values, modified for efficiency of the FFT</li>
<li><strong>ngfft</strong> (7) is <a class="wikilink codevar-wikilink" href="/variables/dev#fftalg">fftalg</a></li>
<li><strong>ngfft</strong> (8) is <a class="wikilink codevar-wikilink" href="/variables/dev#fftcache">fftcache</a></li>
<li><strong>ngfft</strong> (9) is set to 0 if the parallelization of the FFT is not activated, while it is set to 1 if it is activated.</li>
<li><strong>ngfft</strong> (10) is the number of processors of the FFT group</li>
<li><strong>ngfft</strong> (11) is the index of the processor in the group of processors</li>
<li><strong>ngfft</strong> (12) is n2proc, the number of x-z planes, in reciprocal space, treated by the processor</li>
<li><strong>ngfft</strong> (13) is n3proc, the number of x-y planes, in real space, treated by the processor</li>
<li><strong>ngfft</strong> (14) is mpi_comm_fft, the handle on the MPI communicator in charge of the FFT parallelisation</li>
<li><strong>ngfft</strong> (15:18) are not yet used</li>
</ul>
<p>The number of points stored by this processor in real space is n1*n2*n3proc,
while in reciprocal space, it is n1*n2proc*n3.</p>
<h2 id="ngqpt"><strong>ngqpt</strong><a class="headerlink" href="#ngqpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Grid points for Q PoinTs generation<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT calculations" data-toggle="popover" href="/topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> &gt;= 0<br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#qptrlatt">qptrlatt</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [35/1245] in all abinit tests, [16/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
the sequence of datasets makes the ground states and
all of the explicit perturbations of the single
Al atom in all directions, for the irreducible
qpoints in a 2x2x2 grid.
Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_1.abi" target="_blank">teph_legacy_1.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through ngqpt and nshiftq.
Otherwise, similar to Tv2#26" data-toggle="popover" href="/tests/v6/Input/t78.abi" target="_blank">t78.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. The wtq variable is introduced to be able to reproduce the q-point
weight obtained with ngqpt and qptopt.
The main reason being that the initialization of large q-point (same for k-point) grid
is extremely slow. Inputing manually the qpt and wtq in the input file avoid such
inefficient initialization." data-toggle="popover" href="/tests/v7/Input/t57.abi" target="_blank">t57.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-toggle="popover" href="/tests/v8/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the imaginary part of the Fan-Migdal self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the imaginary part of the Fan-Migdal self-energy matrix elements.
Use of the tetrahedron method for the electron linewidth" data-toggle="popover" href="/tests/v9/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the imaginary part of the Fan-Migdal self-energy matrix elements.
Use of the two-grids technique" data-toggle="popover" href="/tests/v9/Input/t55.abi" target="_blank">t55.abi</a> &hellip;</li>
</ul>
</details>
<p>WARNING : Only used if <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a> = 1. If <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>=0 (which is the default value of <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>), no reading of  <strong>ngqpt</strong>  is done,
and the default value of  <strong>ngqpt</strong>  is kept.</p>
<p>Similar to <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>, but for the q-wavevector. At variance with <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>, note that only one q point is selected per dataset
(see <a class="wikilink codevar-wikilink" href="/variables/gstate#iqpt">iqpt</a>).
Its three positive components give the number of q points of Monkhorst-Pack
grids (defined with respect to primitive axis in reciprocal space) in each of
the three dimensions. The use of <a class="wikilink codevar-wikilink" href="/variables/gstate#nshiftq">nshiftq</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#shiftq">shiftq</a>, allows one to
generate shifted grids, or Monkhorst-Pack grids defined with respect to
conventional unit cells.</p>
<p>For more information on Monkhorst-Pack grids, see <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>.</p>
<h2 id="nline"><strong>nline</strong><a class="headerlink" href="#nline" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of LINE minimizations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 6 if <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a> == 1 or 11 ,
4 otherwise.</p>
<p><em>Comment:</em> 4 for conjugate-gradient-based algorithm, 6 for spectrum-filtering-based algorithms<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1242/1245] in all abinit tests, [159/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>For conjugate-gradient based algorithms (conjugate gradient or LOBPCG):</p>
<p><strong>nline</strong>  gives the maximum number of line minimizations allowed in preconditioned conjugate
gradient minimization for each band. The default, 4, is fine.
Special cases, with degeneracies or near-degeneracies of levels at the Fermi
energy may require a larger value of  <strong>nline</strong>  (5 or 6 ?). Line minimizations
will be stopped anyway when improvement gets small (governed by <a class="wikilink codevar-wikilink" href="/variables/dev#tolrde">tolrde</a>).
Note that  <strong>nline</strong>  = 0 can be used to diagonalize the Hamiltonian matrix in the
subspace spanned by the input wavefunctions.</p>
<p>For algorithms using spectrum filtering (f.i. Chebyshev filtering, <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a>=1 or 111):</p>
<p><strong>nline</strong>  gives the maximum degree of the Chebyshev polynomial used as filtering function.
The default is 6 to ensure a good quality of the filtering.</p>
<p>With the input variable <a class="wikilink codevar-wikilink" href="/variables/dev#nnsclo">nnsclo</a>,  <strong>nline</strong>  governs the convergence of the
wavefunctions for fixed potential.</p>
<h2 id="npsp"><strong>npsp</strong><a class="headerlink" href="#npsp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of PSeudoPotentials to be read<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the types of atoms that form the system" data-toggle="popover" href="/topics/AtomTypes">topic_AtomTypes</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to master the use of norm-conserving pseudopotentials and PAW atomic data, and their consequences" data-toggle="popover" href="/topics/PseudosPAW">topic_PseudosPAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [27/1245] in all abinit tests, [3/159] in abinit tutorials</summary><ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with PAW and spin-orbit coupling. 2x2x2 K grid; low cut-off for test
Test paral_kgb==1 with MPI-FFT/spinor parallelization, the IO of the WFK file,
the output of potential files and the calculation of PJDOS in parallel
(PW term + on-site contributions)" data-toggle="popover" href="/tests/mpiio/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the parallelization over spinorial components of WF
Bi A7 structure (2 atoms, treated as semi-conductor),
using PAW, within LDA and spin-orbit coupling.
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)" data-toggle="popover" href="/tests/paral/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with NC and spin-orbit coupling.
Test RMM-DIIS eigensolver with paral_kgb == 1 and band-spinor MPI parallelization." data-toggle="popover" href="/tests/paral/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz.
Ground state with LOBPCG + RMM-DIIS eigensolver and paral_kgb parallelism with 4 MPI procs." data-toggle="popover" href="/tests/paral/Input/t63.abi" target="_blank">t63.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-toggle="popover" href="/tests/tutoparal/Input/tmbt_1.abi" target="_blank">tmbt_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GW calculation for crystalline alpha-quartz. Screening calculation" data-toggle="popover" href="/tests/tutoparal/Input/tmbt_2.abi" target="_blank">tmbt_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-toggle="popover" href="/tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms (well, with no mixing, just for a test)
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
The first psp is Si, the second one is Ge, but the
mixing coefficients are 1.0 and 0.0 .
See test 4 of v2, except with alchemy." data-toggle="popover" href="/tests/v3/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Ge, the second one is Si, but the
mixing coefficients are 0.0 and 1.0 .
See previous test, except GS only, and the two atoms are switched." data-toggle="popover" href="/tests/v3/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Si, the second one is Si, the
mixing coefficients are 0.2 and 0.8 , then, in a second
dataset, they are 0.5 and 0.5 .
Should give same numerical results as the previous test." data-toggle="popover" href="/tests/v3/Input/t94.abi" target="_blank">t94.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth atom, isolated, in a supercell.
Try alchemical pseudopotentials with spin-orbit.
Spinor calculation (nspinor=2, nspden=1, nsppol=1)
Metallic occupations.
Also compare the halved spin-orbit interaction alchemical mixing
with a pseudopotential directly prepared with halved spin-orbit interaction.
The agreement is perfect." data-toggle="popover" href="/tests/v5/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-toggle="popover" href="/tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-toggle="popover" href="/tests/v5/Input/t64.abi" target="_blank">t64.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ga Al(1-x) Asx
Test of alchemical calculations with images.
Mostly checking the treatment of input variables and their echo.
(Tests 30-36 are more slots for testing the ground state)" data-toggle="popover" href="/tests/v6/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-toggle="popover" href="/tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a non-ordered set of atoms. Norm-conserving case.
Similar to v6#97." data-toggle="popover" href="/tests/v67mbpt/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a set of translated atoms. Norm-conserving case.
Similar to v6#97." data-toggle="popover" href="/tests/v67mbpt/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz: GS calculations with UPF2 pseudos.
Test scalar-relativistic pseudos with useylm 0 and 1." data-toggle="popover" href="/tests/v9/Input/t130.abi" target="_blank">t130.abi</a> &hellip;</li>
</ul>
</details>
<p>Usually, the number of pseudopotentials to be read,  <strong>npsp</strong> , is equal to the number of
type of atoms, <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>. However, in the case an alchemical mixing of pseudopotential is
used,  <strong>npsp</strong>  will be bigger than <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>.</p>
<p>Alchemical pseudopotentials will be present when <a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a> is non-zero. See
<a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a> to understand how to use alchemical potentials in ABINIT. The
input variables (<a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#algalch">algalch</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#mixalch">mixalch</a>) are active, and
generate alchemical potentials from the available pseudopotentials. Also, the
inner variables (<a class="wikilink codevar-wikilink" href="/variables/gstate#ntyppure">%ntyppure</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#npspalch">%npspalch</a>) become active. See these input
variables, especially <a class="wikilink codevar-wikilink" href="/variables/gstate#mixalch">mixalch</a>, to understand how to use alchemical
potentials in ABINIT.</p>
<h2 id="npspalch"><strong>npspalch</strong><a class="headerlink" href="#npspalch" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of PSeudoPotentials that are &ldquo;ALCHemical&rdquo;<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INTERNAL_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the types of atoms that form the system" data-toggle="popover" href="/topics/AtomTypes">topic_AtomTypes</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#npsp">npsp</a>-<a class="wikilink codevar-wikilink" href="/variables/gstate#ntyppure">%ntyppure</a><br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a>&gt;0<br />
<em>Added in version:</em> before_v9  </p>
<p>Gives the number of pseudopotentials that are used for alchemical mixing (when <a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a> is non-zero):</p>
<p><strong>npspalch</strong>  = <a class="wikilink codevar-wikilink" href="/variables/gstate#npsp">npsp</a>-<a class="wikilink codevar-wikilink" href="/variables/gstate#ntyppure">%ntyppure</a></p>
<p>When alchemical mixing of potentials is used (that is, when <a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a>&gt;0), then  <strong>npspalch</strong>  must be greater than 0.</p>
<h2 id="nqfd"><strong>nqfd</strong><a class="headerlink" href="#nqfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Quasi Fermi-Dirac excited carriers<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify bands and occupation numbers, for metals or insulators" data-toggle="popover" href="/topics/BandOcc">topic_BandOcc</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a Δ-SCF calculation of neutral excitations" data-toggle="popover" href="/topics/DeltaSCF">topic_DeltaSCF</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
2 Silicon atoms, in a diamond structure.
Test the computation of occopt 9." data-toggle="popover" href="/tests/v9/Input/t91.abi" target="_blank">t91.abi</a></li>
</ul>
</details>
<p>Only used if [[occopt] = 9.</p>
<p>Controls the numbers of electrons per cell constrained in conduction bands with index
strictly greater than <a class="wikilink codevar-wikilink" href="/variables/gstate#ivalence">ivalence</a>, and the number of holes per cell constrained in
valence bands with index between 1 and <a class="wikilink codevar-wikilink" href="/variables/gstate#ivalence">ivalence</a>.
Internal variables ne_qFD (number of electrons) and nh_qFD (number of holes) are presently initialized to  <strong>nqfd</strong> , which is NOT INTERNAL.</p>
<h2 id="nqpt"><strong>nqpt</strong><a class="headerlink" href="#nqpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Q - POINTs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT calculations" data-toggle="popover" href="/topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [213/1245] in all abinit tests, [19/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using OpenMP GPU.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of various XC functionals for the response functions
(thus, the XC kernel is also tested).
The test includes 3 different functionals:
1) Perdew-Zunger: ixc=2 and ixc=-001009
2) PBE: ixc=11 and ixc=-101130
3) Perdew-Wang92: ixc=7, ixc=-001012, and ixc=-001013
The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent
unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting
some lines indicated by GMR.
Note that the underlying FFT grid does not have the symmetry of the
lattice." data-toggle="popover" href="/tests/libxc/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of the Perdew-Zunger XC functionals for the response functions
(thus, the XC kernel is also tested) in PAW." data-toggle="popover" href="/tests/libxc/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, NC pseudopotentials.
Test the IO routines for a typical DFPT calculation" data-toggle="popover" href="/tests/mpiio/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al; non-selfconsistent computation of wavefunctions" data-toggle="popover" href="/tests/paral/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al; non-selfconsistent computation of wavefunctions" data-toggle="popover" href="/tests/paral/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
CrystallIne AlAs
first three runs are for calculation of ground state at finite electric field
the fourth run gets the gs wavefunction and then do response calculation
the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-toggle="popover" href="/tests/seq/Input/tsv4_80.abi" target="_blank">tsv4_80.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
(see test.si.chain of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. Generate the data for optic (linear and non-linear coefficients).
to be analysed in the test 57." data-toggle="popover" href="/tests/v4/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation with the GGA
Note that this test and the following one, 59,
address more advanced features of strain perturbation than the ones
going with number 60 to 79, and were developed later, but were
placed here for convenience).
AlAs in the zincblende structure, with a choice of
pseudopotenials that include model core charges.  In the LDA, the
strain perturbation simply introduces perturbing charge densities
leading to perturbing first-order potentials in a straightforward
manner.  (This perturbation does act differently on the valence
and model core charges.)   The GGA is a non-trivial extension,
since strain perturbs the gradient operator itself.  This test
is a symmetrized and stripped-down version of a test case used in
development which yielded agreement between such RF calculations
and numerical derivatives of GS stresses and forces to 1.e-8 to
1.e-9 atomic units for the elastic tensor and intenal strain
coupling parameters.  Acheiving this agreement does require forcing
a considerably more dense fft grid than the default which is
accepted here. (ngfft= 50 50 50 was used.)  While only the PBE GGA
is tested here, all forms present in Abinit should give comparably
accurate results." data-toggle="popover" href="/tests/v4/Input/t58.abi" target="_blank">t58.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbFCl in the matlockite structure P4/nmm. 6 atoms per cell.
Compute a set of matrix elements of the dynamical matrix,
for q wavevector 0.5 0.5 0.5 .
In this test case, the symmetry operations have an important
non-symmorphic character. There was a bug in the treatment
of this material, prior to v5.2.4 ." data-toggle="popover" href="/tests/v5/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-toggle="popover" href="/tests/v5/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through qptrlatt.
Otherwise, similar to Tv2#26 and Tv6#78." data-toggle="popover" href="/tests/v6/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrO2 FCC (fluorite structure).
Compute the phonon frequencies at the X point.
This worked correctly before 5.2.4, but then, an erroneous bug fix (correcting v5#21) was introduced.
Final (correct) fixing in v6.0.4.
(Contributed by I. Lukacevic, trying to reproduce results by Detraux et al 1997)" data-toggle="popover" href="/tests/v6/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
Warning : only valid for Gamma, AND the temperature-dependent shifts must be averaged
over degenerate states." data-toggle="popover" href="/tests/v6/Input/t37.abi" target="_blank">t37.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of optic with temperature-dependent renormalization
WARNING: This feature is still under testing, files and variables could change in the next versions" data-toggle="popover" href="/tests/v67mbpt/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Silicon, DDK computation to prepare &#x27;optic&#x27;" data-toggle="popover" href="/tests/v7/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
20-electron PAW pseudo (4f in the core, but 4d10 as semi-core : 4d10 5s2 5p6 (5d0) 6s2 )
Test of computation of dielectric tensor, Born effective charges, dynamical matrix.
To keep the CPU time to a reasonable level, the responses are computed
with minimal parameters (nstep and the kpoint grid are too small,
ecut might be increased, and also pawecutdg).
Note: Charge neutrality is not achieved with the present dataset for Born Effective Charges,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 6 6 6,  ecut 40. pawecutdg 40.) gives Z(Eu)=2.5085, Z(O)=-2.4982" data-toggle="popover" href="/tests/v7/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests uses psps8 files with model core charges and valence charge densities.
We test the initialization of rhor1, rhog1 from atomic quantities and the
treatment of the non-linear core correction in G-space (nc_xccc_gspace)." data-toggle="popover" href="/tests/v7/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/v8/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test printing out the full perturbed wavefunction" data-toggle="popover" href="/tests/v8/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparatory run for the calculation of the Fan-Migdal + Debye-Waller self-energy
C in diamond structure. Very rough 2x2x2 q-point grid (3 qpoints); low ecut." data-toggle="popover" href="/tests/v8/Input/t41.abi" target="_blank">t41.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 06 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 08 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. PAW. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 10 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
</ul>
</details>
<p>Determines whether one q point must be read (See the variable <a class="wikilink codevar-wikilink" href="/variables/internal#qptn">%qptn</a>).
Can be either 0 or 1.</p>
<p>If 1 and used in ground-state calculation, a global shift of all the k-points
is applied, to give calculation at k+q. In this case, the output wavefunction
will be appended by _WFQ instead of _WFK
Also, if 1 and a RF calculation is done, defines the wavevector of the perturbation.</p>
<p>For further information about the naming of files in ABINIT, consult the <a class="wikilink user-guide-wikilink" href="/guide/abinit#files-file">abinit help file</a>.</p>
<h2 id="nshiftq"><strong>nshiftq</strong><a class="headerlink" href="#nshiftq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of SHIFTs for Q point grids<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT calculations" data-toggle="popover" href="/topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1245] in all abinit tests, [3/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline AlAs : computation of the phonon spectrum" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_2.abi" target="_blank">trf2_2.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through qptrlatt.
Otherwise, similar to Tv2#26 and Tv6#78." data-toggle="popover" href="/tests/v6/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through ngqpt and nshiftq.
Otherwise, similar to Tv2#26" data-toggle="popover" href="/tests/v6/Input/t78.abi" target="_blank">t78.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a></li>
</ul>
</details>
<p>WARNING : Only used if <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a> = 1. If <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>=0 (which is the default value of <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>), no reading of  <strong>nshiftq</strong>  is done,
and the default value of  <strong>nshiftq</strong>  is kept.</p>
<p>This parameter gives the number of shifted grids to be used concurrently to
generate the full grid of q points. It can be used with primitive grids
defined either from <a class="wikilink codevar-wikilink" href="/variables/gstate#ngqpt">ngqpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#qptrlatt">qptrlatt</a>. The maximum allowed value of
 <strong>nshiftq</strong>  is 8. The values of the shifts are given by <a class="wikilink codevar-wikilink" href="/variables/gstate#shiftq">shiftq</a>.</p>
<h2 id="nspden"><strong>nspden</strong><a class="headerlink" href="#nspden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of SPin-DENsity components<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a spin-polarized calculation" data-toggle="popover" href="/topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [118/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
Pt single atom with semi-core electrons, Krack pseudopotentials (pspcod = 10),
and colinear spin polarisation (GGA functional)." data-toggle="popover" href="/tests/bigdft/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC" data-toggle="popover" href="/tests/built-in/Input/testin_libxc.abi" target="_blank">testin_libxc.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Test functionals from libXC that were present in ABINITv5 (LDAs and GGAs).
This is to check the portability for different platform.
Extremely quick (nstep=1, nline=1). Less than 20 secs to test 45 functionals ..." data-toggle="popover" href="/tests/libxc/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with PAW and spin-orbit coupling. 2x2x2 K grid; low cut-off for test
Test paral_kgb==1 with MPI-FFT/spinor parallelization, the IO of the WFK file,
the output of potential files and the calculation of PJDOS in parallel
(PW term + on-site contributions)" data-toggle="popover" href="/tests/mpiio/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the parallelization over spinorial components of WF
Bi A7 structure (2 atoms, treated as semi-conductor),
using PAW, within LDA and spin-orbit coupling.
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)" data-toggle="popover" href="/tests/paral/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with NC and spin-orbit coupling.
Test RMM-DIIS eigensolver with paral_kgb == 1 and band-spinor MPI parallelization." data-toggle="popover" href="/tests/paral/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="first run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_1.abi" target="_blank">tdftu_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="second run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_2.abi" target="_blank">tdftu_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="third run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_3.abi" target="_blank">tdftu_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
3H2 molecule with distant atoms : probe the use of the spinat variable
Use spin-polarized mode, spinor mode, as well as antiferromagnetic mode.
Even consider an initialization with reather crazy, nearly ferromagnetic spinat.
Use PseudosGTH_pwteter/01h.pspgth, in a 8 8 16 box, with 15 Ha cut-off.
Separation is 4 bohr.
Consider anti-parallel spin configuration,  which is the favoured one
for this distance. Get total energy of -0.981 839  Ha .
Note that the spin-polarization is not complete.
Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-toggle="popover" href="/tests/v1/Input/t39.abi" target="_blank">t39.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 diatomic molecule. Spin-polarized (anti-ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=1 (Teter LSDA)
From datasets 3 and 4, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 6.283100652 Ha, while the direct computation,
without using Shubnikov symmetries, gives
6.282967527 Ha." data-toggle="popover" href="/tests/v3/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H diatomic molecule in the antiferromagnetic regime.
Different data sets.
Test Shubnikov symmetries." data-toggle="popover" href="/tests/v3/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test different ways to obtain the NiO antiferromagnetic structure" data-toggle="popover" href="/tests/v3/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test a fake antiferromagnetic Fe crystal :
recognition of symmetries when there is a small set of non-magnetic
atoms, and a larger set of antiferromagnetic atoms.
There was a bug in pre-4.5.3 versions." data-toggle="popover" href="/tests/v4/Input/t99.abi" target="_blank">t99.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni atom in a big box.
Test the use of the atvshift variable :
change the potential of the d orbitals." data-toggle="popover" href="/tests/v5/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni molecule in a big box.
Test the use of the atvshift variable
First dataset : no shift, the ten states number 9 to 18
come from the 3d atomic states, the state number 19 is a bonding 4s state.
States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1).
State number 18 is a 3d sigma antibonding state (m=0).
Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the
levels change by less than 0.0002 (and their energy decrease), except state number
9 (a 3d sigma bonding state (m=0)), that goes from -0.24020 to -0.23982 (+0.0004)
and state number 18, that goes from -0.15439 to 0.15399 (+0.0004).
Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials.
All the levels are affected (likely the m=1 and -1 orbitals adjust, and cause modification
of the potential), but the states 10, 11, 16, and 17 increase their energy, while the
other state see their energy decrease.
Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking
of the degeneracy.
This test was not easy to make portable. The problem lies in the fact that when the density
becomes negative, due to Bragg oscillations, the xc kernel can be extremely large, and when
use for the prediction of the residual of the forces, the differences between machines
can be extremely large. IN order to see this effect, put ecut 7 and npulayit 7 (its default value)." data-toggle="popover" href="/tests/v5/Input/t15.abi" target="_blank">t15.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi atom in a big supercell.
Test the application of a Zeeman field." data-toggle="popover" href="/tests/v6/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests series for the mGGA implementation (from 31 to 33)
Silicon bulk. Two datasets are run. One (classic) LDA calculation with ixc 7.
One with a fake native mGGA (fake1, i.e. ixc 31) and using effmass_free=1.01.
Both calculation should give the same total energy (change in kinetic energy due to
effmass_free is compensated by the fake mGGA using kinetic energy density: taur).
(Two other datasets are also run for spin polarized case)" data-toggle="popover" href="/tests/v6/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the extension of the pspcod=8 input format to include
spin-orbit coupling with multiple non-local projectors.  The
band structure of fcc Pt is computed at Gamma, X, and L.
The pseudopotential used in the test is generated by the open-source
ONCVPSP code, which is available at www.mat-simresearch.com, and
described in D. R. Hamann, Phys. Rev. B 88, 085177 (2013).
The relativistic extension is documented in the code package.
The Pt 5s and 5p semi-cores are treated as valence, and the band
structure is well-converged at the ecut used in the test (20 Ha).
A complete description of the input format is avaiable in
doc/psp_infos/psp8_info.txt." data-toggle="popover" href="/tests/v7/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Similar to v7[07]. Here we test optdriver 8 (WFK post-processing) with NC
and SO. More specifically, we reconstruct the wavefunctions in the full BZ in
dataset 2 and we use this WFK to restart the calculation in dataset 3 with
the full k-mesh (kptopt 3). The SCF cycle should exit at the first iteration
since the wavefunctions are already converged." data-toggle="popover" href="/tests/v7/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with PAW atomic data." data-toggle="popover" href="/tests/v9/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with the same PAW atomic data, however defaulting to usexcnhat=0." data-toggle="popover" href="/tests/v9/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
</ul>
</details>
<p>If  <strong>nspden</strong>  = 1, no spin-magnetization the density matrix is diagonal, with
same values spin-up and spin-down (compatible with <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1 only, for both
<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1 or 2)</p>
<p>If  <strong>nspden</strong>  = 2, scalar magnetization (the axis is arbitrarily fixed in the z
direction) the density matrix is diagonal, with different values for spin-up
and spin-down (compatible with <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1, either with <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2
-general collinear magnetization- or <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1 -antiferromagnetism)</p>
<p>If  <strong>nspden</strong>  = 4, vector magnetization: the density matrix is full, with
allowed x, y and z magnetization (useful only with <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2 and
<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1, either because there is spin-orbit without time-reversal
symmetry - and thus spontaneous magnetization, or with spin-orbit, if one
allows for spontaneous non-collinear magnetism). Available for
response functions <a class="wikilink citation-wikilink" data-tippy-content="Density functional perturbation theory within noncollinear magnetism" data-toggle="popover" href="/theory/bibliography#ricci2019">[Ricci2019]</a>. Not yet available for mGGA. Also note that, with  <strong>nspden</strong>  = 4, time-reversal symmetry
is not taken into account (at present; this has to be checked) and thus
<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> has to be different from 1 or 2.</p>
<p>The default ( <strong>nspden</strong>  = <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>) does not suit the case of vector magnetization.
Note that the choice of  <strong>nspden</strong>  has an influence on the treatment of symmetries. See <a class="wikilink codevar-wikilink" href="/variables/gstate#symafm">symafm</a>.</p>
<h2 id="nspinor"><strong>nspinor</strong><a class="headerlink" href="#nspinor" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of SPINORial components of the wavefunctions<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a spin-polarized calculation" data-toggle="popover" href="/topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2 if <a class="wikilink codevar-wikilink" href="/variables/paw#pawspnorb">pawspnorb</a> == 1,
1 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [112/1245] in all abinit tests, [8/159] in abinit tutorials</summary><ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC" data-toggle="popover" href="/tests/built-in/Input/testin_libxc.abi" target="_blank">testin_libxc.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Test functionals from libXC that were present in ABINITv5 (LDAs and GGAs).
This is to check the portability for different platform.
Extremely quick (nstep=1, nline=1). Less than 20 secs to test 45 functionals ..." data-toggle="popover" href="/tests/libxc/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with PAW and spin-orbit coupling. 2x2x2 K grid; low cut-off for test
Test paral_kgb==1 with MPI-FFT/spinor parallelization, the IO of the WFK file,
the output of potential files and the calculation of PJDOS in parallel
(PW term + on-site contributions)" data-toggle="popover" href="/tests/mpiio/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the parallelization over spinorial components of WF
Bi A7 structure (2 atoms, treated as semi-conductor),
using PAW, within LDA and spin-orbit coupling.
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)" data-toggle="popover" href="/tests/paral/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with NC and spin-orbit coupling.
Test RMM-DIIS eigensolver with paral_kgb == 1 and band-spinor MPI parallelization." data-toggle="popover" href="/tests/paral/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test cprj_in_memory=1 with xg_nonlop_option=0 or 1 (releveant for chebfi2 only). PAW,nspinor=2,npband=4" data-toggle="popover" href="/tests/paral/Input/t38.abi" target="_blank">t38.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Z2Pack (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tz2_2.abi" target="_blank">tz2_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="first run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_1.abi" target="_blank">tdftu_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="second run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_2.abi" target="_blank">tdftu_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="third run of the DFT+U tutorial" data-toggle="popover" href="/tests/tutorial/Input/tdftu_3.abi" target="_blank">tdftu_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3H2 molecule with distant atoms : probe the use of the spinat variable
Use spin-polarized mode, spinor mode, as well as antiferromagnetic mode.
Even consider an initialization with reather crazy, nearly ferromagnetic spinat.
Use PseudosGTH_pwteter/01h.pspgth, in a 8 8 16 box, with 15 Ha cut-off.
Separation is 4 bohr.
Consider anti-parallel spin configuration,  which is the favoured one
for this distance. Get total energy of -0.981 839  Ha .
Note that the spin-polarization is not complete.
Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-toggle="popover" href="/tests/v1/Input/t39.abi" target="_blank">t39.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,nspinor=2" data-toggle="popover" href="/tests/v10/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tin in the diamond structure, with 2 special points
Test the effect of spin-orbit coupling, especially the
electronic structure.
Degeneracies at Gamma are correct !
(note that ecut and nkpt are too low for quantitative accuracy)
Without spin-orbit (in eV), dataset 4:
-8.82682  1.26955 (x3) 1.30262 3.45296 (x3)
With spin-orbit (in eV), dataset 6:
-8.82682  0.75225      1.30262 1.50965 (x2) 3.07128 3.62556 (x2)" data-toggle="popover" href="/tests/v2/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth, treated as a metal, with 2 special points
Test the effect of spin-orbit coupling, especially the forces.
The dataset 1 to 3 are related to the nspinor=1 case. The forces
are computed from finite differences of energy :
abs(etotal3-etotal1)=0.00090461 Ha
abs(xcart3-xcart1)=0.089970092 (taking into account both atoms)
Their ratio is 0.01005456 Ha/Bohr, to be compared with
fcart2=1.0049850156E-02 Ha/Bohr
The dataset 4 checks the case nspinor=2, pspso=1 (no spin-orbit yet)
The dataset 5 to 7 try to reproduce the comparison of forces
with spin-orbit :
abs(etotal7-etotal5)=0.000445155 Ha
abs(xcart7-xcart5)=0.089970092 (taking into account both atoms)
Their ratio is 3.83633E-03 Ha/Bohr ...
A better finite-difference scheme incorporating also data from
half-displacement, lead to 3.81832E-03 Ha/Bohr.
This is in excellent agreement with
fcart6=3.8183150850E-03 Ha/Bohr" data-toggle="popover" href="/tests/v2/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon, diamond structure.
Test the ability to read an input wavefunction and to generate
from it any other wavefunction, changing different parameters.
One of the _DEN file is also used as starting point of
the cut3D tests." data-toggle="popover" href="/tests/v2/Input/t76.abi" target="_blank">t76.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
First dataset : compute the density
Second dataset : compute the spinor wfs at one k point,
non-self consistently
Third dataset : use the spinor wfs of the previous dataset
to restart computations at symmetric k points." data-toggle="popover" href="/tests/v3/Input/t13.abi" target="_blank">t13.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ta, single atom in a box (1k point). Same as test v2 #84
HGH pseudopotential
Ecut and acell are NOT realistic. One would need 20 Ha
and a 20x20x20 box, while here we have 5 Ha and a 12x12x12 box.
Prepare the analysis of next test
level  degeneracy       energy (Ha)  spin-orbit splitting
6s      2               -0.194573
5d3/2   4               -0.141779
5d5/2   6               -0.119933       0.0218
6p1/2   2               -0.050542
6p3/2   4               -0.031281       0.0193" data-toggle="popover" href="/tests/v4/Input/t36.abi" target="_blank">t36.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using PAW, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the spin-orbit coupling
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)
Also tests spnorbscl and pawcpxocc variables reserved to exp. users." data-toggle="popover" href="/tests/v5/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi atom in a big supercell.
Test the application of a Zeeman field." data-toggle="popover" href="/tests/v6/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="test partial dos calculation with spinors (previously not enabled) and spin
polarization while we are at it" data-toggle="popover" href="/tests/v7/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
Check jointly the charge and vector magnetization constraints, with differing vector orientations." data-toggle="popover" href="/tests/v8/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with PAW atomic data." data-toggle="popover" href="/tests/v9/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with the same PAW atomic data, however defaulting to usexcnhat=0." data-toggle="popover" href="/tests/v9/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
</ul>
</details>
<p>If  <strong>nspinor</strong>  = 1, usual case: scalar wavefunction (compatible with
(<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 1) as well as (<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 2) )</p>
<p>If  <strong>nspinor</strong>  = 2, the wavefunction is a spinor (compatible with <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1,
with <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 1 or 4, but not with <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2)</p>
<p>When  <strong>nspinor</strong>  is 2, the values of <a class="wikilink codevar-wikilink" href="/variables/dev#istwfk">istwfk</a> are automatically set to 1.
Also, the number of bands, for each k-point, should be even.</p>
<h2 id="ntypalch"><strong>ntypalch</strong><a class="headerlink" href="#ntypalch" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of TYPe of atoms that are &ldquo;ALCHemical&rdquo;<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the types of atoms that form the system" data-toggle="popover" href="/topics/AtomTypes">topic_AtomTypes</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms (well, with no mixing, just for a test)
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
The first psp is Si, the second one is Ge, but the
mixing coefficients are 1.0 and 0.0 .
See test 4 of v2, except with alchemy." data-toggle="popover" href="/tests/v3/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Ge, the second one is Si, but the
mixing coefficients are 0.0 and 1.0 .
See previous test, except GS only, and the two atoms are switched." data-toggle="popover" href="/tests/v3/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Si, the second one is Si, the
mixing coefficients are 0.2 and 0.8 , then, in a second
dataset, they are 0.5 and 0.5 .
Should give same numerical results as the previous test." data-toggle="popover" href="/tests/v3/Input/t94.abi" target="_blank">t94.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Si, the second one is Ge, the
mixing coefficients are 0.2 and 0.8, then
0.5 and 0.5 , then 0.001 and 0.999 ." data-toggle="popover" href="/tests/v3/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Si, the second one is Ge, the
mixing coefficients are 0.5 and 0.5 . The
pseudopotentials differ from the ones of test #93 ." data-toggle="popover" href="/tests/v3/Input/t96.abi" target="_blank">t96.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fake MoSixO(1-x) molecule along the diagonal of a cube,
using alchemical pseudopotentials.
Si and O are not isovalent, so might not be
physically meaningful.
4 pairs of mixing coefficients are studied, including
one for which the occupation numbers becomes fractionary." data-toggle="popover" href="/tests/v3/Input/t97.abi" target="_blank">t97.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth atom, isolated, in a supercell.
Try alchemical pseudopotentials with spin-orbit.
Spinor calculation (nspinor=2, nspden=1, nsppol=1)
Metallic occupations.
Also compare the halved spin-orbit interaction alchemical mixing
with a pseudopotential directly prepared with halved spin-orbit interaction.
The agreement is perfect." data-toggle="popover" href="/tests/v5/Input/t44.abi" target="_blank">t44.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ga Al(1-x) Asx
Test of alchemical calculations with images.
Mostly checking the treatment of input variables and their echo.
(Tests 30-36 are more slots for testing the ground state)" data-toggle="popover" href="/tests/v6/Input/t28.abi" target="_blank">t28.abi</a></li>
</ul>
</details>
<p>Used for the generation of alchemical pseudopotentials: when <strong>ntypalch</strong> is
non-zero, alchemical mixing will be used.</p>
<p>Among the <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a> types of atoms, the last <strong>ntypalch</strong> will be
&ldquo;alchemical&rdquo; pseudoatoms, while only the first <a class="wikilink codevar-wikilink" href="/variables/gstate#ntyppure">%ntyppure</a> will be uniquely
associated with a pseudopotential (the <a class="wikilink codevar-wikilink" href="/variables/gstate#ntyppure">%ntyppure</a> first of these, actually).
The <strong>ntypalch</strong> types of alchemical pseudoatoms are to be made from the
remaining <a class="wikilink codevar-wikilink" href="/variables/gstate#npspalch">%npspalch</a> pseudopotentials.</p>
<p>In this case, the input variables <a class="wikilink codevar-wikilink" href="/variables/gstate#algalch">algalch</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#mixalch">mixalch</a> are active, and
generate alchemical potentials from the available pseudopotentials. See these
input variables, especially <a class="wikilink codevar-wikilink" href="/variables/gstate#mixalch">mixalch</a>, to understand how to use alchemical
potentials in ABINIT.</p>
<h2 id="ntyppure"><strong>ntyppure</strong><a class="headerlink" href="#ntyppure" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of TYPe of atoms that are &ldquo;PURE&rdquo;<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INTERNAL_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the types of atoms that form the system" data-toggle="popover" href="/topics/AtomTypes">topic_AtomTypes</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>-<a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a><br />
<em>Added in version:</em> before_v9  </p>
<p>Gives the number of type of atoms that are &ldquo;pure&rdquo; when alchemical mixing is
used (<a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a> /= 0):</p>
<p><strong>ntyppure</strong>  = <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a> - <a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a></p>
<h2 id="nucdipmom"><strong>nucdipmom</strong><a class="headerlink" href="#nucdipmom" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> NUClear DIPole MOMents<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to calculate NMR chemical shieldings" data-toggle="popover" href="/topics/NMR">topic_NMR</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to take into account an external magnetic field" data-toggle="popover" href="/topics/MagField">topic_MagField</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>)<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> = 1; <a class="wikilink codevar-wikilink" href="/variables/paw#pawcpxocc">pawcpxocc</a> = 2; <a class="wikilink codevar-wikilink" href="/variables/dev#optforces">optforces</a> = 0; <a class="wikilink codevar-wikilink" href="/variables/gstate#optstress">optstress</a> = 0; <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 0, 4, or 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [9/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a></li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test presence of nuclear magnetic dipole moments on atomic sites" data-toggle="popover" href="/tests/v7/Input/t32.abi" target="_blank">t32.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP" data-toggle="popover" href="/tests/v9/Input/t140.abi" target="_blank">t140.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nspinor 2" data-toggle="popover" href="/tests/v9/Input/t141.abi" target="_blank">t141.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nsppol 2" data-toggle="popover" href="/tests/v9/Input/t142.abi" target="_blank">t142.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism in metallic sodium" data-toggle="popover" href="/tests/v9/Input/t143.abi" target="_blank">t143.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP with discretized wavefunctions" data-toggle="popover" href="/tests/v9/Input/t144.abi" target="_blank">t144.abi</a></li>
</ul>
</details>
<p>Places an array of nuclear magnetic dipole moments on the atomic
positions, useful for computing the magnetization in the presence of
nuclear dipoles and thus the chemical shielding by the converse method (see <a class="wikilink codevar-wikilink" href="/variables/dfpt#orbmag">orbmag</a>,
<a class="wikilink citation-wikilink" data-tippy-content="A converse approach to the calculation of NMR shielding tensors" data-toggle="popover" href="/theory/bibliography#thonhauser2009">[Thonhauser2009]</a> and <a class="wikilink citation-wikilink" data-tippy-content="Orbital magnetism and chemical shielding in the projector augmented-wave formalism" data-toggle="popover" href="/theory/bibliography#zwanziger2023">[Zwanziger2023]</a>). The presence of these dipoles breaks time
reversal symmetry and lowers the overall spatial symmetry.  The dipole
moment values are entered in atomic units, as vectors in the Cartesian (not crystallographic)
coordinate frame. For reference, note that
one Bohr magneton has value <span><span class="MathJax_Preview">1/2</span><script type="math/tex">1/2</script></span> in atomic units, while one nuclear
Bohr magneton has value <span><span class="MathJax_Preview">2.7321\times 10^{-4}</span><script type="math/tex">2.7321\times 10^{-4}</script></span> in atomic units.</p>
<h2 id="nwfshist"><strong>nwfshist</strong><a class="headerlink" href="#nwfshist" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of WaveFunctionS HISTory<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculations on a wavelet basis" data-toggle="popover" href="/topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [16/1245] in all abinit tests, [9/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Water molecule in a big box" data-toggle="popover" href="/tests/bigdft/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with geometry optimisation using BFGS (test the reformating part of the code)." data-toggle="popover" href="/tests/bigdft/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si single atom with fractional occupation." data-toggle="popover" href="/tests/bigdft/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Pt single atom with semi-core electrons, Krack pseudopotentials (pspcod = 10),
and colinear spin polarisation (GGA functional)." data-toggle="popover" href="/tests/bigdft/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a></li>
</ul>
</details>
<p>In the wavelet basis set, the ground state is found by direct minimisation.
The algorithm used can be either the steepest descent or the DIIS (Direct Inversion of Iteration Space).
When  <strong>nwfshist</strong>  = 0, the steepest descent is used ( <em>i.e.</em> there is no history storage of the previous iterations).</p>
<p>If  <strong>nwfshist</strong>  is strictly positive, a DIIS is used. A typical value is 6. Using
a DIIS increases the memory required by the program since N previous
wavefunctions are stored during the electronic minimisation.</p>
<h2 id="occ"><strong>occ</strong><a class="headerlink" href="#occ" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OCCupation numbers<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">EVOLVING</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify bands and occupation numbers, for metals or insulators" data-toggle="popover" href="/topics/BandOcc">topic_BandOcc</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>,<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>)<br />
<em>Commentdims:</em> in case <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>=2, dimensions are (<a class="wikilink codevar-wikilink" href="/variables/internal#mband">%mband</a>,<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>,<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>)<br />
<em>Default value:</em> <em>0<br />
*Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [712/1245] in all abinit tests, [79/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si single atom with fractional occupation." data-toggle="popover" href="/tests/bigdft/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Pt single atom with semi-core electrons, Krack pseudopotentials (pspcod = 10),
and colinear spin polarisation (GGA functional)." data-toggle="popover" href="/tests/bigdft/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Oxygen atom
Test a few functionals for which HGH pseudopotentials are available (from M. Krack),
that are present also in the lib XC, but not in the native ABINIT set of functionals." data-toggle="popover" href="/tests/libxc/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Total energy vs. cell size for bulk FCC aluminium, to compare with the
PSML results of t08 and t12" data-toggle="popover" href="/tests/psml/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Al fcc metal - elastic constant calculation" data-toggle="popover" href="/tests/tutorespfn/Input/telast_6.abi" target="_blank">telast_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
the sequence of datasets makes the ground states and
all of the explicit perturbations of the single
Al atom in all directions, for the irreducible
qpoints in a 2x2x2 grid.
Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_1.abi" target="_blank">teph_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_5.abi" target="_blank">teph4mob_5.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H atom in a big box
Same file as tbase1_1.abi, except that natom, typat, and xcart were changed,
and that the input variables nband, nsppol, occ and occopt are used." data-toggle="popover" href="/tests/tutorial/Input/tbase1_5.abi" target="_blank">tbase1_5.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj to test restarxf -1" data-toggle="popover" href="/tests/v10/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj restarting from HIST file using restarxf -1" data-toggle="popover" href="/tests/v10/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Yb (1 atom per unit cell),
using a l=3 psp with s local part.
Crazy cut-off and number of k points.
Shows that the derivative of the eigenenergies
with respect to the wavevector can be obtained
both by finite differences and analytical means
(from a preliminary computation in the
treatment of the ddk perturbation).
For the (0.25,0.25,0.25) k point,
the tenth band eigenvalue is -3.01209 eV.
Going to the (0.251,0.251,0.251) k point
it becomes -3.00562 eV, with finite-difference
estimation of the derivative with respect
to ONE wavevector change (all three
components changed) being 0.00647 eV/0.001/3=2.157 eV
This value is unchanged when using the
data at the (0.253,0.253,0.253) k point.
The analytical value is 2.15566 eV." data-toggle="popover" href="/tests/v3/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives occupation numbers for all bands in the problem. Needed if <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> == 0
or <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> == 2. Ignored otherwise (automatically computed). Also ignored when <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> = -2.
Typical band occupancy is either 2.0 or 0.0, but will usually be 1.0 or 0.0 for <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>=2, or <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a>=2,
or half-occupied band, or other choices in special circumstances.</p>
<p>If <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> is not 2, then the occupancies must be the same for each k point.
If <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>=1, the total number of arrays which must be provided is <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, in order of increasing energy.
If <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>=2, the total number of arrays which must be provided is <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>*<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>,
first spin up, in order of increasing electronic eigenenergy, then spin down, in order of increasing electronic eigenenergy.</p>
<p>If <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> = 2, then the band occupancies must be provided explicitly for
each band, EACH k POINT, and EACH SPIN-POLARIZATION, in an array which runs
over all bands, k points, and spin-polarizations.
The order of entries in the array would correspond to all bands at the first k
point (spin up), then all bands at the second k point (spin up), etc, then all
k-points spin down.
The total number of array elements which must be provided is
( <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>(1)+<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>(2)+&hellip;+ <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>(<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>) ) * <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>.</p>
<p>The occupation numbers evolve only for metallic occupations, that is, <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> ≥ 3.</p>
<p>When there are several images,  <strong>occ</strong>  might depend on the image number, see the description in <a class="wikilink codevar-wikilink" href="/variables/rlx#nimage">nimage</a>.</p>
<h2 id="optdriver"><strong>optdriver</strong><a class="headerlink" href="#optdriver" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OPTions for the DRIVER<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a GW- Lanczos-Sternheimer calculation" data-toggle="popover" href="/topics/GWls">topic_GWls</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the matrix elements of the electron-phonon interaction" data-toggle="popover" href="/topics/ElPhonInt">topic_ElPhonInt</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a GW calculation, including self-consistency" data-toggle="popover" href="/topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a Bethe-Salpeter calculation of neutral excitation energies and dielectric function" data-toggle="popover" href="/topics/BSE">topic_BSE</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a>, <a class="wikilink topic-wikilink" data-tippy-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-toggle="popover" href="/topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-toggle="popover" href="/topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [190/1245] in all abinit tests, [35/159] in abinit tutorials</summary><ul>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-toggle="popover" href="/tests/libxc/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-toggle="popover" href="/tests/libxc/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation HSE with the GW code.
The Fock exchange mixing parameter is tunable." data-toggle="popover" href="/tests/libxc/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="GW calculation for crystalline alpha-quartz. Screening calculation" data-toggle="popover" href="/tests/tutoparal/Input/tmbt_2.abi" target="_blank">tmbt_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-toggle="popover" href="/tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use...
example for post-processing mode of ABINIT-Wannier90 with wfk_task" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_7.abi" target="_blank">tw90_7.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_5.abi" target="_blank">teph4mob_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_6.abi" target="_blank">teph4mob_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_7.abi" target="_blank">teph4mob_7.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-toggle="popover" href="/tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-toggle="popover" href="/tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Convergence of the number of bands in the transition space." data-toggle="popover" href="/tests/tutorial/Input/tbs_3.abi" target="_blank">tbs_3.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-toggle="popover" href="/tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-toggle="popover" href="/tests/v3/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-toggle="popover" href="/tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-toggle="popover" href="/tests/v4/Input/t85.abi" target="_blank">t85.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-toggle="popover" href="/tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-toggle="popover" href="/tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-toggle="popover" href="/tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized.
However nsppol=2 for testing purposes.
Over 1200 WARNINGS.
This test must give the same results of the test 64
non-linear response with nsppol=1 does not support MPI with nprocs &gt; 1" data-toggle="popover" href="/tests/v6/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized
Over 1200 WARNINGS.
This test must give the same results of the test 63" data-toggle="popover" href="/tests/v6/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl Molecule in a big box
3DTE calculation with only one k-point" data-toggle="popover" href="/tests/v6/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Similar to v7[07]. Here we test optdriver 8 (WFK post-processing) with NC
and SO. More specifically, we reconstruct the wavefunctions in the full BZ in
dataset 2 and we use this WFK to restart the calculation in dataset 3 with
the full k-mesh (kptopt 3). The SCF cycle should exit at the first iteration
since the wavefunctions are already converged." data-toggle="popover" href="/tests/v7/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Random stopping power within RPA and TD-LDA" data-toggle="popover" href="/tests/v7/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-toggle="popover" href="/tests/v8/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 48, 49 and 50." data-toggle="popover" href="/tests/v8/Input/t47.abi" target="_blank">t47.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t57.abi" target="_blank">t57.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-toggle="popover" href="/tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-toggle="popover" href="/tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-toggle="popover" href="/tests/v9/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-toggle="popover" href="/tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use...
Adapted from t01, to test wfd-wannier interface" data-toggle="popover" href="/tests/wannier90/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
</ul>
</details>
<p>For each dataset, choose the task to be done, at the level of the &ldquo;driver&rdquo; routine.</p>
<p>The choice is among:</p>
<ul>
<li>0 &rarr; ground-state calculation (GS), routine <em>gstate</em></li>
<li>1 &rarr; response-function calculation (RF), routine <em>respfn</em></li>
<li>2 &rarr; susceptibility calculation (SUS), routine <em>suscep</em></li>
<li>3 &rarr; susceptibility and dielectric matrix calculation (SCR), routine <em>screening</em></li>
<li>4 &rarr; self-energy calculation (SIG), routine <em>sigma</em>.</li>
<li>5 &rarr; non-linear response functions (NONLINEAR), using the 2n+1 theorem, routine <em>nonlinear</em>.</li>
<li>6 &rarr; GW real space imaginary time driver (GWR), using the <a class="wikilink citation-wikilink" data-tippy-content="Cubic scaling GW: Towards fast quasiparticle calculations" data-toggle="popover" href="/theory/bibliography#liu2016">[Liu2016]</a> algorithm, routine <em>gwr_driver</em>, see <a class="wikilink codevar-wikilink" href="/variables/gw#gwr_task">gwr_task</a>.</li>
<li>7 &rarr; electron-phonon coupling (EPH), see also <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> input variable.</li>
<li>8 &rarr; Post-processing of WFK file, routine <em>wfk_analyze</em>. See also <a class="wikilink codevar-wikilink" href="/variables/gstate#wfk_task">wfk_task</a> input variable.</li>
<li>10 &rarr; longwave response functions (LONGWAVE), routine <em>longwave</em>. See also <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_flexo">lw_flexo</a>,  <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_qdrpl">lw_qdrpl</a> or <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_natopt">lw_natopt</a> input variables.</li>
<li>66 &rarr; GW using Lanczos-Sternheimer, see input variables whose name start with <code>gwls_*</code>.</li>
<li>99 &rarr; Bethe-Salpeter calculation (BSE), routine <em>bethe_salpeter</em></li>
</ul>
<p>If one of <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfphon">rfphon</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfddk">rfddk</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a>, or <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> is non-zero, while
<strong>optdriver</strong> is not defined in the input file, ABINIT will set <strong>optdriver</strong>
to 1 automatically. These input variables (<a class="wikilink codevar-wikilink" href="/variables/dfpt#rfphon">rfphon</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfddk">rfddk</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a>,
and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a>) must be zero if <strong>optdriver</strong> is not set to 1.</p>
<h2 id="optstress"><strong>optstress</strong><a class="headerlink" href="#optstress" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OPTion for the computation of STRESS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the computation of forces and stresses" data-toggle="popover" href="/topics/ForcesStresses">topic_ForcesStresses</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [80/1245] in all abinit tests, [17/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule NON-spin-polarized, in a big box, without tetragonal symmetry, in order to avoid
spurious degeneracy effects coupled to occupation numbers rapidly changing.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization." data-toggle="popover" href="/tests/libxc/Input/t70.abi" target="_blank">t70.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). NC,istwfk&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t37.abi" target="_blank">t37.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test cprj_in_memory=1 with xg_nonlop_option=0 or 1 (releveant for chebfi2 only). PAW,nspinor=2,npband=4" data-toggle="popover" href="/tests/paral/Input/t38.abi" target="_blank">t38.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of forces in finite electric fields
(contributed by J. Zwanziger, adapted from efield tutorial.)
Cannot be executed with more than 1 MPI node." data-toggle="popover" href="/tests/seq/Input/tsv7_70.abi" target="_blank">tsv7_70.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
First step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_1.abi" target="_blank">tpositron_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Second step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, &quot;conventional&quot; scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_2.abi" target="_blank">tpositron_2.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). Should give same results than v10[04]. PAW,istwfk=1" data-toggle="popover" href="/tests/v10/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk=1,nsppol=2." data-toggle="popover" href="/tests/v10/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,nspinor=2" data-toggle="popover" href="/tests/v10/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiH rocksalt structure with a negative lithium vacancy
test thee potential alignement usepotzero=0,1" data-toggle="popover" href="/tests/v7/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test presence of nuclear magnetic dipole moments on atomic sites" data-toggle="popover" href="/tests/v7/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the electron-positron Doppler broadening
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Computes the positron lifetime and well as the electron-positron
pairs momentum distributions, after the SCF iterations." data-toggle="popover" href="/tests/v7/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces and stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces at every iteration, compute stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t74.abi" target="_blank">t74.abi</a> &hellip;</li>
</ul>
</details>
<p>If set to 1, the computation of stresses is done, in the SCF case (under the
conditions <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt; 0, <a class="wikilink codevar-wikilink" href="/variables/files#prtstm">prtstm</a> == 0, <a class="wikilink codevar-wikilink" href="/variables/gstate#positron">positron</a> == 0, and either
<a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a> &gt;0, or <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 0 or <a class="wikilink codevar-wikilink" href="/variables/files#irdwfk">irdwfk</a> == 1).
Otherwise, to save CPU time, if no optimization of the cell is required, one
can skip the computation of stresses. The CPU time saving might be interesting
for some PAW calculations.</p>
<h2 id="posdoppler"><strong>posdoppler</strong><a class="headerlink" href="#posdoppler" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> POSitron computation of DOPPLER broadening<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a calculation with a positron in the system." data-toggle="popover" href="/topics/positron">topic_positron</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Fifth step of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_5.abi" target="_blank">tpositron_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Sixth step (part 2) of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW - 12 valence electrons
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_7.abi" target="_blank">tpositron_7.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the electron-positron Doppler broadening
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Computes the positron lifetime and well as the electron-positron
pairs momentum distributions, after the SCF iterations." data-toggle="popover" href="/tests/v7/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p>Relevant only when <a class="wikilink codevar-wikilink" href="/variables/gstate#positron">positron</a>/=0.
This input parameter activates the calculation of the Doppler broadening of
the electron-positron annihilation radiation.
An output file containing the momentum distributions of annihilating electron-positron pairs is created.
Such a computation needs a core wave-function file (per atom type) to be
provided. This core WF file should be named &lsquo;<strong>psp_file_name</strong>.corewf&rsquo; (where
<strong>pspfile_name</strong> is the name of the pseudo-potential (or PAW) file) or
&lsquo;corewf.abinit**ityp**&rsquo; (where <strong>ityp</strong> is the index of the atom type). Core WF
files can be obtained with the atompaw tool by the use of <strong>prtcorewf</strong> keyword.</p>
<h2 id="positron"><strong>positron</strong><a class="headerlink" href="#positron" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> POSITRON calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a calculation with a positron in the system." data-toggle="popover" href="/topics/positron">topic_positron</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [11/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
First step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_1.abi" target="_blank">tpositron_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Second step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, &quot;conventional&quot; scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_2.abi" target="_blank">tpositron_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Third step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, self-consistent scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_3.abi" target="_blank">tpositron_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Fourth step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, relaxation effect" data-toggle="popover" href="/tests/tutorial/Input/tpositron_4.abi" target="_blank">tpositron_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Fifth step of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_5.abi" target="_blank">tpositron_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Sixth step (part 1) of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW - 12 valence electrons
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_6.abi" target="_blank">tpositron_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Sixth step (part 2) of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW - 12 valence electrons
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_7.abi" target="_blank">tpositron_7.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al FCC, in conventional cell (4 atoms/cell).
Preparation of the positron calculation, test#96." data-toggle="popover" href="/tests/v4/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Al FCC, in conventional cell (4 atoms/cell).
Positron calculation : lifetime and decay rate." data-toggle="popover" href="/tests/v4/Input/t96.abi" target="_blank">t96.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the electron-positron Doppler broadening
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Computes the positron lifetime and well as the electron-positron
pairs momentum distributions, after the SCF iterations." data-toggle="popover" href="/tests/v7/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p>This input parameter can be positive or negative.
Negative values for  <strong>positron</strong>  are only relevant for PAW calculations.
Electron-positron correlation functional is defined by <a class="wikilink codevar-wikilink" href="/variables/gstate#ixcpositron">ixcpositron</a>.
Other relevant input parameter: <a class="wikilink codevar-wikilink" href="/variables/gstate#posocc">posocc</a> (occupation number for the
positron).</p>
<p>Positive values for  <strong>positron</strong> :
For  <strong>positron</strong>  = 1 or 2, will perform the calculation of positron
lifetime (and annihilation rate).</p>
<ul>
<li><strong>positron</strong>  = 1:\n
Starting from a previous electronic GS density (with  <strong>positron</strong>  = 0), a
positronic ground-state calculation is performed, considering that the
electrons are not perturbed by the presence of the positron.
This is almost correct for a positron in a perfect bulk material. But this
approximation fails when defects exist in the material (for instance: the
positron might be trapped by a vacancy).
The electronic density will be automatically read from a _DEN file (with or
without <a class="wikilink codevar-wikilink" href="/variables/files#irdden">irdden</a> keyword).
At the end of the SCF cycle, the positron lifetime and annihilation rate are
printed out.</li>
</ul>
<p>Additional information for the use of pseudopotentials:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">PAW</span> <span class="nt">datasets</span><span class="o">:</span> <span class="nt">nothing</span> <span class="nt">to</span> <span class="nt">do</span><span class="o">;</span> <span class="nt">simply</span> <span class="nt">use</span> <span class="nt">usual</span> <span class="nt">electronic</span> <span class="nt">PAW</span> <span class="nt">datasets</span>
<span class="nt">Norm-conserving</span> <span class="nt">pseudopotentials</span><span class="o">:</span> <span class="nt">One</span> <span class="nt">has</span> <span class="nt">to</span> <span class="nt">use</span> <span class="nt">specific</span> <span class="nt">pseudopotentials</span> <span class="nt">for</span> <span class="nt">the</span> <span class="nt">positron</span> <span class="nt">calculation</span><span class="o">.</span> <span class="nt">They</span> <span class="nt">must</span> <span class="nt">be</span> <span class="nt">of</span> <span class="nt">the</span> <span class="nt">FHI</span> <span class="nt">type</span> <span class="o">(</span><span class="nt">pspcod</span><span class="o">=</span><span class="nt">6</span><span class="o">),</span> <span class="nt">and</span> <span class="nt">must</span> <span class="nt">contain</span> <span class="nt">at</span> <span class="nt">their</span> <span class="nt">end</span><span class="o">,</span> <span class="nt">the</span> <span class="nt">all-electrons</span> <span class="nt">core</span> <span class="nt">density</span> <span class="nt">generated</span> <span class="nt">with</span> <span class="nt">FHI98PP</span><span class="o">.</span> <span class="nt">They</span> <span class="nt">must</span> <span class="nt">have</span> <span class="nt">lmax</span><span class="o">=</span><span class="nt">lloc</span><span class="o">=</span><span class="nt">0</span> <span class="o">(</span><span class="nt">check</span> <span class="nt">that</span> <span class="nt">this</span> <span class="nt">works</span> <span class="nt">for</span> <span class="nt">the</span> <span class="nt">electronic</span> <span class="nt">GS</span> <span class="o">!!</span> <span class="nt">No</span> <span class="nt">ghost</span><span class="o">,</span> <span class="nt">etc</span><span class="o">...).</span> <span class="nt">Otherwise</span><span class="o">,</span> <span class="nt">their</span> <span class="nt">are</span> <span class="nt">similar</span> <span class="nt">to</span> <span class="nt">an</span> <span class="nt">usual</span> <span class="nt">FHI</span> <span class="nt">pseudopotential</span><span class="o">.</span>
</code></pre></div>

<ul>
<li><strong>positron</strong>  = 2:\n
Starting from a previous positronic GS density (with  <strong>positron</strong>  = 1 ), an
electronic ground-state calculation is performed, keeping the positronic
density constant.
The positronic density will be automatically read from a _DEN file (with or
without <a class="wikilink codevar-wikilink" href="/variables/files#getden">getden</a>/<a class="wikilink codevar-wikilink" href="/variables/files#irdden">irdden</a> keyword).
At the end of the SCF cycle, the positron lifetime and annihilation rate are
printed out.</li>
</ul>
<p>Additional information for the use of pseudopotentials:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">PAW</span> <span class="nt">datasets</span><span class="o">:</span> <span class="nt">nothing</span> <span class="nt">to</span> <span class="nt">do</span><span class="o">;</span> <span class="nt">simply</span> <span class="nt">use</span> <span class="nt">usual</span> <span class="nt">electronic</span> <span class="nt">PAW</span> <span class="nt">datasets</span>
<span class="nt">Norm-conserving</span> <span class="nt">pseudopotentials</span><span class="o">:</span> <span class="nt">One</span> <span class="nt">has</span> <span class="nt">to</span> <span class="nt">use</span> <span class="nt">specific</span> <span class="nt">pseudopotentials</span> <span class="nt">for</span> <span class="nt">the</span> <span class="nt">electron</span> <span class="nt">calculation</span><span class="o">.</span> <span class="nt">They</span> <span class="nt">must</span> <span class="nt">be</span> <span class="nt">of</span> <span class="nt">the</span> <span class="nt">FHI</span> <span class="nt">type</span> <span class="o">(</span><span class="nt">pspcod</span><span class="o">=</span><span class="nt">6</span><span class="o">),</span> <span class="nt">and</span> <span class="nt">must</span> <span class="nt">contain</span> <span class="nt">at</span> <span class="nt">their</span> <span class="nt">end</span><span class="o">,</span> <span class="nt">the</span> <span class="nt">all-electrons</span> <span class="nt">core</span> <span class="nt">density</span> <span class="nt">generated</span> <span class="nt">with</span> <span class="nt">FHI98PP</span><span class="o">.</span>
</code></pre></div>

<ul>
<li><strong>Typical use</strong>:\n
The calculation is done in several steps:
The first one is a normal GS calculation for the electrons, with  <strong>positron</strong>  = 0.
The only specific thing to do is to set <a class="wikilink codevar-wikilink" href="/variables/files#prtden">prtden</a> = 1 (this is the default
for ABINIT v6.x+). This will create the associated _DEN file which will be
used as input file for the positronic GS calculation.
The second step is the GS calculation of the positron and subsequently its
lifetime, with  <strong>positron</strong>  =1. One has to define also <a class="wikilink codevar-wikilink" href="/variables/gstate#ixcpositron">ixcpositron</a>.
Then, it is possible to perform an additional step, computing the GS
electronic density in presence of the positron, with  <strong>positron</strong>  = 2 and so on&hellip;
This procedure can be automated (for PAW only) by the use of a negative value
for  <strong>positron</strong> .
At the end, a converged value of the positron lifetime (decomposed in several
contributions) is printed.
See also <a class="wikilink codevar-wikilink" href="/variables/gstate#posdoppler">posdoppler</a> keyword for the calculation of Doppler broadening.</li>
</ul>
<p>Negative values for  <strong>positron</strong> :\n
For  <strong>positron</strong> &lt;0, will perform an automatic calculation of electrons and
positron densities in the two-component DFT context; then will compute
positron lifetime (and annihilation rate).</p>
<ul>
<li>
<p><strong>positron</strong>  = -1:\n
Starting from scratch, will first perform a usual electronic ground-state
calculation until convergence (controlled by the use of one of the <em>tolerance</em>
keywords).
Then will perform a positronic ground state calculation in presence of the
electrons and ions; then an electronic ground state calculation in presence of
the positron and the ions and so on until the total energy is converged.
The convergence of the total energy of the ions+electrons+positron system is
controlled by the use of the <a class="wikilink codevar-wikilink" href="/variables/gstate#postoldfe">postoldfe</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#postoldff">postoldff</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#posnstep">posnstep</a>
input keywords.
With  <strong>positron</strong>  = -1, at the beginning of each new electronic/positronic
step, the wave functions are unknown.</p>
</li>
<li>
<p><strong>positron</strong>  = -10:\n
Same as  <strong>positron</strong>  = -1 except that the electronic/positronic wave functions
are stored in memory.
Consequently, the total number of iterations to reach the convergence
(<span><span class="MathJax_Preview">\Delta</span><script type="math/tex">\Delta</script></span>Etotal&lt;<a class="wikilink codevar-wikilink" href="/variables/gstate#postoldfe">postoldfe</a> or <span><span class="MathJax_Preview">\Delta</span><script type="math/tex">\Delta</script></span>Forces&lt;<a class="wikilink codevar-wikilink" href="/variables/gstate#postoldff">postoldff</a>) is smaller.
But, this can increase the total amount of memory needed by the code.</p>
</li>
<li>
<p><strong>positron</strong>  = -2:\n
Same as  <strong>positron</strong>  = -1 except that the two-component DFT cycle is forced to
stop at the end of an electronic step.</p>
</li>
<li>
<p><strong>positron</strong>  = -20:\n
Same as  <strong>positron</strong>  = -10 except that the two-component DFT cycle is forced to
stop at the end of an electronic step.</p>
</li>
</ul>
<p>Advice for use:
There are two typical cases which have to be differently treated:</p>
<ul>
<li>
<p><strong>A positron in a perfect <em>bulk</em> system</strong>:\n
In that case, the positron is delocalized in the whole crystal. Its density is
almost zero.
Thus, the &ldquo;zero density positron limit&rdquo; has to be used. <a class="wikilink codevar-wikilink" href="/variables/gstate#ixcpositron">ixcpositron</a> has to
be chosen accordingly.
In order to have the zero density positron limit it is advised to follow these
points:</p>
</li>
<li>
<p>1- Put a small positronic charge (by setting a <a class="wikilink codevar-wikilink" href="/variables/gstate#posocc">posocc</a> to a small value) <strong>OR</strong> use a big supercell.</p>
</li>
<li>2- Use only k=<span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> wave vector for the positronic calculation.</li>
<li>3- Use the manual procedure in 2 steps: first  <strong>positron</strong>  = 0 and then  <strong>positron</strong>  = 1; avoid the  <strong>positron</strong>  = 2 step and the automatic procedure ( <strong>positron</strong> &lt;0).</li>
</ul>
<p>In principle, the positron lifetime should converge with the value of
<a class="wikilink codevar-wikilink" href="/variables/gstate#posocc">posocc</a> or the size of the supercell.</p>
<ul>
<li><strong>A positron trapped in a <em>default</em> (vacancy)</strong>:\n
In that case, the positron is localized in the default. Its density can be
localized in the simulation cell (provided that the cell is sufficiently
large) and influences the electronic density.
So, it is advised to use the automatic procedure ( <strong>positron</strong> &lt;0) or the
manual procedure with several  <strong>positron</strong>  = 0,1,2,1,&hellip; steps.
K-points can be used as in usual electronic calculations.
Also note that it is possible to use forces and stresses to perform structural
minimization.</li>
</ul>
<p>References: <a class="wikilink citation-wikilink" data-tippy-content="Electron liquid in collective description. III. Positron annihilation" data-toggle="popover" href="/theory/bibliography#arponen1979a">[Arponen1979a]</a>, <a class="wikilink citation-wikilink" data-tippy-content="Electron-positron density-functional theory" data-toggle="popover" href="/theory/bibliography#boronski1986">[Boronski1986]</a>, <a class="wikilink citation-wikilink" data-tippy-content="First-principles calculation of positron lifetimes in solids" data-toggle="popover" href="/theory/bibliography#sterne1991">[Sterne1991]</a>, <a class="wikilink citation-wikilink" data-tippy-content="Electron-positron Car-Parrinello methods: Self-consistent treatment of charge densities and ionic relaxations" data-toggle="popover" href="/theory/bibliography#puska1995">[Puska1995]</a>, <a class="wikilink citation-wikilink" data-tippy-content="Gradient correction for positron states in solids" data-toggle="popover" href="/theory/bibliography#barbiellini1995">[Barbiellini1995]</a></p>
<h2 id="posnstep"><strong>posnstep</strong><a class="headerlink" href="#posnstep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> POSitron calculation: max. Number of STEPs for the two-component DFT<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a calculation with a positron in the system." data-toggle="popover" href="/topics/positron">topic_positron</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 50<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Third step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, self-consistent scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_3.abi" target="_blank">tpositron_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Fourth step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, relaxation effect" data-toggle="popover" href="/tests/tutorial/Input/tpositron_4.abi" target="_blank">tpositron_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Fifth step of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_5.abi" target="_blank">tpositron_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Sixth step (part 2) of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW - 12 valence electrons
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_7.abi" target="_blank">tpositron_7.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the electron-positron Doppler broadening
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Computes the positron lifetime and well as the electron-positron
pairs momentum distributions, after the SCF iterations." data-toggle="popover" href="/tests/v7/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p>Relevant only when <a class="wikilink codevar-wikilink" href="/variables/gstate#positron">positron</a>&lt;0.
Sets the maximum number of electronic/positronic iterations that, when
reached, will cause the two-component DFT SCF cycle to stop.
The code will first compute the electronic ground-state, then the positronic
ground state in the electronic density, then the electronic ground state in
the positronic density until <span><span class="MathJax_Preview">\Delta</span><script type="math/tex">\Delta</script></span>Etotal&lt;<a class="wikilink codevar-wikilink" href="/variables/gstate#postoldfe">postoldfe</a> or <span><span class="MathJax_Preview">\Delta</span><script type="math/tex">\Delta</script></span>Forces&lt;<a class="wikilink codevar-wikilink" href="/variables/gstate#postoldff">postoldff</a> or the number
of electronic/positronic steps is  <strong>posnstep</strong> .</p>
<h2 id="posocc"><strong>posocc</strong><a class="headerlink" href="#posocc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> POSitron calculation: OCCupation number for the positron<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a calculation with a positron in the system." data-toggle="popover" href="/topics/positron">topic_positron</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [9/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
First step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_1.abi" target="_blank">tpositron_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Second step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, &quot;conventional&quot; scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_2.abi" target="_blank">tpositron_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Third step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, self-consistent scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_3.abi" target="_blank">tpositron_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Fourth step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, relaxation effect" data-toggle="popover" href="/tests/tutorial/Input/tpositron_4.abi" target="_blank">tpositron_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Fifth step of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_5.abi" target="_blank">tpositron_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Sixth step (part 1) of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW - 12 valence electrons
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_6.abi" target="_blank">tpositron_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Sixth step (part 2) of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW - 12 valence electrons
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_7.abi" target="_blank">tpositron_7.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the electron-positron Doppler broadening
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Computes the positron lifetime and well as the electron-positron
pairs momentum distributions, after the SCF iterations." data-toggle="popover" href="/tests/v7/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p>Relevant only when <a class="wikilink codevar-wikilink" href="/variables/gstate#positron">positron</a>/=0.
Sets the occupation number for the positron. Has to be &lt;=1.
Changing  <strong>posocc</strong>  is only useful for bulk calculation when one wants to
perform lifetime computations using a small simulation cell (can avoid the use
of a supercell). It simulates the dispersion of the positron in the whole
crystal.</p>
<h2 id="postoldfe"><strong>postoldfe</strong><a class="headerlink" href="#postoldfe" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> POSitron calculation: TOLerance on the DiFference of total Energy<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a calculation with a positron in the system." data-toggle="popover" href="/topics/positron">topic_positron</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1e-06 if <a class="wikilink codevar-wikilink" href="/variables/gstate#postoldff">postoldff</a> = 0,
0.0 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Third step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, self-consistent scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_3.abi" target="_blank">tpositron_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Fourth step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, relaxation effect" data-toggle="popover" href="/tests/tutorial/Input/tpositron_4.abi" target="_blank">tpositron_4.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the electron-positron Doppler broadening
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Computes the positron lifetime and well as the electron-positron
pairs momentum distributions, after the SCF iterations." data-toggle="popover" href="/tests/v7/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p>Relevant only when <a class="wikilink codevar-wikilink" href="/variables/gstate#positron">positron</a>&lt;0.
Sets a tolerance for absolute difference of total energy (of
<em>ions+electrons+positron</em> system) that, when reached, will cause the SCF cycle
to stop before the number of steps is <a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a> or the number of
electronic/positronic steps is <a class="wikilink codevar-wikilink" href="/variables/gstate#posnstep">posnstep</a>.</p>
<p>Can be specified in Ha (the default), Ry, eV or Kelvin, since  <strong>postoldfe</strong>  has the <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics.
One and only one of  <strong>postoldfe</strong>  or <a class="wikilink codevar-wikilink" href="/variables/gstate#postoldff">postoldff</a> can be set.</p>
<h2 id="postoldff"><strong>postoldff</strong><a class="headerlink" href="#postoldff" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> POSitron calculation: TOLerance on the DiFference of Forces<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a calculation with a positron in the system." data-toggle="popover" href="/topics/positron">topic_positron</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a></li>
</ul>
</details>
<p>Relevant only when <a class="wikilink codevar-wikilink" href="/variables/gstate#positron">positron</a> &lt; 0.
Sets a tolerance for absolute difference of maximum force (in hartree/Bohr) acting on ions (due
to <em>ions+electrons+positron</em> system) that, when reached, will cause the SCF
cycle to stop before the number of SCF steps is <a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a> or the number of
electronic/positronic steps is <a class="wikilink codevar-wikilink" href="/variables/gstate#posnstep">posnstep</a>.
One and only one of <a class="wikilink codevar-wikilink" href="/variables/gstate#postoldfe">postoldfe</a> or  <strong>postoldff</strong>  can be set.</p>
<h2 id="prt_lorbmag"><strong>prt_lorbmag</strong><a class="headerlink" href="#prt_lorbmag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT L ORBital MAGnetic moment inside PAW spheres<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute atom-centered properties" data-toggle="popover" href="/topics/AtomCentered">topic_AtomCentered</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> == 4 and <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/paw#usepawu">usepawu</a> != 0<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test for the printing of the local orbital magnetic moment
of NiO (fcc supercell with 2 Ni and 2 O atoms).
Cut-off and k-points are unrealistic.
Works only in the case of PAW and DFT+U" data-toggle="popover" href="/tests/v9/Input/t112.abi" target="_blank">t112.abi</a></li>
</ul>
</details>
<p>If set to 1, prints in the output the orbital magnetic moment integrated inside the PAW spheres (Bohr magneton).
The orbital magnetic moment is resolved orbital by orbital (p, d and f, the s orbital moment being always zero) on each atom.
Works only if PAW and DFT+U is used and if the spin-orbit coupling is on (with <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> == 4).</p>
<h2 id="prtdensph"><strong>prtdensph</strong><a class="headerlink" href="#prtdensph" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT integral of DENsity inside atomic SPHeres<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [16/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U features.
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Antiferromagnetism and PAW+U
* Use of an initial and constant density matrix during the first SCF iterations" data-toggle="popover" href="/tests/v5/Input/t37.abi" target="_blank">t37.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
In t67 the ground state wfs are computed, t68 is for dfpt calculation" data-toggle="popover" href="/tests/v8/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, ground state WF" data-toggle="popover" href="/tests/v8/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=2" data-toggle="popover" href="/tests/v8/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=3" data-toggle="popover" href="/tests/v8/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, electric field perturbation with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, electric field perturbation with ixcrot=2" data-toggle="popover" href="/tests/v8/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, electric field perturbation with ixcrot=3" data-toggle="popover" href="/tests/v8/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, atomic perturbation with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, atomic perturbation with ixcrot=2" data-toggle="popover" href="/tests/v8/Input/t79.abi" target="_blank">t79.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, atomic perturbation with ixcrot=3" data-toggle="popover" href="/tests/v8/Input/t80.abi" target="_blank">t80.abi</a></li>
</ul>
</details>
<p>When this flag is activated, values of integral(s) of total density inside
sphere(s) around each atom are printed in output file (for each spin
component). Spheres around atoms are defined by a radius given by <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a> keyword.
Note: integral of density inside a sphere around an atom can be used to
determine a rough approximation of the local magnetic moment; this is
particularly useful for antiferromagnetic systems.
The algorithm to compute this integral is particularly primitive: the points
on the FFT grids, belonging to the interior of the sphere are determined, and
the value of the functions on these points are summed, taking into account a
fixed volume attributed to each point. In particular, the integral as a
function of the radius will be a constant, except when a new point enters the
sphere, in which case a sudden jump occurs. However, since the purpose of this
output is to get a rough idea of the repartition of the density, this is not a
real problem. If you are interested in a more accurate estimation of the
density within a sphere, you should use the cut3d postprocessor (<a class="wikilink user-guide-wikilink" href="/guide/cut3d">cut3d help file</a>).</p>
<h2 id="prtebands"><strong>prtebands</strong><a class="headerlink" href="#prtebands" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT Electron BANDS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0 if <a class="wikilink codevar-wikilink" href="/variables/rlx#nimage">nimage</a> &gt; 1,
1 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-toggle="popover" href="/tests/libxc/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
AFII NiO 4-atom cell | LRUJ utility | LMac 2022
Linear Response Hubbard U and Hund&#x27;s J (LRUJ)
post-processing utility for the determination of
said parameters in situ and ab initio" data-toggle="popover" href="/tests/tutorial/Input/tlruj_2.abi" target="_blank">tlruj_2.abi</a></li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj to test restarxf -1" data-toggle="popover" href="/tests/v10/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj restarting from HIST file using restarxf -1" data-toggle="popover" href="/tests/v10/Input/t82.abi" target="_blank">t82.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon linewidths and e-ph coupling parameter lambda." data-toggle="popover" href="/tests/v7/Input/t88.abi" target="_blank">t88.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="test supercell_latt construction" data-toggle="popover" href="/tests/v8/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>This option activates the output of the electron eigenvalues. Possible values:</p>
<ul>
<li>0- Disable the output of the band energies.</li>
<li>1- Write eigenvalues in xmgrace format. A file with extension <code>EBANDS.agr</code> is produced at the end of the run.
    Use <code>xmgrace file_EBANDS.agr</code> to visualize the band energies</li>
<li>2- Write eigenvalues in gnuplot format. The code produces a <code>EBANDS.dat</code> file with the eigenvalues
    and a <code>file_EBANDS.gnuplot</code> script. Use <code>gnuplot file_EBANDS.gnuplot</code> to visualize the band energies.</li>
</ul>
<h2 id="qpt"><strong>qpt</strong><a class="headerlink" href="#qpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q PoinT<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT calculations" data-toggle="popover" href="/topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [235/1245] in all abinit tests, [31/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using OpenMP GPU.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of various XC functionals for the response functions
(thus, the XC kernel is also tested).
The test includes 3 different functionals:
1) Perdew-Zunger: ixc=2 and ixc=-001009
2) PBE: ixc=11 and ixc=-101130
3) Perdew-Wang92: ixc=7, ixc=-001012, and ixc=-001013
The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent
unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting
some lines indicated by GMR.
Note that the underlying FFT grid does not have the symmetry of the
lattice." data-toggle="popover" href="/tests/libxc/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of the Perdew-Zunger XC functionals for the response functions
(thus, the XC kernel is also tested) in PAW." data-toggle="popover" href="/tests/libxc/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, NC pseudopotentials.
Test the IO routines for a typical DFPT calculation" data-toggle="popover" href="/tests/mpiio/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al; non-selfconsistent computation of wavefunctions" data-toggle="popover" href="/tests/paral/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al; non-selfconsistent computation of wavefunctions" data-toggle="popover" href="/tests/paral/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
CrystallIne AlAs
first three runs are for calculation of ground state at finite electric field
the fourth run gets the gs wavefunction and then do response calculation
the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-toggle="popover" href="/tests/seq/Input/tsv4_80.abi" target="_blank">tsv4_80.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
(see test.si.chain of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. Generate the data for optic (linear and non-linear coefficients).
to be analysed in the test 57." data-toggle="popover" href="/tests/v4/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation with the GGA
Note that this test and the following one, 59,
address more advanced features of strain perturbation than the ones
going with number 60 to 79, and were developed later, but were
placed here for convenience).
AlAs in the zincblende structure, with a choice of
pseudopotenials that include model core charges.  In the LDA, the
strain perturbation simply introduces perturbing charge densities
leading to perturbing first-order potentials in a straightforward
manner.  (This perturbation does act differently on the valence
and model core charges.)   The GGA is a non-trivial extension,
since strain perturbs the gradient operator itself.  This test
is a symmetrized and stripped-down version of a test case used in
development which yielded agreement between such RF calculations
and numerical derivatives of GS stresses and forces to 1.e-8 to
1.e-9 atomic units for the elastic tensor and intenal strain
coupling parameters.  Acheiving this agreement does require forcing
a considerably more dense fft grid than the default which is
accepted here. (ngfft= 50 50 50 was used.)  While only the PBE GGA
is tested here, all forms present in Abinit should give comparably
accurate results." data-toggle="popover" href="/tests/v4/Input/t58.abi" target="_blank">t58.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbFCl in the matlockite structure P4/nmm. 6 atoms per cell.
Compute a set of matrix elements of the dynamical matrix,
for q wavevector 0.5 0.5 0.5 .
In this test case, the symmetry operations have an important
non-symmorphic character. There was a bug in the treatment
of this material, prior to v5.2.4 ." data-toggle="popover" href="/tests/v5/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-toggle="popover" href="/tests/v5/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through qptrlatt.
Otherwise, similar to Tv2#26 and Tv6#78." data-toggle="popover" href="/tests/v6/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrO2 FCC (fluorite structure).
Compute the phonon frequencies at the X point.
This worked correctly before 5.2.4, but then, an erroneous bug fix (correcting v5#21) was introduced.
Final (correct) fixing in v6.0.4.
(Contributed by I. Lukacevic, trying to reproduce results by Detraux et al 1997)" data-toggle="popover" href="/tests/v6/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
Warning : only valid for Gamma, AND the temperature-dependent shifts must be averaged
over degenerate states." data-toggle="popover" href="/tests/v6/Input/t37.abi" target="_blank">t37.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of optic with temperature-dependent renormalization
WARNING: This feature is still under testing, files and variables could change in the next versions" data-toggle="popover" href="/tests/v67mbpt/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Silicon, DDK computation to prepare &#x27;optic&#x27;" data-toggle="popover" href="/tests/v7/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
20-electron PAW pseudo (4f in the core, but 4d10 as semi-core : 4d10 5s2 5p6 (5d0) 6s2 )
Test of computation of dielectric tensor, Born effective charges, dynamical matrix.
To keep the CPU time to a reasonable level, the responses are computed
with minimal parameters (nstep and the kpoint grid are too small,
ecut might be increased, and also pawecutdg).
Note: Charge neutrality is not achieved with the present dataset for Born Effective Charges,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 6 6 6,  ecut 40. pawecutdg 40.) gives Z(Eu)=2.5085, Z(O)=-2.4982" data-toggle="popover" href="/tests/v7/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests uses psps8 files with model core charges and valence charge densities.
We test the initialization of rhor1, rhog1 from atomic quantities and the
treatment of the non-linear core correction in G-space (nc_xccc_gspace)." data-toggle="popover" href="/tests/v7/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/v8/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test printing out the full perturbed wavefunction" data-toggle="popover" href="/tests/v8/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparatory run for the calculation of the Fan-Migdal + Debye-Waller self-energy
C in diamond structure. Very rough 2x2x2 q-point grid (3 qpoints); low ecut." data-toggle="popover" href="/tests/v8/Input/t41.abi" target="_blank">t41.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 06 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 08 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. PAW. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 10 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
</ul>
</details>
<p>WARNING : Only used if <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a> = 1. If <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>=0 (which is the default value of <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>), no reading of  <strong>qpt</strong>  is done,
and the default value of  <strong>qpt</strong> , namely the null vector, is kept.</p>
<p>Combined with <a class="wikilink codevar-wikilink" href="/variables/gstate#qptnrm">qptnrm</a>, define the q vector <a class="wikilink codevar-wikilink" href="/variables/internal#qptn">%qptn</a>(1:3) in the case
<a class="wikilink codevar-wikilink" href="/variables/gstate#qptopt">qptopt</a> = 0.</p>
<p>This input variable is not internal (<a class="wikilink codevar-wikilink" href="/variables/internal#qptn">%qptn</a>(1:3) is used instead), but is
used to echo the value of <a class="wikilink codevar-wikilink" href="/variables/internal#qptn">%qptn</a>(1:3), with renormalisation factor one.</p>
<h2 id="qptnrm"><strong>qptnrm</strong><a class="headerlink" href="#qptnrm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q PoinTs NoRMalization<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT calculations" data-toggle="popover" href="/topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiTi simple cubic (RockSalt) Metallic. Different mems are zero.
The second perturbation does not converge well !
Should be improved." data-toggle="popover" href="/tests/v3/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si diamond
Spin-polarized calculation (nspden=2)
RF phonon with q=0.5 0 0" data-toggle="popover" href="/tests/v3/Input/t86.abi" target="_blank">t86.abi</a></li>
</ul>
</details>
<p>Only used if <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a> = 1 and <a class="wikilink codevar-wikilink" href="/variables/gstate#qptopt">qptopt</a> = 0</p>
<p>Provides re-normalization of <a class="wikilink codevar-wikilink" href="/variables/gstate#qpt">qpt</a>. Must be positive, non-zero. The actual q
vector (renormalized) is <a class="wikilink codevar-wikilink" href="/variables/internal#qptn">%qptn</a>(1:3)= <a class="wikilink codevar-wikilink" href="/variables/gstate#qpt">qpt</a>(1:3)/ <strong>qptnrm</strong> .</p>
<h2 id="qptopt"><strong>qptopt</strong><a class="headerlink" href="#qptopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> QPoinTs OPTion<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT calculations" data-toggle="popover" href="/topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [14/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
the sequence of datasets makes the ground states and
all of the explicit perturbations of the single
Al atom in all directions, for the irreducible
qpoints in a 2x2x2 grid.
Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_1.abi" target="_blank">teph_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline AlAs : computation of the phonon spectrum" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_2.abi" target="_blank">trf2_2.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through qptrlatt.
Otherwise, similar to Tv2#26 and Tv6#78." data-toggle="popover" href="/tests/v6/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through ngqpt and nshiftq.
Otherwise, similar to Tv2#26" data-toggle="popover" href="/tests/v6/Input/t78.abi" target="_blank">t78.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed." data-toggle="popover" href="/tests/v7/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. The wtq variable is introduced to be able to reproduce the q-point
weight obtained with ngqpt and qptopt.
The main reason being that the initialization of large q-point (same for k-point) grid
is extremely slow. Inputing manually the qpt and wtq in the input file avoid such
inefficient initialization." data-toggle="popover" href="/tests/v7/Input/t57.abi" target="_blank">t57.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Testing of the phonon potential interpolation routines." data-toggle="popover" href="/tests/v8/Input/t65.abi" target="_blank">t65.abi</a></li>
</ul>
</details>
<p>WARNING : Only used if <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a> = 1. If <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>=0 (which is the default value of <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>), no reading of  <strong>qptopt</strong>  is done,
and the default value of  <strong>qptopt</strong>  is kept.</p>
<p>Controls the set up to generate the Q point <a class="wikilink codevar-wikilink" href="/variables/internal#qptn">%qptn</a>(1:3) to be used for the
specific dataset, either as a shift of k-point grid in ground-state
calculations, or as a stand-alone phonon wavevector.</p>
<p>There are two basic techniques to generate the Q point: either by specifying
it directly, possibly with a renormalisation factor ( <strong>qptopt</strong>  = 0), or
extracting it from a grid a Q points ( <strong>qptopt</strong>  = 1 to 4), using the index
<a class="wikilink codevar-wikilink" href="/variables/gstate#iqpt">iqpt</a>. At variance with the similar generation of k points, only ONE q
point can be used per dataset.</p>
<p>With  <strong>qptopt</strong>  = 1 to 4, rely on <a class="wikilink codevar-wikilink" href="/variables/gstate#ngqpt">ngqpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#qptrlatt">qptrlatt</a>, as well as on
<a class="wikilink codevar-wikilink" href="/variables/gstate#nshiftq">nshiftq</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#shiftq">shiftq</a> to set up a q point grid, from which the q point
with number <a class="wikilink codevar-wikilink" href="/variables/gstate#iqpt">iqpt</a> will be selected. The values  <strong>qptopt</strong>  = 1 to 4 differ by
the treatment of symmetries. Note that the symmetries are recomputed starting
from the values of <a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#spinat">spinat</a>. So, the explicit value
of <a class="wikilink codevar-wikilink" href="/variables/basic#symrel">symrel</a> are not used. This is to allow doing calculations with
<a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> = 1, sometimes needed for T-dependent electronic structure, still
decreasing the number of q points in the case  <strong>qptopt</strong>  = 1 or  <strong>qptopt</strong>  = 3.</p>
<ul>
<li>
<p>0 &rarr; read directly <a class="wikilink codevar-wikilink" href="/variables/gstate#qpt">qpt</a>, and its (possible) renormalisation factor <a class="wikilink codevar-wikilink" href="/variables/gstate#qptnrm">qptnrm</a>.</p>
</li>
<li>
<p>1 &rarr; Take fully into account the symmetry to generate the grid of q points in the Irreducible Brillouin Zone only.
    (This is the usual mode for RF calculations)</p>
</li>
<li>
<p>2 &rarr; Take into account only the time-reversal symmetry: q points will be generated in half the Brillouin zone.</p>
</li>
<li>
<p>3 &rarr; Do not take into account any symmetry: q points will be generated in the full Brillouin zone.</p>
</li>
<li>
<p>4 &rarr; Take into account all the symmetries EXCEPT the time-reversal symmetry to generate
    the k points in the Irreducible Brillouin Zone.</p>
</li>
</ul>
<p>In the case of a grid of q points, the auxiliary variables <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlen">kptrlen</a>,
<a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> and <a class="wikilink codevar-wikilink" href="/variables/files#prtkpt">prtkpt</a> might help you to select the optimal grid, similarly
to the case of the K point grid.</p>
<h2 id="qptrlatt"><strong>qptrlatt</strong><a class="headerlink" href="#qptrlatt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q - PoinTs grid: Real space LATTice<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT calculations" data-toggle="popover" href="/topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,3)<br />
<em>Default value:</em> <em>0<br />
*The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#ngqpt">ngqpt</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through qptrlatt.
Otherwise, similar to Tv2#26 and Tv6#78." data-toggle="popover" href="/tests/v6/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p>WARNING : Only used if <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a> = 1. If <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>=0 (which is the default value of <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>), no reading of  <strong>qptrlatt</strong>  is done,
and the default value of  <strong>qptrlatt</strong>  is kept.</p>
<p>This input variable is used only when <a class="wikilink codevar-wikilink" href="/variables/gstate#qptopt">qptopt</a> is positive. It partially
defines the q point grid. The other piece of information is contained in
<a class="wikilink codevar-wikilink" href="/variables/gstate#shiftq">shiftq</a>.  <strong>qptrlatt</strong>  cannot be used together with <a class="wikilink codevar-wikilink" href="/variables/gstate#ngqpt">ngqpt</a>.</p>
<p>The values  <strong>qptrlatt</strong> (1:3,1),  <strong>qptrlatt</strong> (1:3,2),  <strong>qptrlatt</strong> (1:3,3) are
the coordinates of three vectors in real space, expressed in the <a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>
coordinate system (reduced coordinates). They define a super-lattice in real
space. The k point lattice is the reciprocal of this super-lattice, possibly
shifted (see <a class="wikilink codevar-wikilink" href="/variables/gstate#shiftq">shiftq</a>).</p>
<p>If neither <a class="wikilink codevar-wikilink" href="/variables/gstate#ngqpt">ngqpt</a> nor  <strong>qptrlatt</strong>  are defined, ABINIT will automatically
generate a set of k point grids, and select the best combination of
 <strong>qptrlatt</strong>  and <a class="wikilink codevar-wikilink" href="/variables/gstate#shiftq">shiftq</a> that allows one to reach a sufficient value of
<a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlen">kptrlen</a>. See this latter variable for a complete description of this procedure.</p>
<h2 id="ratsm"><strong>ratsm</strong><a class="headerlink" href="#ratsm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Radii of the ATomic spheres SMearing<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation with constrained atomic magnetic moments" data-toggle="popover" href="/topics/MagMom">topic_MagMom</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation within constrained DFT" data-toggle="popover" href="/topics/ConstrainedDFT">topic_ConstrainedDFT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.05 if any(<a class="wikilink codevar-wikilink" href="/variables/gstate#constraint_kind">constraint_kind</a> &gt; 1),
0.0 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [12/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
Check jointly the charge and vector magnetization constraints, with differing vector orientations." data-toggle="popover" href="/tests/v8/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction" data-toggle="popover" href="/tests/v8/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2 with sphere overlap
DS2 Constrains the collinear magnetization around atom 1 to be +0.70 and around atom 2 to be -0.70
DS3 Constrains the collinear magnetization around atom 1 to be +0.70 and around atom 2 to be -0.70, and the total charge of both to be 0.00.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.70 and around atom 2 to be -0.70. Same result as DS2.
DS5 and DS6 are not really useful, simply sanity checks for imposition of axis or direction of magnetization for collinear magnetism" data-toggle="popover" href="/tests/v8/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction.
Case where the spheres overlap
Interestingly, in the case where only the magnitude of the magnetization on the second atom is fixed,
without fixing its charge, the optimal configuration gives a 90 degree difference of magnetization direction for both atoms.
It would be interesting to understand the meaning of such results, and see whether one is not in a local minimum.
A full mapping of the energy as a function of both magnitude and direction of the magnetization of the second atom would be interesting ..." data-toggle="popover" href="/tests/v8/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization." data-toggle="popover" href="/tests/v8/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization.
At present DS31 and DS32 do not work as expected ..." data-toggle="popover" href="/tests/v8/Input/t96.abi" target="_blank">t96.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization.
At present DS21, 31 and 32 do not work as expected. Hence the huge tolerance." data-toggle="popover" href="/tests/v8/Input/t97.abi" target="_blank">t97.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a></li>
</ul>
</details>
<p>Smearing width for the atomic spheres whose radius is determined by <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a>.
For each spherical zone around each atom, the integrating function goes
from 1.0 to 0.0 in an interval from <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a>- <strong>ratsm</strong>  to <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsph">ratsph</a>.
The function is the same as the one used to smear the kinetic energy, see <a class="wikilink codevar-wikilink" href="/variables/rlx#ecutsm">ecutsm</a>.</p>
<h2 id="ratsph"><strong>ratsph</strong><a class="headerlink" href="#ratsph" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Radii of the ATomic SPHere(s)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation with constrained atomic magnetic moments" data-toggle="popover" href="/topics/MagMom">topic_MagMom</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic DOS and related topics" data-toggle="popover" href="/topics/ElecDOS">topic_ElecDOS</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation within constrained DFT" data-toggle="popover" href="/topics/ConstrainedDFT">topic_ConstrainedDFT</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute atom-centered properties" data-toggle="popover" href="/topics/AtomCentered">topic_AtomCentered</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> <a class="wikilink" data-tippy-content="This is an external parameter
typically compilation parameters, available libraries, or number of processors.
You can change these parameters at compile or runtime usually.
" data-toggle="popover" href="/variables/external_parameters#auto_from_psp" title="Means that the value is read from the PSP file">AUTO_FROM_PSP</a> if <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1,
2.0 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [20/1245] in all abinit tests, [3/159] in abinit tutorials</summary><ul>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Z2Pack (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tz2_2.abi" target="_blank">tz2_2.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PAW1 tutorial
Diamond at experimental volume
Computation of Density of States" data-toggle="popover" href="/tests/tutorial/Input/tpaw1_4.abi" target="_blank">tpaw1_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe fcc structure with two atoms per unit cell for test of antiferromagnetic
This is the simplest fcc structure compatible with a X point spiral" data-toggle="popover" href="/tests/tutorial/Input/tspin_3.abi" target="_blank">tspin_3.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
One He atom in a big simple cubic box
Compute the DOS using the tetrahedron method.
Also compute the partial DOS.
There is a quite surprising feature of this very simple DOS,
that might seem to be due to a bug, but is NOT one.
Indeed, the obtained DOS is not continuous (vizualize the result
of DATASET 2):  at two energies, there is a small, but sizeable
jump. This feature is associated with a rather sparse sampling
of the Brillouin zone. Indeed, some of the tetrahedra have
three corners with perfectly identical energies. Such
a set of corners belong to two different tetrahedra.
If there is not an equal slope of energy when moving away from
each sides of the triangles, in the different tetrahedra,
the DOS is discontinuous at the energy of the three shared corners.
(explanation found by M. Verstraete)" data-toggle="popover" href="/tests/v4/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the computation of the partial DOS, using the linear tetrahedron method.
2 Silicon atoms, in a diamond structure." data-toggle="popover" href="/tests/v4/Input/t38.abi" target="_blank">t38.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U features.
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Antiferromagnetism and PAW+U
* Use of an initial and constant density matrix during the first SCF iterations" data-toggle="popover" href="/tests/v5/Input/t37.abi" target="_blank">t37.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation with constrained charges
Constrain the charge around atom 1 to the value 0.5, then work with both atoms and larger spheres

For dataset 2, the derivative wrt the constraint, the derivative of the total energy with respect to atomic displacement
and the stress calculations have been checked, as follows.

Initially, the total energy is -0.99164352451, the target charge is 0.5, and the gradient wrt the charge is computed -0.58356219787.
Changing the target charge by +0.001 gives etotal -0.99222576777
Changing the target charge by -0.001 gives etotal -0.99105864425
Finite-difference gives -0.5835617, in excellent agreement for that level of methodology.

For atom 1, dE/dtau (=-force in reduced coordinate) is computed 8.330114676.
Changing the atomic position of the first atom from -1.1 to -1.10015
gives etotal -0.99172669330, to -1.09985 gives etotal -0.99156009221, delivering 8.330054.
The result of a similar finite-difference estimation with twice bigger values gives 8.329896.
Combining both results to eliminate the quadratic error gives 8.330107, with an agreement of 5 digits with dE/dtau.

The stress is computed 2.755820639e-4 .
Multiplying both acell and xcart by 1.001 gives etotal -0.99122698240.
Multiplying both acell and xcart by 0.999 gives etotal -0.99205366103.
The derivative of total energy wrt to strain is thus 0.41333932. Dividing by the unit cell volume (1500) gives 2.75559e-4 ,
in excellent agreement for that level of methodology." data-toggle="popover" href="/tests/v8/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
Check jointly the charge and vector magnetization constraints, with differing vector orientations." data-toggle="popover" href="/tests/v8/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction" data-toggle="popover" href="/tests/v8/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2 with sphere overlap
DS2 Constrains the collinear magnetization around atom 1 to be +0.70 and around atom 2 to be -0.70
DS3 Constrains the collinear magnetization around atom 1 to be +0.70 and around atom 2 to be -0.70, and the total charge of both to be 0.00.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.70 and around atom 2 to be -0.70. Same result as DS2.
DS5 and DS6 are not really useful, simply sanity checks for imposition of axis or direction of magnetization for collinear magnetism" data-toggle="popover" href="/tests/v8/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction.
Case where the spheres overlap
Interestingly, in the case where only the magnitude of the magnetization on the second atom is fixed,
without fixing its charge, the optimal configuration gives a 90 degree difference of magnetization direction for both atoms.
It would be interesting to understand the meaning of such results, and see whether one is not in a local minimum.
A full mapping of the energy as a function of both magnitude and direction of the magnetization of the second atom would be interesting ..." data-toggle="popover" href="/tests/v8/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization." data-toggle="popover" href="/tests/v8/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization.
At present DS31 and DS32 do not work as expected ..." data-toggle="popover" href="/tests/v8/Input/t96.abi" target="_blank">t96.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization.
At present DS21, 31 and 32 do not work as expected. Hence the huge tolerance." data-toggle="popover" href="/tests/v8/Input/t97.abi" target="_blank">t97.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a></li>
</ul>
</details>
<p>Relevant only when <a class="wikilink codevar-wikilink" href="/variables/gstate#prtdensph">prtdensph</a> = 1, or <a class="wikilink codevar-wikilink" href="/variables/gstate#magconon">magconon</a>/=0, or any(<a class="wikilink codevar-wikilink" href="/variables/gstate#constraint_kind">constraint_kind</a>(:)/=0) (that is, constrained DFT), or <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> = 3.
In most cases (see later for <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> = 3), provides the radius of the spheres around each atom in which the total
charge density or magnetization will be integrated.
The integral within the sphere is obtained by a sum over real space FFT points
inside the sphere, multiplied by a function that is one inside the sphere, except in a small boundary zone determined by <a class="wikilink codevar-wikilink" href="/variables/gstate#ratsm">ratsm</a>,
where this function goes smoothly from 1 to 0.
In case of PAW,  <strong>ratsph</strong>  radius has to be greater or equal to PAW radius of
considered atom type (which is read from the PAW dataset file; see <strong>rc_sph</strong> or <strong>r_paw</strong>).
In case of constrained DFT, note that the sphere for different atoms are not allowed to overlap.</p>
<p>When <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> = 3 or 4 :</p>
<p>Provides the radius of the spheres around the <a class="wikilink codevar-wikilink" href="/variables/gstate#natsph">natsph</a> atoms of indices
<a class="wikilink codevar-wikilink" href="/variables/gstate#iatsph">iatsph</a>, in which the local DOS and its angular-momentum projections will
be analysed.</p>
<p>The choice of this radius is quite arbitrary. In a plane-wave
basis set, there is no natural definition of an atomic sphere. However, it
might be wise to use the following well-defined and physically motivated procedure:
from the Bader analysis, one can define the radius of the sphere that contains
the same charge as the Bader volume. This &ldquo;Equivalent Bader charge atomic
radius&rdquo; might then be used to perform the present analysis. See the
<a class="wikilink user-guide-wikilink" href="/guide/aim">aim help file</a> for more explanations. Another physically motivated choice would
be to rely on another charge partitioning, like the Hirshfeld one (see the
cut3d utility <a class="wikilink user-guide-wikilink" href="/guide/cut3d">cut3d help file</a>). The advantage of using charge partitioning schemes comes from
the fact that the sum of atomic DOS, for all angular momenta and atoms,
integrated on the energy range of the occupied states, gives back the total
charge. If this is not an issue, one could rely on the half of the nearest-
neighbour distances, or any scheme that allows one to define an atomic radius.
Note that the choice of this radius is however critical for the balance
between the s, p and d components. Indeed, the integrated charge within a
given radius, behave as a different power of the radius, for the different
channels s, p, d. At the limit of very small radii, the s component dominates
the charge contained in the sphere.</p>
<h2 id="ratsph_extra"><strong>ratsph_extra</strong><a class="headerlink" href="#ratsph_extra" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Radii of the ATomic SPHere(s) in the EXTRA set<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute atom-centered properties" data-toggle="popover" href="/topics/AtomCentered">topic_AtomCentered</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2.0 Bohr<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a></li>
</ul>
</details>
<p>Radius for extra spheres the DOS is projected into. See <a class="wikilink codevar-wikilink" href="/variables/gstate#natsph_extra">natsph_extra</a> and
<a class="wikilink codevar-wikilink" href="/variables/gstate#xredsph_extra">xredsph_extra</a> for the number and positions of the spheres.</p>
<h2 id="rcut"><strong>rcut</strong><a class="headerlink" href="#rcut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Radius of the CUT-off for coulomb interaction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to treat adequately the Coulomb interaction, especially in charged cells," data-toggle="popover" href="/topics/Coulomb">topic_Coulomb</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a GW- Lanczos-Sternheimer calculation" data-toggle="popover" href="/topics/GWls">topic_GWls</a>, <a class="wikilink topic-wikilink" data-tippy-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-toggle="popover" href="/topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-toggle="popover" href="/topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [19/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
5. Galaborane molecule to test the HGH pseudo-potentials.
WARNING : BigDFT try to read an additional line giving rcutoff and rloc, present in some pseudopotentials.
If such a line exist after the value defined by lmax, but does NOT contain proper rcutoff and rloc (e.g. 0.0), BigDFT might fail by hanging
or SEGFAULT, without giving proper error message. This is difficult to debug." data-toggle="popover" href="/tests/bigdft/Input/t05.abi" target="_blank">t05.abi</a></li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock with time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock without time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t11.abi" target="_blank">t11.abi</a></li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-toggle="popover" href="/tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-toggle="popover" href="/tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-toggle="popover" href="/tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-toggle="popover" href="/tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-toggle="popover" href="/tests/paral/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated hydrogen atom
Calculation of the HF levels with different ways to integrate the Coulomb divergence" data-toggle="popover" href="/tests/v67mbpt/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-toggle="popover" href="/tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
RPA correlation energy calculation in Si:
using exact or numerical integration over the coupling constant, using extrapolar trick or not,
using the full or long-range only Coulomb interaction" data-toggle="popover" href="/tests/v67mbpt/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with PAW and nsppol = 2.
Use model dielectric function computed from AE PAW density (denfgr.F90)." data-toggle="popover" href="/tests/v67mbpt/Input/t29.abi" target="_blank">t29.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: G0W0 @ scPBE0-1/3 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scPBE0 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scPBE0-1/3 level, the Kohn-Sham basis delivers 8.101 eV,
while the plane wave basis delivers 8.122 eV.
At the G0W0-scPBE0-1/3 level, the Kohn-Sham basis delivers 7.638 eV,
while the plane wave basis delivers 7.659 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
4.4126 from scPBE0-1/3(KS) and 4.4105 from scPBE0-1/3(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
In this case, one used the PBE0 functional (ixc_sigma=41 or ixc_sigma=-406,
of even isc_sigma=42 with hyb_mixing=0.25 - all the cases were checked).
At the PBE level, the (KS) band gap was 5.661 eV,
At the scPBE0 level, the Kohn-Sham basis delivered 7.882 eV,
while the plane wave basis delivered 7.884 eV.
At the G0W0-scPBE0 level, the Kohn-Sham basis delivered 7.820 eV,
while the plane wave basis delivered 7.827 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
4.483 from scPBE0(KS) and 4.490 from scPBE0(planewaves)." data-toggle="popover" href="/tests/v7/Input/t68.abi" target="_blank">t68.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-toggle="popover" href="/tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz: GS calculations with UPF2 pseudos.
Test scalar-relativistic pseudos with useylm 0 and 1." data-toggle="popover" href="/tests/v9/Input/t130.abi" target="_blank">t130.abi</a></li>
</ul>
</details>
<p>Truncation of the Coulomb interaction in real space. The meaning of  <strong>rcut</strong> 
is governed by the cutoff shape options <a class="wikilink codevar-wikilink" href="/variables/gstate#icutcoul">icutcoul</a>, <a class="wikilink codevar-wikilink" href="/variables/gw#gw_icutcoul">gw_icutcoul</a> and/or <a class="wikilink codevar-wikilink" href="/variables/gstate#fock_icutcoul">fock_icutcoul</a>.
See complementary information in <a class="wikilink codevar-wikilink" href="/variables/gstate#vcutgeo">vcutgeo</a>.</p>
<p>In the method of Ismail-Beigi <a class="wikilink citation-wikilink" data-tippy-content="Truncation of periodic image interactions for confined systems" data-toggle="popover" href="/theory/bibliography#ismail-beigi2006">[Ismail-Beigi2006]</a> for one-dimensional systems, the cutoff region is given by the
Wigner-Seitz cell centered on the axis of the cylinder. The cutoff region is
thus automatically defined by the unit cell and there is no need to specify
the value of  <strong>rcut</strong> . For two-dimensional systems, Ismail-Beigi <a class="wikilink citation-wikilink" data-tippy-content="Truncation of periodic image interactions for confined systems" data-toggle="popover" href="/theory/bibliography#ismail-beigi2006">[Ismail-Beigi2006]</a> also fixes the cutoff region,
at half the replication length perpendicular to the (truly) periodic plane.</p>
<p>Thus, when the Beigi methods in 1D or 2D are expected,  <strong>rcut</strong>  must be 0.0.
Using another value of  <strong>rcut</strong>  will prevent the Beigi method to be used.
See complementary information in <a class="wikilink codevar-wikilink" href="/variables/gstate#vcutgeo">vcutgeo</a>.</p>
<p>On the other hand, when the Rozzi methods in 1D or 2D are expected, which is the case when one component of <a class="wikilink codevar-wikilink" href="/variables/gstate#vcutgeo">vcutgeo</a> is negative,
 <strong>rcut</strong>  mut be defined.</p>
<p>If  <strong>rcut</strong>  is negative, the cutoff is automatically calculated so to enclose
the same volume inside the cutoff as the volume of the primitive cell.</p>
<h2 id="rmm_diis"><strong>rmm_diis</strong><a class="headerlink" href="#rmm_diis" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Activate the RMM-DIIS eigensolver for GS calculations.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.3.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with NC and spin-orbit coupling.
Test RMM-DIIS eigensolver with paral_kgb == 1 and band-spinor MPI parallelization." data-toggle="popover" href="/tests/paral/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz.
Ground state with LOBPCG + RMM-DIIS eigensolver and paral_kgb parallelism with 4 MPI procs." data-toggle="popover" href="/tests/paral/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Ground state with LOBPCG + RMM-DIIS eigensolver and paral_kgb parallelism with 4 MPI procs." data-toggle="popover" href="/tests/paral/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test band parallelism in DFPT with NC pseudos" data-toggle="popover" href="/tests/paral/Input/t65.abi" target="_blank">t65.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test band parallelism in DFPT with PAW" data-toggle="popover" href="/tests/paral/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with GWR code.
Test symmetrization with time-reversal and umklapp g0 vectors
as well as parallelization over k/g/tau." data-toggle="popover" href="/tests/paral/Input/t79.abi" target="_blank">t79.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GS calculation with the CG + RMM-DIIS eigensolver and NC pseudos" data-toggle="popover" href="/tests/v9/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
GS calculation with the CG + RMM-DIIS eigensolver and PAW GGA-PBE pseudos." data-toggle="popover" href="/tests/v9/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz: GS calculations with UPF2 pseudos.
Test scalar-relativistic pseudos with useylm 0 and 1." data-toggle="popover" href="/tests/v9/Input/t130.abi" target="_blank">t130.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure" data-toggle="popover" href="/tests/v9/Input/t131.abi" target="_blank">t131.abi</a></li>
</ul>
</details>
<p>This variable activates the Residual Minimization Method, Direct Inversion in the Iterative Subspace (RMM-DIIS)
eigensolver to <strong>accelerate</strong> GS computations, structural relaxations and molecular-dynamics simulations.
The algorithm is inspired to <a class="wikilink citation-wikilink" data-tippy-content="Efficient iterative schemes for ab initio total-energy calculations using a plane-wave basis set" data-toggle="popover" href="/theory/bibliography#kresse1996">[Kresse1996]</a> although the ABINIT implementation is not
completely equivalent to the original formulation.
RMM-DIIS can be used both with NC and PAW pseudos and is fully compatible with the <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> distribution.
Note, however, that PAW seems to be more sensitive to some internal tricks used to accelerate the computation
so you should not expect to see the same speedup as in the NC case.
This variable has no effect when <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> &gt; 0.</p>
<p>It is worth noting that RMM-DIIS is usually employed <strong>in conjunction with another eigenvalue solver</strong>
that is used to perform the initial SCF iterations.
RMM-DIIS, indeed, <strong>is not guaranteed to converge to the ground state</strong>
as the algorithm will find the eigenvector/eigenvalue pair closest to the input trial state.
The reliability of RMM-DIIS thus <strong>strongly</strong> depends on the initialisation of the SCF cycle
and on the quality of the input wavefunctions that are supposed to be reasonably close to the final solution.</p>
<p>Both the CG and the LOBPCG solver can be used in conjunction with RMM-DIIS although
it is strongly suggested to use LOBPCG with <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> = 1 to take advantage of
its better efficiency and improved parallel scalability.
To activate RMM-DIIS with e.g. LOBPCG, it is sufficient to use:</p>
<div class="highlight"><pre><span></span><code>paral_kgb 1
rmm_diis  1
</code></pre></div>
<p>in the input file and then select the value of <a class="wikilink codevar-wikilink" href="/variables/paral#np_spkpt">np_spkpt</a>, <a class="wikilink codevar-wikilink" href="/variables/paral#npband">npband</a>, <a class="wikilink codevar-wikilink" href="/variables/paral#npfft">npfft</a>, <a class="wikilink codevar-wikilink" href="/variables/paral#npspinor">npspinor</a> according to the system.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Using <a class="wikilink codevar-wikilink" href="/variables/dev#use_gemm_nonlop">use_gemm_nonlop</a> = 1 with <a class="wikilink codevar-wikilink" href="/variables/paral#bandpp">bandpp</a> &gt; 1 can lead to a significant speedup
at the price of increased memory requirements.</p>
</div>
<p>In the case of standard SCF calculations, Abinit activates the RMM-DIIS solver after 3 +  <strong>rmm_diis</strong>  SCF iterations.
When performing structural relaxations, RMM-DIIS is activated after  <strong>rmm_diis</strong>  SCF iterations
once the first GS calculation is completed.
This means that using  <strong>rmm_diis</strong>  = 1 for a structural relaxation leads to:</p>
<div class="codehilite"><pre><span></span><code>    <span class="o">-</span> <span class="mi">4</span> <span class="nv">SCF</span> <span class="nv">iterations</span> <span class="nv">with</span> <span class="nv">the</span> <span class="nv">CG</span><span class="o">/</span><span class="nv">LOBPCG</span> <span class="nv">eigensolver</span> <span class="nv">followed</span> <span class="nv">by</span> <span class="nv">RMM</span><span class="o">-</span><span class="nv">DIIS</span> <span class="nv">when</span> <span class="nv">are</span> <span class="nv">performing</span> <span class="nv">the</span> <span class="o">**</span><span class="nv">first</span> <span class="nv">GS</span> <span class="nv">calculation</span><span class="o">**</span>.
    <span class="o">-</span> <span class="mi">1</span> <span class="nv">SCF</span> <span class="nv">iterations</span> <span class="nv">with</span> <span class="nv">CG</span><span class="o">/</span><span class="nv">LOBPCG</span> <span class="nv">followed</span> <span class="nv">by</span> <span class="nv">RMM</span><span class="o">-</span><span class="nv">DIIS</span> <span class="k">for</span> <span class="nv">all</span> <span class="nv">the</span> <span class="nv">subsequent</span> <span class="nv">relaxation</span> <span class="nv">steps</span>.
</code></pre></div>

<p>A negative value  <strong>rmm_diis</strong>  (e.g. -3) can be used to bypass the initial CG/LOBPCG iterations
but this option should be used with extreme care and it is not recommended in general.</p>
<p>RMM-DIIS usually requires less wall-time per iteration when compared to other approaches since
there is no explicit orthogonalization while optimizing the trial states.
Only a single full-band Cholesky orthogonalization is performed per SCF iteration before recomputing the new density.
As a consequence, one RMM-DIIS iteration is usually faster (sometimes even by a factor two) than one CG/LOBPCG iteration,
especially in systems with relatively large <a class="wikilink codevar-wikilink" href="/variables/internal#mpw">%mpw</a>.
However, the additional steps of the algorithm (subspace rotation and Cholesky orthogonalization)
present poor MPI-scalability hence this part will start to dominate the wall-time in systems with large <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.</p>
<p>The algorithm can also be used for NSCF band structure calculations although one should not expect RMM-DIIS
to provide <strong>high-energy</strong> states of the same quality as the one obtained with other eigenvalue solvers.
Although RMM-DIIS can be used for computing band structures and electron DOS with <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> = -2, we do not recommend
using this solver to produce WFK files with many empty states as required by many-body calculations.</p>
<p>From the above discussion, it should be clear that RMM-DIIS is <strong>less stable</strong> than the other eigenvalue solvers
and you should be aware (and accept) that RMM-DIIS calculations <strong>may fail</strong>.
In the best case scenario, one clearly sees the problem as the SCF cycle does not convergence and/or
the code aborts with a non-zero exit status returned by one of the LAPACK routines.
In the worst case scenario, RMM-DIIS may seamlessly <strong>converge to the wrong solution</strong>.
This is especially true if the first LOBPCG/CG iterations fail to provide a reasonably-good initial starting point.</p>
<p>In problematic cases, you may want to increase the value of  <strong>rmm_diis</strong>  so that more SCF iterations are done
with LOBPCG/CG before activating RMM-DIIS.
RMM-DIIS is indeed very sensitive to density mixing and increasing  <strong>rmm_diis</strong>  is a possible solution if you don&rsquo;t want
to play with the variables defining the mixing algorithm.</p>
<p>As a general rule, we <strong>strongly suggest</strong> to include in the calculation more <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> bands that what is strictly
needed to accommodate all the valence electrons (let&rsquo;s say &gt; 10% of the occupied bands).
Increasing <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, indeed, increases the number of vectors used
for the Rayleigh-Ritz subspace rotation and this step is crucial for finding the most accurate variational approximation
to the eigenvectors before starting the DIIS optimization.</p>
<p>For a given precision, RMM-DIIS usually requires more iterations than the other eigensolvers.
For performance reasons, one should avoid using tight tolerances.
Something of the order of <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> = 1e-8 or <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> = 1e-10 to stop the SCF cycle should be fine.
Avoid using (<a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>) (criterion on the residuals) as converge criterion for SCF cycles
Use <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> only if you are using RMM-DIIS for NSCF band structure calculations (as this is the only converge criterion
available for NSCF calculations).</p>
<p>Last but not least, note that the default implementation is quite aggressive at the level of memory allocations.
A less memory-intensive version of the algorithm can be activated via <a class="wikilink codevar-wikilink" href="/variables/gstate#rmm_diis_savemem">rmm_diis_savemem</a> = 1.</p>
<h2 id="rmm_diis_savemem"><strong>rmm_diis_savemem</strong><a class="headerlink" href="#rmm_diis_savemem" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Save memory in the RMM-DIIS eigensolver.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.3.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GS calculation with the CG + RMM-DIIS eigensolver and NC pseudos" data-toggle="popover" href="/tests/v9/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
GS calculation with the CG + RMM-DIIS eigensolver and PAW GGA-PBE pseudos." data-toggle="popover" href="/tests/v9/Input/t30.abi" target="_blank">t30.abi</a></li>
</ul>
</details>
<p>This variable allows one to save memory in the RMM-DIIS eigensolver when <a class="wikilink codevar-wikilink" href="/variables/gstate#rmm_diis">rmm_diis</a> /= 0.
By default, the RMM-DIIS routine allocates two extra arrays to reduce the number of applications of the Hamiltonian.
The size of these arrays depends on the number of plane-waves treated by each processor and <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.
The amount of memory scales with <a class="wikilink codevar-wikilink" href="/variables/paral#npband">npband</a> and <a class="wikilink codevar-wikilink" href="/variables/paral#npfft">npfft</a> yet this extra memory is not negligible and the code
may go out of memory for large systems.
In this case, one can use  <strong>rmm_diis_savemem</strong>  = 1 to activate a version of RMM-DIIS that avoids these extra allocations.</p>
<h2 id="scphon_supercell"><strong>scphon_supercell</strong><a class="headerlink" href="#scphon_supercell" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Self Consistent PHONon SUPERCELL<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [1, 1, 1]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1245] in all abinit tests, [0/159] in abinit tutorials</summary></details>
<p>Give extent, in number of primitive unit cells, of the supercell being used
for a self-consistent phonon calculation. Presumes the phonon frequencies and
eigenvectors have been calculated in the original primitive unit cell, on a
grid of q-points which corresponds to the supercell in the present calculation.
Experimental.</p>
<h2 id="scphon_temp"><strong>scphon_temp</strong><a class="headerlink" href="#scphon_temp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Self Consistent PHONon TEMPerature<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1245] in all abinit tests, [0/159] in abinit tutorials</summary></details>
<p>Temperature which is imposed on phonon distribution, in the self-consistent
scheme of <a class="wikilink citation-wikilink" data-tippy-content="Entropy Driven Stabilization of Energetically Unstable Crystal Structures Explained from First Principles Theory" data-toggle="popover" href="/theory/bibliography#souvatzis2008">[Souvatzis2008]</a>. Determines the extent of the
finite displacements used, and consequent anharmonic effects. Experimental.</p>
<h2 id="shiftq"><strong>shiftq</strong><a class="headerlink" href="#shiftq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SHIFT for Q points<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT calculations" data-toggle="popover" href="/topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="/variables/gstate#nshiftq">nshiftq</a>)<br />
<em>Default value:</em> None if <a class="wikilink codevar-wikilink" href="/variables/gstate#nshiftq">nshiftq</a>&gt;1,
[0.5, 0.5, 0.5] otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [9/1245] in all abinit tests, [3/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline AlAs : computation of the phonon spectrum" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_2.abi" target="_blank">trf2_2.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through qptrlatt.
Otherwise, similar to Tv2#26 and Tv6#78." data-toggle="popover" href="/tests/v6/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through ngqpt and nshiftq.
Otherwise, similar to Tv2#26" data-toggle="popover" href="/tests/v6/Input/t78.abi" target="_blank">t78.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of e-ph coupling matrix elements
and output of the GKK and GKQ files." data-toggle="popover" href="/tests/v7/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Testing of the phonon potential interpolation routines." data-toggle="popover" href="/tests/v8/Input/t65.abi" target="_blank">t65.abi</a></li>
</ul>
</details>
<p>WARNING : Only used if <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a> = 1. If <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>=0 (which is the default value of <a class="wikilink codevar-wikilink" href="/variables/gstate#nqpt">nqpt</a>), no reading of  <strong>shiftq</strong>  is done,
and the default value of  <strong>shiftq</strong>  is kept.</p>
<p>It is used only when <a class="wikilink codevar-wikilink" href="/variables/gstate#qptopt">qptopt</a> &gt;= 0, and must be defined if <a class="wikilink codevar-wikilink" href="/variables/gstate#nshiftq">nshiftq</a> is larger than 1.
 <strong>shiftq</strong> (1:3,1:<a class="wikilink codevar-wikilink" href="/variables/gstate#nshiftq">nshiftq</a>) defines <a class="wikilink codevar-wikilink" href="/variables/gstate#nshiftq">nshiftq</a> shifts of the homogeneous
grid of q points based on <a class="wikilink codevar-wikilink" href="/variables/gstate#ngqpt">ngqpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#qptrlatt">qptrlatt</a>.</p>
<p>See <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> for more information on the definition, use, and suitable
values for these shifts.</p>
<h2 id="slabwsrad"><strong>slabwsrad</strong><a class="headerlink" href="#slabwsrad" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> jellium SLAB Wigner-Seitz RADius<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform some artificial modifications of the physics" data-toggle="popover" href="/topics/Artificial">topic_Artificial</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk jellium (the slab fills up the entire cell): computation of the total
energy. Tested 3 Wigner-Seitz radii: 1.5, 2 (~aluminum), 4. For each
Wigner-Seitz radius the energy per particle agrees with that analytically
calculated using the Teter-Pade functional form.
The number of k points has been much reduced, for the purpose of the automatic testing." data-toggle="popover" href="/tests/v5/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium slab (50 jellium/ 50 vacuum) with Wigner-Seitz radius=4.
Computation of the total energy
The number of k points has been much reduced" data-toggle="popover" href="/tests/v5/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium thin slab with Wigner-Seitz radius=2.56 (~copper) + 1 Na adatom.
Computation of the total energy and force on the Na atom. Its position
with respect to the slab already is the equilibrium position so the
calculation should use only one optimization step." data-toggle="popover" href="/tests/v5/Input/t58.abi" target="_blank">t58.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium thin slab with Wigner-Seitz radius=2.56 (~copper) + 1 Na adatom.
Computation of the total energy at the Na equilibrium distance from the
jellium edge and two other ones, slightly farther and slightly closer.
The total energies should indicate as more stable the equilibrium distance.
The number of k points has been much reduced" data-toggle="popover" href="/tests/v5/Input/t59.abi" target="_blank">t59.abi</a></li>
</ul>
</details>
<p>Fix the bulk-mean positive charge density <span><span class="MathJax_Preview">n_{bulk}</span><script type="math/tex">n_{bulk}</script></span> of a jellium slab (if the
latter is employed, e.g. <a class="wikilink codevar-wikilink" href="/variables/gstate#jellslab">jellslab</a>/=0). Often called <span><span class="MathJax_Preview">r_s</span><script type="math/tex">r_s</script></span> (see for example
<a class="wikilink citation-wikilink" data-tippy-content="Theory of Metal Surfaces: Charge Density and Surface Energy" data-toggle="popover" href="/theory/bibliography#lang1970">[Lang1970]</a>),  <strong>slabwsrad</strong>  is the radius of a
sphere which has the same volume as the average volume per particle in a
homogeneous electron gas with density <span><span class="MathJax_Preview">n_{bulk}</span><script type="math/tex">n_{bulk}</script></span>, so:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
      \frac{1}{n_{bulk}} = \frac{4 \pi}{3}  **slabwsrad** ^3 \nonumber
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
      \frac{1}{n_{bulk}} = \frac{4 \pi}{3}  **slabwsrad** ^3 \nonumber
\end{equation}</script>
</div>
<p>For example, the bulk aluminum fcc lattice constant is <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span>=4.0495 Angstroms
<a href="https://www.webelements.com/">WebElements</a>, each cubic centered cell includes 4 Al atoms and each atom
has 3 valence electrons, so the average volume per electron is <span><span class="MathJax_Preview">a^3/12</span><script type="math/tex">a^3/12</script></span>=37.34
Bohr<span><span class="MathJax_Preview">^3</span><script type="math/tex">^3</script></span> which has to be equal to <span><span class="MathJax_Preview">\frac{4 \pi}{3} r_s^3</span><script type="math/tex">\frac{4 \pi}{3} r_s^3</script></span>. Consequently Al has approximately
<span><span class="MathJax_Preview">r_s</span><script type="math/tex">r_s</script></span>=2.07 Bohr, while for example magnesium has <span><span class="MathJax_Preview">r_s</span><script type="math/tex">r_s</script></span>=2.65 Bohr, sodium 3.99 Bohr.
By default, given in Bohr atomic units (1 Bohr=0.5291772108 Angstroms).</p>
<h2 id="slabzbeg"><strong>slabzbeg</strong><a class="headerlink" href="#slabzbeg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> jellium SLAB BEGinning edge along the z-direction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform some artificial modifications of the physics" data-toggle="popover" href="/topics/Artificial">topic_Artificial</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk jellium (the slab fills up the entire cell): computation of the total
energy. Tested 3 Wigner-Seitz radii: 1.5, 2 (~aluminum), 4. For each
Wigner-Seitz radius the energy per particle agrees with that analytically
calculated using the Teter-Pade functional form.
The number of k points has been much reduced, for the purpose of the automatic testing." data-toggle="popover" href="/tests/v5/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium slab (50 jellium/ 50 vacuum) with Wigner-Seitz radius=4.
Computation of the total energy
The number of k points has been much reduced" data-toggle="popover" href="/tests/v5/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium thin slab with Wigner-Seitz radius=2.56 (~copper) + 1 Na adatom.
Computation of the total energy and force on the Na atom. Its position
with respect to the slab already is the equilibrium position so the
calculation should use only one optimization step." data-toggle="popover" href="/tests/v5/Input/t58.abi" target="_blank">t58.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium thin slab with Wigner-Seitz radius=2.56 (~copper) + 1 Na adatom.
Computation of the total energy at the Na equilibrium distance from the
jellium edge and two other ones, slightly farther and slightly closer.
The total energies should indicate as more stable the equilibrium distance.
The number of k points has been much reduced" data-toggle="popover" href="/tests/v5/Input/t59.abi" target="_blank">t59.abi</a></li>
</ul>
</details>
<p>Define the edges of the jellium slab (if used, so if <a class="wikilink codevar-wikilink" href="/variables/gstate#jellslab">jellslab</a>/=0) along
z, namely the slab starts at a point along z which is expressed in Bohr by
 <strong>slabzbeg</strong>  and it ends at a point expressed in Bohr by <a class="wikilink codevar-wikilink" href="/variables/gstate#slabzend">slabzend</a>.
The z-direction is parallel to the third crystal primitive lattice vector which has
to be orthogonal to the other ones, so the length of the cell along z is
<a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>(3,3). In addition  <strong>slabzbeg</strong>  and <a class="wikilink codevar-wikilink" href="/variables/gstate#slabzend">slabzend</a> have to be such that:</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">≤</span><span class="w">  </span><span class="o">**</span><span class="n">slabzbeg</span><span class="o">**</span><span class="w">   </span><span class="o">&lt;</span><span class="w"> </span><span class="o">[</span><span class="n">[slabzend</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="err">≤</span><span class="w"> </span><span class="o">[</span><span class="n">[rprimd</span><span class="o">]</span><span class="err">]</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<p>Together with <a class="wikilink codevar-wikilink" href="/variables/gstate#slabwsrad">slabwsrad</a> they define the jellium positive charge density
distribution <span><span class="MathJax_Preview">n_{+}(x,y,z)</span><script type="math/tex">n_{+}(x,y,z)</script></span> in this way:</p>
<div>
<div class="MathJax_Preview">\begin{eqnarray}
      n_{+}(x,y,z) &amp;=&amp; n_{bulk} \quad \text{if} \quad  **slabzbeg**   \leq z \leq [[slabzend]]  \nonumber\\
                &amp;=&amp; 0       \quad \text{otherwise}                           \nonumber
\end{eqnarray}</div>
<script type="math/tex; mode=display">\begin{eqnarray}
      n_{+}(x,y,z) &=& n_{bulk} \quad \text{if} \quad  **slabzbeg**   \leq z \leq [[slabzend]]  \nonumber\\
                &=& 0       \quad \text{otherwise}                           \nonumber
\end{eqnarray}</script>
</div>
<p>so the positive charge density is invariant along the xy plane as well as the
electrostatic potential generated by it.</p>
<h2 id="slabzend"><strong>slabzend</strong><a class="headerlink" href="#slabzend" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> jellium SLAB ENDing edge along the z-direction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform some artificial modifications of the physics" data-toggle="popover" href="/topics/Artificial">topic_Artificial</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk jellium (the slab fills up the entire cell): computation of the total
energy. Tested 3 Wigner-Seitz radii: 1.5, 2 (~aluminum), 4. For each
Wigner-Seitz radius the energy per particle agrees with that analytically
calculated using the Teter-Pade functional form.
The number of k points has been much reduced, for the purpose of the automatic testing." data-toggle="popover" href="/tests/v5/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium slab (50 jellium/ 50 vacuum) with Wigner-Seitz radius=4.
Computation of the total energy
The number of k points has been much reduced" data-toggle="popover" href="/tests/v5/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium thin slab with Wigner-Seitz radius=2.56 (~copper) + 1 Na adatom.
Computation of the total energy and force on the Na atom. Its position
with respect to the slab already is the equilibrium position so the
calculation should use only one optimization step." data-toggle="popover" href="/tests/v5/Input/t58.abi" target="_blank">t58.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium thin slab with Wigner-Seitz radius=2.56 (~copper) + 1 Na adatom.
Computation of the total energy at the Na equilibrium distance from the
jellium edge and two other ones, slightly farther and slightly closer.
The total energies should indicate as more stable the equilibrium distance.
The number of k points has been much reduced" data-toggle="popover" href="/tests/v5/Input/t59.abi" target="_blank">t59.abi</a></li>
</ul>
</details>
<p>Define the edges of the jellium slab (if used, so if <a class="wikilink codevar-wikilink" href="/variables/gstate#jellslab">jellslab</a>/=0) along
z, namely the slab starts at a point along z which is expressed in Bohr by
<a class="wikilink codevar-wikilink" href="/variables/gstate#slabzbeg">slabzbeg</a> and it ends at a point expressed in Bohr by  <strong>slabzend</strong> .
The z-direction is parallel to the third crystal primitive lattice vector which has
to be orthogonal to the other ones, so the length of the cell along z is
<a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>(3,3). In addition <a class="wikilink codevar-wikilink" href="/variables/gstate#slabzbeg">slabzbeg</a> and  <strong>slabzend</strong>  have to be such that:</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">≤</span><span class="w"> </span><span class="o">[</span><span class="n">[slabzbeg</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w">  </span><span class="o">**</span><span class="n">slabzend</span><span class="o">**</span><span class="w">   </span><span class="err">≤</span><span class="w"> </span><span class="o">[</span><span class="n">[rprimd</span><span class="o">]</span><span class="err">]</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<p>Together with <a class="wikilink codevar-wikilink" href="/variables/gstate#slabwsrad">slabwsrad</a> they define the jellium positive charge density
distribution <span><span class="MathJax_Preview">n_{+}(x,y,z)</span><script type="math/tex">n_{+}(x,y,z)</script></span> in this way:</p>
<div>
<div class="MathJax_Preview">\begin{eqnarray}
      n_{+}(x,y,z) &amp;=&amp; n_{bulk} \quad  \text{if} \quad [[slabzbeg]] \leq z \leq  **slabzend**  \nonumber \\
                   &amp;=&amp; 0        \quad  \text{otherwise}                                    \nonumber
\end{eqnarray}</div>
<script type="math/tex; mode=display">\begin{eqnarray}
      n_{+}(x,y,z) &=& n_{bulk} \quad  \text{if} \quad [[slabzbeg]] \leq z \leq  **slabzend**  \nonumber \\
                   &=& 0        \quad  \text{otherwise}                                    \nonumber
\end{eqnarray}</script>
</div>
<p>so the positive charge density is invariant along the xy plane as well as the
electrostatic potential generated by it.</p>
<h2 id="slk_rankpp"><strong>slk_rankpp</strong><a class="headerlink" href="#slk_rankpp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ScaLapacK matrix RANK Per Process<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic_parallelism</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> [1000]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Test for input variable slk_rankpp" data-toggle="popover" href="/tests/paral/Input/t31.abi" target="_blank">t31.abi</a></li>
</ul>
</details>
<p>This variable controls how the number of processes to be used in Scalapack diagonalization algorithm: <a class="wikilink codevar-wikilink" href="/variables/paral#np_slk">np_slk</a> will be calculated according to this value.
This value is the matrix rank that each process will hold for the diagonalization.
For a 1000x1000 matrix with default value, scalapack won&rsquo;t be used (Lapack will be used).
For a 2000x2000 matrix with default value, scalapack will be used with 2000/1000=2 MPI processes.
For a 2000x2000 matrix with a slk_rank=500, scalapack will be used with 2000/500=4 MPI processes.
In case of hybrid MPI+OpenMP, the number of thread is also taken into account.</p>
<p><strong><em>WARNING</em></strong> None of the available scalapack library are thread-safe  (2018). Therefore using both scalapack <em>and</em> OpenMP is highly unpredictable.
Furthermore, using multithreaded linear algebra library (MKL ACML&hellip;) is more efficient than pure MPI scalapack.</p>
<p>Usually it is better to define this variable and let the code do the rest.</p>
<h2 id="so_psp"><strong>so_psp</strong><a class="headerlink" href="#so_psp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Spin-Orbit treatment for each PSeudoPotential<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a spin-polarized calculation" data-toggle="popover" href="/topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/gstate#npsp">npsp</a>)<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#npsp">npsp</a> * 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> == 2 and <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [50/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
3H2 molecule with distant atoms : probe the use of the spinat variable
Use spin-polarized mode, spinor mode, as well as antiferromagnetic mode.
Even consider an initialization with reather crazy, nearly ferromagnetic spinat.
Use PseudosGTH_pwteter/01h.pspgth, in a 8 8 16 box, with 15 Ha cut-off.
Separation is 4 bohr.
Consider anti-parallel spin configuration,  which is the favoured one
for this distance. Get total energy of -0.981 839  Ha .
Note that the spin-polarization is not complete.
Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-toggle="popover" href="/tests/v1/Input/t39.abi" target="_blank">t39.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tin in the diamond structure, with 2 special points
Test the effect of spin-orbit coupling, especially the
electronic structure.
Degeneracies at Gamma are correct !
(note that ecut and nkpt are too low for quantitative accuracy)
Without spin-orbit (in eV), dataset 4:
-8.82682  1.26955 (x3) 1.30262 3.45296 (x3)
With spin-orbit (in eV), dataset 6:
-8.82682  0.75225      1.30262 1.50965 (x2) 3.07128 3.62556 (x2)" data-toggle="popover" href="/tests/v2/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth, treated as a metal, with 2 special points
Test the effect of spin-orbit coupling, especially the forces.
The dataset 1 to 3 are related to the nspinor=1 case. The forces
are computed from finite differences of energy :
abs(etotal3-etotal1)=0.00090461 Ha
abs(xcart3-xcart1)=0.089970092 (taking into account both atoms)
Their ratio is 0.01005456 Ha/Bohr, to be compared with
fcart2=1.0049850156E-02 Ha/Bohr
The dataset 4 checks the case nspinor=2, pspso=1 (no spin-orbit yet)
The dataset 5 to 7 try to reproduce the comparison of forces
with spin-orbit :
abs(etotal7-etotal5)=0.000445155 Ha
abs(xcart7-xcart5)=0.089970092 (taking into account both atoms)
Their ratio is 3.83633E-03 Ha/Bohr ...
A better finite-difference scheme incorporating also data from
half-displacement, lead to 3.81832E-03 Ha/Bohr.
This is in excellent agreement with
fcart6=3.8183150850E-03 Ha/Bohr" data-toggle="popover" href="/tests/v2/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon, diamond structure.
Test the ability to read an input wavefunction and to generate
from it any other wavefunction, changing different parameters.
One of the _DEN file is also used as starting point of
the cut3D tests." data-toggle="popover" href="/tests/v2/Input/t76.abi" target="_blank">t76.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe2 dimer in a big box, treated with non-collinear magnetism.
First dataset is the metallic treatment, second dataset
is a fixed occupation number treatment. Dataset 3 to 5 start from
other initial magnetization direction
Only 5 or 2 steps. The run is not invariant
against changing the initial magnetization direction.
If the wavefunctions were completely optimized in the
first fixed potential, the run should be invariant ..." data-toggle="popover" href="/tests/v3/Input/t47.abi" target="_blank">t47.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to verify that different values
of input variable &#x27;ortalg&#x27; give the same results for
total energy. &#x27;ortalg&#x27; is use in the conjugate gradient
algorithm which solves, in the case of PAW calculations,
a generalized eigenproblem (H.|Psi&gt;=Lambda.S|Psi&gt;).
Three datasets are perfomed ; they must give the same
total energies values (when converged)." data-toggle="popover" href="/tests/v4/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
GeTe in rhombohedral structure
Test the computation of phonons, dielectric tensor and Born effective
charges, with and without spin-orbit coupling." data-toggle="popover" href="/tests/v5/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth atom, isolated, in a supercell.
Try alchemical pseudopotentials with spin-orbit.
Spinor calculation (nspinor=2, nspden=1, nsppol=1)
Metallic occupations.
Also compare the halved spin-orbit interaction alchemical mixing
with a pseudopotential directly prepared with halved spin-orbit interaction.
The agreement is perfect." data-toggle="popover" href="/tests/v5/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
preliminary spin current output test: output x y z- spin current density in x,y,z directions" data-toggle="popover" href="/tests/v5/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi atom in a big supercell.
Test the application of a Zeeman field." data-toggle="popover" href="/tests/v6/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="test partial dos calculation with spinors (previously not enabled) and spin
polarization while we are at it" data-toggle="popover" href="/tests/v7/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
Check jointly the charge and vector magnetization constraints, with differing vector orientations." data-toggle="popover" href="/tests/v8/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction" data-toggle="popover" href="/tests/v8/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction.
Case where the spheres overlap
Interestingly, in the case where only the magnitude of the magnetization on the second atom is fixed,
without fixing its charge, the optimal configuration gives a 90 degree difference of magnetization direction for both atoms.
It would be interesting to understand the meaning of such results, and see whether one is not in a local minimum.
A full mapping of the energy as a function of both magnitude and direction of the magnetization of the second atom would be interesting ..." data-toggle="popover" href="/tests/v8/Input/t29.abi" target="_blank">t29.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with PAW atomic data." data-toggle="popover" href="/tests/v9/Input/t13.abi" target="_blank">t13.abi</a> &hellip;</li>
</ul>
</details>
<p>For each type of atom (each pseudopotential), specify the treatment of spin-orbit
interaction (if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> == 2 and Norm-conserving pseudopotentials i.e. <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 0)
For PAW calculations with SOC, please refer to <a class="wikilink codevar-wikilink" href="/variables/paw#pawspnorb">pawspnorb</a>.</p>
<ul>
<li>If 0: no spin-orbit interaction, even if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2</li>
<li>If 1: treat spin-orbit as specified in the pseudopotential file.</li>
<li>If 2: treat spin-orbit in the HGH form (usual form, although not allowed for all pseudopotentials)</li>
<li>If 3: treat spin-orbit in the HFN form (Hemstreet-Fong-Nelson) (actually, not implemented).</li>
</ul>
<p>For typical usage, the default value is OK. If the spin-orbit needs to be
turned off for one atom, 0 might be relevant. Note however, that the code will
stop if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> == 2 is used and one of the pseudopotential does not contain
the information about the spin-orbit interaction (this is the case for some
old pseudopotentials). Indeed, for spinorial calculations, turning off the
spin-orbit interaction is unphysical, and also does not save CPU time.
It should only be done for test purposes</p>
<p>Note that if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> == 1, the spin-orbit cannot be treated anyhow, so the
value of  <strong>so_psp</strong>  is irrelevant.</p>
<p>Prior to v5.4, the input variable <strong>so_typat</strong> was used, in place of
 <strong>so_psp</strong> . Because the values 0 and 1 have been switched between  <strong>so_psp</strong> 
and <strong>so_typat</strong>, it was dangerous to continue to allow the use of <strong>so_typat</strong>.</p>
<h2 id="spinat"><strong>spinat</strong><a class="headerlink" href="#spinat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SPIN for AToms<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a spin-polarized calculation" data-toggle="popover" href="/topics/spinpolarisation">topic_spinpolarisation</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation with constrained atomic magnetic moments" data-toggle="popover" href="/topics/MagMom">topic_MagMom</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculation within constrained DFT" data-toggle="popover" href="/topics/ConstrainedDFT">topic_ConstrainedDFT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> [3, <a class="wikilink codevar-wikilink" href="/variables/geo#natrd">natrd</a> ] if <a class="wikilink codevar-wikilink" href="/variables/geo#natrd">natrd</a>&lt;<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>,
[3, <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a> ] otherwise.</p>
<p><em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [155/1245] in all abinit tests, [18/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC" data-toggle="popover" href="/tests/built-in/Input/testin_libxc.abi" target="_blank">testin_libxc.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Test functionals from libXC that were present in ABINITv5 (LDAs and GGAs).
This is to check the portability for different platform.
Extremely quick (nstep=1, nline=1). Less than 20 secs to test 45 functionals ..." data-toggle="popover" href="/tests/libxc/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the parallelization over spinorial components of WF
Bi A7 structure (2 atoms, treated as semi-conductor),
using PAW, within LDA and spin-orbit coupling.
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)" data-toggle="popover" href="/tests/paral/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in FCC structure; GS and RF calculation (RF at q=0 0 0)
Test the parallelism on both spin and k points" data-toggle="popover" href="/tests/paral/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in FCC structure; GS and RF calculation (RF at q=0 0 0)
Test the parallelism on both spin and k points" data-toggle="popover" href="/tests/paral/Input/t56.abi" target="_blank">t56.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization" data-toggle="popover" href="/tests/psml/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization" data-toggle="popover" href="/tests/psml/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H atom in a big box
Same file as tbase1_1.abi, except that natom, typat, and xcart were changed,
and that the input variables nband, nsppol, occ and occopt are used." data-toggle="popover" href="/tests/tutorial/Input/tbase1_5.abi" target="_blank">tbase1_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom." data-toggle="popover" href="/tests/tutorial/Input/tbase2_1.abi" target="_blank">tbase2_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom.
Here, a double loop has been used." data-toggle="popover" href="/tests/tutorial/Input/tbase2_2.abi" target="_blank">tbase2_2.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated like a metal (there is a degeneracy at the Fermi level),
occopt=4 and tsmear=0.04 , with nsppol=2 .
Use spinat to polarize the molecule at start.
Gives total energy of -32.09317 Hartree
This test can be used to check the accuracy of stresses in the
spin-polarized case. Setting acell(1:2) to 7.005 and 6.995
gives ETOT -32.090846193972 and -32.095501753750,
ucvol  441.63023 and 440.37023
so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03,
to be compared with sigma(1)=3.6949713786E-03
and sigma(2)=3.6949681083E-03 from the present test
(the degeneracy is slightly lifted because of incomplete convergence,
using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both
sigma values)." data-toggle="popover" href="/tests/v1/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated as a spin-polarized molecule, with fixed occupation
numbers (occopt=2), with nsppol=2 . Gives total energy of -32.09792 Hartree" data-toggle="popover" href="/tests/v1/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3H2 molecule with distant atoms : probe the use of the spinat variable
Use spin-polarized mode, spinor mode, as well as antiferromagnetic mode.
Even consider an initialization with reather crazy, nearly ferromagnetic spinat.
Use PseudosGTH_pwteter/01h.pspgth, in a 8 8 16 box, with 15 Ha cut-off.
Separation is 4 bohr.
Consider anti-parallel spin configuration,  which is the favoured one
for this distance. Get total energy of -0.981 839  Ha .
Note that the spin-polarization is not complete.
Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-toggle="popover" href="/tests/v1/Input/t39.abi" target="_blank">t39.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (nsppol=2, non-linear XC core correction, GGA)
Some similarities with test 41, except that nsppol=2 instead of 1.
Computation of uniaxial stresses in the GGA,
and comparison with a finite difference of energy.
The estimation of sigma(zz) stress  at acell(3)=9.0
from acell(3)=8.9991 and 9.0009
gives 1.62867d-3 Ha/Bohr**3
A simple finite-difference estimation gives
a difference in total energy of 0.123861d-3 Ha,
for a difference of volume of 0.07605 Bohr**3 leading
to a stress estimation of 1.62867d-3 Ha/Bohr**3" data-toggle="popover" href="/tests/v2/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (nsppol=2, non-linear XC core correction, GGA)
Similar to test50, except use iscf=6 ." data-toggle="popover" href="/tests/v2/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the symmetry finder for all the Bravais lattices,
with different input formats (rprim or angdeg), and for
non-conventional choices of axes as well.
Uses two atoms of the same type, placed at (0 0 0) and (0.1 0 0), thus
breaking many symmetries, while the inversion needs a non-symmorphic
translation." data-toggle="popover" href="/tests/v2/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 diatomic molecule. Spin-polarized (anti-ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=1 (Teter LSDA)
From datasets 3 and 4, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 6.283100652 Ha, while the direct computation,
without using Shubnikov symmetries, gives
6.282967527 Ha." data-toggle="popover" href="/tests/v3/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe FCC, spin-polarized (ferro), with only the Gamma point.
Test spin-polarized GS and RF calculation, at varying occupation
number (occopt=4). Check acoustic sum rule." data-toggle="popover" href="/tests/v3/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe, one atom in a big box.
Test spin-polarized GS and RF calculation, at fixed occupation
number. Check acoustic sum rule.
The ecut is 18 Hartree. It seems quite low, but gives
phonon frequency of 3.83i cm-1, which is quite small,
while increasing it to 22 Ha or 26 Ha, respectively,
gives 4.73i cm-1 and 1.32i cm-1, respectively." data-toggle="popover" href="/tests/v3/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in BCC structure. Low cut-offs and few k-points.
This test is done within GGA and (ferro-)magnetism in PAW formalism.
The same job is done twice with two differents PAW datasets.
First PAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed analytically.
SecondPAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed numerically." data-toggle="popover" href="/tests/v4/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H based fake crystals : magnetic groups, Shubnikov type III
Test the generation and recognition of the
orthorhombic space groups (part I : spgroup 16 to 46)" data-toggle="popover" href="/tests/v4/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H based fake crystals : magnetic groups, Shubnikov type III
Test the generation and recognition of the
orthorhombic space groups (part II : spgroup 47 to 62)" data-toggle="popover" href="/tests/v4/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi atom in a big supercell.
Test the application of a Zeeman field." data-toggle="popover" href="/tests/v6/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="test partial dos calculation with spinors (previously not enabled) and spin
polarization while we are at it" data-toggle="popover" href="/tests/v7/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Nickel ferromagnetic fcc structure with an ONCVPSP pseudo containing valence density.
We test several improvements that are available when the NC file contains the PS valence charge.
More specifically, we test the initialization of the density from atomic quantities (initro.F90),
the correction to the forces due to the residuals and the extrapolation of the density
for structural relaxations (well, xred is fixed by symmetry).
We also test the treatment of the core charge in G-space in the case of GS calculations
By default, abinit handles XCCC in real space, here we use nc_xccc_gspace==1 to treat it
in G-space using the same approach as the one used in PAW." data-toggle="popover" href="/tests/v7/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
Check jointly the charge and vector magnetization constraints, with differing vector orientations." data-toggle="popover" href="/tests/v8/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
with mixed constraints (different for different atomic types), and also fixing the amplitude or the direction" data-toggle="popover" href="/tests/v8/Input/t27.abi" target="_blank">t27.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test collinear treatment as well as non-collinear, with different starting spinat
See test v9#41 for DFPT, with PAW atomic data." data-toggle="popover" href="/tests/v9/Input/t13.abi" target="_blank">t13.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the initial electronic spin-magnetization for each atom, in unit of <span><span class="MathJax_Preview">\hbar/2</span><script type="math/tex">\hbar/2</script></span>,
as well as, in case of fixed magnetization calculations (see <a class="wikilink codevar-wikilink" href="/variables/gstate#constraint_kind">constraint_kind</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#magconon">magconon</a>), the target value of the magnetization.</p>
<p>Note that if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 2, the z-component must be given for each atom, in
triplets (0 0 z-component).
For example, the electron of an hydrogen atom can be spin up (0 0 1.0) or spin
down (0 0 -1.0).</p>
<p>This value is only used to create the first exchange and correlation
potential.
It is not checked against the initial occupation numbers <a class="wikilink codevar-wikilink" href="/variables/gstate#occ">occ</a> for each spin
channel.
It is meant to give an easy way to break the spin symmetry, and to allow to
find stable local spin fluctuations, for example: antiferromagnetism, or the
spontaneous spatial spin separation of elongated H<span><span class="MathJax_Preview">_2</span><script type="math/tex">_2</script></span> molecule.</p>
<ul>
<li>
<p>If the atom manipulator is used,  <strong>spinat</strong>  will be related to the preprocessed set of atoms,
  generated by the atom manipulator. The user must thus foresee the effect of this atom manipulator (see <a class="wikilink codevar-wikilink" href="/variables/geo#objarf">objarf</a>).</p>
</li>
<li>
<p>If the atom manipulator is not used, and the symmetries are not specified by the user (<a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> = 0),
spinat will be used, if present, to determine the anti-ferromagnetic characteristics of the symmetry operations, see <a class="wikilink codevar-wikilink" href="/variables/gstate#symafm">symafm</a>.
In case of collinear antiferromagnetism (<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1,
<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 2), these symmetries are used to symmetrize the density.
In case of non-collinear magnetism (<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2,
<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 4), they are also used to symmetrize the density. In the latter
case, this strongly constrains the magnetization (imposing its direction). If
the user want to let all degrees of freedom of the magnetization evolve, it is
then recommended to put <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> = 1.</p>
</li>
<li>
<p>If the symmetries are specified, and the irreducible set of atoms is specified, the anti-ferromagnetic characteristics of the symmetry operations <a class="wikilink codevar-wikilink" href="/variables/gstate#symafm">symafm</a> will be used to generate  <strong>spinat</strong>  for all the non-irreducible atoms.</p>
</li>
<li>
<p>In the case of PAW+U calculations using the <a class="wikilink codevar-wikilink" href="/variables/paw#dmatpawu">dmatpawu</a> initial occupation matrix, and if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 4,  <strong>spinat</strong>  is also used to determine the direction of the integrated magnetization matrix.</p>
</li>
</ul>
<h2 id="stmbias"><strong>stmbias</strong><a class="headerlink" href="#stmbias" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Scanning Tunneling Microscopy BIAS voltage<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to obtain a Scanning Tunneling Microscopy map" data-toggle="popover" href="/topics/STM">topic_STM</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
5-atom Al slab, with three vacuum layers.
First, converge the wavefunctions, then compute the
STM charge density below and above the Fermi energy, within a 2eV range.
Also compute band-by-band decomposition of STM charge density below the Fermi energy, within a 2eV range." data-toggle="popover" href="/tests/v4/Input/t46.abi" target="_blank">t46.abi</a></li>
</ul>
</details>
<p>Gives, in Hartree, the bias of the STM tip, with respect to the sample, in
order to generate the STM density map.
Used with positive <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> = 7 (metallic, gaussian), <a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a> = 1,
and positive <a class="wikilink codevar-wikilink" href="/variables/files#prtstm">prtstm</a>, this value is used to generate a charge density map
from electrons close to the Fermi energy, in a (positive or negative) energy
range. Positive  <strong>stmbias</strong>  will lead to the inclusion of occupied (valence)
states only, while negative  <strong>stmbias</strong>  will lead to the inclusion of
unoccupied (conduction) states only.
Can be specified in Ha (the default), Ry, eV or Kelvin, since  <strong>stmbias</strong>  has
the <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics (0.001 Ha = 27.2113845 meV = 315.773 Kelvin).
With <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> = 7, one has also to specify an independent broadening <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a>.</p>
<h2 id="supercell_latt"><strong>supercell_latt</strong><a class="headerlink" href="#supercell_latt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SUPERCELL LATTice<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the unit cell" data-toggle="popover" href="/topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [1, 1, 1]<br />
<em>Added in version:</em> before v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="test supercell_latt construction" data-toggle="popover" href="/tests/v8/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>Factor that multiplies the three primitive vectors to generate a supercell.
The starting nuclei types <a class="wikilink codevar-wikilink" href="/variables/basic#typat">typat</a> and coordinates <a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#xcart">xcart</a>
are simply replicated in the different images of the original primitive cell.
If present, <a class="wikilink codevar-wikilink" href="/variables/gstate#spinat">spinat</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#chrgat">chrgat</a> are also replicated without change.
Note that  <strong>supercell_latt</strong>  is not echoed. It is immediately used to change
<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#typat">typat</a>, and all input variables that depend on <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#typat">typat</a>.</p>
<p>This input variable cannot be used jointly with non-default values of <a class="wikilink codevar-wikilink" href="/variables/geo#natrd">natrd</a> and <a class="wikilink codevar-wikilink" href="/variables/geo#nobj">nobj</a>.
Also, <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> is set to 1. Also note that <a class="wikilink codevar-wikilink" href="/variables/rlx#vel">vel</a>, if defined, must have the dimensions of the
number of atoms in the supercell, not the initial <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, because it is not replicated.
 <strong>supercell_latt</strong>  is typically used to initialize molecular dynamics runs.</p>
<h2 id="symafm"><strong>symafm</strong><a class="headerlink" href="#symafm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SYMmetries, Anti-FerroMagnetic characteristics<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a spin-polarized calculation" data-toggle="popover" href="/topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a>)<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> * 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
H diatomic molecule in the antiferromagnetic regime.
Different data sets.
Test Shubnikov symmetries." data-toggle="popover" href="/tests/v3/Input/t20.abi" target="_blank">t20.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization." data-toggle="popover" href="/tests/v8/Input/t95.abi" target="_blank">t95.abi</a></li>
</ul>
</details>
<p>In case the material is magnetic, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>=2 or 4, additional symmetry operations might appear,
that change the sign of the magnetization (spin-flip). They have been introduced by
Shubnikov in 1951 <a class="wikilink citation-wikilink" data-tippy-content="The mathematical theory of symmetry in solids: representation theory for point groups and space groups" data-toggle="popover" href="/theory/bibliography#bradley1972">[Bradley1972]</a>. They can be used by ABINIT to decrease the CPU time, either
by decreasing the number of k-points or by suppressing the explicit treatment of one spin channel,
or by decreasing the number of perturbations in DFPT.</p>
<p><strong>symafm</strong>  should be set to +1 for all the usual symmetry operations, that do
not change the sign of the magnetization, while it should be set to -1 for the
magnetization-changing operations (spin-flip).
If the symmetry operations are not specified by the user in the input file,
that is, if <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> = 0, then ABINIT will use the values of <a class="wikilink codevar-wikilink" href="/variables/gstate#spinat">spinat</a> to
determine the content of  <strong>symafm</strong> .</p>
<p>The symmetries that can act on the magnetization can yield decreased CPU time  (and usually also memory decrease)
in the following cases:</p>
<ul>
<li>antiferromagnetism (<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 2)</li>
<li>non-collinear magnetism (<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 4)</li>
</ul>
<p>Also in the case <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 2  they might simply yield better accuracy (or faster convergence),
but there is no automatic gain of CPU time or memory, although it is not as clear cut as in the above cases.</p>
<p>IMPORTANT : The meaning of  <strong>symafm</strong>  is different in the <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 2 case (collinear magnetism),
and in the <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 4 case (non-collinear magnetism, with explicit treatment of magnetization as a vector).
Indeed in the first case, it is supposed that the magnetization vector is not affected by the real space symmetry operations
(so-called black and white symmetry groups).
By contrast, in the second case, the real space symmetry operations act on the magnetization vector.
The rationale for such different treatment comes from the fact that the treatment of spin-orbit coupling is incompatible with collinear magnetism <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>=2,
so there is no need to worry about it in this case. On the contrary, many calculations with <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>=4
will include spin-orbit coupling. The symmetry operations should thus act coherently on the spin-orbit coupling, which implies
that the real space operations should act also on the magnetization vector in the <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>=4 case. So, with
<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>=4, even with  <strong>symafm</strong> =1,
symmetry operations might change the magnetization vector, e.g. possibly reverse it from one atom to another atom.
Still, when real space operations also act on the magnetization vector, nothing prevents to have ADDITIONAL &ldquo;spin-flip&rdquo; operations, which
is indeed then the meaning of  <strong>symafm</strong> =-1 in the <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>=4 case.
Note that real-space operations act on the magnetization as an axial vector, not as a normal vector. For example, the inversion symmetry
does not change the magnetization vector.</p>
<p>Let&rsquo;s illustrate this with an example. Take an H<span><span class="MathJax_Preview">_2</span><script type="math/tex">_2</script></span> system, with the two H atoms quite distant from each other.
The electron on the first H atom might be 1s spin up, and the electron on the second atom might be 1s spin down.
With <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>=2, the inversion symmetry centered in the middle of the segment joining the two atoms will NOT act on the spin,
so that the actual symmetry operation that leaves the system invariant is an inversion (<a class="wikilink codevar-wikilink" href="/variables/basic#symrel">symrel</a>= -1 0 0  0 -1 0  0 0 -1) accompanied
by a spin-flip with  <strong>symafm</strong> =-1.
By contrast, with <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>=4, the inversion symmetry centered in the middle of the segment joining the two atoms will reverse the spin direction as well,
so that the proper symmetry operation is <a class="wikilink codevar-wikilink" href="/variables/basic#symrel">symrel</a>= -1 0 0  0 -1 0  0 0 -1 but no additional spin-flip is needed to obtain a symmetry operation that leaves the system invariant, so that  <strong>symafm</strong> =1.</p>
<p>Although this might seem confusing, ABINIT is able to recognise the correct symmetry operations from the available atomic coordinates, from <a class="wikilink codevar-wikilink" href="/variables/gstate#spinat">spinat</a>,
and from <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>, so that the user should hardly be affected by such different conventions. However, the use of <a class="wikilink codevar-wikilink" href="/variables/geo#ptgroupma">%ptgroupma</a> and <a class="wikilink codevar-wikilink" href="/variables/geo#spgroupma">spgroupma</a> to define
the antiferromagnetic operations of symmetry should be done carefully.</p>
<p>Related variables: <a class="wikilink codevar-wikilink" href="/variables/basic#symrel">symrel</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tnons">tnons</a>, <a class="wikilink codevar-wikilink" href="/variables/geo#ptgroupma">%ptgroupma</a>, <a class="wikilink codevar-wikilink" href="/variables/geo#spgroupma">spgroupma</a>.</p>
<h2 id="timopt"><strong>timopt</strong><a class="headerlink" href="#timopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TIMing OPTion<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink" data-tippy-content="This is an external parameter
typically compilation parameters, available libraries, or number of processors.
You can change these parameters at compile or runtime usually.
" data-toggle="popover" href="/variables/external_parameters#sequential" title="True if the code is compiled without MPI">SEQUENTIAL</a>,
0 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [115/1245] in all abinit tests, [18/159] in abinit tutorials</summary><ul>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
21. Conduct same relaxation but use ionmov=1 (molecular dynamics)." data-toggle="popover" href="/tests/fast/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Gold with one vacancy (107 atoms of gold)." data-toggle="popover" href="/tests/tutoparal/Input/tparal_bandpw_01.abi" target="_blank">tparal_bandpw_01.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom (see above)
Treated with LSD, Teter rational polynomial parametrization (4/93) (ixc=1).
The total energy is -0.4792 Ha.
Also additional tests concerning the kinetic energy density calculation,
the gradient of electronic density calculation and
the Laplacian of electronic density calculation are performed." data-toggle="popover" href="/tests/v1/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Space group number 225 : FCC Aluminum, in both conventional and
primitive unit cells." data-toggle="popover" href="/tests/v2/Input/t59.abi" target="_blank">t59.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms)." data-toggle="popover" href="/tests/v4/Input/t97.abi" target="_blank">t97.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-toggle="popover" href="/tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
One-shot GW calculations within the PAW formalism" data-toggle="popover" href="/tests/v5/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrure of Lithium-Boron, in a face-centered monoclinic cell.
Test the recognition of the space group (C2/c (# 15)). Was lacking a case before Dec 2011." data-toggle="popover" href="/tests/v6/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon. Diamond structure.
Quick test of the use of datasets with a numbering beyond 1000 (the last one is 1022).
(Tests 35-40 are for response-function)" data-toggle="popover" href="/tests/v6/Input/t34.abi" target="_blank">t34.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-toggle="popover" href="/tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiF. Optical properties within BSE and PAW (Haydock method)." data-toggle="popover" href="/tests/v67mbpt/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom." data-toggle="popover" href="/tests/v8/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom along one direction." data-toggle="popover" href="/tests/v8/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Simple input (from fast/t03) to test nblock_lobpcg variable" data-toggle="popover" href="/tests/v9/Input/t205.abi" target="_blank">t205.abi</a> &hellip;</li>
</ul>
</details>
<p>This input variable allows one to modulate the use of the timing routines.</p>
<ul>
<li>If 0  &rarr;  as soon as possible, suppresses all calls to timing routines</li>
<li>If 1  &rarr;  usual timing behaviour, with short analysis, appropriate for
sequential execution</li>
<li>If 2  &rarr;  close to  <strong>timopt</strong>  = 1, except that the analysis routine does not time
the timer, appropriate for parallel execution.</li>
<li>If 3  &rarr;  close to  <strong>timopt</strong>  = 1, except that the different parts of the lobpcg
routine are timed in detail.</li>
<li>If 4  &rarr;  close to  <strong>timopt</strong>  = 1, except that the different parts of the lobpcg
routine are timed in detail. A different splitting of lobpcg than for
 <strong>timopt</strong>  = -3 is provided.</li>
<li>If 10  &rarr;  relevant only when the wavelet basis set is used (i.e. <a class="wikilink codevar-wikilink" href="/variables/basic#usewvl">usewvl</a> = 1).
    When activated, a file named <code>wvl_timings.yaml</code>,
    in <a href="https://en.wikipedia.org/wiki/YAML">YAML format</a>, is created.
    It contains a time analysis of the <em>BigDFT</em> wavelet routines.
    See the <a class="wikilink lesson-wikilink" href="/tutorial/paral_gswvl">tutorial on parallelism using wavelets</a></li>
<li>If -1  &rarr;  a full analysis of timings is delivered</li>
<li>If -2  &rarr;  a full analysis of timings is delivered, except timing the timer</li>
<li>If -3  &rarr;  a full analysis of timings is delivered, including the detailed
timing of the different parts of the lobpcg routine. (this takes time, and is
discouraged for too small runs - the timing would take more time than the run
!). The timer is timed.</li>
<li>If -4  &rarr;  a full analysis of timings is delivered, including the detailed
timing of the different parts of the lobpcg routine. A different splitting of
lobpcg than for  <strong>timopt</strong>  = -3 is provided (this takes time, and is discouraged
for too small runs - the timing would take more time than the run !). The
timer is timed. The sum of the independent parts is closer to 100% than for  <strong>timopt</strong>  = -3.</li>
</ul>
<h2 id="tl_nprccg"><strong>tl_nprccg</strong><a class="headerlink" href="#tl_nprccg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TaiL maximum Number of PReConditioner Conjugate Gradient iterations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculations on a wavelet basis" data-toggle="popover" href="/topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 30<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiH4 molecule with truncated convergence to test the computation of the tail
correction (see the tl_radius) parameter in the input file." data-toggle="popover" href="/tests/bigdft/Input/t09.abi" target="_blank">t09.abi</a></li>
</ul>
</details>
<p>This variable is similar to <a class="wikilink codevar-wikilink" href="/variables/gstate#wvl_nprccg">wvl_nprccg</a> but for the preconditioner
iterations during the tail corrections (see <a class="wikilink codevar-wikilink" href="/variables/gstate#tl_radius">tl_radius</a>).</p>
<h2 id="tl_radius"><strong>tl_radius</strong><a class="headerlink" href="#tl_radius" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TaiL expansion RADIUS<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculations on a wavelet basis" data-toggle="popover" href="/topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiH4 molecule with truncated convergence to test the computation of the tail
correction (see the tl_radius) parameter in the input file." data-toggle="popover" href="/tests/bigdft/Input/t09.abi" target="_blank">t09.abi</a></li>
</ul>
</details>
<p>In the wavelet computation case, the linkage between the grid and the free
boundary conditions can be smoothed using an exponential decay. This means a
correction on the energy at the end on each wavefunction optimisation run. If
this parameter is set to zero, no tail computation is done. On the contrary,
put it to a positive value makes the tail correction available. The value
correspond to a length in atomic units being the spacial expansion with the
exponential decay around the grid.</p>
<h2 id="tphysel"><strong>tphysel</strong><a class="headerlink" href="#tphysel" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Temperature (PHYSical) of the ELectrons<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify bands and occupation numbers, for metals or insulators" data-toggle="popover" href="/topics/BandOcc">topic_BandOcc</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell.
Testing temperature-dependent libxc functionals.
Several XC functionals, several electronic temperatures." data-toggle="popover" href="/tests/libxc/Input/t22.abi" target="_blank">t22.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms)." data-toggle="popover" href="/tests/v4/Input/t97.abi" target="_blank">t97.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test tphysel input, which convolutes a physical temperature (tphysel)
dependence with an artificial cold-smearing (Marzari) to further improve
k-point convergence. Physical T dependence should be preserved, while
k-point convergence is sped up." data-toggle="popover" href="/tests/v5/Input/t80.abi" target="_blank">t80.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Boron, 32 atoms - Thomas-Fermi method (without orbitals)
Test the temperature-dependent XC functional (ixc=50)
(Ichimaru et al Phys. Rep. 149, 91-205 (1987)
Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-toggle="popover" href="/tests/v7/Input/t11.abi" target="_blank">t11.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom." data-toggle="popover" href="/tests/v8/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom along one direction." data-toggle="popover" href="/tests/v8/Input/t22.abi" target="_blank">t22.abi</a></li>
</ul>
</details>
<p>Gives, in Hartree, the physical temperature of the system, in case <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> = 4, 5, 6, or 7.</p>
<p>Can be specified in Ha (the default), Ry, eV or Kelvin, since  <strong>tphysel</strong>  has the
<a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics (0.001 Ha = 27.2113845 meV = 315.773 Kelvin). One
has to specify an independent broadening <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a>. The combination of the
two parameters  <strong>tphysel</strong>  and <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a> is described in <a class="wikilink citation-wikilink" data-tippy-content="Smearing scheme for finite-temperature electronic-structure calculations" data-toggle="popover" href="/theory/bibliography#verstraete2002">[Verstraete2002]</a>.
Note that the signification of the entropy is modified with respect to the usual entropy.
The choice has been made to use <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a> as a prefactor of the entropy, to
define the entropy contribution to the free energy.
Note that  <strong>tphysel</strong>  might be used as parameter for Free Energy exchange-correlation functionals (see <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>).</p>
<h2 id="tsmear"><strong>tsmear</strong><a class="headerlink" href="#tsmear" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Temperature of SMEARing<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify bands and occupation numbers, for metals or insulators" data-toggle="popover" href="/topics/BandOcc">topic_BandOcc</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to obtain a Scanning Tunneling Microscopy map" data-toggle="popover" href="/topics/STM">topic_STM</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.01<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [328/1245] in all abinit tests, [43/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule NON-spin-polarized, in a big box, without tetragonal symmetry, in order to avoid
spurious degeneracy effects coupled to occupation numbers rapidly changing.
GPU
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization." data-toggle="popover" href="/tests/gpu_omp/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Oxygen atom
Test a few functionals for which HGH pseudopotentials are available (from M. Krack),
that are present also in the lib XC, but not in the native ABINIT set of functionals." data-toggle="popover" href="/tests/libxc/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell.
Testing temperature-dependent libxc functionals.
Several XC functionals, several electronic temperatures." data-toggle="popover" href="/tests/libxc/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule NON-spin-polarized, in a big box, without tetragonal symmetry, in order to avoid
spurious degeneracy effects coupled to occupation numbers rapidly changing.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization." data-toggle="popover" href="/tests/libxc/Input/t70.abi" target="_blank">t70.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Total energy vs. cell size for bulk FCC aluminium, to compare with the
PSML results of t08 and t12" data-toggle="popover" href="/tests/psml/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Gold with one vacancy (107 atoms of gold)." data-toggle="popover" href="/tests/tutoparal/Input/tparal_bandpw_01.abi" target="_blank">tparal_bandpw_01.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Al fcc metal - elastic constant calculation" data-toggle="popover" href="/tests/tutorespfn/Input/telast_6.abi" target="_blank">telast_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
the sequence of datasets makes the ground states and
all of the explicit perturbations of the single
Al atom in all directions, for the irreducible
qpoints in a 2x2x2 grid.
Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_1.abi" target="_blank">teph_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Computation of the isotropic Migdal-Eliashberg Tc" data-toggle="popover" href="/tests/tutorespfn/Input/teph4isotc_2.abi" target="_blank">teph4isotc_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : optimization of the lattice parameter
at fixed number of k points and broadening." data-toggle="popover" href="/tests/tutorial/Input/tbase4_1.abi" target="_blank">tbase4_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : optimization of the lattice parameter

Convergence with respect to k points." data-toggle="popover" href="/tests/tutorial/Input/tbase4_2.abi" target="_blank">tbase4_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy

Convergence with respect to k points" data-toggle="popover" href="/tests/tutorial/Input/tbase4_3.abi" target="_blank">tbase4_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=6 and tsmear=0.05.
Designed to test the treatment of metals,
with the Gaussian-Hermite smearing of Methfessel and Paxton.
Also test the use of fband instead of nband." data-toggle="popover" href="/tests/v1/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj to test restarxf -1" data-toggle="popover" href="/tests/v10/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj restarting from HIST file using restarxf -1" data-toggle="popover" href="/tests/v10/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
Compares with frozen-phonon calculations. Examine two cases:
varying occupation numbers, and fixed occupation numbers.
A. Varying occupation numbers (occopt=4):
RF calculation in dataset 5 gives
2DE equal to -3.812577 Ha, while finite difference of &quot;TOTAL&quot;
energy (datasets 6 and 7, including entropy term) gives -3.812230 Ha
(the agreement could be better with better finite difference)
B. Fixed occupation numbers (occopt=2):
RF calculation in dataset 8 gives
2DE equal to +5.431807 Ha, while finite difference of total
energy (no entropy term is present with occopt=2) gives +5.431857 Ha
(the agreement could be better with better finite difference)" data-toggle="popover" href="/tests/v2/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 28. The chosen grid (too coarse, though) is
(0 0 0), (1/4 1/4 0), (1/2 1/2 0), (1/2 0 0),
(1/2 1/4 1/4), (1/2 -1/4 1/4)  (in reduced coordinates).
The ecut and nkpt parameters are really too low (see test 28),
but parameters suitable for physical results (see test 29)
are also provided in the input files." data-toggle="popover" href="/tests/v2/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Al2 molecule in a big box. Treat 8 bands, occupied using occopt=4.
For a metallic occopt, the frozen-phonon (finite-difference) approach
is strictly equivalent to the RF approach only at q/=Gamma.
Here, computes the result at q=(0 0 1/2).
With delta(xred)=0.0001 (DATASET 5), one gets
delta(etot)/delta(xred)=0.42807994 .
The direct computation of 2DTE at the target geometry
gives 0.428080350 ." data-toggle="popover" href="/tests/v2/Input/t36.abi" target="_blank">t36.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
Compares with frozen-phonon calculations.
Similar to test v2 #11, except use of PBE GGA.
Examine two cases:
varying occupation numbers, and fixed occupation numbers.
A. Varying occupation numbers (occopt=4):
RF calculation in dataset 5 gives
2DE equal to -4.053115 Ha, while finite difference of &quot;TOTAL&quot;
energy (datasets 6 and 7, including entropy term) gives -4.0475002 Ha.
This is fair, BUT it does not improve with a better
finite-difference, so there is a problem.
B. Fixed occupation numbers (occopt=2):
RF calculation in dataset 8 gives
2DE equal to +5.394365 Ha, while finite difference of total
energy (no entropy term is present with occopt=2) gives +5.3998556 Ha
This is fair, BUT it does not improve with a better
finite-difference, so there is a problem.
Then, in dataset 11, compute phonon frequencies at Gamma
of the doubled cell. The 2DTE is 10.7997781 Ha, which
corresponds to 5.3998890 Ha, so in much better agreement
with the frozen-phonon calculation.
TO BE UNDERSTOOD ..." data-toggle="popover" href="/tests/v3/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test different ways to obtain the NiO antiferromagnetic structure" data-toggle="popover" href="/tests/v3/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to verify that different values
of input variable &#x27;ortalg&#x27; give the same results for
total energy. &#x27;ortalg&#x27; is use in the conjugate gradient
algorithm which solves, in the case of PAW calculations,
a generalized eigenproblem (H.|Psi&gt;=Lambda.S|Psi&gt;).
Three datasets are perfomed ; they must give the same
total energies values (when converged)." data-toggle="popover" href="/tests/v4/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-toggle="popover" href="/tests/v6/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for simple cubic Ti crystal, for reference purposes (conventional = primitive unit cell for symmetry ops)" data-toggle="popover" href="/tests/v6/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="test partial dos calculation with spinors (previously not enabled) and spin
polarization while we are at it" data-toggle="popover" href="/tests/v7/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the broadening of occupation numbers <a class="wikilink codevar-wikilink" href="/variables/gstate#occ">occ</a>, in the metallic cases
(<a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> = 3, 4, 5, 6 and 7). Can be specified in Ha (the default), eV, Ry,
or Kelvin, since  <strong>tsmear</strong>  has the <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics (0.001 Ha =
27.2113845 meV = 315.773 Kelvin).
Default is 0.01 Ha. This should be OK using gaussian like smearings (<a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> = 4,5,6,7)
for a free-electron metal like Al. For d-band metals, you may need to
use less.
Always check the convergence of the calculation with respect to this
parameter, and simultaneously, with respect to the sampling of k-points (see
<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>)
If <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> = 3,  <strong>tsmear</strong>  is the physical temperature, as the broadening is
based on Fermi-Dirac statistics. However, if <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> = 4, 5, 6, or 7, the
broadening is not based on Fermi-Dirac statistics, and  <strong>tsmear</strong>  is only a
convergence parameter. It is still possible to define a physical temperature,
thanks to the input variable <a class="wikilink codevar-wikilink" href="/variables/gstate#tphysel">tphysel</a> (See also <a class="wikilink citation-wikilink" data-tippy-content="Smearing scheme for finite-temperature electronic-structure calculations" data-toggle="popover" href="/theory/bibliography#verstraete2002">[Verstraete2002]</a>).</p>
<h2 id="useextfpmd"><strong>useextfpmd</strong><a class="headerlink" href="#useextfpmd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE EXTended FPMD model<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to enable the Extended FPMD method for high temperature simulations" data-toggle="popover" href="/topics/ExtFPMD">topic_ExtFPMD</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.5.2  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Check Extended FPMD routines with low number of bands for
Aluminum FCC lattice at high temperature." data-toggle="popover" href="/tests/v9/Input/t92.abi" target="_blank">t92.abi</a></li>
</ul>
</details>
<p>Enables the calculation of contributions to the energy, entropy, stresses,
number of electrons and chemical potential using the extended First Principle
Molecular Dynamics model for high temperature simulations.</p>
<p>For now, ExtFPMD is only available with <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> = 3, with <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a> defined
as the electronic temperature. More occupation options will be supported in the
future.</p>
<p>In case of electronic SCF cycle convergency problems, try to set a number of
unoccupied bands in the buffer with <a class="wikilink codevar-wikilink" href="/variables/gstate#extfpmd_nbdbuf">extfpmd_nbdbuf</a> input variable.</p>
<ul>
<li>
<p><strong>useextfpmd</strong> = 1 <em>(Recommended)</em>, the energy shift will be evaluated
by making an integration of the trial potential over the real space and the
contributions will be computed using the density of states of the Fermi gas.</p>
</li>
<li>
<p><strong>useextfpmd</strong> = 2, the energy shift will be evaluated by making
the average between the eigenvalues and the Fermi gas energy over the last
<a class="wikilink codevar-wikilink" href="/variables/gstate#extfpmd_nbcut">extfpmd_nbcut</a> bands, and the contributions will be computed with integrals
over the band number.</p>
</li>
<li>
<p><strong>useextfpmd</strong> = 3, the energy shift will be evaluated by making the
average between the eigenvalues and the kinetic energies over the last
<a class="wikilink codevar-wikilink" href="/variables/gstate#extfpmd_nbcut">extfpmd_nbcut</a> bands, and the contributions will be computed using the
density of states of the Fermi gas.</p>
</li>
<li>
<p><strong>useextfpmd</strong> = 4, the energy shift will be evaluated
by making an integration of the trial potential over the real space and the
contributions will be computed with integrals over the band number.</p>
</li>
<li>
<p><strong>useextfpmd</strong> = 5, the energy shift will be evaluated
by making an integration of the trial potential over the real space and the
contributions will be computed with discrete integer sums over the band indices.
<a class="wikilink codevar-wikilink" href="/variables/gstate#extfpmd_nband">extfpmd_nband</a> sets the last band index, which acts like <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> for a
conventional calculation.</p>
</li>
</ul>
<h2 id="usekden"><strong>usekden</strong><a class="headerlink" href="#usekden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE Kinetic energy DENsity<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [14/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Carbon atom
Test the Becke-Johnson mGGA functional, generating directly XC potentials.
Convergence parameters are quite high, and the test is reasonably portable.
To make the test more portable, we generate GGA-PBE wave functions as starting point." data-toggle="popover" href="/tests/libxc/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
To make the test more portable, we generate GGA-PBE wave functions as starting point." data-toggle="popover" href="/tests/libxc/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Carbon atom
Test the mGGA functionals generating directly XC potentials.
To make the test more poratble, we generate GGA-PBE wave functions as starting point.
Similar to test 08, but with smaller acell and ecut.
Without the use of a &quot;large&quot; xc_denpos, Tran-Blaha is hard to converge. Hypothesis : there is a strong non-linear
region, preventing the Anderson method to work effectively.
Note that the default iscf (=7) does not allow to converge with the default xc_denpos !
By contrast, things are much better behaved with xc_denpos on the order of 1.0e-7 ." data-toggle="popover" href="/tests/libxc/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Argon solid, experimental lattice parameter.
Realistic parameters are used (ecut=20, ngkpt=2x2x2 shifted 4 times, but centered on Gamma).
Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
The LDA gap is observed at Gamma : 8.071 eV, is in reasonable agreement with the gap from the TB paper PRL 102, 226401 (2009),
where it is mentioned to be 8.16 eV.
The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV.
The reading of the kinetic energy density, to start a non-SCF calculation is not yet implemented,
as of ABINITv6.12.0 .
This test was used to examine the speed of the convergence in case of elongated cells, up to 16 atoms.
The mGGA convergence was found to be similar to the LDA convergence.
Also, test non-self-consistent mGGA calculation, with reading of the previously produced _DEN and _KDEN files." data-toggle="popover" href="/tests/libxc/Input/t19.abi" target="_blank">t19.abi</a></li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom (see above)
Treated with LSD, Teter rational polynomial parametrization (4/93) (ixc=1).
The total energy is -0.4792 Ha.
Also additional tests concerning the kinetic energy density calculation,
the gradient of electronic density calculation and
the Laplacian of electronic density calculation are performed." data-toggle="popover" href="/tests/v1/Input/t21.abi" target="_blank">t21.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth atom, isolated, in a supercell.
Compares different spin treatments :
- spin-polarized collinear (nspinor=1, nspden=2, nsppol=2, no spin-orbit)
- spinor (nspinor=2, nspden=4, nsppol=1, no spin-orbit)
Both with fixed occupation numbers and metallic occupations.
This test has been contributed by L.E. Diaz.
Additional test added for kinetic energy density by A. Lherbier" data-toggle="popover" href="/tests/v5/Input/t51.abi" target="_blank">t51.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom.
Treated with GGA C09x exchange functional (ixc=24).
The total energy is -0.429523 Ha.
Also additional tests concerning the kinetic energy density calculation,
the gradient of electronic density calculation and
the Laplacian of electronic density calculation are performed.
Test taken from v1/t21.in." data-toggle="popover" href="/tests/v6/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi atom in a big supercell.
Test the application of a Zeeman field." data-toggle="popover" href="/tests/v6/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests series for the mGGA implementation (from 31 to 33)
Silicon bulk. Two datasets are run. One (classic) LDA calculation with ixc 7.
One with a fake native mGGA (fake1, i.e. ixc 31) and using effmass_free=1.01.
Both calculation should give the same total energy (change in kinetic energy due to
effmass_free is compensated by the fake mGGA using kinetic energy density: taur).
(Two other datasets are also run for spin polarized case)" data-toggle="popover" href="/tests/v6/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the mGGA implementation. Silicon bulk. Two datasets are run.
One with a fake native mGGA (fake2, i.e. ixc 32) involving laplacian of the density.
One with a fake native mGGA (fake3, i.e. ixc 33) involving gradient of the density.
Both calculation should give the same total and exchange-correlation energies.
(Two other datasets are also run for spin polarized case)" data-toggle="popover" href="/tests/v6/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the mGGA implementation. Isolated Hydrogen atom. Two datasets are run.
One with a fake native mGGA (fake3, i.e. ixc 33) involving gradient of the density.
One with a fake native mGGA (fake4, i.e. ixc 34) involving kinetic energy density (and its gradient).
Both calculation should give the same total and exchange-correlation energies.
(Two other datasets are also run for spin polarized case)" data-toggle="popover" href="/tests/v6/Input/t33.abi" target="_blank">t33.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
InN non-primitive cell, doubled wurtzite, rather inaccurate rprimd and xred.
Test disabling all checks and fixes of atomic positions or cell parameters. Otherwise, similar to v9#17" data-toggle="popover" href="/tests/v9/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Copper atom isolated in a box, mGGA Norm conserving
Tests the reading of the upf2 potential, and inputs related to the model core kinetic energy density, then their usage.
nc_xccc_gspace 0 calculates model core contribution in real space, and is much cleaner (0 kinE and density outside NLCC radius)
Density (+kinE) mixing works much better than potential mixing: in the vacuum the mGGA potential is very sensitive" data-toggle="popover" href="/tests/v9/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
InN non-primitive cell, doubled wurtzite, rather inaccurate rprimd and xred.
Test automatic correction of rprimd, tnons and xred, as well as final
proposal of atomic positions that would given tolerated values of tnons
if chksymtnons is not set to zero.
WARNING XG20201109: the xred is presently too symmetric (with respect to symrel), so that it is fully
matching the FFT grid at the end. One should shift the xred by 0.01.
I tried this, but then the symmetrize_xred was unable to select the correcting proposal.
In order to debug, one should likely select a simpler case, with orthogonal rprim
So, at present there is no test of properly working chksymtnons 2 ." data-toggle="popover" href="/tests/v9/Input/t192.abi" target="_blank">t192.abi</a></li>
</ul>
</details>
<p>If  <strong>usekden</strong>  = 1 the kinetic energy density will be computed during
the self-consistent loop, in a way similar to the computation of the density.
This is needed if a meta-GGA is to be used as XC functional. By default
( <strong>usekden</strong>  = 0), the kinetic energy density is not computed during the self-
consistent loop.  <strong>usekden</strong>  = 1 is not yet allowed with <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a>=4 (non-collinear magnetism).</p>
<h2 id="vacuum"><strong>vacuum</strong><a class="headerlink" href="#vacuum" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> VACUUM identification<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> None<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [23/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum slab

Determination of the surface energy of aluminum :
a minimal slab." data-toggle="popover" href="/tests/tutorial/Input/tbase4_5.abi" target="_blank">tbase4_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy

Determination of the surface energy of aluminum :
convergence with respect to the number of vacuum layers." data-toggle="popover" href="/tests/tutorial/Input/tbase4_6.abi" target="_blank">tbase4_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy
Determination of the surface energy of aluminum :
convergence with respect to the number of vacuum layers." data-toggle="popover" href="/tests/tutorial/Input/tbase4_7.abi" target="_blank">tbase4_7.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Mo surface, with 10 atom per cell. Not very large, but the
number of bands make it a medium-size problem : 36 bands." data-toggle="popover" href="/tests/v1/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab : 5 layers of Mo + 3 layers of vacuum, ixc=0 .
Central layer is slightly displaced, to break the symmetry.
Metallic occupation numbers.
Only 20 bands, while at least 15 are needed.
Use iscf=2, start with default metallic preconditioner,
damped (diemix=0.5d0). A factor of 2 is gained
at each iteration. Then evaluate RPA matrix eigenvalues
using the extrapolation, and including the metallic correction.
Largest are 3.2541E+01  1.2089E+01  6.1305E+00 .
Then, uses the dielectric matrix preconditioning to converge.
No damping is needed.
A factor of about 10 is gained at each iteration on average." data-toggle="popover" href="/tests/v1/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same system as for case 55. Evaluate eigenvalue of the standard
SCF cycle. Find -2.68. This explains the damping needed in case 55." data-toggle="popover" href="/tests/v1/Input/t56.abi" target="_blank">t56.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the mechanism for checking the presence of vacuum.
Use H2 molecule, placed in a big box." data-toggle="popover" href="/tests/v2/Input/t58.abi" target="_blank">t58.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
5-atom Al slab, with three vacuum layers.
First, converge the wavefunctions, then compute the
STM charge density below and above the Fermi energy, within a 2eV range.
Also compute band-by-band decomposition of STM charge density below the Fermi energy, within a 2eV range." data-toggle="popover" href="/tests/v4/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Jellium slab (50 jellium/ 50 vacuum) with Wigner-Seitz radius=4.
Computation of the total energy
The number of k points has been much reduced" data-toggle="popover" href="/tests/v5/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BeH spin-polarized, in a supercell
Test the spin-polarized TDDFT implementation.
nband 20 , ecut 8 , acell 14 14 14 .
For the first two excitations, one finds :
2.40967E+00 eV , doubly degenerate  (Pi excitation)
3.94165E+00 eV  (Sigma+ excitation)
They come mainly from the 2nd occupied Kohn-Sham state, spin up.
The third excitation, at 5.11592E+00 eV (Sigma+ excitation) comes mainly from
the 1st occupied Kohn-Sham state, spin down.
Then, come excitations that are in the continuum, or close to it
(depending on the parameters of the calculation), so, harder to converge,
In order to have a calculation converged
at the level of 0.1 eV, one needs parameters like
nband 40 , ecut 10 , acell 30.
In that case, the three above-mentioned excitations become
2.388 eV (Pi), 4.432 eV (Sigma+), 5.357 eV (Sigma+).
In this case, the latter is no more the third excitation, as other ones,
coupled to the vacuum have a lower energy.
These numbers can be compared to the values given by
J. Guan, ME Casida, DR Salahub, J. of Mol. Structure - Theochem 527,
229, Sp. Iss. SI (2000) :
2.391 eV (1Pi), 4.593 eV (2Sigma+), 5.418 eV (5Sigma+),
and to the experimental values (see the above paper)
2.56 eV/2.484 eV , 5.51 eV , 6.71 eV." data-toggle="popover" href="/tests/v5/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for rsprc preconditionner (not already effective)
simple scf calculation
following part of the code are tested:
04rsprc/prcrscgres.F90
01cg/*" data-toggle="popover" href="/tests/v5/Input/t73.abi" target="_blank">t73.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Copper atom isolated in a box, mGGA Norm conserving
Tests the reading of the upf2 potential, and inputs related to the model core kinetic energy density, then their usage.
nc_xccc_gspace 0 calculates model core contribution in real space, and is much cleaner (0 kinE and density outside NLCC radius)
Density (+kinE) mixing works much better than potential mixing: in the vacuum the mGGA potential is very sensitive" data-toggle="popover" href="/tests/v9/Input/t95.abi" target="_blank">t95.abi</a> &hellip;</li>
</ul>
</details>
<p>Establishes the presence (if  <strong>vacuum</strong>  = 1) or absence (if  <strong>vacuum</strong>  = 0) of a vacuum layer, along the
three possible directions normal to the primitive axes.</p>
<p>This information might be used to generate k-point grids, if <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 0 and
neither <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> nor <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> are defined (see explanations with the
input variable <a class="wikilink codevar-wikilink" href="/variables/files#prtkpt">prtkpt</a>).
It will allow to select a zero-, one-, two- or three-dimensional grid of k
points. The coordinate of the k points along vacuum directions is
automatically set to zero.</p>
<p>If  <strong>vacuum</strong>  is not defined, the input variable <a class="wikilink codevar-wikilink" href="/variables/gstate#vacwidth">vacwidth</a> will be used to
determine automatically whether the distance between atoms is sufficient to
have the presence or absence of vacuum.</p>
<h2 id="vacwidth"><strong>vacwidth</strong><a class="headerlink" href="#vacwidth" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> VACuum WIDTH<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a>, <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the mechanism for checking the presence of vacuum.
Use H2 molecule, placed in a big box." data-toggle="popover" href="/tests/v2/Input/t58.abi" target="_blank">t58.abi</a></li>
</ul>
</details>
<p>Give a minimum &ldquo;projected&rdquo; distance between atoms to be found in order to
declare that there is some <a class="wikilink codevar-wikilink" href="/variables/gstate#vacuum">vacuum</a> present for each of the three
directions. By default, given in Bohr atomic units (1 Bohr=0.5291772108
Angstroms), although Angstrom can be specified, if preferred, since
 <strong>vacwidth</strong>  has the <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a> characteristics.
The precise requirement is that a slab of width  <strong>vacwidth</strong> , delimited by two
planes of constant reduced coordinates in the investigated direction, must be empty of atoms.</p>
<h2 id="vcutgeo"><strong>vcutgeo</strong><a class="headerlink" href="#vcutgeo" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> V (potential) CUT-off GEOmetry<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to treat adequately the Coulomb interaction, especially in charged cells," data-toggle="popover" href="/topics/Coulomb">topic_Coulomb</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a GW- Lanczos-Sternheimer calculation" data-toggle="popover" href="/topics/GWls">topic_GWls</a>, <a class="wikilink topic-wikilink" data-tippy-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-toggle="popover" href="/topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-toggle="popover" href="/topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#icutcoul">icutcoul</a> in [1,2]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the 0D and 2D Coulomb cut-off functionality
in the ground state  for graphene." data-toggle="popover" href="/tests/v9/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
h-BN single layer using 2D cut-off method of Beigi :
compute the first order derivative of the total energy
With delta(xred)=0.0002, one gets delta(etot)/delta(xred)=-0,0050208160
With delta(xred)=0.0001, one gets delta(etot)/delta(xred)=-0,0050213750
The combination of both results, in a higher-order finite difference
formula gives -0,0050215613 . The direct computation of forces
at the target geometry gives -0,0050217263 when converged values are used.
The agreement falls within (6) digits of the finite-difference result." data-toggle="popover" href="/tests/v9/Input/t132.abi" target="_blank">t132.abi</a></li>
</ul>
</details>
<p><strong>vcutgeo</strong>  is used in conjunction with <a class="wikilink codevar-wikilink" href="/variables/gstate#icutcoul">icutcoul</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#fock_icutcoul">fock_icutcoul</a> and/or <a class="wikilink codevar-wikilink" href="/variables/gw#gw_icutcoul">gw_icutcoul</a>
to specify the geometry used to truncate the Coulomb interaction, as well as the particular approach
to be used. It has a meaning either for a periodic one-dimensional system, typically
a nanowire, nanotube or polymer surrounded by vacuum separating the system
from images in neighbouring cells
(<a class="wikilink codevar-wikilink" href="/variables/gstate#icutcoul">icutcoul</a> = 1) or in the case of periodic two-dimensional system,
typically a slab with vacuum separating it from images in neighbouring cells (<a class="wikilink codevar-wikilink" href="/variables/gstate#icutcoul">icutcoul</a> = 2).</p>
<p>When a non-zero component of this three-dimensional vector is non-zero, this indicate that the system is
periodic along this dimension. Note that the components of this vector are real numbers, which is
useful in the current implementation of the Rozzi methods <a class="wikilink citation-wikilink" data-tippy-content="Exact Coulomb cutoff technique for supercell calculations" data-toggle="popover" href="/theory/bibliography#rozzi2006">[Rozzi2006]</a>. Of course, just specifying 0 or 1 is allowed,
but will be read as 0.0 or 1.0.</p>
<p>For each
geometry, two different definitions of the cutoff region are available (see
<a class="wikilink citation-wikilink" data-tippy-content="Truncation of periodic image interactions for confined systems" data-toggle="popover" href="/theory/bibliography#ismail-beigi2006">[Ismail-Beigi2006]</a> and <a class="wikilink citation-wikilink" data-tippy-content="Exact Coulomb cutoff technique for supercell calculations" data-toggle="popover" href="/theory/bibliography#rozzi2006">[Rozzi2006]</a> for a complete description
of the methods).
The Beigi method is used by default. The Rozzi method is used if <a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a> is not at its default value (0.0), or if
one component of  <strong>vcutgeo</strong>  is negative.</p>
<p>To define a cylinder along the z-axis use the following lines:
<div class="highlight"><pre><span></span><code>icutcoul 1
vcutgeo  0 0 1
</code></pre></div></p>
<p>Please note that the method of Ismail-Beigi is implemented only in the case of an
orthorhombic Bravais lattice. For hexagonal lattices, one has to use the method
of Rozzi <a class="wikilink citation-wikilink" data-tippy-content="Exact Coulomb cutoff technique for supercell calculations" data-toggle="popover" href="/theory/bibliography#rozzi2006">[Rozzi2006]</a>. In this case, the interaction is truncated
in a finite cylinder. Contrarily to the first approach, the user has to
specify both the radius of the cylinder with <a class="wikilink codevar-wikilink" href="/variables/gstate#rcut">rcut</a> as well as the length of
the cylinder along the periodic dimension, that should always be smaller than
the extension of the Born von Karman box. The length of the cylinder is given
in terms of a multiple of the primitive vector along the periodic direction.
Another option provided by Rozzi <a class="wikilink citation-wikilink" data-tippy-content="Exact Coulomb cutoff technique for supercell calculations" data-toggle="popover" href="/theory/bibliography#rozzi2006">[Rozzi2006]</a> is the infinite length cylinder.
In order to activate it in ABINIT,
one needs to use a very large negative  <strong>vcutgeo</strong>  value on the third direction
(i.e. vcutgeo(3) &lt;= -999).</p>
<p>For example, in order to define a finite cylinder along z of radius 2.5 Bohr
and length 3*R3,
<div class="highlight"><pre><span></span><code>icutcoul 1
vcutgeo  0 0 -3.0 # note the minus sign
rcut     2.5
</code></pre></div></p>
<p>For two-dimensional systems (<a class="wikilink codevar-wikilink" href="/variables/gstate#icutcoul">icutcoul</a> = 2),  <strong>vcutgeo</strong>  is used to define the
two periodic directions. Also in this case two different
techniques are available. In the method of Ismail-Beigi, the (positive) non-zero
components of vcutgeo define the periodic directions of the infinite surface.
The interaction is truncated within a slab of width L where L is the projection of
the primitive vector of the lattice along the direction perpendicular to the periodic plane. For
example:
<div class="highlight"><pre><span></span><code>icutcoul 2
vcutgeo  1 1 0
</code></pre></div>
At present, the implementation of the Beigi technique for two-dimensional systems is restricted
to the periodic directions being in the x-y plane.</p>
<p>In Rozzi&rsquo;s method, it is also possible to define a finite range
for the Coulomb interaction in the periodic directions by employing negative values. For example:
<div class="highlight"><pre><span></span><code>icutcoul 2
vcutgeo -3 -2 0
</code></pre></div>
<strong>Definition to be added</strong></p>
<p>Note that not all k-point grids are allowed in these 1D and 2D cases:
the k point vector component(s) along non-periodic direction(s) must vanish.
So, if the 2D Ismail-Beigi technique is used, the z-component of the k points must vanish.</p>
<h2 id="wfinit"><strong>wfinit</strong><a class="headerlink" href="#wfinit" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WaveFunctions INITialization<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to master the use of norm-conserving pseudopotentials and PAW atomic data, and their consequences" data-toggle="popover" href="/topics/PseudosPAW">topic_PseudosPAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.9.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz: GS calculations with UPF2 pseudos.
Test scalar-relativistic pseudos with useylm 0 and 1." data-toggle="popover" href="/tests/v9/Input/t130.abi" target="_blank">t130.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure" data-toggle="popover" href="/tests/v9/Input/t131.abi" target="_blank">t131.abi</a></li>
</ul>
</details>
<p>This option specifies how to initialize the wavefunctions in the case of GS calculations.
It requires pseudos with pseudized wavefunctions e.g. UPF2.
Possible values are:</p>
<div class="codehilite"><pre><span></span><code><span class="o">*</span> <span class="mi">0</span>: <span class="nv">Start</span> <span class="nv">from</span> <span class="k">random</span> <span class="nv">wavefunctions</span> <span class="ss">(</span><span class="nv">default</span><span class="ss">)</span>
<span class="o">*</span> <span class="mi">1</span>: <span class="nv">Use</span> <span class="nv">atomic</span> <span class="nv">orbitals</span> <span class="o">+</span> <span class="k">random</span> <span class="nv">numbers</span>.
<span class="o">*</span> <span class="mi">2</span>: <span class="nv">Use</span> <span class="nv">atomic</span> <span class="nv">orbitals</span> <span class="nv">without</span> <span class="k">random</span> <span class="nv">numbers</span>.
</code></pre></div>

<h2 id="wfk_task"><strong>wfk_task</strong><a class="headerlink" href="#wfk_task" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WaveFunction at K TASK<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a><br />
<em>Variable type:</em> string<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 8<br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use...
example for post-processing mode of ABINIT-Wannier90 with wfk_task" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_7.abi" target="_blank">tw90_7.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Computation of isotropic Migdal-Eliashberg Tc" data-toggle="popover" href="/tests/tutorespfn/Input/teph4isotc_3.abi" target="_blank">teph4isotc_3.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Similar to v7[07]. Here we test optdriver 8 (WFK post-processing) with NC
and SO. More specifically, we reconstruct the wavefunctions in the full BZ in
dataset 2 and we use this WFK to restart the calculation in dataset 3 with
the full k-mesh (kptopt 3). The SCF cycle should exit at the first iteration
since the wavefunctions are already converged." data-toggle="popover" href="/tests/v7/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. Test ABINIT --&gt; LOBSTER converter.
The first dataset performs a standard SCF run with symmetries.
The second dataset calls the converter to generate a new WFK in the
full BZ with istwfk==1. The third dataset reads the WFK in the full BZ
and it&#x27;s expected to exit after the first iteration since wavefunctions
are already converged." data-toggle="popover" href="/tests/v7/Input/t36.abi" target="_blank">t36.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of velocity matrix elements (DDK) with
optdriver 8 and wfk_task4 &quot;wfk_ddk&quot;." data-toggle="popover" href="/tests/v8/Input/t59.abi" target="_blank">t59.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t62.abi" target="_blank">t62.abi</a></li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use...
Adapted from t01, to test wfd-wannier interface" data-toggle="popover" href="/tests/wannier90/Input/t14.abi" target="_blank">t14.abi</a></li>
</ul>
</details>
<p>This variable defines the quantity that should be computed starting from a previously generated WFK file.
Possible values are:</p>
<ul>
<li>
<p>&ldquo;wfk_fullbz&rdquo; &rarr; Read input WFK file and produce new WFK file with <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in the full BZ.
     Wavefunctions with <a class="wikilink codevar-wikilink" href="/variables/dev#istwfk">istwfk</a> &gt; 2 are automatically converted into the full G-sphere representation.
     This option can be used to interface Abinit with external tools (e.g. lobster) requiring <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in the full BZ.
     Use <a class="wikilink codevar-wikilink" href="/variables/dev#iomode">iomode</a> = 3 and <a class="wikilink codevar-wikilink" href="/variables/files#prtkbff">prtkbff</a> = 1 to produce a WFK file in netcdf format with Kleynmann-Bylander form factors.</p>
</li>
<li>
<p>&ldquo;wfk_einterp&rdquo; &rarr; Read energies from WFK file and interpolate the band structure with the modified SKW method <a class="wikilink citation-wikilink" data-tippy-content="Smooth Fourier interpolation of periodic functions" data-toggle="popover" href="/theory/bibliography#pickett1988">[Pickett1988]</a>,
     using the parameters specified by <a class="wikilink codevar-wikilink" href="/variables/basic#einterp">einterp</a>.</p>
</li>
<li>
<p>&ldquo;wfk_ddk&rdquo; &rarr; Compute velocity matrix elements for all bands and <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points found the input WFK file.
     The code generates three <code>_EVK.nc</code> netcdf files with the matrix element of the <span><span class="MathJax_Preview">\frac{d}{d{\kk_i}}</span><script type="math/tex">\frac{d}{d{\kk_i}}</script></span>
     operator using the same list of <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points found in the input WFK file i.e. the same value of <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>.
     These files can then be passed to optics via the <code>ddkfile_1, ddkfile_2, ddkfile_3</code> variables
     without having to call the DFPT part that is much more expensive at the level of memory.</p>
<p>Please note that, at present, the computation of non-linear optical properties in optic requires
 <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 3 i.e. <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in the full BZ whereas the computation of linear optical properties
 can take advantage of spatial and time-reversal symmetries.
 If you use <strong>wfk_ddk</strong> to generate input files for optics, please make sure that your input WFK file
 has the correct value of <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> according to the physical properties you want to compute.</p>
<p>In other words, don&rsquo;t use a WFK with <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> != 3 if you plan to compute non-linear optical properties.
 To work around the limitation of the non-linear part of optics, one can use &ldquo;wfk_optics_fullbz&rdquo;
 to generate WKF and EVK files in the full BZ starting from a WFK defined in the IBZ.</p>
</li>
<li>
<p>&ldquo;wfk_optics_fullbz&rdquo; &rarr; Similar to &ldquo;wfk_ddk&rdquo; but accepts a WFK with wavefunctions in the IBZ
     and generates a new WFK and three <code>_EVK.nc</code> files with <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in the full BZ.
     This procedure is equivalent to performing a NSCF + DDK calculation with <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 3 as documented
     in the tutorial <a class="wikilink lesson-wikilink" href="/tutorial/optic">optic tutorial</a> for non-linear optical properties but it is much faster and, most importantly,
     less memory demanding.</p>
</li>
<li>
<p>&ldquo;wfk_kpts_erange&rdquo; &rarr; Read WFK file, use star-function and <a class="wikilink codevar-wikilink" href="/variables/basic#einterp">einterp</a> parameters to interpolate
     electron energies onto fine k-mesh defined by <a class="wikilink codevar-wikilink" href="/variables/gw#sigma_ngkpt">sigma_ngkpt</a> and <a class="wikilink codevar-wikilink" href="/variables/gw#sigma_shiftk">sigma_shiftk</a>.
     Find k-points inside (electron/hole) pockets according to the values specified by <a class="wikilink codevar-wikilink" href="/variables/eph#sigma_erange">sigma_erange</a>.
     Write KERANGE.nc file with all the tables required by the code to automate NSCF band structure calculations
     inside the pocket(s) and electron lifetime computation in the EPH code when <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> = -4.</p>
</li>
<li>
<p>&ldquo;wannier&rdquo; &rarr; Read WFK file and run Wannierization. It has the similar effect of
      <a class="wikilink codevar-wikilink" href="/variables/files#prtwant">prtwant</a> = 2, which uses the <strong>ABINIT- Wannier90</strong> interface. The difference is that with wfk_task &ldquo;wannier&rdquo;,
      the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points in the full BZ is not necessary. Instead, the wavefunctions with the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points not in
      the IBZ will be reconstructed by symmetry. This functionality does not yet work with PAW when the wavefunction
      is not already in full BZ.</p>
<p>ABINIT will produce the input files required by Wannier90 and it will run
  Wannier90 to produce the Maximally-locallized Wannier functions (see <a href="http://www.wannier.org">
  http://www.wannier.org </a> ).
  !!! Notes</p>
<div class="codehilite"><pre><span></span><code>  <span class="o">*</span> <span class="n">The</span> <span class="n">files</span> <span class="n">that</span> <span class="n">are</span> <span class="n">created</span> <span class="n">can</span> <span class="n">also</span> <span class="n">be</span> <span class="n">used</span> <span class="n">by</span> <span class="n">Wannier90</span> <span class="ow">in</span> <span class="n">stand</span><span class="o">-</span><span class="n">alone</span> <span class="n">mode</span><span class="o">.</span>
  <span class="o">*</span> <span class="n">In</span> <span class="n">order</span> <span class="n">to</span> <span class="n">use</span> <span class="n">Wannier90</span> <span class="k">as</span> <span class="n">a</span> <span class="n">post</span><span class="o">-</span><span class="n">processing</span> <span class="n">program</span> <span class="k">for</span> <span class="n">ABINIT</span> <span class="n">you</span> <span class="n">might</span> <span class="n">have</span> <span class="n">to</span>
    <span class="n">compile</span> <span class="n">it</span> <span class="n">with</span> <span class="n">the</span> <span class="n">appropriate</span> <span class="n">flags</span> <span class="p">(</span><span class="n">see</span> <span class="n">ABINIT</span> <span class="n">makefile</span><span class="p">)</span><span class="o">.</span> <span class="n">You</span> <span class="n">might</span> <span class="n">use</span> <span class="o">./</span><span class="n">configure</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">wannier90</span>
  <span class="o">*</span> <span class="n">There</span> <span class="n">are</span> <span class="n">some</span> <span class="n">other</span> <span class="n">variables</span> <span class="n">related</span> <span class="n">to</span> <span class="n">the</span> <span class="n">interface</span> <span class="n">of</span> <span class="n">Wannier90</span> <span class="ow">and</span> <span class="n">ABINIT</span><span class="o">.</span> <span class="n">See</span> <span class="p">[[</span><span class="n">varset</span><span class="p">:</span><span class="n">w90</span><span class="p">]]</span><span class="o">.</span>
</code></pre></div>

<h2 id="wfmix"><strong>wfmix</strong><a class="headerlink" href="#wfmix" title="Permanent link">&para;</a></h2>
</li>
</ul>
<p><em>Mnemonics:</em> WaveFunctions MIXing factor<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> &gt; 0 and <a class="wikilink codevar-wikilink" href="/variables/dev#nnsclohf">nnsclohf</a> &gt;0 and <a class="wikilink codevar-wikilink" href="/variables/gstate#fockoptmix">fockoptmix</a>/100 &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and NC psps" data-toggle="popover" href="/tests/v7/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and PAW" data-toggle="popover" href="/tests/v7/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with RMM-DIIS and NC psps
The energy computation is not variational. While residm and vres2 converge
quite fast, the total energy convergence is lagging behind ..." data-toggle="popover" href="/tests/v7/Input/t72.abi" target="_blank">t72.abi</a></li>
</ul>
</details>
<p>When the wavefunctions are determined using a SCF double loop (hybrid
functionals),  <strong>wfmix</strong>  provides the mixing factor to obtain the new input
wavefunctions by the combination of the earlier input wavefunctions and
corresponding (DFT-preconditioned) output wavefunctions at the level of the
outer loop, according to the algorithm specified by <a class="wikilink codevar-wikilink" href="/variables/gstate#fockoptmix">fockoptmix</a>/100. If
 <strong>wfmix</strong>  is 1.0, the output wavefunctions only will determine the new input
wavefunctions. This might possibly lead to instabilities. If  <strong>wfmix</strong>  is
smaller than 1.0, the whole iteration procedure is damped, which might allow
better stability, but might be slower. If it is larger than 1.0, perhaps less
iterations will be needed (if there is no instability).</p>
<h2 id="wtq"><strong>wtq</strong><a class="headerlink" href="#wtq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WeighTs for the current Q-points<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT calculations" data-toggle="popover" href="/topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Comment:</em> Except when <a class="wikilink codevar-wikilink" href="/variables/gstate#qptopt">qptopt</a>/=0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. The wtq variable is introduced to be able to reproduce the q-point
weight obtained with ngqpt and qptopt.
The main reason being that the initialization of large q-point (same for k-point) grid
is extremely slow. Inputing manually the qpt and wtq in the input file avoid such
inefficient initialization." data-toggle="popover" href="/tests/v7/Input/t57.abi" target="_blank">t57.abi</a></li>
</ul>
</details>
<p>Gives the current q-point weight.</p>
<h2 id="wvl_bigdft_comp"><strong>wvl_bigdft_comp</strong><a class="headerlink" href="#wvl_bigdft_comp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WaVeLet BIGDFT Comparison<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculations on a wavelet basis" data-toggle="popover" href="/topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiH4 molecule with default parameters. This routine tests the program with several different atoms." data-toggle="popover" href="/tests/bigdft/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
5. Galaborane molecule to test the HGH pseudo-potentials.
WARNING : BigDFT try to read an additional line giving rcutoff and rloc, present in some pseudopotentials.
If such a line exist after the value defined by lmax, but does NOT contain proper rcutoff and rloc (e.g. 0.0), BigDFT might fail by hanging
or SEGFAULT, without giving proper error message. This is difficult to debug." data-toggle="popover" href="/tests/bigdft/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Water molecule in a big box" data-toggle="popover" href="/tests/bigdft/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiH4 molecule with truncated convergence to test the computation of the tail
correction (see the tl_radius) parameter in the input file." data-toggle="popover" href="/tests/bigdft/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with geometry optimisation using BFGS (test the reformating part of the code)." data-toggle="popover" href="/tests/bigdft/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si single atom with fractional occupation." data-toggle="popover" href="/tests/bigdft/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Pt single atom with semi-core electrons, Krack pseudopotentials (pspcod = 10),
and colinear spin polarisation (GGA functional)." data-toggle="popover" href="/tests/bigdft/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t32.abi" target="_blank">t32.abi</a></li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a></li>
</ul>
</details>
<p>This variable is used for the wavelets capabilities of ABINIT (see <a class="wikilink codevar-wikilink" href="/variables/basic#usewvl">usewvl</a>).
It is used to compare the results obtained with ABINIT with those obtained
with BigDFT stand-alone. When it is set to 1, ABINIT will follow the workflow
as in BigDFT stand-alone. Therefore, the results must be exactly the same with the two codes.</p>
<h2 id="wvl_crmult"><strong>wvl_crmult</strong><a class="headerlink" href="#wvl_crmult" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WaVeLet Coarse grid Radius MULTiplier<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculations on a wavelet basis" data-toggle="popover" href="/topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 6.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [20/1245] in all abinit tests, [9/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="Water molecule in a big box" data-toggle="popover" href="/tests/bigdft/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si single atom with fractional occupation." data-toggle="popover" href="/tests/bigdft/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Pt single atom with semi-core electrons, Krack pseudopotentials (pspcod = 10),
and colinear spin polarisation (GGA functional)." data-toggle="popover" href="/tests/bigdft/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t32.abi" target="_blank">t32.abi</a></li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a></li>
</ul>
</details>
<p>This factor is used to define the expansion of the coarse resolution grid in
the case of wavelets (see <a class="wikilink codevar-wikilink" href="/variables/basic#usewvl">usewvl</a>). The grid is made of points inside
spheres centered on atoms. The radius of these spheres are the product between
this factor and the covalent radius of element (read from the pseudo-potential file).
This factor is responsible for the amount of used memory (see also <a class="wikilink codevar-wikilink" href="/variables/basic#wvl_hgrid">wvl_hgrid</a>).</p>
<h2 id="wvl_frmult"><strong>wvl_frmult</strong><a class="headerlink" href="#wvl_frmult" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WaVeLet Fine grid Radius MULTiplier<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculations on a wavelet basis" data-toggle="popover" href="/topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [20/1245] in all abinit tests, [9/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="Water molecule in a big box" data-toggle="popover" href="/tests/bigdft/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si single atom with fractional occupation." data-toggle="popover" href="/tests/bigdft/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Pt single atom with semi-core electrons, Krack pseudopotentials (pspcod = 10),
and colinear spin polarisation (GGA functional)." data-toggle="popover" href="/tests/bigdft/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t32.abi" target="_blank">t32.abi</a></li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a></li>
</ul>
</details>
<p>This factor is used to define the expansion of the fine resolution grid in
the case of wavelets (see <a class="wikilink codevar-wikilink" href="/variables/basic#usewvl">usewvl</a>). This fine resolution grid has the same
grid step than the coarse one (see <a class="wikilink codevar-wikilink" href="/variables/gstate#wvl_crmult">wvl_crmult</a> ), but on each point, 8
coefficients are stored instead of one, increasing the precision of the
calculation in this area. The grid is made of points inside spheres centered
on atoms. The radius of these spheres are the product between this factor and
a value read from the pseudo-potential file.
This factor is responsible for the amount of used memory (see also <a class="wikilink codevar-wikilink" href="/variables/basic#wvl_hgrid">wvl_hgrid</a>).</p>
<h2 id="wvl_ngauss"><strong>wvl_ngauss</strong><a class="headerlink" href="#wvl_ngauss" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WaVeLet Number of GAUSSians<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculations on a wavelet basis" data-toggle="popover" href="/topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, 100]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t32.abi" target="_blank">t32.abi</a></li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a></li>
</ul>
</details>
<p>In the wavelet-PAW computation case, projectors may be fitted to a sum of
complex Gaussians. The fit is done for  <strong>wvl_ngauss</strong> (1),  <strong>wvl_ngauss</strong> (1)+1&hellip; up
to  <strong>wvl_ngauss</strong> (2) Gaussians.</p>
<h2 id="wvl_nprccg"><strong>wvl_nprccg</strong><a class="headerlink" href="#wvl_nprccg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WaVeLet maximum Number of PReConditioner Conjugate Gradient iterations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculations on a wavelet basis" data-toggle="popover" href="/topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 5<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [17/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiH4 molecule with default parameters. This routine tests the program with several different atoms." data-toggle="popover" href="/tests/bigdft/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
5. Galaborane molecule to test the HGH pseudo-potentials.
WARNING : BigDFT try to read an additional line giving rcutoff and rloc, present in some pseudopotentials.
If such a line exist after the value defined by lmax, but does NOT contain proper rcutoff and rloc (e.g. 0.0), BigDFT might fail by hanging
or SEGFAULT, without giving proper error message. This is difficult to debug." data-toggle="popover" href="/tests/bigdft/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Water molecule in a big box" data-toggle="popover" href="/tests/bigdft/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiH4 molecule with truncated convergence to test the computation of the tail
correction (see the tl_radius) parameter in the input file." data-toggle="popover" href="/tests/bigdft/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with geometry optimisation using BFGS (test the reformating part of the code)." data-toggle="popover" href="/tests/bigdft/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Pt single atom with semi-core electrons, Krack pseudopotentials (pspcod = 10),
and colinear spin polarisation (GGA functional)." data-toggle="popover" href="/tests/bigdft/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t32.abi" target="_blank">t32.abi</a></li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a></li>
</ul>
</details>
<p>In the wavelet computation case, the wavefunctions are directly minimised
using a real-space preconditioner. This preconditioner has internally some
conjugate gradient iterations. This value defines a boundary for the number of
conjugate gradient iterations on each wavefunction convergence step.</p>
<h2 id="xredsph_extra"><strong>xredsph_extra</strong><a class="headerlink" href="#xredsph_extra" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> X(position) in REDuced coordinates of the SPHeres for dos projection in the EXTRA set<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute atom-centered properties" data-toggle="popover" href="/topics/AtomCentered">topic_AtomCentered</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="/variables/gstate#natsph_extra">natsph_extra</a>)<br />
<em>Default value:</em> <em>0.0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#natsph_extra">natsph_extra</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a></li>
</ul>
</details>
<p>The positions in reduced coordinates of extra spheres used in the DOS
projection, simulating an STS signal. See <a class="wikilink codevar-wikilink" href="/variables/gstate#natsph_extra">natsph_extra</a> for a more complete description.</p>
                
                  
                
              

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/"
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../geo/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Geometry
            </div>
          </div>
        </a>
      
      
        <a href="../gw/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              GW
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version b'10.2.3-dirty'</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "b'10.2.3-dirty'"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>