
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="dfpt input variables">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/variables/dfpt/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>DFPT - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dfpt-input-variables" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DFPT
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Variables
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorial/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        Abitk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_15" type="checkbox" id="__nav_1_15" >
      
      <label class="md-nav__link" for="__nav_1_15">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_15">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        AtomCentered
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        CalcUJ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        GWR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        Install
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        NMR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" checked>
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          DFPT
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        DFPT
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#asr" class="md-nav__link">
    asr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bdeigrf" class="md-nav__link">
    bdeigrf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chneut" class="md-nav__link">
    chneut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_atpol" class="md-nav__link">
    d3e_pert1_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_dir" class="md-nav__link">
    d3e_pert1_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_elfd" class="md-nav__link">
    d3e_pert1_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_phon" class="md-nav__link">
    d3e_pert1_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_atpol" class="md-nav__link">
    d3e_pert2_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_dir" class="md-nav__link">
    d3e_pert2_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_elfd" class="md-nav__link">
    d3e_pert2_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_phon" class="md-nav__link">
    d3e_pert2_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_atpol" class="md-nav__link">
    d3e_pert3_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_dir" class="md-nav__link">
    d3e_pert3_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_elfd" class="md-nav__link">
    d3e_pert3_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_phon" class="md-nav__link">
    d3e_pert3_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfpt_sciss" class="md-nav__link">
    dfpt_sciss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas" class="md-nav__link">
    efmas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_bands" class="md-nav__link">
    efmas_bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_calc_dirs" class="md-nav__link">
    efmas_calc_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_deg" class="md-nav__link">
    efmas_deg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_deg_tol" class="md-nav__link">
    efmas_deg_tol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_dim" class="md-nav__link">
    efmas_dim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_dirs" class="md-nav__link">
    efmas_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_n_dirs" class="md-nav__link">
    efmas_n_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_ntheta" class="md-nav__link">
    efmas_ntheta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elph2_imagden" class="md-nav__link">
    elph2_imagden
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esmear" class="md-nav__link">
    esmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffnl_lw" class="md-nav__link">
    ffnl_lw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frzfermi" class="md-nav__link">
    frzfermi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ieig2rf" class="md-nav__link">
    ieig2rf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ixcrot" class="md-nav__link">
    ixcrot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lw_flexo" class="md-nav__link">
    lw_flexo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lw_natopt" class="md-nav__link">
    lw_natopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lw_qdrpl" class="md-nav__link">
    lw_qdrpl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonlinear_info" class="md-nav__link">
    nonlinear_info
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#orbmag" class="md-nav__link">
    orbmag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepalw" class="md-nav__link">
    prepalw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepanl" class="md-nav__link">
    prepanl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepgkk" class="md-nav__link">
    prepgkk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtbbb" class="md-nav__link">
    prtbbb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtefmas" class="md-nav__link">
    prtefmas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtfull1wf" class="md-nav__link">
    prtfull1wf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rf2_dkde" class="md-nav__link">
    rf2_dkde
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rf2_dkdk" class="md-nav__link">
    rf2_dkdk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rf2_pert1_dir" class="md-nav__link">
    rf2_pert1_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rf2_pert2_dir" class="md-nav__link">
    rf2_pert2_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfatpol" class="md-nav__link">
    rfatpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfddk" class="md-nav__link">
    rfddk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfdir" class="md-nav__link">
    rfdir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfelfd" class="md-nav__link">
    rfelfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfmagn" class="md-nav__link">
    rfmagn
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfmeth" class="md-nav__link">
    rfmeth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfphon" class="md-nav__link">
    rfphon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfstrs" class="md-nav__link">
    rfstrs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfstrs_ref" class="md-nav__link">
    rfstrs_ref
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfuser" class="md-nav__link">
    rfuser
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smdelta" class="md-nav__link">
    smdelta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#td_maxene" class="md-nav__link">
    td_maxene
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#td_mexcit" class="md-nav__link">
    td_mexcit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tim1rev" class="md-nav__link">
    tim1rev
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usepead" class="md-nav__link">
    usepead
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/basepar/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/ucalc_crpa/" class="md-nav__link">
        cRPA U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lruj/" class="md-nav__link">
        Linear Response U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr_intro/" class="md-nav__link">
        GWR_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr1/" class="md-nav__link">
        GWR1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lw_quad/" class="md-nav__link">
        quadrupoles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_tdep_legacy/" class="md-nav__link">
        eph_tdep_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        Troubleshooting (old-dokuwiki)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        Tuning (old-dokuwiki)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#asr" class="md-nav__link">
    asr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bdeigrf" class="md-nav__link">
    bdeigrf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chneut" class="md-nav__link">
    chneut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_atpol" class="md-nav__link">
    d3e_pert1_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_dir" class="md-nav__link">
    d3e_pert1_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_elfd" class="md-nav__link">
    d3e_pert1_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_phon" class="md-nav__link">
    d3e_pert1_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_atpol" class="md-nav__link">
    d3e_pert2_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_dir" class="md-nav__link">
    d3e_pert2_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_elfd" class="md-nav__link">
    d3e_pert2_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_phon" class="md-nav__link">
    d3e_pert2_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_atpol" class="md-nav__link">
    d3e_pert3_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_dir" class="md-nav__link">
    d3e_pert3_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_elfd" class="md-nav__link">
    d3e_pert3_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_phon" class="md-nav__link">
    d3e_pert3_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfpt_sciss" class="md-nav__link">
    dfpt_sciss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas" class="md-nav__link">
    efmas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_bands" class="md-nav__link">
    efmas_bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_calc_dirs" class="md-nav__link">
    efmas_calc_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_deg" class="md-nav__link">
    efmas_deg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_deg_tol" class="md-nav__link">
    efmas_deg_tol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_dim" class="md-nav__link">
    efmas_dim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_dirs" class="md-nav__link">
    efmas_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_n_dirs" class="md-nav__link">
    efmas_n_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_ntheta" class="md-nav__link">
    efmas_ntheta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elph2_imagden" class="md-nav__link">
    elph2_imagden
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esmear" class="md-nav__link">
    esmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffnl_lw" class="md-nav__link">
    ffnl_lw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frzfermi" class="md-nav__link">
    frzfermi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ieig2rf" class="md-nav__link">
    ieig2rf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ixcrot" class="md-nav__link">
    ixcrot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lw_flexo" class="md-nav__link">
    lw_flexo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lw_natopt" class="md-nav__link">
    lw_natopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lw_qdrpl" class="md-nav__link">
    lw_qdrpl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonlinear_info" class="md-nav__link">
    nonlinear_info
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#orbmag" class="md-nav__link">
    orbmag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepalw" class="md-nav__link">
    prepalw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepanl" class="md-nav__link">
    prepanl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepgkk" class="md-nav__link">
    prepgkk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtbbb" class="md-nav__link">
    prtbbb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtefmas" class="md-nav__link">
    prtefmas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtfull1wf" class="md-nav__link">
    prtfull1wf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rf2_dkde" class="md-nav__link">
    rf2_dkde
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rf2_dkdk" class="md-nav__link">
    rf2_dkdk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rf2_pert1_dir" class="md-nav__link">
    rf2_pert1_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rf2_pert2_dir" class="md-nav__link">
    rf2_pert2_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfatpol" class="md-nav__link">
    rfatpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfddk" class="md-nav__link">
    rfddk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfdir" class="md-nav__link">
    rfdir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfelfd" class="md-nav__link">
    rfelfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfmagn" class="md-nav__link">
    rfmagn
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfmeth" class="md-nav__link">
    rfmeth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfphon" class="md-nav__link">
    rfphon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfstrs" class="md-nav__link">
    rfstrs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfstrs_ref" class="md-nav__link">
    rfstrs_ref
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfuser" class="md-nav__link">
    rfuser
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smdelta" class="md-nav__link">
    smdelta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#td_maxene" class="md-nav__link">
    td_maxene
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#td_mexcit" class="md-nav__link">
    td_mexcit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tim1rev" class="md-nav__link">
    tim1rev
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usepead" class="md-nav__link">
    usepead
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/variables/dfpt.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->
<h1 id="dfpt-input-variables">dfpt input variables<a class="headerlink" href="#dfpt-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
dfpt input variables to be used in the input file for the abinit executable.</p>
<h2 id="asr"><strong>asr</strong><a class="headerlink" href="#asr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Acoustic Sum Rule<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [68/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
(see test.si.chain of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2, and preceeding test,
but use the full XC PBE functional.
Also, tolvrs is better.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.81162533 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.81213804 Ha
with delta(xred)=0.0001, 188.81175352 Ha .
Combining the results gives 188.81162525 Ha." data-toggle="popover" href="/tests/v3/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the the effect of the first-order Fermi energy on a Q=0
phonon calculation in metals.
The example is for a hypothetical intermetallic compound MgAl2,
in a structure which can be thought of as fcc Al with every third
(111) layer replaced by Mg.  Technically, this is the hexagonal
CdI2 structure, space group #164, P-3 m 1.  For this case, neglect
of this contribution yields approximately a 2% error in the largest
interatomic force constants.  Its effect on many force constants
for this system cancels because of symmetry.  This calculation
is not particularly well converged, especially with respect
to k sample.  A well-converged version is in excellent agreement
with interatomic force constants calculated by numerical
differentiation of ground-state forces." data-toggle="popover" href="/tests/v4/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PbFCl in the matlockite structure P4/nmm. 6 atoms per cell.
Compute a set of matrix elements of the dynamical matrix,
for q wavevector 0.5 0.5 0.5 .
In this test case, the symmetry operations have an important
non-symmorphic character. There was a bug in the treatment
of this material, prior to v5.2.4 ." data-toggle="popover" href="/tests/v5/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-toggle="popover" href="/tests/v5/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GeTe in rhombohedral structure
Test the computation of phonons, dielectric tensor and Born effective
charges, with and without spin-orbit coupling." data-toggle="popover" href="/tests/v5/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon linewidths and e-ph coupling parameter lambda." data-toggle="popover" href="/tests/v7/Input/t88.abi" target="_blank">t88.abi</a> &hellip;</li>
</ul>
</details>
<p>Set the treatment of the Acoustic Sum Rule (ASR) in phonon calculations in the ABINIT code.
Same values as the corresponding ANADDB variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#asr">asr@anaddb</a>. Please switch to this description.</p>
<p>Using anaddb is indeed the recommended approach if you want to analyze the breaking of the sum rules.
Running different DFPT calculations from scratch just to change  <strong>asr</strong>  is indeed a waste of time as
you can compute the DDB only once and then use anaddb.</p>
<p>Anyhow, this input variable is used in different contexts in ABINIT, in addition of being used in ANADDB :
<a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=1 (phonon calculations), <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=7 (electron-phonon calculations) and
<a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=10 (longwave calculations).
For <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=1, it does not modify the self-consistent calculations, neither the DDB generation, but only the echo in the main output file
of the dynamical matrix, and the subsequent echo of the phonon frequencies at Gamma, TO and LO parts.</p>
<p>See also the variables <a class="wikilink codevar-wikilink" href="/variables/dfpt#chneut">chneut</a> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#chneut">chneut@anaddb</a>, that govern the imposition of the charge neutrality sum rule.</p>
<h2 id="bdeigrf"><strong>bdeigrf</strong><a class="headerlink" href="#bdeigrf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BanD for second-order EIGenvalues from Response-Function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="To to calculate the temperature dependence of the electronic structure" data-toggle="popover" href="/topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#ieig2rf">ieig2rf</a> in [1,2,3,4,5]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [15/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
Warning : only valid for Gamma, AND the temperature-dependent shifts must be averaged
over degenerate states." data-toggle="popover" href="/tests/v6/Input/t37.abi" target="_blank">t37.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
For testing the electron-phonon modification of the electronic structure.
To be compared with the results of tests 51 to 59.
Use a 2x2x2 grid of k (shifted) and q (non-shifted) points.
No imaginary frequences for the phonons with this choice.
Computation of the electronic eigenvalues as well as phonon eigenfrequencies,
and corresponding ingredients for the computation of the electron-phonon effect, in the
next tests 51-53." data-toggle="popover" href="/tests/v6/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC conventional cell. Fake smooth pseudopotential.
For testing the electron-phonon modification of the electronic structure.
To be compared with the results of tests 50 to 59.
Use a FCC grid of k (shifted) and q (non-shifted) points.
No imaginary frequences for the phonons with this choice.
Computation of the electronic eigenvalues as well as phonon eigenfrequencies,
and corresponding ingredients for the computation of the electron-phonon effect, in the
next tests 55-57." data-toggle="popover" href="/tests/v6/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC 8-atom supercell. Fake smooth pseudopotential.
For testing the electron-phonon modification of the electronic structure.
To be compared with the results of tests 50 to 59.
Use 1/2 1/2 1/2 for electronice wavevector and Gamma point for phonon wavevector
Computation of the electronic eigenvalues as well as phonon eigenfrequencies,
and corresponding ingredients for the computation of the electron-phonon effect, in the
next test 59 (no need of mrgddb with only one q point." data-toggle="popover" href="/tests/v6/Input/t58.abi" target="_blank">t58.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 Molecule in a small box
Second-order eigenvalue calculation using a small number of bands, testing bdeigrf." data-toggle="popover" href="/tests/v6/Input/t61.abi" target="_blank">t61.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a reasonably large box
Compute the Fan and Diagonal Debye-Waller corrections to the eigenenergies." data-toggle="popover" href="/tests/v6/Input/t68.abi" target="_blank">t68.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed." data-toggle="popover" href="/tests/v7/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2
Oxygen spin-temperature-dependent of the band energies" data-toggle="popover" href="/tests/v7/Input/t83.abi" target="_blank">t83.abi</a></li>
</ul>
</details>
<p>The variable <em>bdeigrf</em> is the maximum number of bands for which the second-
order eigenvalues must be calculated: the full number of bands is still used
during the computation of these corrections.</p>
<p>If <em>bdeigrf</em> is set to -1, the code will automatically set <em>bdeigrf</em> equal to <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.</p>
<h2 id="chneut"><strong>chneut</strong><a class="headerlink" href="#chneut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CHarge NEUTrality treatment<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [69/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant by two different techniques" data-toggle="popover" href="/tests/seq/Input/tsv3_05.abi" target="_blank">tsv3_05.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
(see test.si.chain of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2, and preceeding test,
but use the full XC PBE functional.
Also, tolvrs is better.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.81162533 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.81213804 Ha
with delta(xred)=0.0001, 188.81175352 Ha .
Combining the results gives 188.81162525 Ha." data-toggle="popover" href="/tests/v3/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the the effect of the first-order Fermi energy on a Q=0
phonon calculation in metals.
The example is for a hypothetical intermetallic compound MgAl2,
in a structure which can be thought of as fcc Al with every third
(111) layer replaced by Mg.  Technically, this is the hexagonal
CdI2 structure, space group #164, P-3 m 1.  For this case, neglect
of this contribution yields approximately a 2% error in the largest
interatomic force constants.  Its effect on many force constants
for this system cancels because of symmetry.  This calculation
is not particularly well converged, especially with respect
to k sample.  A well-converged version is in excellent agreement
with interatomic force constants calculated by numerical
differentiation of ground-state forces." data-toggle="popover" href="/tests/v4/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PbFCl in the matlockite structure P4/nmm. 6 atoms per cell.
Compute a set of matrix elements of the dynamical matrix,
for q wavevector 0.5 0.5 0.5 .
In this test case, the symmetry operations have an important
non-symmorphic character. There was a bug in the treatment
of this material, prior to v5.2.4 ." data-toggle="popover" href="/tests/v5/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-toggle="popover" href="/tests/v5/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GeTe in rhombohedral structure
Test the computation of phonons, dielectric tensor and Born effective
charges, with and without spin-orbit coupling." data-toggle="popover" href="/tests/v5/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon linewidths and e-ph coupling parameter lambda." data-toggle="popover" href="/tests/v7/Input/t88.abi" target="_blank">t88.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO polaron effective mass along different direction: 100,110,111.
Frohlich ZPR is also computed.
Method available only for cubic materials." data-toggle="popover" href="/tests/v9/Input/t66.abi" target="_blank">t66.abi</a> &hellip;</li>
</ul>
</details>
<p>Set the treatment of the Charge Neutrality requirement for the effective charges in the ABINIT code.
Same values as the corresponding ANADDB variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#chneut">chneut@anaddb</a>. Please switch to this description.
Note however the different default value in abinit (1) and anaddb (0).</p>
<p>Using anaddb is indeed the recommended approach if you want to analyze the breaking of the sum rules.
Running different DFPT calculations from scratch just to change  <strong>chneut</strong>  is indeed a waste of time as
you can compute the DDB only once and then use anaddb.</p>
<p>Anyhow, this input variable is used in different contexts in ABINIT, in addition of being used in ANADDB :
<a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=1 (phonon calculations), <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=7 (electron-phonon calculations) and
<a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=10 (longwave calculations).
For <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=1, it does not modify the self-consistent calculations, neither the DDB generation, but only the echo in the main output file
of the Born effective charge, and the subsequent echo of the phonon frequencies at Gamma, LO part only.</p>
<p>See also the variables <a class="wikilink codevar-wikilink" href="/variables/dfpt#asr">asr</a> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#asr">asr@anaddb</a>, that govern the imposition of the acoustic sum rule.</p>
<h2 id="d3e_pert1_atpol"><strong>d3e_pert1_atpol</strong><a class="headerlink" href="#d3e_pert1_atpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 1: limits of ATomic POLarisations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, &lsquo;<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>&rsquo;]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements" data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_2.abi" target="_blank">tnlo_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements.
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_6.abi" target="_blank">tnlo_6.abi</a></li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
He dimer, with bare pseudopotential ixc=0
Compute Raman intensity, showing essentially perfect agreement
between DFPT and finite-differences, when the number of k points
is extended to infinity.
The present test use ngkpt 10 1 1, giving DFPT: 0.039868
Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077
to be divided by 0.02 (the difference in xcart) and 4pi =&gt; 0.040439
Going to ngkpt 80 1 1, gives:
DFPT: 0.040052
Finite-differences: 0.040054
The DFPT with ngkpt 320 1 1 gives 0.040055." data-toggle="popover" href="/tests/v6/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Charged (He dimer)+, with bare pseudopotential. ixc=7
Compute Raman intensity, showing essentially perfect agreement
between DFPT and finite-differences, when the number of k points
is extended to infinity.
The present test use ngkpt 10 1 1 , like the previous one.
Going to ngkpt 80 1 1 gives
Finite-differences: 0.022275
The DFPT with ngkpt 320 1 1 gives 0.022279 .
(To obtain the finite-difference results, one has to reactivate the dtset 15 case)
Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-toggle="popover" href="/tests/v6/Input/t67.abi" target="_blank">t67.abi</a></li>
</ul>
</details>
<p>Controls the range of atoms for which displacements will be considered in non-linear
computations (using the 2n+1 theorem), for the 1<sup>st</sup> perturbation.
May take values from 1 to <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, with <strong>d3e_pert1_atpol</strong> (1)&lt;=
<strong>d3e_pert1_atpol</strong> (2). See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a> for additional details.</p>
<h2 id="d3e_pert1_dir"><strong>d3e_pert1_dir</strong><a class="headerlink" href="#d3e_pert1_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 1: DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [1, 1, 1]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
He dimer, with bare pseudopotential ixc=0
Compute Raman intensity, showing essentially perfect agreement
between DFPT and finite-differences, when the number of k points
is extended to infinity.
The present test use ngkpt 10 1 1, giving DFPT: 0.039868
Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077
to be divided by 0.02 (the difference in xcart) and 4pi =&gt; 0.040439
Going to ngkpt 80 1 1, gives:
DFPT: 0.040052
Finite-differences: 0.040054
The DFPT with ngkpt 320 1 1 gives 0.040055." data-toggle="popover" href="/tests/v6/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Charged (He dimer)+, with bare pseudopotential. ixc=7
Compute Raman intensity, showing essentially perfect agreement
between DFPT and finite-differences, when the number of k points
is extended to infinity.
The present test use ngkpt 10 1 1 , like the previous one.
Going to ngkpt 80 1 1 gives
Finite-differences: 0.022275
The DFPT with ngkpt 320 1 1 gives 0.022279 .
(To obtain the finite-difference results, one has to reactivate the dtset 15 case)
Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-toggle="popover" href="/tests/v6/Input/t67.abi" target="_blank">t67.abi</a></li>
</ul>
</details>
<p>Gives the directions to be considered in non-linear computations (using the
2n+1 theorem), for the 1<sup>st</sup> perturbation.
The three elements corresponds to the three primitive vectors, either in real
space (atomic displacement), or in reciprocal space (electric field perturbation).
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> for additional details.</p>
<h2 id="d3e_pert1_elfd"><strong>d3e_pert1_elfd</strong><a class="headerlink" href="#d3e_pert1_elfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 1: ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [23/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements" data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_2.abi" target="_blank">tnlo_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements.
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_6.abi" target="_blank">tnlo_6.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized.
However nsppol=2 for testing purposes.
Over 1200 WARNINGS.
This test must give the same results of the test 64
non-linear response with nsppol=1 does not support MPI with nprocs &gt; 1" data-toggle="popover" href="/tests/v6/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized
Over 1200 WARNINGS.
This test must give the same results of the test 63" data-toggle="popover" href="/tests/v6/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl Molecule in a big box
3DTE calculation with only one k-point" data-toggle="popover" href="/tests/v6/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 48, 49 and 50." data-toggle="popover" href="/tests/v8/Input/t47.abi" target="_blank">t47.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
</ul>
</details>
<p>Turns on electric field perturbation in non-linear computation, as 1<sup>st</sup>
perturbation. Actually, such calculations requires first the non-self-
consistent calculation of derivatives with respect to k, independently of the
electric field perturbation itself. See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> for additional details.</p>
<h2 id="d3e_pert1_phon"><strong>d3e_pert1_phon</strong><a class="headerlink" href="#d3e_pert1_phon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 1: PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [23/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements" data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_2.abi" target="_blank">tnlo_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements.
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_6.abi" target="_blank">tnlo_6.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized.
However nsppol=2 for testing purposes.
Over 1200 WARNINGS.
This test must give the same results of the test 64
non-linear response with nsppol=1 does not support MPI with nprocs &gt; 1" data-toggle="popover" href="/tests/v6/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized
Over 1200 WARNINGS.
This test must give the same results of the test 63" data-toggle="popover" href="/tests/v6/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl Molecule in a big box
3DTE calculation with only one k-point" data-toggle="popover" href="/tests/v6/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 48, 49 and 50." data-toggle="popover" href="/tests/v8/Input/t47.abi" target="_blank">t47.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
</ul>
</details>
<p>Turns on atomic displacement perturbation in non-linear computation, as 1<sup>st</sup> perturbation.
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfphon">rfphon</a> for additional details.</p>
<h2 id="d3e_pert2_atpol"><strong>d3e_pert2_atpol</strong><a class="headerlink" href="#d3e_pert2_atpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 2: limits of ATomic POLarisations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, &lsquo;<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>&rsquo;]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a></li>
</ul>
</details>
<p>Controls the range of atoms for which displacements will be considered in non-
linear computations (using the 2n+1 theorem), for the 2<sup>nd</sup> perturbation.
May take values from 1 to <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, with <strong>d3e_pert2_atpol</strong> (1) &lt;= <strong>d3e_pert2_atpol</strong> (2).
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a> for additional details.</p>
<h2 id="d3e_pert2_dir"><strong>d3e_pert2_dir</strong><a class="headerlink" href="#d3e_pert2_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 2: DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
He dimer, with bare pseudopotential ixc=0
Compute Raman intensity, showing essentially perfect agreement
between DFPT and finite-differences, when the number of k points
is extended to infinity.
The present test use ngkpt 10 1 1, giving DFPT: 0.039868
Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077
to be divided by 0.02 (the difference in xcart) and 4pi =&gt; 0.040439
Going to ngkpt 80 1 1, gives:
DFPT: 0.040052
Finite-differences: 0.040054
The DFPT with ngkpt 320 1 1 gives 0.040055." data-toggle="popover" href="/tests/v6/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Charged (He dimer)+, with bare pseudopotential. ixc=7
Compute Raman intensity, showing essentially perfect agreement
between DFPT and finite-differences, when the number of k points
is extended to infinity.
The present test use ngkpt 10 1 1 , like the previous one.
Going to ngkpt 80 1 1 gives
Finite-differences: 0.022275
The DFPT with ngkpt 320 1 1 gives 0.022279 .
(To obtain the finite-difference results, one has to reactivate the dtset 15 case)
Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-toggle="popover" href="/tests/v6/Input/t67.abi" target="_blank">t67.abi</a></li>
</ul>
</details>
<p>Gives the directions to be considered in non-linear computations (using the
2n+1 theorem), for the 2<sup>nd</sup> perturbation.
The three elements corresponds to the three primitive vectors, either in real
space (atomic displacement), or in reciprocal space (electric field perturbation).
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> for additional details.</p>
<h2 id="d3e_pert2_elfd"><strong>d3e_pert2_elfd</strong><a class="headerlink" href="#d3e_pert2_elfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 2: ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [23/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements" data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_2.abi" target="_blank">tnlo_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements.
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_6.abi" target="_blank">tnlo_6.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized.
However nsppol=2 for testing purposes.
Over 1200 WARNINGS.
This test must give the same results of the test 64
non-linear response with nsppol=1 does not support MPI with nprocs &gt; 1" data-toggle="popover" href="/tests/v6/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized
Over 1200 WARNINGS.
This test must give the same results of the test 63" data-toggle="popover" href="/tests/v6/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl Molecule in a big box
3DTE calculation with only one k-point" data-toggle="popover" href="/tests/v6/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 48, 49 and 50." data-toggle="popover" href="/tests/v8/Input/t47.abi" target="_blank">t47.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
</ul>
</details>
<p>Turns on electric field perturbation in non-linear computation, as 2<sup>nd</sup>
perturbation. Actually, such calculations requires first the non-self-
consistent calculation of derivatives with respect to k, independently of the
electric field perturbation itself. See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> for additional details.</p>
<h2 id="d3e_pert2_phon"><strong>d3e_pert2_phon</strong><a class="headerlink" href="#d3e_pert2_phon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 2: PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a></li>
</ul>
</details>
<p>Turns on atomic displacement perturbation in non-linear computation, as 2<sup>nd</sup> perturbation.
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfphon">rfphon</a> for additional details.</p>
<h2 id="d3e_pert3_atpol"><strong>d3e_pert3_atpol</strong><a class="headerlink" href="#d3e_pert3_atpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 3: limits of ATomic POLarisations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, &lsquo;<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>&rsquo;]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a></li>
</ul>
</details>
<p>Controls the range of atoms for which displacements will be considered in non-
linear computations (using the 2n+1 theorem), for the 3<sup>rd</sup> perturbation.
May take values from 1 to <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, with <strong>d3e_pert3_atpol</strong> (1)&lt;= <strong>d3e_pert3_atpol</strong> (2).
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a> for additional details.</p>
<h2 id="d3e_pert3_dir"><strong>d3e_pert3_dir</strong><a class="headerlink" href="#d3e_pert3_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 3: DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
He dimer, with bare pseudopotential ixc=0
Compute Raman intensity, showing essentially perfect agreement
between DFPT and finite-differences, when the number of k points
is extended to infinity.
The present test use ngkpt 10 1 1, giving DFPT: 0.039868
Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077
to be divided by 0.02 (the difference in xcart) and 4pi =&gt; 0.040439
Going to ngkpt 80 1 1, gives:
DFPT: 0.040052
Finite-differences: 0.040054
The DFPT with ngkpt 320 1 1 gives 0.040055." data-toggle="popover" href="/tests/v6/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Charged (He dimer)+, with bare pseudopotential. ixc=7
Compute Raman intensity, showing essentially perfect agreement
between DFPT and finite-differences, when the number of k points
is extended to infinity.
The present test use ngkpt 10 1 1 , like the previous one.
Going to ngkpt 80 1 1 gives
Finite-differences: 0.022275
The DFPT with ngkpt 320 1 1 gives 0.022279 .
(To obtain the finite-difference results, one has to reactivate the dtset 15 case)
Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-toggle="popover" href="/tests/v6/Input/t67.abi" target="_blank">t67.abi</a></li>
</ul>
</details>
<p>Gives the directions to be considered in non-linear computations (using the
2n+1 theorem), for the 3<sup>rd</sup> perturbation.
The three elements corresponds to the three primitive vectors, either in real
space (atomic displacement), or in reciprocal space (electric field perturbation).
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> for additional details.</p>
<h2 id="d3e_pert3_elfd"><strong>d3e_pert3_elfd</strong><a class="headerlink" href="#d3e_pert3_elfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 3: ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [23/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements" data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_2.abi" target="_blank">tnlo_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements.
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_6.abi" target="_blank">tnlo_6.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized.
However nsppol=2 for testing purposes.
Over 1200 WARNINGS.
This test must give the same results of the test 64
non-linear response with nsppol=1 does not support MPI with nprocs &gt; 1" data-toggle="popover" href="/tests/v6/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized
Over 1200 WARNINGS.
This test must give the same results of the test 63" data-toggle="popover" href="/tests/v6/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl Molecule in a big box
3DTE calculation with only one k-point" data-toggle="popover" href="/tests/v6/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 48, 49 and 50." data-toggle="popover" href="/tests/v8/Input/t47.abi" target="_blank">t47.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
</ul>
</details>
<p>Turns on electric field perturbation in non-linear computation, as 3<sup>rd</sup>
perturbation. Actually, such calculations requires first the non-self-
consistent calculation of derivatives with respect to k, independently of the
electric field perturbation itself.
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> for additional details.</p>
<h2 id="d3e_pert3_phon"><strong>d3e_pert3_phon</strong><a class="headerlink" href="#d3e_pert3_phon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 3: PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a></li>
</ul>
</details>
<p>Turns on atomic displacement perturbation in non-linear computation, as 3<sup>rd</sup> perturbation.
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfphon">rfphon</a> for additional details.</p>
<h2 id="dfpt_sciss"><strong>dfpt_sciss</strong><a class="headerlink" href="#dfpt_sciss" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DFPT SCISSor operator<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant with a scissor .
Note that the fulfilment of the charge neutrality sum rule, already broken without a scissor operator, is
strongly affected by a scissor" data-toggle="popover" href="/tests/v7/Input/t46.abi" target="_blank">t46.abi</a></li>
</ul>
</details>
<p>It is the value of the &ldquo;scissors operator&rdquo; <a class="wikilink citation-wikilink" data-tippy-content="Linear Optical Response in Silicon and Germanium Including Self-Energy Effects" data-toggle="popover" href="/theory/bibliography#levine1989">[Levine1989]</a>, the shift of conduction band
eigenvalues, used in response function calculations.
Can be specified in Ha (the default), Ry, eV or Kelvin, since <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> has the
<a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics (1 Ha = 27.2113845 eV).
Typical use is for response to electric field (<a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> = 3), but NOT for d/dk
(<a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> = 2) and phonon responses.</p>
<h2 id="efmas"><strong>efmas</strong><a class="headerlink" href="#efmas" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Germanium.
Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-toggle="popover" href="/tests/v7/Input/t80.abi" target="_blank">t80.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW for multiple bands and k-points." data-toggle="popover" href="/tests/v7/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-toggle="popover" href="/tests/v7/Input/t82.abi" target="_blank">t82.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgO
MgO effective mass tensor at \Gamma, published in Nery2018.
From present calculation, hole effective masses (ordered by increasing mass) are
m*(100)= -0.382, -2.171, -2.171 to be compared with Nery2018 Table I, -0.387, -2.164 (two-fold degenerate)
m*(111)= -0.331, -3.826, -3.826 to be compared with Nery2018 Table I, -0.335, -3.822 (two-fold degenerate)
m*(110)= -0.342, -2.171, -6.181
with angular average effective mass for Frohlich model is 1.923.
From present calculation, electron effective mass is
m*= 0.334 to be compared with Nery2018 Table I, -0.340.
Setting kpt to 8 8 8 and ecut to 50 allows one to reproduce the published values." data-toggle="popover" href="/tests/v8/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass." data-toggle="popover" href="/tests/v8/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO polaron effective mass along different direction: 100,110,111.
Frohlich ZPR is also computed.
Method available only for cubic materials." data-toggle="popover" href="/tests/v9/Input/t66.abi" target="_blank">t66.abi</a></li>
</ul>
</details>
<p>Turns on effective mass tensor calculations. Such calculations requires the
non-self-consistent calculation of derivatives with respect to k, in the same
dataset. It must therefore be used with <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> = 2 (or 1).</p>
<ul>
<li>0 &rarr; no effective mass tensor calculation</li>
<li>1 &rarr; effective mass tensor calculation</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At the present time, both norm-conserving (NC) and PAW calculations are
supported. Also, for PAW calculations only, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> == 2 and
<a class="wikilink codevar-wikilink" href="/variables/paw#pawspnorb">pawspnorb</a> == 1 (i.e. spin-orbit (SO) calculations) is supported.
NC SO calculations are NOT currently supported. Also, for both NC and PAW,
<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> /= 1 and <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> /= 1 are NOT supported.</p>
</div>
<h2 id="efmas_bands"><strong>efmas_bands</strong><a class="headerlink" href="#efmas_bands" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, BANDS to be treated.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2,<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>)<br />
<em>Default value:</em> The full range of band available in the calculation for each k-point.<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas">efmas</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Germanium.
Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-toggle="popover" href="/tests/v7/Input/t80.abi" target="_blank">t80.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW for multiple bands and k-points." data-toggle="popover" href="/tests/v7/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-toggle="popover" href="/tests/v7/Input/t82.abi" target="_blank">t82.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgO
MgO effective mass tensor at \Gamma, published in Nery2018.
From present calculation, hole effective masses (ordered by increasing mass) are
m*(100)= -0.382, -2.171, -2.171 to be compared with Nery2018 Table I, -0.387, -2.164 (two-fold degenerate)
m*(111)= -0.331, -3.826, -3.826 to be compared with Nery2018 Table I, -0.335, -3.822 (two-fold degenerate)
m*(110)= -0.342, -2.171, -6.181
with angular average effective mass for Frohlich model is 1.923.
From present calculation, electron effective mass is
m*= 0.334 to be compared with Nery2018 Table I, -0.340.
Setting kpt to 8 8 8 and ecut to 50 allows one to reproduce the published values." data-toggle="popover" href="/tests/v8/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass." data-toggle="popover" href="/tests/v8/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO polaron effective mass along different direction: 100,110,111.
Frohlich ZPR is also computed.
Method available only for cubic materials." data-toggle="popover" href="/tests/v9/Input/t66.abi" target="_blank">t66.abi</a></li>
</ul>
</details>
<p>This variable controls the range of bands for which the effective mass is to
be calculated. If a band is degenerate, all other bands of the degenerate
group will automatically be treated, even if they were not part of the user specified range.</p>
<h2 id="efmas_calc_dirs"><strong>efmas_calc_dirs</strong><a class="headerlink" href="#efmas_calc_dirs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, CALCulate along DIRectionS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas">efmas</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Germanium.
Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-toggle="popover" href="/tests/v7/Input/t80.abi" target="_blank">t80.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-toggle="popover" href="/tests/v7/Input/t82.abi" target="_blank">t82.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgO
MgO effective mass tensor at \Gamma, published in Nery2018.
From present calculation, hole effective masses (ordered by increasing mass) are
m*(100)= -0.382, -2.171, -2.171 to be compared with Nery2018 Table I, -0.387, -2.164 (two-fold degenerate)
m*(111)= -0.331, -3.826, -3.826 to be compared with Nery2018 Table I, -0.335, -3.822 (two-fold degenerate)
m*(110)= -0.342, -2.171, -6.181
with angular average effective mass for Frohlich model is 1.923.
From present calculation, electron effective mass is
m*= 0.334 to be compared with Nery2018 Table I, -0.340.
Setting kpt to 8 8 8 and ecut to 50 allows one to reproduce the published values." data-toggle="popover" href="/tests/v8/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass." data-toggle="popover" href="/tests/v8/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO polaron effective mass along different direction: 100,110,111.
Frohlich ZPR is also computed.
Method available only for cubic materials." data-toggle="popover" href="/tests/v9/Input/t66.abi" target="_blank">t66.abi</a></li>
</ul>
</details>
<p>Allows the user to calculate the scalar effective mass of all bands specified
by <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_bands">efmas_bands</a> along specific directions in reciprocal space. This is
particularly useful when considering degenerate bands, which are usually
warped, and thus cannot have their dispersion (hessian) and effective mass
expressed as a tensor. This allows the user to see the more complex angular
behavior of effective masses in these cases, for instance.</p>
<p>When  <strong>efmas_calc_dirs</strong>  == 0, no directions are read from the input file (using
<a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_dirs">efmas_dirs</a>) and the effective masses along the 3 cartesian directions are output by default.</p>
<p>When  <strong>efmas_calc_dirs</strong>  == 1, 2 or 3, <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_n_dirs">efmas_n_dirs</a> directions are read from
<a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_dirs">efmas_dirs</a>, assuming cartesian, reduced or angular (<span><span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script></span>,<span><span class="MathJax_Preview">\phi</span><script type="math/tex">\phi</script></span>)
coordinates, respectively. In the case  <strong>efmas_calc_dirs</strong>  == 3, 2 real values
per directions are read, whereas 3 real values are read in the two other cases.</p>
<h2 id="efmas_deg"><strong>efmas_deg</strong><a class="headerlink" href="#efmas_deg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, activate DEGenerate formalism<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas">efmas</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-toggle="popover" href="/tests/v7/Input/t82.abi" target="_blank">t82.abi</a></li>
</ul>
</details>
<p>Activate (==1) or not (==0) the treatment of degenerate bands
(criterion <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_deg_tol">efmas_deg_tol</a> is used to determine whether bands are degenerate).
Also compute the transport equivalent effective mass (see <a class="wikilink citation-wikilink" data-tippy-content="Theory of band warping and its effects on thermoelectronic transport properties" data-toggle="popover" href="/theory/bibliography#mecholsky2014">[Mecholsky2014]</a>).</p>
<p><a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas">efmas</a> = 0 should only be used for testing purposes.</p>
<h2 id="efmas_deg_tol"><strong>efmas_deg_tol</strong><a class="headerlink" href="#efmas_deg_tol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, DEGeneracy TOLerance<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1e-05<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_deg">efmas_deg</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-toggle="popover" href="/tests/v7/Input/t82.abi" target="_blank">t82.abi</a></li>
</ul>
</details>
<p>Energy difference below which 2 bands are considered degenerate (and treated
using the formalism activated with <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_deg">efmas_deg</a> == 1).  <strong>efmas_deg_tol</strong>  has
the <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics.</p>
<h2 id="efmas_dim"><strong>efmas_dim</strong><a class="headerlink" href="#efmas_dim" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, DIMension of the effective mass tensor<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas">efmas</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Germanium.
Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-toggle="popover" href="/tests/v7/Input/t80.abi" target="_blank">t80.abi</a></li>
</ul>
</details>
<p>For 2D or 1D systems, the band dispersion goes to 0 perpendicular to the
system, which causes the inverse effective mass to be singular, i.e. the
effective mass to be NaN. This keyword circumvents the problem by eliminating
the troublesome dimensions from the inverse effective mass.</p>
<p>In 2D, the Z axis is ignored and, in 1D, the Z and Y axis are ignored.</p>
<p>Also, note that in the 2D degenerate case, a subtlety arises: the &lsquo;transport
equivalent&rsquo; effective mass does not determine the scale of the transport
tensors (conductivity and others). Therefore, for this specific case, the
factor by which these transport tensors should be scaled once determined from
the &lsquo;transport equivalent&rsquo; effective mass tensor is output separately on the
line immediately after the effective mass.</p>
<h2 id="efmas_dirs"><strong>efmas_dirs</strong><a class="headerlink" href="#efmas_dirs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, DIRectionS to be calculated<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3 or 2,<a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_n_dirs">efmas_n_dirs</a>)<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_calc_dirs">efmas_calc_dirs</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Germanium.
Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-toggle="popover" href="/tests/v7/Input/t80.abi" target="_blank">t80.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-toggle="popover" href="/tests/v7/Input/t82.abi" target="_blank">t82.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgO
MgO effective mass tensor at \Gamma, published in Nery2018.
From present calculation, hole effective masses (ordered by increasing mass) are
m*(100)= -0.382, -2.171, -2.171 to be compared with Nery2018 Table I, -0.387, -2.164 (two-fold degenerate)
m*(111)= -0.331, -3.826, -3.826 to be compared with Nery2018 Table I, -0.335, -3.822 (two-fold degenerate)
m*(110)= -0.342, -2.171, -6.181
with angular average effective mass for Frohlich model is 1.923.
From present calculation, electron effective mass is
m*= 0.334 to be compared with Nery2018 Table I, -0.340.
Setting kpt to 8 8 8 and ecut to 50 allows one to reproduce the published values." data-toggle="popover" href="/tests/v8/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass." data-toggle="popover" href="/tests/v8/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO polaron effective mass along different direction: 100,110,111.
Frohlich ZPR is also computed.
Method available only for cubic materials." data-toggle="popover" href="/tests/v9/Input/t66.abi" target="_blank">t66.abi</a></li>
</ul>
</details>
<p>List of <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_n_dirs">efmas_n_dirs</a> directions to be considered according to the value of
<a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_calc_dirs">efmas_calc_dirs</a>. The directions are specified by 3 real values if
<a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_calc_dirs">efmas_calc_dirs</a> == 1 or 2 and by 2 real values if <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_calc_dirs">efmas_calc_dirs</a> == 3.</p>
<h2 id="efmas_n_dirs"><strong>efmas_n_dirs</strong><a class="headerlink" href="#efmas_n_dirs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, Number of DIRectionS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_calc_dirs">efmas_calc_dirs</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Germanium.
Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-toggle="popover" href="/tests/v7/Input/t80.abi" target="_blank">t80.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-toggle="popover" href="/tests/v7/Input/t82.abi" target="_blank">t82.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgO
MgO effective mass tensor at \Gamma, published in Nery2018.
From present calculation, hole effective masses (ordered by increasing mass) are
m*(100)= -0.382, -2.171, -2.171 to be compared with Nery2018 Table I, -0.387, -2.164 (two-fold degenerate)
m*(111)= -0.331, -3.826, -3.826 to be compared with Nery2018 Table I, -0.335, -3.822 (two-fold degenerate)
m*(110)= -0.342, -2.171, -6.181
with angular average effective mass for Frohlich model is 1.923.
From present calculation, electron effective mass is
m*= 0.334 to be compared with Nery2018 Table I, -0.340.
Setting kpt to 8 8 8 and ecut to 50 allows one to reproduce the published values." data-toggle="popover" href="/tests/v8/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass." data-toggle="popover" href="/tests/v8/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO polaron effective mass along different direction: 100,110,111.
Frohlich ZPR is also computed.
Method available only for cubic materials." data-toggle="popover" href="/tests/v9/Input/t66.abi" target="_blank">t66.abi</a></li>
</ul>
</details>
<p>Number of directions in <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_dirs">efmas_dirs</a>, to be considered according to <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_calc_dirs">efmas_calc_dirs</a>.</p>
<h2 id="efmas_ntheta"><strong>efmas_ntheta</strong><a class="headerlink" href="#efmas_ntheta" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, Number of points for integration w/r to THETA<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1000<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas">efmas</a> == 1 and <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas_bands">efmas_bands</a> == (degenerate band index)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Germanium.
Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-toggle="popover" href="/tests/v7/Input/t80.abi" target="_blank">t80.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW for multiple bands and k-points." data-toggle="popover" href="/tests/v7/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon.
Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-toggle="popover" href="/tests/v7/Input/t82.abi" target="_blank">t82.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgO
MgO effective mass tensor at \Gamma, published in Nery2018.
From present calculation, hole effective masses (ordered by increasing mass) are
m*(100)= -0.382, -2.171, -2.171 to be compared with Nery2018 Table I, -0.387, -2.164 (two-fold degenerate)
m*(111)= -0.331, -3.826, -3.826 to be compared with Nery2018 Table I, -0.335, -3.822 (two-fold degenerate)
m*(110)= -0.342, -2.171, -6.181
with angular average effective mass for Frohlich model is 1.923.
From present calculation, electron effective mass is
m*= 0.334 to be compared with Nery2018 Table I, -0.340.
Setting kpt to 8 8 8 and ecut to 50 allows one to reproduce the published values." data-toggle="popover" href="/tests/v8/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass." data-toggle="popover" href="/tests/v8/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO polaron effective mass along different direction: 100,110,111.
Frohlich ZPR is also computed.
Method available only for cubic materials." data-toggle="popover" href="/tests/v9/Input/t66.abi" target="_blank">t66.abi</a></li>
</ul>
</details>
<p>When a band is degenerate, the usual definition of effective mass becomes
invalid. However, it is still possible to define a &lsquo;transport equivalent mass
tensor&rsquo; that reproduces the contribution of the band to the conductivity
tensor. To obtain this tensor, an integration over the solid sphere is
required. The angular variables are sampled using  <strong>efmas_ntheta</strong>  points for the theta coordinate,
and twice  <strong>efmas_ntheta</strong>  points for the phi coordinate.
The default value gives a tensor accurate to the 4<sup>th</sup> decimal in Ge.</p>
<h2 id="elph2_imagden"><strong>elph2_imagden</strong><a class="headerlink" href="#elph2_imagden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ELectron-PHonon interaction at 2<sup>nd</sup> order: IMAGinary shift of the DENominator<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="To to calculate the temperature dependence of the electronic structure" data-toggle="popover" href="/topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#ieig2rf">ieig2rf</a> != 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [19/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
Warning : only valid for Gamma, AND the temperature-dependent shifts must be averaged
over degenerate states." data-toggle="popover" href="/tests/v6/Input/t37.abi" target="_blank">t37.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed." data-toggle="popover" href="/tests/v7/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. The wtq variable is introduced to be able to reproduce the q-point
weight obtained with ngqpt and qptopt.
The main reason being that the initialization of large q-point (same for k-point) grid
is extremely slow. Inputing manually the qpt and wtq in the input file avoid such
inefficient initialization." data-toggle="popover" href="/tests/v7/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. Test the getddb variable that cancels the divergence in el-ph for small q-points
Such divergence is induced by a residual electric field.
Note: The Fan terms in DATASET 6 should be different (renormalized) from the one of DATASET 5." data-toggle="popover" href="/tests/v7/Input/t58.abi" target="_blank">t58.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. Test the getddb variable that cancels the divergence in el-ph for small q-points
Such divergence is induced by a residual electric field.
Note: DATASET 7 test the irdddb that should behave exactly as getddb." data-toggle="popover" href="/tests/v7/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2
Oxygen spin-temperature-dependent of the band energies" data-toggle="popover" href="/tests/v7/Input/t83.abi" target="_blank">t83.abi</a></li>
</ul>
</details>
<p>The variable  <strong>elph2_imagden</strong>  determines the imaginary shift of the
denominator of the sum-over-states in the perturbation,
<span><span class="MathJax_Preview">(e_{nk}-e_{n'k'}+i</span><script type="math/tex">(e_{nk}-e_{n'k'}+i</script></span> <strong>elph2_imagden</strong> ). One should use a width comparable with
the Debye frequency or the maximum phonon frequency.
Can be specified in Ha (the default), Ry, eV or Kelvin, since <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> has the
<a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics (1 Ha = 27.2113845 eV).</p>
<h2 id="esmear"><strong>esmear</strong><a class="headerlink" href="#esmear" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Eigenvalue SMEARing<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="To to calculate the temperature dependence of the electronic structure" data-toggle="popover" href="/topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.01<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#smdelta">smdelta</a> != 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the smearing parameter ESMEAR of the imaginary second order eigenvalues
for Q-point (0 0 0), contained in the EIGI2D files. Parameters are far from
convergence, nband=5 and nkpt=16." data-toggle="popover" href="/tests/v6/Input/t60.abi" target="_blank">t60.abi</a></li>
</ul>
</details>
<p>The variable  <strong>esmear</strong>  determines the width of the functions approximating
the delta function, <span><span class="MathJax_Preview">\delta(e_{nk}-e_{n'k'})</span><script type="math/tex">\delta(e_{nk}-e_{n'k'})</script></span>, present in the expression of the
lifetimes. One should use a width comparable with the Debye frequency or the
maximum phonon frequency.
Can be specified in Ha (the default), Ry, eV or Kelvin, since <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> has the
<a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics (1 Ha = 27.2113845 eV).</p>
<h2 id="ffnl_lw"><strong>ffnl_lw</strong><a class="headerlink" href="#ffnl_lw" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> NonLocal Form Factors in LongWave calculation<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute spatial dispersion properties with the longwave DFPT approach." data-toggle="popover" href="/topics/longwave">topic_longwave</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> v9.9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t148.abi" target="_blank">t148.abi</a></li>
</ul>
</details>
<p>In a longwave calculation, the nonlocal form factors and their derivatives are
by default computed for all k points and atom types at an initial step and then
specifically used for each type of perturbation. Depending on the calculation
parameters &ndash;in particular for dense k-point grids, large ecut and pseudopotentials
with large l and n values&ndash; such approach might lead to high virtual memory usage.</p>
<p>With  <strong>ffnl_lw</strong>  = 1 the form factors and derivatives are instead calculated
on-the-fly for each type of perturbation and k point when they are required.
This option saves virtual memory but makes the computation of spatial-dispersion
tensors slower.</p>
<h2 id="frzfermi"><strong>frzfermi</strong><a class="headerlink" href="#frzfermi" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FReeZe FERMI energy<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 28. The chosen grid (too coarse, though) is
(0 0 0), (1/4 1/4 0), (1/2 1/2 0), (1/2 0 0),
(1/2 1/4 1/4), (1/2 -1/4 1/4)  (in reduced coordinates).
The ecut and nkpt parameters are really too low (see test 28),
but parameters suitable for physical results (see test 29)
are also provided in the input files." data-toggle="popover" href="/tests/v2/Input/t26.abi" target="_blank">t26.abi</a></li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (non-spin-polarized, non-linear XC core correction, LDA)
Metallic occupation numbers.
For metallic occupation numbers,
RF computation of 2DTE at Gamma, when taking
Fermi energy changes (frzfermi=0), will give the same
answer than finite-difference of GS computations.
However, prior to v4.4, the change of Fermi energy
due to the perturbation was not computed.
This corresponds to calculations performed with frzfermi=1
(should be used only for testing purposes).
In dataset 1-3, one computes the total energy and forces,
without symmetries, as it should be
for accurate finite-difference tests.
The reduced gradients with respect to displacements
of the first atom along z in datasets 1 and 3 are
-5.705344113253 Ha and -5.692553418498 Ha, giving
the 2DTE of 127.90 Ha.
In dataset 4, RF is computed with the Fermi energy correction,
and the agreement with finite-differences of datasets 1 and 3
is good : one gets 127.9068 Ha .
In dataset 5, RF is computed with frozen Fermi energy
and the disagreement with
finite-differences of datasets 1 and 3 is large:
one gets 100.9991668 Ha ." data-toggle="popover" href="/tests/v3/Input/t75.abi" target="_blank">t75.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of phonons frequencies for metallic occupations at q=0 0 0 within PAW
O2 (nsppol=1); this test is directly inspired by test v3#75.
In datasets 1-3, one computes the total energy and forces, without symmetries,
as it should be for accurate finite-difference tests.
From the reduced gradients with respect to displacements, one can deduce
a 2DTE of 149.9614 Ha.
In dataset 4, RF is computed with the Fermi energy correction,
and the agreement with finite-differences of datasets 1 and 3
is good : one gets 149.9612 Ha.
In dataset 5, RF is computed with frozen Fermi energy and the disagreement with
finite-differences of datasets 1 and 3 is large: one gets 124.9787 Ha." data-toggle="popover" href="/tests/v6/Input/t89.abi" target="_blank">t89.abi</a></li>
</ul>
</details>
<p>Can be used to suppress artificially the first-order change of Fermi energy,
in case of Response Function calculation for metals at Q=0. If the input variable
 <strong>frzfermi</strong>  is set to 1, this contribution is suppressed, even though this is incorrect.</p>
<h2 id="ieig2rf"><strong>ieig2rf</strong><a class="headerlink" href="#ieig2rf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for second-order EIGenvalues from Response-Function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="To to calculate the temperature dependence of the electronic structure" data-toggle="popover" href="/topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [26/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of second order eigenvalues for two qpoints, (0 0 0)
and (1/2 0 0), contained in the EIGR2D files. Parameters are far from
convergence, nband=5 and nkpt=16." data-toggle="popover" href="/tests/v5/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
Warning : only valid for Gamma, AND the temperature-dependent shifts must be averaged
over degenerate states." data-toggle="popover" href="/tests/v6/Input/t37.abi" target="_blank">t37.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
For testing the electron-phonon modification of the electronic structure.
To be compared with the results of tests 51 to 59.
Use a 2x2x2 grid of k (shifted) and q (non-shifted) points.
No imaginary frequences for the phonons with this choice.
Computation of the electronic eigenvalues as well as phonon eigenfrequencies,
and corresponding ingredients for the computation of the electron-phonon effect, in the
next tests 51-53." data-toggle="popover" href="/tests/v6/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC conventional cell. Fake smooth pseudopotential.
For testing the electron-phonon modification of the electronic structure.
To be compared with the results of tests 50 to 59.
Use a FCC grid of k (shifted) and q (non-shifted) points.
No imaginary frequences for the phonons with this choice.
Computation of the electronic eigenvalues as well as phonon eigenfrequencies,
and corresponding ingredients for the computation of the electron-phonon effect, in the
next tests 55-57." data-toggle="popover" href="/tests/v6/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed." data-toggle="popover" href="/tests/v7/Input/t55.abi" target="_blank">t55.abi</a> &hellip;</li>
</ul>
</details>
<p>If  <strong>ieig2rf</strong>  is greater than 0, the code will produce a file, named with the
suffix _EIGR2D, containing the second-order electronic eigenvalues for the perturbation.
These files are used in the calculation of the thermal
correction to the electronic eigenvalues.</p>
<ul>
<li>
<p>If  <strong>ieig2rf</strong>  is set to 1, the second-order electronic eigenvalues will be
    calculated from the DFPT method (Sternheimer).</p>
</li>
<li>
<p>If  <strong>ieig2rf</strong>  is set to 2, the second-order electronic eigenvalues will be
    calculated from the Allen-Cardona method (sum over states).</p>
</li>
<li>
<p>If  <strong>ieig2rf</strong>  is set to 3, the second-order electronic eigenvalues will be
    calculated from the DFPT method (sum over states) but using a different part
    of the code. This is equivalent to  <strong>ieig2rf</strong>  = 1 [debuging].</p>
</li>
<li>
<p>If  <strong>ieig2rf</strong>  is set to 4, the second-order electronic eigenvalues will be
    calculated from the dynamical DFPT method (Sternheimer). The code will
    generate _EIGR2D.nc files that contain the electron-phonon matrix element
    squared on the space orthogonal to the active space. The code will also
    produce _FAN.nc files that contain the electron-phonon matrix elements
    squared.</p>
</li>
<li>
<p>If  <strong>ieig2rf</strong>  is set to 5, the second-order electronic eigenvalues will be
    calculated from the dynamical DFPT method (Sternheimer). The code will
    generate _EIGR2D.nc files that contain the electron-phonon matrix element
    square on the space orthogonal to the active space. The code will also produce
    _GKK.nc files that contain electron-phonon matrix elements. This option is
    preferable for large system to  <strong>ieig2rf</strong>  = 4 as the GKK files take much
    less disk space and memory (but run a little bit slower).</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>ieig2rf</strong>  = 4 and 5 can only be used if Abinit is compiled with NETCDF support.</p>
</div>
<p>Related variables: <a class="wikilink codevar-wikilink" href="/variables/dfpt#bdeigrf">bdeigrf</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#elph2_imagden">elph2_imagden</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#getgam_eig2nkq">getgam_eig2nkq</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#smdelta">smdelta</a></p>
<h2 id="ixcrot"><strong>ixcrot</strong><a class="headerlink" href="#ixcrot" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Index of the XC ROTation method used to calculate first-order exchange-correlation potential in non-collinear DFPT calculations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [12/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=2" data-toggle="popover" href="/tests/v8/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism: ddk with ixcrot=3" data-toggle="popover" href="/tests/v8/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, electric field perturbation with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, electric field perturbation with ixcrot=2" data-toggle="popover" href="/tests/v8/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, electric field perturbation with ixcrot=3" data-toggle="popover" href="/tests/v8/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, atomic perturbation with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, atomic perturbation with ixcrot=2" data-toggle="popover" href="/tests/v8/Input/t79.abi" target="_blank">t79.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, atomic perturbation with ixcrot=3" data-toggle="popover" href="/tests/v8/Input/t80.abi" target="_blank">t80.abi</a></li>
</ul>
</details>
<p>Method of calculation of the 1<sup>st</sup> order XC potential in non-collinear DFPT
calculations. The possible values 1,2 and 3 correspond to the following
methods:</p>
<ul>
<li>If ixcrot=1, the spinor rotation matrix U at each FFT point is not calculated explicitly. Instead the needed expressions involving U are derived based on the general properties of the U matrix.</li>
<li>If ixcrot=2, U is computed explicitly</li>
<li>If ixcrot=3, the brute force evaluation of the 1<sup>st</sup> order XC potential as a functional derivative is used. Rotation matrices are not computed.</li>
</ul>
<p>In theory, all methods give identical results. However, due to different
implementation approaches, the round-off errors can lead to slight differences
intermediate and final results obtained using methods 1,2 and 3. The choice of
the method can also affect the convergence. For more details, see <a class="wikilink citation-wikilink" data-tippy-content="Density functional perturbation theory within noncollinear magnetism" data-toggle="popover" href="/theory/bibliography#ricci2019">[Ricci2019]</a> or <a class="wikilink citation-wikilink" data-tippy-content="The Abinit project: Impact, environment and recent developments" data-toggle="popover" href="/theory/bibliography#gonze2020">[Gonze2020]</a>.
WARNING: in <a class="wikilink citation-wikilink" data-tippy-content="Density functional perturbation theory within noncollinear magnetism" data-toggle="popover" href="/theory/bibliography#ricci2019">[Ricci2019]</a>, the meaning of  <strong>ixcrot</strong> =2 or 3 is inverted with respect to the implementation. On the contrary,
the implemention and <a class="wikilink citation-wikilink" data-tippy-content="The Abinit project: Impact, environment and recent developments" data-toggle="popover" href="/theory/bibliography#gonze2020">[Gonze2020]</a> agree. More explicitly, the method refered to as method 1&rsquo; in <a class="wikilink citation-wikilink" data-tippy-content="Density functional perturbation theory within noncollinear magnetism" data-toggle="popover" href="/theory/bibliography#ricci2019">[Ricci2019]</a>
is  <strong>ixcrot</strong> =2, and method refereed to as method 2 in <a class="wikilink citation-wikilink" data-tippy-content="Density functional perturbation theory within noncollinear magnetism" data-toggle="popover" href="/theory/bibliography#ricci2019">[Ricci2019]</a> is  <strong>ixcrot</strong> =3.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For non-zero perturbation wavevector (<a class="wikilink codevar-wikilink" href="/variables/gstate#qpt">qpt</a>/=0), only the  <strong>ixcrot</strong> =3 implementation is currently available.
The code will stop with the default  <strong>ixcrot</strong>  value for non-zero perturbation wavevector. The user should then set  <strong>ixcrot</strong> =3 and restart.</p>
</div>
<h2 id="lw_flexo"><strong>lw_flexo</strong><a class="headerlink" href="#lw_flexo" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> LongWave calculation of FLEXOelectricity related spatial dispersion tensors<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute spatial dispersion properties with the longwave DFPT approach." data-toggle="popover" href="/topics/longwave">topic_longwave</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 10<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_1.abi" target="_blank">tlw_1.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GGA Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t148.abi" target="_blank">t148.abi</a></li>
</ul>
</details>
<p>Used to run the calculation of spatial dispersion tensorial quantities needed to
build the bulk flexoelectric tensor (the clamped-ion flexoelectric tensor is directly calculated by
abinit whereas the mixed and lattice-mediated ones are obtained through a postprocessing anaddb calculation,
see <a class="wikilink codevar-wikilink" href="/variables/anaddb#flexoflag">flexoflag@anaddb</a>).</p>
<p>This <strong>requires</strong> the precalculation of the ground-state wave-functions and
density, as well as response functions and densities to a set of perturbations as specified below.
The number of linear-response calculations to be explicitly precomputed can be reduced via symmetry arguments
selecting the appropiate value of the <a class="wikilink codevar-wikilink" href="/variables/dfpt#prepalw">prepalw</a> variable.</p>
<ul>
<li>0 &rarr; No flexoelectric spatial dispersion tensors are calculated.</li>
<li>1 &rarr; Four tensors required to build all the contributions to the bulk flexoelectric tensor
          are calculated. Requires precomputed linear response functions
          and densities: ddk, d2_dkdk, electric field, atomic displacement and strain.</li>
<li>2 &rarr; Clamped-ion flexoelectric tensor is calculated. Requires precomputed linear response functions
          and densities: ddk, d2_dkdk, electric field and strain.</li>
<li>3 &rarr; Two tensors required to build the mixed flexoelectric tensor are calculated:
          the first moment of polarization response to an atomic displacement and the first
          moment of the IFCs. Related quantities that can be derived from these two tensors
          are also printed: dynamical quadrupoles, clamped-ion piezoelectric tensor and
          piezoelectric force response tensor. Requires precomputed linear response functions and densities:
          ddk, d2_dkdk, electric field and atomic displacement.</li>
<li>4 &rarr; Two tensors required to build the lattice-mediated flexoelectric tensor are calculated:
          the first moment of the IFCs and the first moment of the piezoelectric force response
          tensor. Related quantities that can be derived from these two tensors
          are also printed: piezoelectric force response tensor and clamped-ion elastic tensor.
          Requires precomputed linear response functions and densities:
          ddk, atomic displacement and strain.</li>
</ul>
<h2 id="lw_natopt"><strong>lw_natopt</strong><a class="headerlink" href="#lw_natopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> LongWave calculation of NATural OPTical activity tensor<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute spatial dispersion properties with the longwave DFPT approach." data-toggle="popover" href="/topics/longwave">topic_longwave</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 10<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Natural optical activity of quartz" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_8.abi" target="_blank">tlw_8.abi</a></li>
</ul>
</details>
<p>Used to run natural optical activity tensor calculation.</p>
<ul>
<li>0 &rarr; No natural optical activity tensor is calculated.</li>
<li>1 &rarr; Natural optical activity tensor is calculated.</li>
</ul>
<p>This <strong>requires</strong> the precalculation of the ground-state wave functions and
density as well as response functions and densities to the following perturbations:
ddk, d2_dkdk, electric fields. The number of linear-response calculations
to be explicitly precomputed can be reduced via symmetry arguments
selecting the appropriate value of the <a class="wikilink codevar-wikilink" href="/variables/dfpt#prepalw">prepalw</a> variable.</p>
<h2 id="lw_qdrpl"><strong>lw_qdrpl</strong><a class="headerlink" href="#lw_qdrpl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> LongWave calculation of dynamical QuaDRuPoLes tensor<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute spatial dispersion properties with the longwave DFPT approach." data-toggle="popover" href="/topics/longwave">topic_longwave</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 10<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Dynamic Quadrupoles Calculation for GaP" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_4.abi" target="_blank">tlw_4.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Dynamic Quadrupoles Calculation for AlAs" data-toggle="popover" href="/tests/v9/Input/t145.abi" target="_blank">t145.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Antisymmetric vector potential response and quadrupoles of HF molecule" data-toggle="popover" href="/tests/v9/Input/t146.abi" target="_blank">t146.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Vector potential response and quadrupoles of HF molecule" data-toggle="popover" href="/tests/v9/Input/t147.abi" target="_blank">t147.abi</a></li>
</ul>
</details>
<p>Used to run dynamical quadrupoles tensor calculation (e.g., needed to include dipole-quadrupole
and/or quadrupole-quadrupole electrostatic interactions in the anaddb calculation of
phonons. See <a class="wikilink codevar-wikilink" href="/variables/anaddb#dipquad">dipquad@anaddb</a> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#quadquad">quadquad@anaddb</a>).</p>
<ul>
<li>0 &rarr; No dynamical quadrupoles are calculated</li>
<li>1 &rarr; Dynamical quadrupoles are calculated. Related quantities that can be derived from
          the dynamical quadrupoles are also printed: the first moment of the polarization
          response to an atomic displacement and the clamped-ion piezoelectric tensor.</li>
</ul>
<p>This <strong>requires</strong> the precalculation of the ground-state wave functions and
density as well as response functions and densities to the following perturbations:
ddk, d2_dkdk, atomic displacements and electric fields. The number of linear-response calculations
to be explicitly precomputed can be reduced via symmetry arguments
selecting the appropiate value of the <a class="wikilink codevar-wikilink" href="/variables/dfpt#prepalw">prepalw</a> variable.</p>
<h2 id="nonlinear_info"><strong>nonlinear_info</strong><a class="headerlink" href="#nonlinear_info" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Output NON-LINEAR INFOrmation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 and <a class="wikilink codevar-wikilink" href="/variables/dfpt#usepead">usepead</a> == 0, or <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkdk">rf2_dkdk</a>/=0 or <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkde">rf2_dkde</a>/=0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [11/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (stresses), using GEMM nonlop.
Related tests: v8 t83 and gpu_omp t21 ." data-toggle="popover" href="/tests/gpu_omp/Input/t25.abi" target="_blank">t25.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield)." data-toggle="popover" href="/tests/v8/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Test the polarized case (with a non-polarized system). Must give same results than t83.in" data-toggle="popover" href="/tests/v8/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t84.in" data-toggle="popover" href="/tests/v8/Input/t86.abi" target="_blank">t86.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Give same results than t83.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t87.abi" target="_blank">t87.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Give same results than t84.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Give same results than t84.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t89.abi" target="_blank">t89.abi</a></li>
</ul>
</details>
<p>Control the output of the non-linear implementation (only when <a class="wikilink codevar-wikilink" href="/variables/dfpt#usepead">usepead</a> == 0).
The default value,  <strong>nonlinear_info</strong>  == 0 does nothing. If  <strong>nonlinear_info</strong>  == 1,
different contributions of 3<sup>rd</sup> derivatives of the energy are written in the
output file (non time consuming).</p>
<p>Higher values activate some internal tests for
checking the implementation correctness (time consuming, not useable in parallel).
If  <strong>nonlinear_info</strong>  == 2, same effect than 1 and tests are done in non-linear
(<a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>==5 and <a class="wikilink codevar-wikilink" href="/variables/dfpt#usepead">usepead</a> == 0).
If  <strong>nonlinear_info</strong>  == 3, same effect than 1 and tests are done in rf2_init
(<a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkdk">rf2_dkdk</a>/=0 or <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkde">rf2_dkde</a>/=0).
If  <strong>nonlinear_info</strong>  == 4, same effect than 1 and tests are done in both non-linear and rf2_init.
A line containining &ldquo;NOT PASSED&rdquo; (and other information) is added to the output file
for each test that does not pass, otherwise nothing is printed. However, more information concerning
the tests is always printed in the <strong>standard</strong> output file.</p>
<h2 id="orbmag"><strong>orbmag</strong><a class="headerlink" href="#orbmag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ORBital MAGnetization<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to calculate NMR chemical shieldings" data-toggle="popover" href="/topics/NMR">topic_NMR</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to take into account an external magnetic field" data-toggle="popover" href="/topics/MagField">topic_MagField</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1;
<a class="wikilink codevar-wikilink" href="/variables/paw#usexcnhat">usexcnhat</a> == 0;
<a class="wikilink codevar-wikilink" href="/variables/paral#paral_atom">paral_atom</a> == 0;
<a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> == 0;
(<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> == 3 or <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> == 0) <br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [9/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a></li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for the printing of the local orbital magnetic moment
of NiO (fcc supercell with 2 Ni and 2 O atoms).
Cut-off and k-points are unrealistic.
Works only in the case of PAW and DFT+U" data-toggle="popover" href="/tests/v9/Input/t112.abi" target="_blank">t112.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP" data-toggle="popover" href="/tests/v9/Input/t140.abi" target="_blank">t140.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nspinor 2" data-toggle="popover" href="/tests/v9/Input/t141.abi" target="_blank">t141.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nsppol 2" data-toggle="popover" href="/tests/v9/Input/t142.abi" target="_blank">t142.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism in metallic sodium" data-toggle="popover" href="/tests/v9/Input/t143.abi" target="_blank">t143.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP with discretized wavefunctions" data-toggle="popover" href="/tests/v9/Input/t144.abi" target="_blank">t144.abi</a></li>
</ul>
</details>
<p>Compute quantities related to orbital magnetic moment. Typically used in the
presence of a nonzero nuclear magnetic dipole moment, see <a class="wikilink codevar-wikilink" href="/variables/gstate#nucdipmom">nucdipmom</a>, to compute
the nuclear magnetic shielding as measured in NMR.  <strong>orbmag</strong> 
is parallelized over k points only. The implementation follows the
theory outlined in <a class="wikilink citation-wikilink" data-tippy-content="Orbital magnetism and chemical shielding in the projector augmented-wave formalism" data-toggle="popover" href="/theory/bibliography#zwanziger2023">[Zwanziger2023]</a>. The computed results are returned in the
standard output file, search for &ldquo;Orbital magnetic moment&rdquo;. This calculation requires
both the ground state and DDK wavefunctions (see <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfddk">rfddk</a> or <a class="wikilink codevar-wikilink" href="/variables/ffield#berryopt">berryopt</a>). The
preferred way to use  <strong>orbmag</strong>  is at the end of a DFPT DDK calculation. Alternatively, it
can be called in a ground state calculation if <a class="wikilink codevar-wikilink" href="/variables/ffield#berryopt">berryopt</a> -2 has also been called,
to generate discretized DDK wavefunctions. This latter method works only on a mesh of
kpoints, while the DFPT version works for both a mesh and for a single k point (as
encountered in studying an atom or molecule in a box, or a pariticularly large unit cell).
Note that convergence with kpt mesh is
<em>much</em> faster using the DFPT approach, and the <a class="wikilink codevar-wikilink" href="/variables/ffield#berryopt">berryopt</a> approach is not recommended
unless a very specific ground state feature is also needed.</p>
<ul>
<li><strong>orbmag</strong>  = 1: Compute orbital magnetization and Chern vector</li>
<li><strong>orbmag</strong>  = 2: Same as  <strong>orbmag</strong>  1 but also print out values of each term making up total
orbital magnetic moment and a band-by-band decomposition.</li>
</ul>
<h2 id="prepalw"><strong>prepalw</strong><a class="headerlink" href="#prepalw" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PREPAre LongWave calculation<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute spatial dispersion properties with the longwave DFPT approach." data-toggle="popover" href="/topics/longwave">topic_longwave</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1245] in all abinit tests, [3/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_1.abi" target="_blank">tlw_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Dynamic Quadrupoles Calculation for GaP" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_4.abi" target="_blank">tlw_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Natural optical activity of quartz" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_8.abi" target="_blank">tlw_8.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GGA Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Dynamic Quadrupoles Calculation for AlAs" data-toggle="popover" href="/tests/v9/Input/t145.abi" target="_blank">t145.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Antisymmetric vector potential response and quadrupoles of HF molecule" data-toggle="popover" href="/tests/v9/Input/t146.abi" target="_blank">t146.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Vector potential response and quadrupoles of HF molecule" data-toggle="popover" href="/tests/v9/Input/t147.abi" target="_blank">t147.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t148.abi" target="_blank">t148.abi</a></li>
</ul>
</details>
<p>The computation of spatial-dispersion quantities from the longwave DFPT
approach requires the first-order wavefunctions and densities obtained from
a linear response calculation. The standard approach in a linear response calculation is:</p>
<ul>
<li>compute only the irreducible perturbations;</li>
<li>use symmetries to reduce the number of k-points for the k-point integration.</li>
</ul>
<p>This approach cannot be applied, presently (v9.x), if the first-order
wavefunctions are to be used to compute spatial dispersion properties.
During the linear response calculation, in order to prepare a longwave
calculation, one should use  <strong>prepalw</strong>  /= 0 in order to force ABINIT to keep
the full number of k-points in half the BZ (kptopt=2), or the full BZ (kptopt=3).
Different options can then be used to set the reducible perturbations that
are enforced to be explicitly calculated:</p>
<ul>
<li>
<p>1 &rarr; Activates the calculation of perturbations required to build spatial-
          dispersion tensors which depend on strain. It is therefore the option
          to choose if one intends to run subsequent longwave calculations with
          <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_flexo">lw_flexo</a> = 1, 2, or 4.</p>
</li>
<li>
<p>2 &rarr; Activates the calculation of perturbations required to build spatial-
          dispersion tensors which combine electric field and atomic displacement
          perturbations. It is therefore the option to choose if one intends to
          run subsequent longwave calculations with <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_qdrpl">lw_qdrpl</a> = 1.</p>
</li>
<li>
<p>3 &rarr; Activates the calculation of perturbations required to build spatial-
          dispersion tensors which combine electric field and atomic displacement
          perturbations as well as two atomic displacements. It is therefore the
          option to choose if one intends to run subsequent longwave calculations
          with <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_flexo">lw_flexo</a> = 3.</p>
</li>
<li>
<p>4 &rarr; Activates the calculation of perturbations required to build spatial-
          dispersion tensors which combine two electric field perturbations.
          It is therefore the option to choose if one intends to run subsequent
          longwave calculations with <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_natopt">lw_natopt</a> = 1.</p>
</li>
</ul>
<h2 id="prepanl"><strong>prepanl</strong><a class="headerlink" href="#prepanl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PREPAre Non-Linear response calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [24/1245] in all abinit tests, [2/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (stresses), using GEMM nonlop.
Related tests: v8 t83 and gpu_omp t21 ." data-toggle="popover" href="/tests/gpu_omp/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements" data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_2.abi" target="_blank">tnlo_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements.
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_6.abi" target="_blank">tnlo_6.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized.
However nsppol=2 for testing purposes.
Over 1200 WARNINGS.
This test must give the same results of the test 64
non-linear response with nsppol=1 does not support MPI with nprocs &gt; 1" data-toggle="popover" href="/tests/v6/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized
Over 1200 WARNINGS.
This test must give the same results of the test 63" data-toggle="popover" href="/tests/v6/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl Molecule in a big box
3DTE calculation with only one k-point" data-toggle="popover" href="/tests/v6/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 48, 49 and 50." data-toggle="popover" href="/tests/v8/Input/t47.abi" target="_blank">t47.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
</ul>
</details>
<p>The computation of third-order derivatives from the 2n+1 theorem requires the
first-order wavefunctions and densities obtained from a linear response
calculation. The standard approach in a linear response calculation is:</p>
<ul>
<li>compute only the irreducible perturbations;</li>
<li>use symmetries to reduce the number of k-points for the k-point integration.</li>
</ul>
<p>This approach cannot be applied, presently (v4.1), if the first-order
wavefunctions are to be used to compute third-order derivatives. First, for
electric fields, the code needs the derivatives along the three directions.
Still, in case of phonons, only the irreducible perturbations are required.
Second, for both electric fields and phonons, the wavefunctions must be
available in half the BZ (kptopt=2), or the full BZ (kptopt=3).
During the linear response calculation, in order to prepare a non-linear
calculation, one should put  <strong>prepanl</strong>  to 1 in order to force ABINIT to
compute the electric field perturbation along the three directions explicitly,
and to keep the full number of k-points.</p>
<p>In the case of a 2<sup>nd</sup> derivative of wavefunction (<a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkdk">rf2_dkdk</a> or <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkde">rf2_dkde</a>),
 <strong>prepanl</strong>  == 1 can be used in order to skip directions of perturbations that
will not be used by the non-linear routine (see <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkdk">rf2_dkdk</a> for more details).</p>
<h2 id="prepgkk"><strong>prepgkk</strong><a class="headerlink" href="#prepgkk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PREPAre GKK calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the matrix elements of the electron-phonon interaction" data-toggle="popover" href="/topics/ElPhonInt">topic_ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
the sequence of datasets makes the ground states and
all of the explicit perturbations of the single
Al atom in all directions, for the irreducible
qpoints in a 2x2x2 grid.
Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_1.abi" target="_blank">teph_legacy_1.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Aluminium - get phonons and ddk in preparation for an electron-phonon coupling run.
a few extra features are used compared to the tutorial." data-toggle="popover" href="/tests/v5/Input/t85.abi" target="_blank">t85.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Ground state and phonons of hcp TiNb alloy" data-toggle="popover" href="/tests/v6/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ground state and phonons of hcp Ti (similar to test 72, but grid 2 2 4)" data-toggle="popover" href="/tests/v6/Input/t90.abi" target="_blank">t90.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ground state and phonons of bcc Li" data-toggle="popover" href="/tests/v7/Input/t90.abi" target="_blank">t90.abi</a></li>
</ul>
</details>
<p>The calculation of electron-phonon coupling quantities requires the presence
of all the perturbations (all atoms in all directions) for the chosen set of
(irreducible) q-points. To impose this and prevent ABINIT from using symmetry
to reduce the number of perturbations, set  <strong>prepgkk</strong>  to 1. Use in
conjunction with <a class="wikilink codevar-wikilink" href="/variables/files#prtgkk">prtgkk</a>.</p>
<h2 id="prtbbb"><strong>prtbbb</strong><a class="headerlink" href="#prtbbb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT Band-By-Band decomposition<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to tune the output of computed quantities" data-toggle="popover" href="/topics/Output">topic_Output</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaO crystal.
Computation of band-by-band decomposition of Born effective charges.
Also, computation of the electronic localization tensor,
and its band-by-band decomposition." data-toggle="popover" href="/tests/v3/Input/t77.abi" target="_blank">t77.abi</a></li>
</ul>
</details>
<p>If  <strong>prtbbb</strong>  is 1, print the band-by-band decomposition of Born effective
charges and localization tensor, in case they are computed. See <a class="wikilink citation-wikilink" data-tippy-content="Band-by-band decompositions of the Born effective charges" data-toggle="popover" href="/theory/bibliography#ghosez2000">[Ghosez2000]</a>.</p>
<h2 id="prtefmas"><strong>prtefmas</strong><a class="headerlink" href="#prtefmas" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRint EFfective MASs data<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas">efmas</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass." data-toggle="popover" href="/tests/v8/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CaO effective mass tensor at \Gamma and X. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
CaO polaron effective mass along different direction: 100,110,111.
Frohlich ZPR is also computed.
Method available only for cubic materials." data-toggle="popover" href="/tests/v9/Input/t66.abi" target="_blank">t66.abi</a></li>
</ul>
</details>
<p>If 1, at the end of an effective mass calculation (<a class="wikilink codevar-wikilink" href="/variables/dfpt#efmas">efmas</a> = 1), create a file *_EFMAS, that
contains the generalized second-order k-derivatives, see Eq.(66) in <a class="wikilink citation-wikilink" data-tippy-content="Precise effective masses from density functional perturbation theory" data-toggle="popover" href="/theory/bibliography#laflamme2016">[Laflamme2016]</a>,
in view of further processing.</p>
<h2 id="prtfull1wf"><strong>prtfull1wf</strong><a class="headerlink" href="#prtfull1wf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT FULL 1<sup>st</sup>-order WaveFunction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test printing out the full perturbed wavefunction" data-toggle="popover" href="/tests/v8/Input/t36.abi" target="_blank">t36.abi</a></li>
</ul>
</details>
<p>If set to 1, the output _1WF files will contain the full 1<sup>st</sup>-order wavefunctions, for both valence and conduction bands.
Otherwise, the _1WF files are not really 1<sup>st</sup>-order perturbed wavefunctions, but merely a set of perturbed wavefunctions that yield the correct perturbed density.
This is used when one expect to perform post-processing of the 1<sup>st</sup>-order wavefunctions.</p>
<h2 id="rf2_dkde"><strong>rf2_dkde</strong><a class="headerlink" href="#rf2_dkde" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function: mixed 2<sup>nd</sup> Derivative of wavefunctions with respect to K and electric field<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements.
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_6.abi" target="_blank">tnlo_6.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield)." data-toggle="popover" href="/tests/v8/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Test the polarized case (with a non-polarized system). Must give same results than t83.in" data-toggle="popover" href="/tests/v8/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t84.in" data-toggle="popover" href="/tests/v8/Input/t86.abi" target="_blank">t86.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Give same results than t83.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t87.abi" target="_blank">t87.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Give same results than t84.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Give same results than t84.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t89.abi" target="_blank">t89.abi</a></li>
</ul>
</details>
<p>If is equal to 1, activates computation of mixed second derivatives of wavefunctions with respect to
wavevector and electric field (ipert = natom+11 is activated). This is not strictly a response function
but is a needed auxiliary quantity in the calculations of 3<sup>rd</sup>-order derivatives of the energy
(non-linear response) if <a class="wikilink codevar-wikilink" href="/variables/dfpt#usepead">usepead</a> == 0. The directions for the derivatives are determined by
<a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_pert1_dir">rf2_pert1_dir</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_pert2_dir">rf2_pert2_dir</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#prepanl">prepanl</a> in the same way than <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkdk">rf2_dkdk</a>.</p>
<h2 id="rf2_dkdk"><strong>rf2_dkdk</strong><a class="headerlink" href="#rf2_dkdk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function: 2<sup>nd</sup> Derivative of wavefunctions with respect to K<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_1.abi" target="_blank">tlw_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Dynamic Quadrupoles Calculation for GaP" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_4.abi" target="_blank">tlw_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Natural optical activity of quartz" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_8.abi" target="_blank">tlw_8.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements.
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_6.abi" target="_blank">tnlo_6.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield)." data-toggle="popover" href="/tests/v8/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Test the polarized case (with a non-polarized system). Must give same results than t83.in" data-toggle="popover" href="/tests/v8/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t84.in" data-toggle="popover" href="/tests/v8/Input/t86.abi" target="_blank">t86.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Give same results than t83.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t87.abi" target="_blank">t87.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Give same results than t84.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Give same results than t84.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GGA Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Dynamic Quadrupoles Calculation for AlAs" data-toggle="popover" href="/tests/v9/Input/t145.abi" target="_blank">t145.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Antisymmetric vector potential response and quadrupoles of HF molecule" data-toggle="popover" href="/tests/v9/Input/t146.abi" target="_blank">t146.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Vector potential response and quadrupoles of HF molecule" data-toggle="popover" href="/tests/v9/Input/t147.abi" target="_blank">t147.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t148.abi" target="_blank">t148.abi</a></li>
</ul>
</details>
<p>If is equal to 1, activates computation of second derivatives of wavefunctions with respect to
wavevectors (ipert = natom+10 is activated). This is not strictly a response function but is a needed
auxiliary quantity in the calculations of 3<sup>rd</sup>-order derivatives of the energy
(non-linear response) if <a class="wikilink codevar-wikilink" href="/variables/dfpt#usepead">usepead</a> == 0. The directions for the derivatives are determined by
<a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_pert1_dir">rf2_pert1_dir</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_pert2_dir">rf2_pert2_dir</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#prepanl">prepanl</a> as the following:</p>
<p>The computation of the 2<sup>nd</sup> derivative of wavefunction with respect to &ldquo;lambda_1&rdquo; and &ldquo;lambda_2&rdquo; is computed if
if rf2_pert1_dir[idir1] AND rf2_pert2_dir[idir2] are equal to 1, where &ldquo;idir1&rdquo; (&ldquo;idir2&rdquo;) is direction of
the perturbation &ldquo;lambda_1&rdquo; (&ldquo;lambda_2&rdquo;).
If ALL directions are activated (default behavior) AND <a class="wikilink codevar-wikilink" href="/variables/dfpt#prepanl">prepanl</a> == 1, then the code automatically selects
only the directions that will be used by the non-linear routine (<a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5) using crystal symmetries.</p>
<p>Since v9.x this variable also activates the computation of the response to a vector potential
in the long-wavelength limit. At first order in the momentum, the perturbation and response can be split
into symmetric plus antisymmetric parts, see Refs. <a class="wikilink citation-wikilink" data-tippy-content="First-Principles Theory of Spatial Dispersion: Dynamical Quadrupoles and Flexoelectricity" data-toggle="popover" href="/theory/bibliography#royo2019">[Royo2019]</a> and <a class="wikilink citation-wikilink" data-tippy-content="Rotational $g$ factors and Lorentz forces of molecules and solids from density functional perturbation theory" data-toggle="popover" href="/theory/bibliography#zabalo2022">[Zabalo2022]</a>.
The symmetric part, activated with  <strong>rf2_dkdk</strong>  == 1, corresponds to the aforementioned second derivatives
of wavefunctions with respect to wavevectors. The antisymmetric part, activated with  <strong>rf2_dkdk</strong>  == 2,
gives the response to a uniform orbital magnetic field, as defined in Ref. <a class="wikilink citation-wikilink" data-tippy-content="Orbital magnetoelectric coupling in band insulators" data-toggle="popover" href="/theory/bibliography#essin2010">[Essin2010]</a>. The total,
symmetric plus antisymmetric, response is activated with  <strong>rf2_dkdk</strong>  == 3.</p>
<p>The response function to a long-wavelength vector potential is a crucial ingredient to compute some of the
spatial-dispersion quantities available in the longwave driver. In particular, those that involve the gradient of an
electric field: the clamped-ion flexoelectric tensor, the first moment of the polarization
response to an atomic displacement and the natural optical activity tensor.</p>
<h2 id="rf2_pert1_dir"><strong>rf2_pert1_dir</strong><a class="headerlink" href="#rf2_pert1_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function (2<sup>nd</sup> order Sternheimer equation): 1<sup>st</sup> PERTurbation DIRection<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [1, 1, 1]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GGA Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t46.abi" target="_blank">t46.abi</a></li>
</ul>
</details>
<p>Gives the directions of the 1<sup>st</sup> perturbation to be considered when solving the 2<sup>nd</sup> order Sternheimer equation.
The three elements corresponds to the three primitive vectors, either in real
space (phonon calculations), or in reciprocal space (<span><span class="MathJax_Preview">\,d/ \,d k</span><script type="math/tex">\,d/ \,d k</script></span>, homogeneous
electric field, homogeneous magnetic field calculations).
If equal to 1, the 2<sup>nd</sup> order wavefunctions, as defined by <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkdk">rf2_dkdk</a> or <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkde">rf2_dkde</a>, are computed for the
corresponding direction. If 0, this direction is not considered.
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkdk">rf2_dkdk</a> for more details.</p>
<h2 id="rf2_pert2_dir"><strong>rf2_pert2_dir</strong><a class="headerlink" href="#rf2_pert2_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function (2<sup>nd</sup> order Sternheimer equation): 2<sup>nd</sup> PERTurbation DIRection<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [1, 1, 1]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GGA Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t46.abi" target="_blank">t46.abi</a></li>
</ul>
</details>
<p>Gives the directions of the 2<sup>nd</sup> perturbation to be considered when solving the 2<sup>nd</sup> order Sternheimer equation.
The three elements corresponds to the three primitive vectors, either in real
space (phonon calculations), or in reciprocal space (<span><span class="MathJax_Preview">\,d/ \,d k</span><script type="math/tex">\,d/ \,d k</script></span>, homogeneous
electric field, homogeneous magnetic field calculations).
If equal to 1, the 2<sup>nd</sup> order wavefunctions, as defined by <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkdk">rf2_dkdk</a> or <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkde">rf2_dkde</a>, are computed for the
corresponding direction. If 0, this direction is not considered.
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkdk">rf2_dkdk</a> for more details.</p>
<h2 id="rfatpol"><strong>rfatpol</strong><a class="headerlink" href="#rfatpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function: ATomic POLarisation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute elastic, piezoelectric and internal strain tensors from DFPT" data-toggle="popover" href="/topics/Elastic">topic_Elastic</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, &lsquo;<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>&rsquo;]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [81/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of various XC functionals for the response functions
(thus, the XC kernel is also tested).
The test includes 3 different functionals:
1) Perdew-Zunger: ixc=2 and ixc=-001009
2) PBE: ixc=11 and ixc=-101130
3) Perdew-Wang92: ixc=7, ixc=-001012, and ixc=-001013
The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent
unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting
some lines indicated by GMR.
Note that the underlying FFT grid does not have the symmetry of the
lattice." data-toggle="popover" href="/tests/libxc/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of the Perdew-Zunger XC functionals for the response functions
(thus, the XC kernel is also tested) in PAW." data-toggle="popover" href="/tests/libxc/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
CrystallIne AlAs
first three runs are for calculation of ground state at finite electric field
the fourth run gets the gs wavefunction and then do response calculation
the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-toggle="popover" href="/tests/seq/Input/tsv4_80.abi" target="_blank">tsv4_80.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Dynamic Quadrupoles Calculation for GaP" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_4.abi" target="_blank">tlw_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline AlAs : computation of the second derivative of the total energy" data-toggle="popover" href="/tests/tutorespfn/Input/trf1_3.abi" target="_blank">trf1_3.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
(see test.si.chain of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the the effect of the first-order Fermi energy on a Q=0
phonon calculation in metals.
The example is for a hypothetical intermetallic compound MgAl2,
in a structure which can be thought of as fcc Al with every third
(111) layer replaced by Mg.  Technically, this is the hexagonal
CdI2 structure, space group #164, P-3 m 1.  For this case, neglect
of this contribution yields approximately a 2% error in the largest
interatomic force constants.  Its effect on many force constants
for this system cancels because of symmetry.  This calculation
is not particularly well converged, especially with respect
to k sample.  A well-converged version is in excellent agreement
with interatomic force constants calculated by numerical
differentiation of ground-state forces." data-toggle="popover" href="/tests/v4/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PbFCl in the matlockite structure P4/nmm. 6 atoms per cell.
Compute a set of matrix elements of the dynamical matrix,
for q wavevector 0.5 0.5 0.5 .
In this test case, the symmetry operations have an important
non-symmorphic character. There was a bug in the treatment
of this material, prior to v5.2.4 ." data-toggle="popover" href="/tests/v5/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and Wu-Cohen GGA.
Similar to test v3#08
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.49410411 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.4945677  Ha
with delta(xred)=0.0001, 189.49422003  Ha .
Combining the results gives 189.4941041 Ha. Perfect !" data-toggle="popover" href="/tests/v5/Input/t29.abi" target="_blank">t29.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of phonons frequencies for metallic occupations at q=0 0 0 within PAW
O2 (nsppol=1); this test is directly inspired by test v3#75.
In datasets 1-3, one computes the total energy and forces, without symmetries,
as it should be for accurate finite-difference tests.
From the reduced gradients with respect to displacements, one can deduce
a 2DTE of 149.9614 Ha.
In dataset 4, RF is computed with the Fermi energy correction,
and the agreement with finite-differences of datasets 1 and 3
is good : one gets 149.9612 Ha.
In dataset 5, RF is computed with frozen Fermi energy and the disagreement with
finite-differences of datasets 1 and 3 is large: one gets 124.9787 Ha." data-toggle="popover" href="/tests/v6/Input/t89.abi" target="_blank">t89.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test printing out the full perturbed wavefunction" data-toggle="popover" href="/tests/v8/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFPT in non-collinear magnetism, atomic perturbation with ixcrot=1" data-toggle="popover" href="/tests/v8/Input/t78.abi" target="_blank">t78.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Dynamic Quadrupoles Calculation for AlAs" data-toggle="popover" href="/tests/v9/Input/t145.abi" target="_blank">t145.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Antisymmetric vector potential response and quadrupoles of HF molecule" data-toggle="popover" href="/tests/v9/Input/t146.abi" target="_blank">t146.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Vector potential response and quadrupoles of HF molecule" data-toggle="popover" href="/tests/v9/Input/t147.abi" target="_blank">t147.abi</a> &hellip;</li>
</ul>
</details>
<p>Control the range of atoms for which displacements will be considered in
phonon calculations (atomic polarizations).
These values are only relevant to phonon response function calculations.
May take values from 1 to <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, with  <strong>rfatpol</strong> (1)&lt;= <strong>rfatpol</strong> (2).
The atoms to be moved will be defined by the do-loop variable iatpol:</p>
<ul>
<li>do iatpol= <strong>rfatpol</strong> (1), <strong>rfatpol</strong> (2)</li>
</ul>
<p>For the calculation of a full dynamical matrix, use  <strong>rfatpol</strong> (1)=1 and
 <strong>rfatpol</strong> (2)=<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, together with <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> 1 1 1, both being the default values.
For selected
elements of the dynamical matrix, use different values of  <strong>rfatpol</strong>  and/or
<a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a>. The name &lsquo;iatpol&rsquo; is used for the part of the internal variable
ipert when it runs from 1 to <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>. The internal variable ipert can also
assume values larger than <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, denoting perturbations of electric field
or stress type (see <a href="/guide/respfn">the DFPT help file</a>).</p>
<p>As a side technical information, the value  <strong>rfatpol</strong> (1)=-1 is admitted, and transformed
immediately to  <strong>rfatpol</strong> (1)=1, while  <strong>rfatpol</strong> (2)=-1 is transformed to   <strong>rfatpol</strong> (2)=<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>,
while the default input values are actually  <strong>rfatpol</strong> =-1 .</p>
<h2 id="rfddk"><strong>rfddk</strong><a class="headerlink" href="#rfddk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to Derivative with respect to K<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [21/1245] in all abinit tests, [3/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (stresses), using GEMM nonlop.
Related tests: v8 t83 and gpu_omp t21 ." data-toggle="popover" href="/tests/gpu_omp/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear response calculation for AlP
Perturbation: atomic displacements, strains, electric fields
Finite difference calculation of the ddk" data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_2.abi" target="_blank">tpolarization_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Finite difference calculation of d chi / d tau of AlP" data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_5.abi" target="_blank">tnlo_5.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Compute DDK response in PAW formalism for two different but equivalent input
variables: rfddk 1, rfelfd 2" data-toggle="popover" href="/tests/v5/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield)." data-toggle="popover" href="/tests/v8/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP" data-toggle="popover" href="/tests/v9/Input/t140.abi" target="_blank">t140.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nspinor 2" data-toggle="popover" href="/tests/v9/Input/t141.abi" target="_blank">t141.abi</a> &hellip;</li>
</ul>
</details>
<p>Activates computation of derivatives of ground state wavefunctions with
respect to wavevectors. This is not strictly a response function but is a
needed auxiliary quantity in the electric field calculations (see <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a>) and orbital magnetism calculations
(see <a class="wikilink codevar-wikilink" href="/variables/dfpt#orbmag">orbmag</a>).
The directions for the derivatives are determined by <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a>.</p>
<ul>
<li>0 &rarr; no derivative calculation</li>
<li>1 &rarr; calculation of first derivatives of wavefunctions with respect to k points (<span><span class="MathJax_Preview">\,d/ \,d k</span><script type="math/tex">\,d/ \,d k</script></span> calculation).
    The exact same functionality is provided by <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> = 2.</li>
</ul>
<h2 id="rfdir"><strong>rfdir</strong><a class="headerlink" href="#rfdir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function: DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute elastic, piezoelectric and internal strain tensors from DFPT" data-toggle="popover" href="/topics/Elastic">topic_Elastic</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [1, 1, 1]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [172/1245] in all abinit tests, [9/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of various XC functionals for the response functions
(thus, the XC kernel is also tested).
The test includes 3 different functionals:
1) Perdew-Zunger: ixc=2 and ixc=-001009
2) PBE: ixc=11 and ixc=-101130
3) Perdew-Wang92: ixc=7, ixc=-001012, and ixc=-001013
The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent
unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting
some lines indicated by GMR.
Note that the underlying FFT grid does not have the symmetry of the
lattice." data-toggle="popover" href="/tests/libxc/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of the Perdew-Zunger XC functionals for the response functions
(thus, the XC kernel is also tested) in PAW." data-toggle="popover" href="/tests/libxc/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GaAs linear response with NC. Test the parallelisation on perturbations" data-toggle="popover" href="/tests/mpiio/Input/t69.abi" target="_blank">t69.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant by two different techniques" data-toggle="popover" href="/tests/seq/Input/tsv3_05.abi" target="_blank">tsv3_05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, rhombohedral.
Test finite electric field
Check the corectness of the symmetry operations with non-zero tnons." data-toggle="popover" href="/tests/seq/Input/tsv4_55.abi" target="_blank">tsv4_55.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlP in hypothetical wurzite (hexagonal) structure
Alternative response function calculation for some rigid-atom
piezoelectric tensor elements." data-toggle="popover" href="/tests/tutorespfn/Input/telast_5.abi" target="_blank">telast_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Al fcc metal - elastic constant calculation" data-toggle="popover" href="/tests/tutorespfn/Input/telast_6.abi" target="_blank">telast_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
(see test.si.chain of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. Generate the data for optic (linear and non-linear coefficients).
to be analysed in the test 57." data-toggle="popover" href="/tests/v4/Input/t56.abi" target="_blank">t56.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation with the GGA
Note that this test and the following one, 59,
address more advanced features of strain perturbation than the ones
going with number 60 to 79, and were developed later, but were
placed here for convenience).
AlAs in the zincblende structure, with a choice of
pseudopotenials that include model core charges.  In the LDA, the
strain perturbation simply introduces perturbing charge densities
leading to perturbing first-order potentials in a straightforward
manner.  (This perturbation does act differently on the valence
and model core charges.)   The GGA is a non-trivial extension,
since strain perturbs the gradient operator itself.  This test
is a symmetrized and stripped-down version of a test case used in
development which yielded agreement between such RF calculations
and numerical derivatives of GS stresses and forces to 1.e-8 to
1.e-9 atomic units for the elastic tensor and intenal strain
coupling parameters.  Acheiving this agreement does require forcing
a considerably more dense fft grid than the default which is
accepted here. (ngfft= 50 50 50 was used.)  While only the PBE GGA
is tested here, all forms present in Abinit should give comparably
accurate results." data-toggle="popover" href="/tests/v4/Input/t58.abi" target="_blank">t58.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbFCl in the matlockite structure P4/nmm. 6 atoms per cell.
Compute a set of matrix elements of the dynamical matrix,
for q wavevector 0.5 0.5 0.5 .
In this test case, the symmetry operations have an important
non-symmorphic character. There was a bug in the treatment
of this material, prior to v5.2.4 ." data-toggle="popover" href="/tests/v5/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbTe in rocksalt structure
Test the computation of phonons, dielectric tensor and Born effective
charges, with and without spin-obit coupling.
BUG : even without spin-orbit coupling, with ngkpt 2 2 2
the Born effective charges are not symmetric, why ??
BUG : even with only Gamma point, the dynamical matrix is not symmetric :
3    2   1    1        -0.0488343140         0.0000000000" data-toggle="popover" href="/tests/v5/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl molecule in a big box.
Test of the computation of the polarisation with the routine berryphase_new,
for different k-point grids : only 1 k-point, a line of k-points, and a full mesh of k-points.
Results with acell 20 10 10 are : -9.727 C/m^2, -9.975 C/m^2, -9.503 C/m^2
multiplied by the volume (in a.u.), gives -19454, -19950, -19006
Test provided by S. Leroux
Going to bigger cells make these results converge to the same value :
Results with acell 30 20 20 are : -1.771 C/m^2, -1.746 C/m^2, -1.747 C/m^2
multiplied by the volume (in a.u.), gives -21252, -20952, -20964
Results with acell 40 20 20 are : -1.3167C/m^2, -1.3057C/m^2, -1.3062C/m^2
multiplied by the volume (in a.u.), gives -21067, -20891, -20899
Results with acell 50 20 20 are : -1.0502C/m^2, -1.0444C/m^2, -1.0450C/m^2
multiplied by the volume (in a.u.), gives -21004, -20888, -20900" data-toggle="popover" href="/tests/v6/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of berrystep
Al-As cristal, zinc-blende structure
Compute the polarization along strings
of k-points parallel to the primitive vectors of the reciprocal
lattice, and using multiple step berry phase calculation.
(Tests 21-30 are related to geometry optimization, molecular dynamics, etc)

Cannot be executed in parallel:
chkint_prt: ERROR -
Context : the value of the variable nproc is 2.
The value of the input variable berrystep is 5, while it must be
equal to 1" data-toggle="popover" href="/tests/v6/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite differences (contributed by J. Zwanziger, adapted from efield tutorial).

MG: Very problematic in parallel (run get stuck!)" data-toggle="popover" href="/tests/v6/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of optic with temperature-dependent renormalization
WARNING: This feature is still under testing, files and variables could change in the next versions" data-toggle="popover" href="/tests/v67mbpt/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silicon, DDK computation to prepare &#x27;optic&#x27;" data-toggle="popover" href="/tests/v7/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant with a scissor .
Note that the fulfilment of the charge neutrality sum rule, already broken without a scissor operator, is
strongly affected by a scissor" data-toggle="popover" href="/tests/v7/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/v8/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test printing out the full perturbed wavefunction" data-toggle="popover" href="/tests/v8/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field.
First, ground state wf is computed, then dfpt calculation." data-toggle="popover" href="/tests/v8/Input/t66.abi" target="_blank">t66.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 06 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 08 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. PAW. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 10 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the directions to be considered for response function calculations (also
for the Berry phase computation of the polarization, see the <a class="wikilink codevar-wikilink" href="/variables/ffield#berryopt">berryopt</a>
input variable).
The three elements corresponds to the three primitive vectors, either in real
space (phonon calculations), or in reciprocal space (<span><span class="MathJax_Preview">\,d/ \,d k</span><script type="math/tex">\,d/ \,d k</script></span>, homogeneous
electric field, homogeneous magnetic field calculations). So, they generate a
basis for the generation of the dynamical matrix or the macroscopic dielectric
tensor or magnetic susceptibility and magnetic shielding, or the effective charge tensors.
If equal to 1, response functions, as defined by  <strong>rfdir</strong> , <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfddk">rfddk</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a>,
<a class="wikilink codevar-wikilink" href="/variables/dfpt#rfphon">rfphon</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfmagn">rfmagn</a>, <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a>, and possibly other response-function activating
input variables, but also <a class="wikilink codevar-wikilink" href="/variables/ffield#berryopt">berryopt</a> are to be computed for the
corresponding direction. If 0, this direction should not be considered.</p>
<h2 id="rfelfd"><strong>rfelfd</strong><a class="headerlink" href="#rfelfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to the ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform an effective mass calculation" data-toggle="popover" href="/topics/EffectiveMass">topic_EffectiveMass</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [117/1245] in all abinit tests, [15/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of various XC functionals for the response functions
(thus, the XC kernel is also tested).
The test includes 3 different functionals:
1) Perdew-Zunger: ixc=2 and ixc=-001009
2) PBE: ixc=11 and ixc=-101130
3) Perdew-Wang92: ixc=7, ixc=-001012, and ixc=-001013
The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent
unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting
some lines indicated by GMR.
Note that the underlying FFT grid does not have the symmetry of the
lattice." data-toggle="popover" href="/tests/libxc/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of the Perdew-Zunger XC functionals for the response functions
(thus, the XC kernel is also tested) in PAW." data-toggle="popover" href="/tests/libxc/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GaAs linear response with NC. Test the parallelisation on perturbations" data-toggle="popover" href="/tests/mpiio/Input/t69.abi" target="_blank">t69.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs in zinc-blende structure; GS and RF calculation
(similar to test v2 #30, except that only two q points are
considered) the 5-th dataset compute 3DTE.
localrdwf=1
Also check parallelism for Raman calculations." data-toggle="popover" href="/tests/paral/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant by two different techniques" data-toggle="popover" href="/tests/seq/Input/tsv3_05.abi" target="_blank">tsv3_05.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlP in hypothetical wurzite (hexagonal) structure
Response function calculation for:
* rigid-atom elastic tensor
* rigid-atom piezoelectric tensor
* interatomic force constants at gamma
* Born effective charges" data-toggle="popover" href="/tests/tutorespfn/Input/telast_2.abi" target="_blank">telast_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
the sequence of datasets makes the ground states and
all of the explicit perturbations of the single
Al atom in all directions, for the irreducible
qpoints in a 2x2x2 grid.
Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_1.abi" target="_blank">teph_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparatory steps for computing phonon-limited mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_1.abi" target="_blank">teph4mob_1.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivatives of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector, as well as to an homogeneous
electric field. The computed derivatives include the
mixed derivative wrt the two perturbations.
(see test.si.elfd of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si crystal (diamond structure), 2 atoms per unit cell.
Computation of responses to atomic displacements
and homogeneous electric field at Gamma,
giving access to the dynamical matrix at q(0 0 0), including
its non-analytical behaviour (effective charges
do not vanish completely due to lack of convergence),
the associated phonon frequencies, and the macroscopic
dielectric constant.
(see test.si.gamma of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for GaAs (zinc-blende).
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 32. The chosen grid (too coarse, though) has only two
special q points : 1/4 1/4 1/4 and 1/4 1/2 1/2 (in reduced coordinates).
The Gamma point is also needed, especially for the computation of
dielectric matric and effective charges, needed to get the asymptotic
behaviour of the interatomic force constants. To generate
the different responses, the following steps are followed,
with each of them corresponding to a different dataset (the multi-dataset
mode allows to have only one input file) :
1) ground state calculation, with a k-point sampling in the irreducible
Brillouin zone only;
2) using the density of 1), computation of the wavefunctions for the
grid of k-points in the full Brillouin zone; (not really needed in v3.0)
3) computation of the ddk response, in preparation to the electric field
response ;
4) computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
5) using the density of 1), computation of the GS wavefunctions
at k+q where q is 1/4 1/4 1/4 ;
6) computation of the dynamical matrix at 1/4 1/4 1/4 ;
7) using the density of 1), computation of the GS wavefunctions
at k+q where q is 1/4 1/2 1/2 ;
8) computation of the dynamical matrix at 1/4 1/2 1/2 ." data-toggle="popover" href="/tests/v2/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Yb (1 atom per unit cell),
using a l=3 psp with s local part.
Crazy cut-off and number of k points.
Shows that the derivative of the eigenenergies
with respect to the wavevector can be obtained
both by finite differences and analytical means
(from a preliminary computation in the
treatment of the ddk perturbation).
For the (0.25,0.25,0.25) k point,
the tenth band eigenvalue is -3.01209 eV.
Going to the (0.251,0.251,0.251) k point
it becomes -3.00562 eV, with finite-difference
estimation of the derivative with respect
to ONE wavevector change (all three
components changed) being 0.00647 eV/0.001/3=2.157 eV
This value is unchanged when using the
data at the (0.253,0.253,0.253) k point.
The analytical value is 2.15566 eV." data-toggle="popover" href="/tests/v3/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si crystal. GGA + non-linear XC core correction.
Compute the interatomic force constant for the displacement of the second atom along (111).
RF calculation of the 2DTE gives 7.51663417 Ha
while finite differences gives: with delta(xred)=0.0001, 7.15663267 Ha.
The agreement is quite good, and might likely be improved by combining finite differences.
Also compute the ddk and electric field responses. The number of k points is much too small to
obtain physical values, but are quite comparable to the result of test v2 #6" data-toggle="popover" href="/tests/v3/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BaO crystal.
Computation of band-by-band decomposition of Born effective charges.
Also, computation of the electronic localization tensor,
and its band-by-band decomposition." data-toggle="popover" href="/tests/v3/Input/t77.abi" target="_blank">t77.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. Generate the data for optic (linear and non-linear coefficients).
to be analysed in the test 57." data-toggle="popover" href="/tests/v4/Input/t56.abi" target="_blank">t56.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-toggle="popover" href="/tests/v5/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GeTe in rhombohedral structure
Test the computation of phonons, dielectric tensor and Born effective
charges, with and without spin-orbit coupling." data-toggle="popover" href="/tests/v5/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by tutorespfn/trf2 tutorial.
Ground state is computed.
DDK is computed.
Dielectric tensor is computed.
Phonon modes at q=0 are computed.
Phonons modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/v6/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized.
However nsppol=2 for testing purposes.
Over 1200 WARNINGS.
This test must give the same results of the test 64
non-linear response with nsppol=1 does not support MPI with nprocs &gt; 1" data-toggle="popover" href="/tests/v6/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized
Over 1200 WARNINGS.
This test must give the same results of the test 63" data-toggle="popover" href="/tests/v6/Input/t64.abi" target="_blank">t64.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of optic with temperature-dependent renormalization
WARNING: This feature is still under testing, files and variables could change in the next versions" data-toggle="popover" href="/tests/v67mbpt/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Silicon, DDK computation to prepare &#x27;optic&#x27;" data-toggle="popover" href="/tests/v7/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
20-electron PAW pseudo (4f in the core, but 4d10 as semi-core : 4d10 5s2 5p6 (5d0) 6s2 )
Test of computation of dielectric tensor, Born effective charges, dynamical matrix.
To keep the CPU time to a reasonable level, the responses are computed
with minimal parameters (nstep and the kpoint grid are too small,
ecut might be increased, and also pawecutdg).
Note: Charge neutrality is not achieved with the present dataset for Born Effective Charges,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 6 6 6,  ecut 40. pawecutdg 40.) gives Z(Eu)=2.5085, Z(O)=-2.4982" data-toggle="popover" href="/tests/v7/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant with a scissor .
Note that the fulfilment of the charge neutrality sum rule, already broken without a scissor operator, is
strongly affected by a scissor" data-toggle="popover" href="/tests/v7/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/v8/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 48, 49 and 50." data-toggle="popover" href="/tests/v8/Input/t47.abi" target="_blank">t47.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of phonons and response to electric field within PAW and GGA (both q=0 and q/=0)
Test on AlAs structure; Ground state, DDK and Dielectric tensor are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters (ngkpt, ecut and pawecutdg)." data-toggle="popover" href="/tests/v8/Input/t51.abi" target="_blank">t51.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 06 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 08 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. PAW. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 10 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
</ul>
</details>
<p>Turns on electric field response function calculations. Actually, such
calculations requires first the non-self-consistent calculation of derivatives
with respect to k, independently of the electric field perturbation itself.</p>
<ul>
<li>0 &rarr; no electric field perturbation</li>
<li>1 &rarr; full calculation, with first the derivative of ground-state wavefunction with respect to k (<span><span class="MathJax_Preview">\,d / \,d k</span><script type="math/tex">\,d / \,d k</script></span> calculation), by a non-self-consistent calculation, then the generation of the first-order response to an homogeneous electric field</li>
<li>2 &rarr; only the derivative of ground-state wavefunctions with respect to k</li>
<li>3 &rarr; only the generation of the first-order response to the electric field, assuming that the data on derivative of ground-state wavefunction with respect to k is available on disk.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because the tolerances to be used for derivatives or homogeneous
electric field are different, one often does the calculation of derivatives in
a separate dataset, followed by calculation of electric field response as well as phonon.
The options 2 and 3 proves useful in that context; also, in case a scissor
shift is to be used, it is usually not applied for the <span><span class="MathJax_Preview">\,d / \,d k</span><script type="math/tex">\,d / \,d k</script></span> response <a class="wikilink citation-wikilink" data-tippy-content="Linear Optical Response in Silicon and Germanium Including Self-Energy Effects" data-toggle="popover" href="/theory/bibliography#levine1989">[Levine1989]</a>).</p>
</div>
<h2 id="rfmagn"><strong>rfmagn</strong><a class="headerlink" href="#rfmagn" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to MAGNetic B-field perturbation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field.
First, ground state wf is computed, then dfpt calculation." data-toggle="popover" href="/tests/v8/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t70.abi" target="_blank">t70.abi</a></li>
</ul>
</details>
<p><strong>rfmagn</strong>  allows one to run response function calculations with respect to
external magnetic field if set to 1. Currently, orbital magnetism is not taken into
account and the perturbing potential has Zeeman form. For more details, see <a class="wikilink citation-wikilink" data-tippy-content="Density functional perturbation theory within noncollinear magnetism" data-toggle="popover" href="/theory/bibliography#ricci2019">[Ricci2019]</a>.</p>
<h2 id="rfmeth"><strong>rfmeth</strong><a class="headerlink" href="#rfmeth" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function METHod<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 8 of v3
but use the revPBE XC functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.66748730880 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.66799915 Ha
with delta(xred)=0.0001, 188.66761529 Ha .
Combining the results gives 188.66748734 Ha.
Excellent." data-toggle="popover" href="/tests/v3/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 8 of v3
but use the RPBE XC functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.92567363225 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.92618485 Ha
with delta(xred)=0.0001, 188.92580145 Ha
Combining the results gives 188.92567365 Ha
Excellent" data-toggle="popover" href="/tests/v3/Input/t71.abi" target="_blank">t71.abi</a></li>
</ul>
</details>
<p>Selects method used in response function calculations. Presently, only abs( <strong>rfmeth</strong> ) = 1 is
allowed. This corresponds to storing matrix elements of the 2DTE computed using non-stationary expressions,
instead of stationary ones.</p>
<p>The difference between positive and negative values is rather technical. Very often, the symmetries can be used in such a way that
some matrix elements can be proven to be zero even without doing any computation. Positive values of  <strong>rfmeth</strong>  activate
this use of symmetries, while it is denied when  <strong>rfmeth</strong>  is negative. There is an indirect additional outcome of this,
as a symmetrization of the whole 2DTE is sometimes rendered possible when the additional knowledge of the zero matrix elements
is available. Thus, the results obtained for positive and negative values of  <strong>rfmeth</strong>  might slightly differ for non-zero elements of the 2DTE,
if they are computed in both cases.</p>
<h2 id="rfphon"><strong>rfphon</strong><a class="headerlink" href="#rfphon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [197/1245] in all abinit tests, [19/159] in abinit tutorials</summary><ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of various XC functionals for the response functions
(thus, the XC kernel is also tested).
The test includes 3 different functionals:
1) Perdew-Zunger: ixc=2 and ixc=-001009
2) PBE: ixc=11 and ixc=-101130
3) Perdew-Wang92: ixc=7, ixc=-001012, and ixc=-001013
The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent
unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting
some lines indicated by GMR.
Note that the underlying FFT grid does not have the symmetry of the
lattice." data-toggle="popover" href="/tests/libxc/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of the Perdew-Zunger XC functionals for the response functions
(thus, the XC kernel is also tested) in PAW." data-toggle="popover" href="/tests/libxc/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, NC pseudopotentials.
Test the IO routines for a typical DFPT calculation" data-toggle="popover" href="/tests/mpiio/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
CrystallIne AlAs
first three runs are for calculation of ground state at finite electric field
the fourth run gets the gs wavefunction and then do response calculation
the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-toggle="popover" href="/tests/seq/Input/tsv4_80.abi" target="_blank">tsv4_80.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
(see test.si.chain of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the the effect of the first-order Fermi energy on a Q=0
phonon calculation in metals.
The example is for a hypothetical intermetallic compound MgAl2,
in a structure which can be thought of as fcc Al with every third
(111) layer replaced by Mg.  Technically, this is the hexagonal
CdI2 structure, space group #164, P-3 m 1.  For this case, neglect
of this contribution yields approximately a 2% error in the largest
interatomic force constants.  Its effect on many force constants
for this system cancels because of symmetry.  This calculation
is not particularly well converged, especially with respect
to k sample.  A well-converged version is in excellent agreement
with interatomic force constants calculated by numerical
differentiation of ground-state forces." data-toggle="popover" href="/tests/v4/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PbFCl in the matlockite structure P4/nmm. 6 atoms per cell.
Compute a set of matrix elements of the dynamical matrix,
for q wavevector 0.5 0.5 0.5 .
In this test case, the symmetry operations have an important
non-symmorphic character. There was a bug in the treatment
of this material, prior to v5.2.4 ." data-toggle="popover" href="/tests/v5/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-toggle="popover" href="/tests/v5/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GeTe in rhombohedral structure
Test the computation of phonons, dielectric tensor and Born effective
charges, with and without spin-orbit coupling." data-toggle="popover" href="/tests/v5/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through qptrlatt.
Otherwise, similar to Tv2#26 and Tv6#78." data-toggle="popover" href="/tests/v6/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZrO2 FCC (fluorite structure).
Compute the phonon frequencies at the X point.
This worked correctly before 5.2.4, but then, an erroneous bug fix (correcting v5#21) was introduced.
Final (correct) fixing in v6.0.4.
(Contributed by I. Lukacevic, trying to reproduce results by Detraux et al 1997)" data-toggle="popover" href="/tests/v6/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
Warning : only valid for Gamma, AND the temperature-dependent shifts must be averaged
over degenerate states." data-toggle="popover" href="/tests/v6/Input/t37.abi" target="_blank">t37.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
20-electron PAW pseudo (4f in the core, but 4d10 as semi-core : 4d10 5s2 5p6 (5d0) 6s2 )
Test of computation of dielectric tensor, Born effective charges, dynamical matrix.
To keep the CPU time to a reasonable level, the responses are computed
with minimal parameters (nstep and the kpoint grid are too small,
ecut might be increased, and also pawecutdg).
Note: Charge neutrality is not achieved with the present dataset for Born Effective Charges,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 6 6 6,  ecut 40. pawecutdg 40.) gives Z(Eu)=2.5085, Z(O)=-2.4982" data-toggle="popover" href="/tests/v7/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests uses psps8 files with model core charges and valence charge densities.
We test the initialization of rhor1, rhog1 from atomic quantities and the
treatment of the non-linear core correction in G-space (nc_xccc_gspace)." data-toggle="popover" href="/tests/v7/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/v8/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test printing out the full perturbed wavefunction" data-toggle="popover" href="/tests/v8/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparatory run for the calculation of the Fan-Migdal + Debye-Waller self-energy
C in diamond structure. Very rough 2x2x2 q-point grid (3 qpoints); low ecut." data-toggle="popover" href="/tests/v8/Input/t41.abi" target="_blank">t41.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q=0.5 .
Works with pseudo Pseudodojo_paw_pbe_standard/Fe.xml , where usexcnhat=0 . See test v9#42 for the usexcnhat==1 case." data-toggle="popover" href="/tests/v9/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/v9/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GGA Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
</ul>
</details>
<p>It must be equal to 1 to run phonon response function calculations.</p>
<h2 id="rfstrs"><strong>rfstrs</strong><a class="headerlink" href="#rfstrs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to STRainS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute elastic, piezoelectric and internal strain tensors from DFPT" data-toggle="popover" href="/topics/Elastic">topic_Elastic</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [30/1245] in all abinit tests, [7/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (stresses), using GEMM nonlop.
Related tests: v8 t83 and gpu_omp t21 ." data-toggle="popover" href="/tests/gpu_omp/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/paral/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/paral/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/paral/Input/t95.abi" target="_blank">t95.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlP in hypothetical wurzite (hexagonal) structure
Response function calculation for:
* rigid-atom elastic tensor
* rigid-atom piezoelectric tensor
* interatomic force constants at gamma
* Born effective charges" data-toggle="popover" href="/tests/tutorespfn/Input/telast_2.abi" target="_blank">telast_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlP in hypothetical wurzite (hexagonal) structure
Alternative response function calculation for some rigid-atom
piezoelectric tensor elements." data-toggle="popover" href="/tests/tutorespfn/Input/telast_5.abi" target="_blank">telast_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Al fcc metal - elastic constant calculation" data-toggle="popover" href="/tests/tutorespfn/Input/telast_6.abi" target="_blank">telast_6.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation with the GGA
Note that this test and the following one, 59,
address more advanced features of strain perturbation than the ones
going with number 60 to 79, and were developed later, but were
placed here for convenience).
AlAs in the zincblende structure, with a choice of
pseudopotenials that include model core charges.  In the LDA, the
strain perturbation simply introduces perturbing charge densities
leading to perturbing first-order potentials in a straightforward
manner.  (This perturbation does act differently on the valence
and model core charges.)   The GGA is a non-trivial extension,
since strain perturbs the gradient operator itself.  This test
is a symmetrized and stripped-down version of a test case used in
development which yielded agreement between such RF calculations
and numerical derivatives of GS stresses and forces to 1.e-8 to
1.e-9 atomic units for the elastic tensor and intenal strain
coupling parameters.  Acheiving this agreement does require forcing
a considerably more dense fft grid than the default which is
accepted here. (ngfft= 50 50 50 was used.)  While only the PBE GGA
is tested here, all forms present in Abinit should give comparably
accurate results." data-toggle="popover" href="/tests/v4/Input/t58.abi" target="_blank">t58.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation with GGA  and spin polarization
This is the same as t79, bcc Fe,
but with the PBE GGA.  This calculation is restricted to one
unaxial strain, which adequately tests the polarization-dependent
parts of the strain GGA code." data-toggle="popover" href="/tests/v4/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation.
Si in the usual diamond structrure using a Troullier-Martins
potential including a model core charge.  The datasets
include an initial ground state run, 2 pairs of 5 ground
state runs with incrementally strained lattice vectors rprim
(xx and yz strains -0.00004, -0.00002, 0, 0.00002, 0.00004),
and one response function run for the strain 2nd derivatives.
This set is illustrative of the kind of testing used extensively
in developing the strain perturbation portions of the code.
The numerical 2nd derivatives of the energy wrt strains were
computed by applying a 5-point derivative formula to ucvol*sigma(i,j),
where the sigmas are the stresses calculated in the series
of ground state calculations.  These agree with the analytic
2nd derivatives calculated in the response function run to ~1.E-7
for the data given here.  The cartesian internal strain (mixed
second derivative wrt strain and atomic coordinate) agrees to ~1E-8.
Note that such numerical tests of the internal strain are only valid
if the forces are zero (relaxed or by symmetry).  Otherwise, the
reduced-coordinate 2nd derivatives must be used for such tests
because the conversion to cartesian coordinates is itself strain-
dependent and will introduce changes in the computed derivatives.
In the actual development tests, stricter converence criteria were
used (tolvrs=1.E-24) as well as larger cutoffs, and agreement was
obtained at the 1.E-9 level.  The model core charge contributes the
largest component of the error.
ADDITIONAL NOTE :
It should be noted that numerical derivative tests of the internal
strain should be done by comparing the &quot;2nd-order matrix&quot; with numerical
strain derivatives of the gradients wrt reduced atomic coordinates.
These are not normally part of the GS output, but can be obtained by
uncommenting the DEBUG section at the end of prtxf.F90.
Comparisons between numerical strain derivatives of the cartesian
forces and the cartesian internal strain tensor will be incorrect
unless the coordinates have been relaxed and the forces are zero
within a tight tolerance." data-toggle="popover" href="/tests/v4/Input/t61.abi" target="_blank">t61.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
Finite-difference runs with strain component 1 (1def) is computed
DFPT is computed
Comparaison with Finite Diferrences give excellent agreement ~1e-5%
DFPT is computed with usexcnhat==0 (Just for test)" data-toggle="popover" href="/tests/v7/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
MG Note that this test fails with np=4, wrong results or SIGSEV (np=2 is ok).
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
Finite-difference runs with strain direction 1   is computed
Finite-difference runs with atom displacement 1  is computed
DFPT is computed
Comparaison with Finite Diferrences give excellent agreement
DFPT is computed with usexcnhat==0 (Just for test)" data-toggle="popover" href="/tests/v7/Input/t96.abi" target="_blank">t96.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of the elastic constants and internal strains for
distorded h-BN (to get non-zero internal strains)
vdW-DFT-D3 corrections with Becke-Jonhson damping (DFT-D3(BJ))
Only the pair-wise is computed (3-body term not implemented)
In this test the following properties are thus tested: contribution
to the energy and to the stress of DFT-D3(BJ) as well as
the contribution to the elastic constants and internal strains" data-toggle="popover" href="/tests/v7/Input/t99.abi" target="_blank">t99.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/v8/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GGA Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t148.abi" target="_blank">t148.abi</a> &hellip;</li>
</ul>
</details>
<p>Used to run strain response-function calculations (e.g. needed to get elastic
constants). Define, with <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a>, the set of perturbations.</p>
<ul>
<li>0 &rarr; no strain perturbation</li>
<li>1 &rarr; only uniaxial strain(s) (ipert=natom+3 is activated)</li>
<li>2 &rarr; only shear strain(s) (ipert=natom+4 is activated)</li>
<li>3 &rarr; both uniaxial and shear strain(s) (both ipert=natom+3 and ipert=natom+4 are activated)</li>
</ul>
<p>See the possible restrictions on the use of strain perturbations, in the <a class="wikilink user-guide-wikilink" href="/guide/respfn">respfn help file</a>.</p>
<h2 id="rfstrs_ref"><strong>rfstrs_ref</strong><a class="headerlink" href="#rfstrs_ref" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to STRainS with the energy REFerence at the average electrostatic potential<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute spatial dispersion properties with the longwave DFPT approach." data-toggle="popover" href="/topics/longwave">topic_longwave</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_1.abi" target="_blank">tlw_1.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GGA Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t148.abi" target="_blank">t148.abi</a></li>
</ul>
</details>
<p>If equal to 1 and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> /= 0 the strain response-function calculations are performed with the
reference energy placed at the average electrostatic potential. The later is the reference adopted
in the longwave driver. Since v9.x,  <strong>rfstrs_ref</strong>  = 1 is warned if <a class="wikilink codevar-wikilink" href="/variables/dfpt#prepalw">prepalw</a>/=0 because first-order
energies are no longer recomputed by the longwave driver but read from the precalculated 1WF files.</p>
<p>Strain first-order energies calculated with  <strong>rfstrs_ref</strong>  = 1 are useful, for instance,
in the calculation of absolute deformation potentials <a class="wikilink citation-wikilink" data-tippy-content="From flexoelectricity to absolute deformation potentials: The case ofSrTiO3" data-toggle="popover" href="/theory/bibliography#stengel2015">[Stengel2015]</a>.</p>
<h2 id="rfuser"><strong>rfuser</strong><a class="headerlink" href="#rfuser" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function, USER-defined<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1245] in all abinit tests, [0/159] in abinit tutorials</summary></details>
<p>Available to the developers, to activate the use of ipert=natom+6 and
ipert=natom+7, two sets of perturbations that the developers can define.</p>
<ul>
<li>0 &rarr; no computations for ipert=natom+6 or ipert=natom+7</li>
<li>1 &rarr; response with respect to perturbation natom+6 will be computed</li>
<li>2 &rarr; response with respect to perturbation natom+7 will be computed</li>
<li>3 &rarr; responses with respect to perturbations natom+6 and natom+7 will be computed</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In order to define and use correctly the new perturbations, the developer
might have to include code lines or additional routines at the level of the
following routines: dfpt_cgwf.F90, dfpt_dyout.F90, dfpt_symph.F90,
dfpt_dyout.F90, dfpt_etot.F90, littlegroup_pert.F90, dfpt_looppert.F90,
dfpt_mkcor.F90, dfpt_nstdy.F90, dfpt_nstwf.F90, respfn.F90, dfpt_scfcv.F90,
irreducible_set_pert.F90, dfpt_vloca.F90, dfpt_vtorho.F90, dfpt_vtowfk.F90. In
these routines, the developer should pay a particular attention to the rfpert
array, defined in the routine respfn (in m_respfn_driver.F90), as well as to the ipert local variable.</p>
</div>
<h2 id="smdelta"><strong>smdelta</strong><a class="headerlink" href="#smdelta" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SMeared DELTA function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="To to calculate the temperature dependence of the electronic structure" data-toggle="popover" href="/topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [26/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the electron-phonon band structure renormalisation for Diamond,
due to the phonon at the Gamma point.
The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the
HOMO shift at Gamma, while the finite-difference of phonon frequencies
gives 28.975 meV, in excellent agreement with frozen-phonon changes of HOMO eigenenergy.
The difference is due to the Non-Site-Diagonal Debye-Waller contribution, that
was explicitly obtained by a finite-difference approach." data-toggle="popover" href="/tests/paral/Input/t59.abi" target="_blank">t59.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of second order eigenvalues for two qpoints, (0 0 0)
and (1/2 0 0), contained in the EIGR2D files. Parameters are far from
convergence, nband=5 and nkpt=16." data-toggle="popover" href="/tests/v5/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
Warning : only valid for Gamma, AND the temperature-dependent shifts must be averaged
over degenerate states." data-toggle="popover" href="/tests/v6/Input/t37.abi" target="_blank">t37.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
For testing the electron-phonon modification of the electronic structure.
To be compared with the results of tests 51 to 59.
Use a 2x2x2 grid of k (shifted) and q (non-shifted) points.
No imaginary frequences for the phonons with this choice.
Computation of the electronic eigenvalues as well as phonon eigenfrequencies,
and corresponding ingredients for the computation of the electron-phonon effect, in the
next tests 51-53." data-toggle="popover" href="/tests/v6/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC conventional cell. Fake smooth pseudopotential.
For testing the electron-phonon modification of the electronic structure.
To be compared with the results of tests 50 to 59.
Use a FCC grid of k (shifted) and q (non-shifted) points.
No imaginary frequences for the phonons with this choice.
Computation of the electronic eigenvalues as well as phonon eigenfrequencies,
and corresponding ingredients for the computation of the electron-phonon effect, in the
next tests 55-57." data-toggle="popover" href="/tests/v6/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed." data-toggle="popover" href="/tests/v7/Input/t55.abi" target="_blank">t55.abi</a> &hellip;</li>
</ul>
</details>
<p>When  <strong>smdelta</strong>  in non-zero, it will trigger the calculation of the imaginary
part of the second-order electronic eigenvalues, which can be related to the
electronic lifetimes. The delta function is evaluated using:</p>
<ul>
<li>when  <strong>smdelta</strong>  == 1, Fermi-Dirac smearing: <span><span class="MathJax_Preview">\frac{0.25}{(cosh(\frac{x}{2.0}))^2}</span><script type="math/tex">\frac{0.25}{(cosh(\frac{x}{2.0}))^2}</script></span></li>
<li>when  <strong>smdelta</strong>  == 2, Cold smearing by Marzari using the parameter <span><span class="MathJax_Preview">a=-0.5634</span><script type="math/tex">a=-0.5634</script></span> (minimization of the bump): <span><span class="MathJax_Preview">\frac{e^{-x^2}}{\sqrt{\pi}}\left(1.5+x(-a\ 1.5+x(-1.0+a\ x))\right)</span><script type="math/tex">\frac{e^{-x^2}}{\sqrt{\pi}}\left(1.5+x(-a\ 1.5+x(-1.0+a\ x))\right)</script></span></li>
<li>when  <strong>smdelta</strong>  == 3, Cold smearing by Marzari using the parameter <span><span class="MathJax_Preview">a=-0.8165</span><script type="math/tex">a=-0.8165</script></span> (monotonic function in the tail): as 2 but different <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span></li>
<li>when  <strong>smdelta</strong>  == 4, Smearing of Methfessel and Paxton (<a class="wikilink citation-wikilink" data-tippy-content="High-precision sampling for Brillouin-zone integration in metals" data-toggle="popover" href="/theory/bibliography#methfessel1989">[Methfessel1989]</a>) with Hermite polynomial of degree 2, corresponding to &ldquo;Cold smearing&rdquo; of N. Marzari with <span><span class="MathJax_Preview">a=0</span><script type="math/tex">a=0</script></span> (so, same smeared delta function as smdelta=2, with different <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span>).</li>
<li>when  <strong>smdelta</strong>  == 5, Gaussian smearing: <span><span class="MathJax_Preview">\frac{e^{-x^2}}{\sqrt{\pi}}</span><script type="math/tex">\frac{e^{-x^2}}{\sqrt{\pi}}</script></span></li>
</ul>
<h2 id="td_maxene"><strong>td_maxene</strong><a class="headerlink" href="#td_maxene" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Time-Dependent dft: MAXimal kohn-sham ENErgy difference<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform time-dependent density-functional theory calculations of neutral excitation energies" data-toggle="popover" href="/topics/TDDFT">topic_TDDFT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Excited states of the Mg atom, with (ixc=1, spin-polarized Teter functional).
Use the multi-dataset mode.
Can be compared with the results in Vasiliev et al, PRL 82, 1919 (1999).
With the values acell 18, ecut 3.5, nband2 10, the present
test generates KS diff=3.46eV, TDLDA(1S1P)=4.48eV, TDLDA(1S3P)=2.81eV
With the values acell 22, ecut 3.5, nband2 22, ABINIT
generates KS diff=3.40eV , TDLDA(1S1P)=4.35eV, TDLDA(1S3P)=2.77eV
Vasiliev gets KS diff=3.39eV, TDLDA(1S1P)=4.34eV, TDLDA(1S3P)=2.79eV" data-toggle="popover" href="/tests/v1/Input/t69.abi" target="_blank">t69.abi</a></li>
</ul>
</details>
<p>The Matrix to be diagonalized in the Casida framework (see <a class="wikilink citation-wikilink" data-tippy-content="Time-Dependent Density Functional Response Theory for Molecules" data-toggle="popover" href="/theory/bibliography#casida1995">[Casida1995]</a>)
is a NxN matrix, where, by default, N is the product of the number of occupied
states by the number of unoccupied states. The input variable  <strong>td_maxene</strong> 
allows one to diminish N: it selects only the pairs of occupied and unoccupied
states for which the Kohn-Sham energy difference is less than  <strong>td_maxene</strong> .
The default value 0.0 means that all pairs are taken into account.
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#td_mexcit">td_mexcit</a> for an alternative way to decrease N.</p>
<h2 id="td_mexcit"><strong>td_mexcit</strong><a class="headerlink" href="#td_mexcit" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Time-Dependent dft: Maximal number of EXCITations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform time-dependent density-functional theory calculations of neutral excitation energies" data-toggle="popover" href="/topics/TDDFT">topic_TDDFT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Excited states of the Mg atom, with (ixc=1, spin-polarized Teter functional).
Use the multi-dataset mode.
Can be compared with the results in Vasiliev et al, PRL 82, 1919 (1999).
With the values acell 18, ecut 3.5, nband2 10, the present
test generates KS diff=3.46eV, TDLDA(1S1P)=4.48eV, TDLDA(1S3P)=2.81eV
With the values acell 22, ecut 3.5, nband2 22, ABINIT
generates KS diff=3.40eV , TDLDA(1S1P)=4.35eV, TDLDA(1S3P)=2.77eV
Vasiliev gets KS diff=3.39eV, TDLDA(1S1P)=4.34eV, TDLDA(1S3P)=2.79eV" data-toggle="popover" href="/tests/v1/Input/t69.abi" target="_blank">t69.abi</a></li>
</ul>
</details>
<p>The Matrix to be diagonalized in the Casida framework (see <a class="wikilink citation-wikilink" data-tippy-content="Time-Dependent Density Functional Response Theory for Molecules" data-toggle="popover" href="/theory/bibliography#casida1995">[Casida1995]</a>)
is a NxN matrix, where, by default, N is the product of the number of occupied
states by the number of unoccupied states. The input variable  <strong>td_mexcit</strong> 
allows one to diminish N: it selects the first  <strong>td_mexcit</strong>  pairs of occupied and
unoccupied states, ordered with respect to increasing Kohn-Sham energy difference.
However, when  <strong>td_mexcit</strong>  is zero, all pairs are allowed.
See <a class="wikilink codevar-wikilink" href="/variables/dfpt#td_maxene">td_maxene</a> for an alternative way to decrease N.</p>
<h2 id="tim1rev"><strong>tim1rev</strong><a class="headerlink" href="#tim1rev" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TIMe 1<sup>st</sup> order REVersal<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t70.abi" target="_blank">t70.abi</a></li>
</ul>
</details>
<p>Allowed values are 0 or 1.</p>
<p>If tim1rev is equal to 1, the Sternheimer equation is solved simultaneously at
+q and -q perturbation wavevectors. The first order potential at -q is taken
to be equal to the Hermitian conjugate of the first order potential at +q.
The wavefunctions from both +q and -q are then combined to generate the first order density.
Relevant in the case of magnetic field perturbation (but will be relevant also in case of non-zero frequency DFPT, when implemented).</p>
<h2 id="usepead"><strong>usepead</strong><a class="headerlink" href="#usepead" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE of PEAD formalism<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> == 5 (non-linear response computations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear and nonlinear response calculation for AlP
Perturbations: electric fields &amp; atomic displacements.
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_6.abi" target="_blank">tnlo_6.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield)." data-toggle="popover" href="/tests/v8/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Test the polarized case (with a non-polarized system). Must give same results than t83.in" data-toggle="popover" href="/tests/v8/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t84.in" data-toggle="popover" href="/tests/v8/Input/t86.abi" target="_blank">t86.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Give same results than t83.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t87.abi" target="_blank">t87.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Give same results than t84.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Give same results than t84.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t89.abi" target="_blank">t89.abi</a></li>
</ul>
</details>
<p>Determine which non-linear implementation is used. If  <strong>usepead</strong> =1, the Perturbation
Expansion After Discretization formalism is used, as in <a class="wikilink citation-wikilink" data-tippy-content="Nonlinear optical susceptibilities, Raman efficiencies, and electro-optic tensors from first-principles density functional perturbation theory" data-toggle="popover" href="/theory/bibliography#veithen2005">[Veithen2005]</a>.
In that method, the electric field is treated numerically, i.e the k-space
gradient operator appearing in the expression of the electric field potential
is discretized (see Eq.7 and 10 of <a class="wikilink citation-wikilink" data-tippy-content="Nonlinear optical susceptibilities, Raman efficiencies, and electro-optic tensors from first-principles density functional perturbation theory" data-toggle="popover" href="/theory/bibliography#veithen2005">[Veithen2005]</a>).
If  <strong>usepead</strong> =0, the electric field is treated analytically, leading to a better
k-points convergence. Furthermore, the current implementation is compatible with PAW
pseudopentials, while  <strong>usepead</strong> =1 is not. The drawback of the analytical method
is one has to solve a second order Sternheimer equation before actually computing
third derivatives of the energy, using <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkdk">rf2_dkdk</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rf2_dkde">rf2_dkde</a>.
This is not the most time-consumming part though.
Look at the inputs of related tests in the testsuite to see examples of the workflow.</p>
                
                  
                
              

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/"
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../paw/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              PAW
            </div>
          </div>
        </a>
      
      
        <a href="../rlx/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Relaxation
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version b'10.2.3-dirty'</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "b'10.2.3-dirty'"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>