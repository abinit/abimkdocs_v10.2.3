
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="anaddb input variables">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/variables/anaddb/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Anaddb - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#anaddb-input-variables" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Anaddb
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Variables
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorial/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        Abitk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_15" type="checkbox" id="__nav_1_15" >
      
      <label class="md-nav__link" for="__nav_1_15">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_15">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        AtomCentered
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        CalcUJ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        GWR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        Install
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        NMR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Anaddb
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Anaddb
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a2fsmear" class="md-nav__link">
    a2fsmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alphon" class="md-nav__link">
    alphon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#asr" class="md-nav__link">
    asr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#atifc" class="md-nav__link">
    atifc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#band_gap" class="md-nav__link">
    band_gap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brav" class="md-nav__link">
    brav
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chneut" class="md-nav__link">
    chneut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddb_filepath" class="md-nav__link">
    ddb_filepath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddk_filepath" class="md-nav__link">
    ddk_filepath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dieflag" class="md-nav__link">
    dieflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dipdip" class="md-nav__link">
    dipdip
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dipquad" class="md-nav__link">
    dipquad
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dos_maxmode" class="md-nav__link">
    dos_maxmode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dosdeltae" class="md-nav__link">
    dosdeltae
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dossmear" class="md-nav__link">
    dossmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dossum" class="md-nav__link">
    dossum
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dostol" class="md-nav__link">
    dostol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eivec" class="md-nav__link">
    eivec
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elaflag" class="md-nav__link">
    elaflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elph_fermie" class="md-nav__link">
    elph_fermie
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elphflag" class="md-nav__link">
    elphflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elphsmear" class="md-nav__link">
    elphsmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enunit" class="md-nav__link">
    enunit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_b_max" class="md-nav__link">
    ep_b_max
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_b_min" class="md-nav__link">
    ep_b_min
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_extrael" class="md-nav__link">
    ep_extrael
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_int_gkk" class="md-nav__link">
    ep_int_gkk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_keepbands" class="md-nav__link">
    ep_keepbands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_nqpt" class="md-nav__link">
    ep_nqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_nspline" class="md-nav__link">
    ep_nspline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_prt_yambo" class="md-nav__link">
    ep_prt_yambo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_qptlist" class="md-nav__link">
    ep_qptlist
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_scalprod" class="md-nav__link">
    ep_scalprod
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eph_prefix" class="md-nav__link">
    eph_prefix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flexoflag" class="md-nav__link">
    flexoflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freeze_displ" class="md-nav__link">
    freeze_displ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frmax" class="md-nav__link">
    frmax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frmin" class="md-nav__link">
    frmin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gkk_filepath" class="md-nav__link">
    gkk_filepath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gkqwrite" class="md-nav__link">
    gkqwrite
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gruns_ddbs" class="md-nav__link">
    gruns_ddbs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gruns_nddbs" class="md-nav__link">
    gruns_nddbs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iatfix" class="md-nav__link">
    iatfix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iatprj_bs" class="md-nav__link">
    iatprj_bs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ifcana" class="md-nav__link">
    ifcana
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ifcflag" class="md-nav__link">
    ifcflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ifcout" class="md-nav__link">
    ifcout
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ifltransport" class="md-nav__link">
    ifltransport
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instrflag" class="md-nav__link">
    instrflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#istrfix" class="md-nav__link">
    istrfix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptrlatt" class="md-nav__link">
    kptrlatt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptrlatt_fine" class="md-nav__link">
    kptrlatt_fine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_anchor_ibands" class="md-nav__link">
    lwf_anchor_ibands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_anchor_proj" class="md-nav__link">
    lwf_anchor_proj
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_anchor_qpt" class="md-nav__link">
    lwf_anchor_qpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_disentangle" class="md-nav__link">
    lwf_disentangle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_mu" class="md-nav__link">
    lwf_mu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_ngqpt" class="md-nav__link">
    lwf_ngqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_nwann" class="md-nav__link">
    lwf_nwann
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_projector" class="md-nav__link">
    lwf_projector
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_sigma" class="md-nav__link">
    lwf_sigma
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwfflag" class="md-nav__link">
    lwfflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mustar" class="md-nav__link">
    mustar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natfix" class="md-nav__link">
    natfix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natifc" class="md-nav__link">
    natifc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natprj_bs" class="md-nav__link">
    natprj_bs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nchan" class="md-nav__link">
    nchan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ndivsm" class="md-nav__link">
    ndivsm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfreq" class="md-nav__link">
    nfreq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ng2qpt" class="md-nav__link">
    ng2qpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngqpt" class="md-nav__link">
    ngqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngrids" class="md-nav__link">
    ngrids
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nlflag" class="md-nav__link">
    nlflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nph1l" class="md-nav__link">
    nph1l
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nph2l" class="md-nav__link">
    nph2l
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nqpath" class="md-nav__link">
    nqpath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nqshft" class="md-nav__link">
    nqshft
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nsphere" class="md-nav__link">
    nsphere
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nstrfix" class="md-nav__link">
    nstrfix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntemper" class="md-nav__link">
    ntemper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nwchan" class="md-nav__link">
    nwchan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outboltztrap" class="md-nav__link">
    outboltztrap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outdata_prefix" class="md-nav__link">
    outdata_prefix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output_file" class="md-nav__link">
    output_file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outscphon" class="md-nav__link">
    outscphon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#piezoflag" class="md-nav__link">
    piezoflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polflag" class="md-nav__link">
    polflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prt_ifc" class="md-nav__link">
    prt_ifc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtbltztrp" class="md-nav__link">
    prtbltztrp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtddb" class="md-nav__link">
    prtddb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtdos" class="md-nav__link">
    prtdos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtfsurf" class="md-nav__link">
    prtfsurf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtmbm" class="md-nav__link">
    prtmbm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtnest" class="md-nav__link">
    prtnest
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtphbands" class="md-nav__link">
    prtphbands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtsrlr" class="md-nav__link">
    prtsrlr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtvol" class="md-nav__link">
    prtvol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#q1shft" class="md-nav__link">
    q1shft
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#q2shft" class="md-nav__link">
    q2shft
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qgrid_type" class="md-nav__link">
    qgrid_type
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qpath" class="md-nav__link">
    qpath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qph1l" class="md-nav__link">
    qph1l
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qph2l" class="md-nav__link">
    qph2l
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qrefine" class="md-nav__link">
    qrefine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quadquad" class="md-nav__link">
    quadquad
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ramansr" class="md-nav__link">
    ramansr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relaxat" class="md-nav__link">
    relaxat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relaxstr" class="md-nav__link">
    relaxstr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfmeth" class="md-nav__link">
    rfmeth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rifcsph" class="md-nav__link">
    rifcsph
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selectz" class="md-nav__link">
    selectz
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symdynmat" class="md-nav__link">
    symdynmat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symgkq" class="md-nav__link">
    symgkq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#targetpol" class="md-nav__link">
    targetpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#telphint" class="md-nav__link">
    telphint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#temperinc" class="md-nav__link">
    temperinc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tempermin" class="md-nav__link">
    tempermin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thermal_supercell" class="md-nav__link">
    thermal_supercell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thmflag" class="md-nav__link">
    thmflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thmtol" class="md-nav__link">
    thmtol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use_k_fine" class="md-nav__link">
    use_k_fine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vs_qrad_tolkms" class="md-nav__link">
    vs_qrad_tolkms
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/basepar/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/ucalc_crpa/" class="md-nav__link">
        cRPA U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lruj/" class="md-nav__link">
        Linear Response U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr_intro/" class="md-nav__link">
        GWR_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr1/" class="md-nav__link">
        GWR1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lw_quad/" class="md-nav__link">
        quadrupoles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_tdep_legacy/" class="md-nav__link">
        eph_tdep_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        Troubleshooting (old-dokuwiki)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        Tuning (old-dokuwiki)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a2fsmear" class="md-nav__link">
    a2fsmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alphon" class="md-nav__link">
    alphon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#asr" class="md-nav__link">
    asr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#atifc" class="md-nav__link">
    atifc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#band_gap" class="md-nav__link">
    band_gap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brav" class="md-nav__link">
    brav
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chneut" class="md-nav__link">
    chneut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddb_filepath" class="md-nav__link">
    ddb_filepath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddk_filepath" class="md-nav__link">
    ddk_filepath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dieflag" class="md-nav__link">
    dieflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dipdip" class="md-nav__link">
    dipdip
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dipquad" class="md-nav__link">
    dipquad
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dos_maxmode" class="md-nav__link">
    dos_maxmode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dosdeltae" class="md-nav__link">
    dosdeltae
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dossmear" class="md-nav__link">
    dossmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dossum" class="md-nav__link">
    dossum
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dostol" class="md-nav__link">
    dostol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eivec" class="md-nav__link">
    eivec
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elaflag" class="md-nav__link">
    elaflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elph_fermie" class="md-nav__link">
    elph_fermie
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elphflag" class="md-nav__link">
    elphflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elphsmear" class="md-nav__link">
    elphsmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enunit" class="md-nav__link">
    enunit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_b_max" class="md-nav__link">
    ep_b_max
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_b_min" class="md-nav__link">
    ep_b_min
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_extrael" class="md-nav__link">
    ep_extrael
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_int_gkk" class="md-nav__link">
    ep_int_gkk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_keepbands" class="md-nav__link">
    ep_keepbands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_nqpt" class="md-nav__link">
    ep_nqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_nspline" class="md-nav__link">
    ep_nspline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_prt_yambo" class="md-nav__link">
    ep_prt_yambo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_qptlist" class="md-nav__link">
    ep_qptlist
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ep_scalprod" class="md-nav__link">
    ep_scalprod
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eph_prefix" class="md-nav__link">
    eph_prefix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flexoflag" class="md-nav__link">
    flexoflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freeze_displ" class="md-nav__link">
    freeze_displ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frmax" class="md-nav__link">
    frmax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frmin" class="md-nav__link">
    frmin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gkk_filepath" class="md-nav__link">
    gkk_filepath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gkqwrite" class="md-nav__link">
    gkqwrite
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gruns_ddbs" class="md-nav__link">
    gruns_ddbs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gruns_nddbs" class="md-nav__link">
    gruns_nddbs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iatfix" class="md-nav__link">
    iatfix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iatprj_bs" class="md-nav__link">
    iatprj_bs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ifcana" class="md-nav__link">
    ifcana
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ifcflag" class="md-nav__link">
    ifcflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ifcout" class="md-nav__link">
    ifcout
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ifltransport" class="md-nav__link">
    ifltransport
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instrflag" class="md-nav__link">
    instrflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#istrfix" class="md-nav__link">
    istrfix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptrlatt" class="md-nav__link">
    kptrlatt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptrlatt_fine" class="md-nav__link">
    kptrlatt_fine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_anchor_ibands" class="md-nav__link">
    lwf_anchor_ibands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_anchor_proj" class="md-nav__link">
    lwf_anchor_proj
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_anchor_qpt" class="md-nav__link">
    lwf_anchor_qpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_disentangle" class="md-nav__link">
    lwf_disentangle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_mu" class="md-nav__link">
    lwf_mu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_ngqpt" class="md-nav__link">
    lwf_ngqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_nwann" class="md-nav__link">
    lwf_nwann
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_projector" class="md-nav__link">
    lwf_projector
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwf_sigma" class="md-nav__link">
    lwf_sigma
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lwfflag" class="md-nav__link">
    lwfflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mustar" class="md-nav__link">
    mustar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natfix" class="md-nav__link">
    natfix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natifc" class="md-nav__link">
    natifc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natprj_bs" class="md-nav__link">
    natprj_bs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nchan" class="md-nav__link">
    nchan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ndivsm" class="md-nav__link">
    ndivsm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfreq" class="md-nav__link">
    nfreq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ng2qpt" class="md-nav__link">
    ng2qpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngqpt" class="md-nav__link">
    ngqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngrids" class="md-nav__link">
    ngrids
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nlflag" class="md-nav__link">
    nlflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nph1l" class="md-nav__link">
    nph1l
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nph2l" class="md-nav__link">
    nph2l
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nqpath" class="md-nav__link">
    nqpath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nqshft" class="md-nav__link">
    nqshft
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nsphere" class="md-nav__link">
    nsphere
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nstrfix" class="md-nav__link">
    nstrfix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntemper" class="md-nav__link">
    ntemper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nwchan" class="md-nav__link">
    nwchan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outboltztrap" class="md-nav__link">
    outboltztrap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outdata_prefix" class="md-nav__link">
    outdata_prefix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output_file" class="md-nav__link">
    output_file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outscphon" class="md-nav__link">
    outscphon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#piezoflag" class="md-nav__link">
    piezoflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polflag" class="md-nav__link">
    polflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prt_ifc" class="md-nav__link">
    prt_ifc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtbltztrp" class="md-nav__link">
    prtbltztrp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtddb" class="md-nav__link">
    prtddb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtdos" class="md-nav__link">
    prtdos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtfsurf" class="md-nav__link">
    prtfsurf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtmbm" class="md-nav__link">
    prtmbm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtnest" class="md-nav__link">
    prtnest
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtphbands" class="md-nav__link">
    prtphbands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtsrlr" class="md-nav__link">
    prtsrlr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtvol" class="md-nav__link">
    prtvol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#q1shft" class="md-nav__link">
    q1shft
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#q2shft" class="md-nav__link">
    q2shft
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qgrid_type" class="md-nav__link">
    qgrid_type
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qpath" class="md-nav__link">
    qpath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qph1l" class="md-nav__link">
    qph1l
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qph2l" class="md-nav__link">
    qph2l
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qrefine" class="md-nav__link">
    qrefine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quadquad" class="md-nav__link">
    quadquad
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ramansr" class="md-nav__link">
    ramansr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relaxat" class="md-nav__link">
    relaxat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relaxstr" class="md-nav__link">
    relaxstr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfmeth" class="md-nav__link">
    rfmeth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rifcsph" class="md-nav__link">
    rifcsph
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selectz" class="md-nav__link">
    selectz
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symdynmat" class="md-nav__link">
    symdynmat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symgkq" class="md-nav__link">
    symgkq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#targetpol" class="md-nav__link">
    targetpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#telphint" class="md-nav__link">
    telphint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#temperinc" class="md-nav__link">
    temperinc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tempermin" class="md-nav__link">
    tempermin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thermal_supercell" class="md-nav__link">
    thermal_supercell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thmflag" class="md-nav__link">
    thmflag
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thmtol" class="md-nav__link">
    thmtol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use_k_fine" class="md-nav__link">
    use_k_fine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vs_qrad_tolkms" class="md-nav__link">
    vs_qrad_tolkms
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/variables/anaddb.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->
<h1 id="anaddb-input-variables">anaddb input variables<a class="headerlink" href="#anaddb-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
anaddb input variables to be used in the input file for the anaddb executable.</p>
<h2 id="a2fsmear"><strong>a2fsmear</strong><a class="headerlink" href="#a2fsmear" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Alpha2F SMEARing factor<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2e-05<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: output auxiliary files and change default smearings" data-toggle="popover" href="/tests/v5/Input/t91.abi" target="_blank">t91.abi</a></li>
</ul>
</details>
<p>Smearing width for the Eliashberg <span><span class="MathJax_Preview">\alpha^2</span><script type="math/tex">\alpha^2</script></span>F function (similar to a phonon DOS),
which is sampled on a finite q and k grid. The Dirac delta functions in energy
are replaced by Gaussians of width <strong>a2fsmear</strong> (by default in Hartree).</p>
<h2 id="alphon"><strong>alphon</strong><a class="headerlink" href="#alphon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ALign PHONon mode eigendisplacements<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>In case <strong>alphon</strong> is set to 1, ANADDB will compute linear combinations of the
eigendisplacements of modes that are degenerate (twice or three times), in
order to align the mode effective charges along the cartesian axes. This
option is useful in the mode-by-mode decomposition of the electrooptic tensor,
and to compute the Raman susceptibilities of individual phonon modes. In case
of uniaxial crystals, the z-axis should be chosen along the optical axis.</p>
<h2 id="asr"><strong>asr</strong><a class="headerlink" href="#asr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Acoustic Sum Rule<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Comment:</em> was 0 before v5.3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [28/74] in all anaddb tests, [4/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB of test23. Uses asr=0.
If asr is set to 1, the results of test 18 are recovered.
The effect of asr choice is important in the case
of BaTiO3, with the pseudopotentials that were used,
see Ph. Ghosez&#x27;s thesis.
The option asr is shown to work on both Gamma and X points :
the correction is obtained at Gamma, and transferred to X.
Note that a DDB MUST include the Gamma point." data-toggle="popover" href="/tests/v2/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=3, 1D - rotational invariance for anaddb. This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=4, 0D - rotational invariance for anaddb. NOTE : This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon frequncies at Gamma. The selected DDB can raise an error for large tolsym in symanal, that is called for symmetry analysis at gamma." data-toggle="popover" href="/tests/v9/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a> &hellip;</li>
</ul>
</details>
<p>Governs the imposition of the Acoustic Sum Rule (ASR) in the ANADDB application.
Note that there is a similar input variable  <strong>asr</strong>  for ABINIT. </p>
<ul>
<li>0 &rarr; no ASR for interatomic force constants is imposed.</li>
<li>1 or 2 &rarr; the ASR for interatomic force constants is imposed by modifying
  the on-site interatomic force constants, in a symmetric way ( <strong>asr</strong> =2),
  or in the more general case, unconstrained way ( <strong>asr</strong> =1).</li>
</ul>
<p>More detailed explanations: the total energy should be invariant under
translation of the crystal as a whole. This would guarantee that the three
lowest phonon modes at Gamma have zero frequency (Acoustic Sum Rule - ASR).
Unfortunately, the way the DDB is generated (presence of a discrete grid of
points for the evaluation of the exchange-correlation potential and energy)
slightly breaks the translational invariance. Well, in some pathological
cases, the breaking can be rather important.</p>
<p>Two quantities are affected: the interatomic forces (or dynamical matrices),
and the effective charges. The ASR for the effective charges is called the
charge neutrality sum rule, and will be dealt with by the variable
<a class="wikilink codevar-wikilink" href="/variables/anaddb#chneut">chneut</a>. The ASR for the interatomic forces can be restored, by
modifying the interatomic force of the atom on itself, (called self-IFC), as
soon as the dynamical matrix at Gamma is known. This quantity should be equal
to minus the sum of all interatomic forces generated by all others atoms
(action-reaction law!), which is determined by the dynamical matrix at Gamma.</p>
<p>So, if <strong>asr</strong> is non-zero, the correction to the self-force will be
determined, and the self-force will be imposed to be consistent with the ASR.
This correction will work if IFCs are computed (<a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcflag">ifcflag</a>/=0), as
well as if the IFCs are not computed (<a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcflag">ifcflag</a>==0). In both cases,
the phonon frequencies might not be the same as the ones determined by the
output of abinit, RF case, unless the same values of asr and chneut are used,
if the IFCs are not computed. If you want to check that the DDB is correct, by
comparing phonon frequencies from abinit and anaddb, it is best to turn off both
<strong>asr</strong> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#chneut">chneut</a>.</p>
<p>Until now, we have not explained the difference between <strong>asr</strong> =1 and <strong>asr</strong>
=2. This is rather subtle. In some local low-symmetry cases (basically the
effective charges should be anisotropic), when the dipole-dipole contribution
is evaluated and subtracted, the ASR cannot be imposed without breaking the
symmetry of the on-site interatomic forces. That explains why two options are
given: the second case ( <strong>asr</strong> =2, sym) does not entirely impose the ASR,
but simply the part that keeps the on-site interatomic forces symmetric (which
means that the acoustic frequencies do not go to zero exactly), the first case
( <strong>asr</strong> =1, asym) imposes the ASR, but breaks the symmetry. <strong>asr</strong> =2 is to
be preferred for the analysis of the interatomic force constant in real space,
while <strong>asr</strong> =1 should be used to get the phonon band structure.</p>
<p>(NOTE: in order to confuse even more the situation, it seems that the acoustic
phonon frequencies generated by the code for both the sym and asym options are
exactly the same likely due to an extra symmetrisation in the
diagonalisation routine. Of course, when the matrix at Gamma has been
generated from IFCs coming from dynamical matrices none of which are Gamma,
the breaking of the ASR is rather severe. In order to clear the situation, one
should use a diagonalisation routine for non-hermitian matrices. 
).</p>
<h2 id="atifc"><strong>atifc</strong><a class="headerlink" href="#atifc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> AToms for IFC analysis<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/anaddb#natifc">natifc</a>)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [31/74] in all anaddb tests, [4/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for BaTiO3, same as test18, but IFCs are
obtained from a 2x2x2 non-shifted grid (referred to as M1
in the above-mentioned paper by Ghosez et al).
At q(1/8 1/8 1/8), the lowest frequency is  i 178.8 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Phonon band structure of Al, from DDB of test 78.
The parameters were really too low in test 78, so that some
phonon unstabilities are present close to Gamma.
Similar to Tv2#28" data-toggle="popover" href="/tests/v6/Input/t80.abi" target="_blank">t80.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Use output from t78 to test qrefine: trivially start with 1x1x1 q-point grid and add the 2x2x2
q-points after the method of Gaal Nagy. Not working yet." data-toggle="popover" href="/tests/v6/Input/t81.abi" target="_blank">t81.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
</ul>
</details>
<p>The actual numbers of the atoms for which the interatomic force constant have
to be written and eventually analysed.</p>
<p>WARNING: there will be an in-place change of meaning of atifc (this is
confusing, and should be taken away in one future version - sorry for this).</p>
<h2 id="band_gap"><strong>band_gap</strong><a class="headerlink" href="#band_gap" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BAND GAP<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 999.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>Allow setting the target band gap, in eV. (<a class="wikilink codevar-wikilink" href="/variables/anaddb#elphflag">elphflag</a>=1).</p>
<h2 id="brav"><strong>brav</strong><a class="headerlink" href="#brav" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BRAVais<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [49/74] in all anaddb tests, [7/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
IFCs are computed as in test 16, but by limiting artificially
the number of allowed interacting shells to 2. The total number
of atoms to be taken into account is 17 (1 for the shell 0,
4 for the shell 1, and 12 for the shell 2).
The frequencies at X and L points are again computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1)
in the above-mentioned paper. The number are close, with
small differences at the level of 0.001 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=3, 1D - rotational invariance for anaddb. This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction of electronic structure." data-toggle="popover" href="/tests/v7/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond structure.
Interpolation of the DDB from a 2x2x2 q-points grid
onto a 4x4x4 q-points grid using the interatomic force constants." data-toggle="popover" href="/tests/v8/Input/t64.abi" target="_blank">t64.abi</a> &hellip;</li>
</ul>
</details>
<p>Allows to specify the Bravais lattice of the crystal, in order to help to
generate a grid of special q points.</p>
<ul>
<li>1 &rarr; all the lattices (including FCC, BCC and hexagonal)</li>
<li>2 &rarr; specific for Face Centered lattices</li>
<li>3 &rarr; specific for Body Centered lattices</li>
<li>4 &rarr; specific for the Hexagonal lattice</li>
</ul>
<p>Note that in the latter case, the <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a> of the unit cell has to be</p>
<p>1.0 0.0 0.0
  -.5 sqrt(3)/2 0.0
  0.0 0.0 1.0</p>
<p>in order for the code to work properly.</p>
<p>Warning: the generation of q-points in anaddb is rather old-fashioned, and
should be replaced by routines used by the main abinit code.</p>
<p>Warning:
The value <strong>brav</strong> = -1 is also possible. It is used for backwards compatibility:
it corresponds to <strong>brav</strong> = 1, with the weights for the
interpolation of the phonon band structure determined by another (now obsolete) algorithm
than the default <strong>brav</strong> = 1 algorithm
based on Wigner-Seitz cells (new as v8.7). The default algorithm has a correct treatment of symmetries.</p>
<h2 id="chneut"><strong>chneut</strong><a class="headerlink" href="#chneut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CHarge NEUTrality treatment<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [42/74] in all anaddb tests, [6/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a simple DDB for quartz, but do not test interatomic
force constants (see test 15 for this). Compute phonon frequencies
at gamma with and without LO-TO splitting." data-toggle="popover" href="/tests/v2/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for ZrO2, containing only the dynamical
matrices at Gamma, X and L.
Generate the IFC using a rough sampling, based on Gamma and X
only, then produces the phonon band structure along Gamma-X,
as well as in L.
The degeneracies can be compared with those of
Detraux et al, Phys. Rev. Lett. 81, 3297 (1998).
The errors produced with this sampling are still large, as can be
judged from the comparison at L. The frequencies (in cm-1) from the DDB are
128.8 (2-deg), 271.4, 413.7 (2-deg), 518.2, 521.8 (2-deg), 598.1 ;
while from the IFCs, using the interpolation, they are
152.5 (2-deg), 290.8, 429.6 (2-deg), 434.6 (2-deg), 551.9, 576.0 .
The same DDB allows to generate a slightly better sampling, by using
nqshft=2 and two shifts (0.0 0.0 0.0) and (0.5 0.5 0.5).
In this case, the L point is used for the interpolation. The comparison
can be done at the level of the mid-point between Gamma and X :
from the GX grid, one gets
107.0 (2-deg), 260.3, 295.5 (2-deg), 394.3, 577.0 (2-deg), 682.1  ;
from the GXL grid, one gets
106.3 (2-deg), 262.6, 302.7 (2-deg), 403.8, 582.5 (2-deg), 684.2  ;
while directly from the ABINIT code, one gets
106.3 (2-deg), 270.0, 277.9 (2-deg), 443.2, 581.6 (2-deg), 681.6  .
This is not yet satisfactory.
More points are needed for better results, the next interesting grid
being obtained by changing ngqpt from 2 2 2 to 4 4 4 in the t22.in file.
Two additional dynamical matrices are then needed." data-toggle="popover" href="/tests/v2/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Use ANADDB to compute the polarization of the previous two tests in cartesian coordinates." data-toggle="popover" href="/tests/v4/Input/t74.abi" target="_blank">t74.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=3, 1D - rotational invariance for anaddb. This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=4, 0D - rotational invariance for anaddb. NOTE : This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t84.abi" target="_blank">t84.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Phonon band structure of Al, from DDB of test 78.
The parameters were really too low in test 78, so that some
phonon unstabilities are present close to Gamma.
Similar to Tv2#28" data-toggle="popover" href="/tests/v6/Input/t80.abi" target="_blank">t80.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 48, for the generation of
the nonlinear coefficients only." data-toggle="popover" href="/tests/v8/Input/t50.abi" target="_blank">t50.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon frequncies at Gamma. The selected DDB can raise an error for large tolsym in symanal, that is called for symmetry analysis at gamma." data-toggle="popover" href="/tests/v9/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a> &hellip;</li>
</ul>
</details>
<p>Set the treatment of the Charge Neutrality requirement for the effective charges in the ANADDB application.
Note that there is a similar input variable <a class="wikilink codevar-wikilink" href="/variables/dfpt#chneut">chneut</a> for ABINIT, however its default value is different..</p>
<ul>
<li><strong>chneut</strong>=0 &rarr; no charge neutrality for effective charges is imposed</li>
<li><strong>chneut</strong>=1 &rarr; the charge neutrality for effective charges is imposed by giving to each atom
    an equal portion of the missing charge. See Eq.(48) in <a class="wikilink citation-wikilink" data-tippy-content="Dynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory" data-toggle="popover" href="/theory/bibliography#gonze1997a">[Gonze1997a]</a>.</li>
<li><strong>chneut</strong>=2 &rarr; the charge neutrality for effective charges is imposed by giving to each atom a portion
    of the missing charge proportional to the screening charge already present.
    See Eq.(49) in <a class="wikilink citation-wikilink" data-tippy-content="Dynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory" data-toggle="popover" href="/theory/bibliography#gonze1997a">[Gonze1997a]</a>.</li>
</ul>
<p>More detailed explanation: the sum of the effective charges in the unit cell
should be equal to zero. It is not the case in the DDB, and this sum rule is
sometimes strongly violated. In particular, this will make the lowest
frequencies at Gamma non-zero. There is no &ldquo;best&rdquo; way of imposing the cherge neutrality on effective charges.</p>
<p>See also <a class="wikilink codevar-wikilink" href="/variables/anaddb#asr">asr@anaddb</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#asr">asr</a>.</p>
<h2 id="ddb_filepath"><strong>ddb_filepath</strong><a class="headerlink" href="#ddb_filepath" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DDB PATH<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> string<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [4/74] in all anaddb tests, [3/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="!Input file for the anaddb code. Analysis of the AlAs DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_4.abi" target="_blank">trf2_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the AlAs DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_5.abi" target="_blank">trf2_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a></li>
</ul>
</details>
<p>This variable specifies the input DDB file when anaddb is invoked with the new syntax:</p>
<div class="codehilite"><pre><span></span><code>anaddb t01.in &gt; log 2&gt; err
</code></pre></div>

<p>instead of the legacy mode based on the files file. Example:</p>
<div class="codehilite"><pre><span></span><code>ddb_filepath = &quot;out_DDB&quot;
</code></pre></div>

<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Shell variables e.g. $HOME or tilde syntax <code>~</code> for user home are not supported.</p>
</div>
<h2 id="ddk_filepath"><strong>ddk_filepath</strong><a class="headerlink" href="#ddk_filepath" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DDK PATH<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> string<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>This variable specifies the name of the input file from which the list of 3 files containing the matrix
elements of the velocity operator are obtained.</p>
<p>This option is needed when anaddb is invoked with the new syntax:</p>
<div class="codehilite"><pre><span></span><code>anaddb t01.in &gt; log 2&gt; err
</code></pre></div>

<p>instead of the legacy mode based on the files file.
This variable is optional and used for performing transport calculations with <a class="wikilink codevar-wikilink" href="/variables/anaddb#elphflag">elphflag@anaddb</a>.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code>ddk_filepath = &quot;t94.ddk&quot;
</code></pre></div>

<p>where t94.ddk contains the list of file names.</p>
<div class="codehilite"><pre><span></span><code>t90o_DS10_GKK4
t90o_DS10_GKK5
t90o_DS10_GKK6
</code></pre></div>

<h2 id="dieflag"><strong>dieflag</strong><a class="headerlink" href="#dieflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DIElectric FLAG<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [35/74] in all anaddb tests, [4/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a simple DDB for quartz, but do not test interatomic
force constants (see test 15 for this). Compute phonon frequencies
at gamma with and without LO-TO splitting." data-toggle="popover" href="/tests/v2/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for BaTiO3 (see also tests 19 and 20). Here,
no use of IFCs is done. Phonon frequencies at the
Gamma, X, M, R and along the Gamma-R line are obtained
directly from the DDB. They are to be compared
with the data in the TABLE II of Ghosez et al, Ferroelectrics,
206-207, 205 (1998), as well as FIGURE I.
At q(1/8 1/8 1/8), the lowest frequency is  i 136.7 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t18.abi" target="_blank">t18.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #67 ,which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to doc/theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t68.abi" target="_blank">t68.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 48, for the generation of
the nonlinear coefficients only." data-toggle="popover" href="/tests/v8/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Debye-Waller tensor." data-toggle="popover" href="/tests/v8/Input/t58.abi" target="_blank">t58.abi</a> &hellip;</li>
</ul>
</details>
<p>Frequency-dependent dielectric tensor flag.</p>
<ul>
<li>
<p>0 &rarr; No dielectric tensor is calculated.</p>
</li>
<li>
<p>1 &rarr; The frequency-dependent dielectric tensor is calculated.
  Requirements for preceding response-function DDB generation run: electric-field and full atomic-displacement responses.
  Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> = 1, 2, or 3 (preferably 3). Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> to do a full calculation of phonons at Q=0.
  The frequencies are defined by the <a class="wikilink codevar-wikilink" href="/variables/anaddb#nfreq">nfreq</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#frmin">frmin</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#frmax">frmax</a> variables.
  Also, the generalized Lyddane-Sachs-Teller relation will be used as an independent check of the dielectric tensor
  at zero frequency (this for the directions defined in the phonon list 2, see <a class="wikilink codevar-wikilink" href="/variables/anaddb#nph2l">nph2l</a>).</p>
</li>
<li>
<p>2 &rarr; Only the electronic dielectric tensor is calculated. It corresponds to a zero-frequency homogeneous field,
   with quenched atomic positions. For large band gap materials, this quantity is measurable because the
   highest phonon frequency is on the order of a few tenths of eV, and the band gap is larger than 5eV.
   Requirements for preceding response-function DDB generation: electric-field response.
   Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> = 1 or 3 (preferably 3). Note that the same information on the electronic dielectric tensor
   will be printed in the .out file of the <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> run.</p>
</li>
<li>
<p>3 &rarr; Compute and print the relaxed-ion dielectric tensor.
  Requirements for preceding response-function DDB generation run:
  electric-field and full atomic-displacement responses. Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> = 1, 2, or 3 (preferably 3).
  Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> to do a full calculation of phonons at Q=0
  (needed because the inverse of force-constant tensor is required). Furthermore, in the anaddb input file
  the variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#nph2l">nph2l</a> must be nonzero in order to initiate computation of atomic displacements.
  If only the dielectric response is needed it is sufficient to set <a class="wikilink codevar-wikilink" href="/variables/anaddb#nph2l">nph2l</a> to 1 and leave <a class="wikilink codevar-wikilink" href="/variables/anaddb#qph2l">qph2l</a>
  at its default value (the Gamma point). Note that the relaxed-ion dielectric tensor computed here can also be obtained
  as the zero-frequency limit of the frequency-dependent dielectric tensor using input variables <strong>dieflag</strong> =1 and <a class="wikilink codevar-wikilink" href="/variables/anaddb#frmin">frmin</a>=0.0.
  (The results obtained using these two approaches should agree to good numerical precision.)
  The ability to compute and print the static dielectric tensor here is provided for completeness
  and consistency with the other tensor quantities that are computed in this section of the code.</p>
</li>
<li>4 &rarr; Calculate dielectric tensor of both relaxed ion and free stress.
  We need information of internal strain and elastic tensor (relaxed ion) in this computation.
  So please set: <a class="wikilink codevar-wikilink" href="/variables/anaddb#elaflag">elaflag</a>=2,3,4 or 5 and <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a>=1</li>
</ul>
<h2 id="dipdip"><strong>dipdip</strong><a class="headerlink" href="#dipdip" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DIPole-DIPole interaction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [56/74] in all anaddb tests, [8/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
IFCs are computed as in test 16, but by limiting artificially
the number of allowed interacting shells to 2. The total number
of atoms to be taken into account is 17 (1 for the shell 0,
4 for the shell 1, and 12 for the shell 2).
The frequencies at X and L points are again computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1)
in the above-mentioned paper. The number are close, with
small differences at the level of 0.001 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction of electronic structure." data-toggle="popover" href="/tests/v7/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon frequncies at Gamma. The selected DDB can raise an error for large tolsym in symanal, that is called for symmetry analysis at gamma." data-toggle="popover" href="/tests/v9/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test whether one can read a DDB with the dynamical quadrupole section that is not the last block.
The order of the blocks indeed depend on the list of files passed to mrgddb and the internal implementation
should not assume any particular order" data-toggle="popover" href="/tests/v9/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a> &hellip;</li>
</ul>
</details>
<ul>
<li>
<p>0 &rarr; the dipole-dipole interaction is not handled separately in the treatment of the interatomic forces.
    This option is available for testing purposes or if effective charge and/or dielectric tensor are not available
    in the DDB file. In semiconductors, this option  gives results much less accurate than <strong>dipdip</strong> = 1.
    Using this value in metals is fine since the interatomic forces are usually short-ranged.</p>
</li>
<li>
<p>1 &rarr; the dipole-dipole interaction is subtracted from the dynamical matrices before Fourier transform,
    so that only the short-range part is handled in real space. Of course, it is reintroduced analytically
    when the phonon spectrum is interpolated, or if the interatomic force constants have to be analysed in real space.
    Note that the Ewald contribution to the dynamical matrix consists of two terms: a G-space sum and
    and another (expensive) sum in R-space.
    See <a class="wikilink citation-wikilink" data-tippy-content="Dynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory" data-toggle="popover" href="/theory/bibliography#gonze1997a">[Gonze1997a]</a>, equations (71) to (75).
    This approach is very accurate but the computation of the R-space sum is rather expensive, especially
    when one has to interpolate many q-points e.g. for PHDOS computations.
    See dipdip -1 option below for a faster algorithm.</p>
</li>
<li>
<p>-1 &rarr; Similar to +1 with the difference that the code computes a material-dependent width for
    the Gaussians that will hopefully make the Ewald real-space summation unnecessary.
    This option is <strong>much faster</strong> that dipdip 1 and is activated by default when
    <a class="wikilink codevar-wikilink" href="/variables/anaddb#dipquad">dipquad</a> or <a class="wikilink codevar-wikilink" href="/variables/anaddb#quadquad">quadquad</a> are set to 1.
    It is recommended to check that calculations with dipdip = 1 and -1 (both with dipquad = 0 and quadquad = 0)
    lead to identical results. Otherwise increase the resolution of the q-point grid and repeat this test.</p>
</li>
</ul>
<h2 id="dipquad"><strong>dipquad</strong><a class="headerlink" href="#dipquad" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DIPole-QUADdrupole interaction<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute spatial dispersion properties with the longwave DFPT approach." data-toggle="popover" href="/topics/longwave">topic_longwave</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [4/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code with dipole-quadrupole and quadrupole-quadrupole interactions." data-toggle="popover" href="/tests/tutorespfn/Input/tlw_6.abi" target="_blank">tlw_6.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<ul>
<li>0 &rarr; the dipole-quadrupole interaction is not handled separately in the treatment of the interatomic forces.</li>
<li>1 &rarr; the dipole-quadrupole interaction is subtracted from the dynamical matrices before Fourier transform,
  so that only the short-range part is handled in real space. Of course, it is reintroduced analytically
  when the phonon spectrum is interpolated. Requires a preceding generation of 3<sup>rd</sup> order DDB with a <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_qdrpl">lw_qdrpl</a> = 1
  or a <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_flexo">lw_flexo</a> = 1 or 2 run.</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The default value is 1.
This means that the dipole-quadrupole interaction is always included <strong>provided</strong> the DDB file contains
the dynamical quadrupoles.
If the DDB file does not contain the dynamical quadrupoles, this variable is automatically set to zero at runtime.</p>
</div>
<h2 id="dos_maxmode"><strong>dos_maxmode</strong><a class="headerlink" href="#dos_maxmode" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Phonon DOS MAX MODE included<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.5  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>This variable specifies the maximum phonon mode index (up to 3*natom)
included in the computation of the phonon DOS</p>
<p>If set to 0, which is the default value, all modes are included in the DOS.</p>
<h2 id="dosdeltae"><strong>dosdeltae</strong><a class="headerlink" href="#dosdeltae" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DOS DELTA in Energy<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.2 cm<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span> (about 0.9E-06 Hartree)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>The input variable <strong>dosdeltae</strong> is used to define the step of the frequency
grid used to calculate the phonon density of states when <a class="wikilink codevar-wikilink" href="/variables/anaddb#prtdos">prtdos</a> = 1.</p>
<p>Prior to v9.10, the default was 1 cm<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span>.</p>
<h2 id="dossmear"><strong>dossmear</strong><a class="headerlink" href="#dossmear" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DOS SMEARing value<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 cm<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span> (about 4.5E-06 Hartree)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: output auxiliary files and change default smearings" data-toggle="popover" href="/tests/v5/Input/t91.abi" target="_blank">t91.abi</a></li>
</ul>
</details>
<p><strong>dossmear</strong> defines the gaussian broadening used to calculate the phonon
density of states when <a class="wikilink codevar-wikilink" href="/variables/anaddb#prtdos">prtdos</a> = 1.</p>
<p>Prior to v9.10, the default was 5 cm<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span>.</p>
<h2 id="dossum"><strong>dossum</strong><a class="headerlink" href="#dossum" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DOS SUM<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Set the flag to 1 to calculate the two phonon dos density of states. Sum and
Difference for the Gamma point. The DOS is converged and based on that, the
sum and difference are reported in the output file.</p>
<h2 id="dostol"><strong>dostol</strong><a class="headerlink" href="#dostol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DOS TOLerance<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.25<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>The relative tolerance on the phonon density of state. This number will
determine when the series of grids with which the DOS is calculated can be
stopped, i.e. the mean of the relative change going from one grid to the next
bigger is smaller than <strong>dostol</strong>.</p>
<h2 id="eivec"><strong>eivec</strong><a class="headerlink" href="#eivec" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EIgenVECtors<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [33/74] in all anaddb tests, [6/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
IFCs are computed as in test 16, but by limiting artificially
the number of allowed interacting shells to 2. The total number
of atoms to be taken into account is 17 (1 for the shell 0,
4 for the shell 1, and 12 for the shell 2).
The frequencies at X and L points are again computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1)
in the above-mentioned paper. The number are close, with
small differences at the level of 0.001 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for BaTiO3, same as test18.
Compute the phonon frequencies at Gamma, and also output
the corresponing eigenvectors. These data can be compared
with those published by Ghosez et al, Ferroelectrics 194, 39 (1997),
TABLE II, although the normalisation factor is different.
For example, the z displacement of mode 1 given by the code
is ( .25d-4 , .158d-2 , -.261d-2, -.118d-2 , -.118d-2 ), that
multiplied by -60.54 and rounded to the third digit,
gives values that appear in the first line of that TABLE II :
( -0.002 , -0.096 , 0.158 , 0.071 , 0.071 )" data-toggle="popover" href="/tests/v2/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for ZrO2, containing only the dynamical
matrices at Gamma, X and L.
Generate the IFC using a rough sampling, based on Gamma and X
only, then produces the phonon band structure along Gamma-X,
as well as in L.
The degeneracies can be compared with those of
Detraux et al, Phys. Rev. Lett. 81, 3297 (1998).
The errors produced with this sampling are still large, as can be
judged from the comparison at L. The frequencies (in cm-1) from the DDB are
128.8 (2-deg), 271.4, 413.7 (2-deg), 518.2, 521.8 (2-deg), 598.1 ;
while from the IFCs, using the interpolation, they are
152.5 (2-deg), 290.8, 429.6 (2-deg), 434.6 (2-deg), 551.9, 576.0 .
The same DDB allows to generate a slightly better sampling, by using
nqshft=2 and two shifts (0.0 0.0 0.0) and (0.5 0.5 0.5).
In this case, the L point is used for the interpolation. The comparison
can be done at the level of the mid-point between Gamma and X :
from the GX grid, one gets
107.0 (2-deg), 260.3, 295.5 (2-deg), 394.3, 577.0 (2-deg), 682.1  ;
from the GXL grid, one gets
106.3 (2-deg), 262.6, 302.7 (2-deg), 403.8, 582.5 (2-deg), 684.2  ;
while directly from the ABINIT code, one gets
106.3 (2-deg), 270.0, 277.9 (2-deg), 443.2, 581.6 (2-deg), 681.6  .
This is not yet satisfactory.
More points are needed for better results, the next interesting grid
being obtained by changing ngqpt from 2 2 2 to 4 4 4 in the t22.in file.
Two additional dynamical matrices are then needed." data-toggle="popover" href="/tests/v2/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=3, 1D - rotational invariance for anaddb. This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=4, 0D - rotational invariance for anaddb. NOTE : This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t84.abi" target="_blank">t84.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
VN in FCC. Phonon analysis using ANADDB." data-toggle="popover" href="/tests/v6/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
VN in FCC. Phonon analysis using ANADDB.
Differs from test 70 by the modification of acell and rprim inside the DDB." data-toggle="popover" href="/tests/v6/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 48, for the generation of
the nonlinear coefficients only." data-toggle="popover" href="/tests/v8/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond structure.
Interpolation of the DDB from a 2x2x2 q-points grid
onto a 4x4x4 q-points grid using the interatomic force constants." data-toggle="popover" href="/tests/v8/Input/t64.abi" target="_blank">t64.abi</a> &hellip;</li>
</ul>
</details>
<ul>
<li>0 &rarr; do not write the phonon eigenvectors;</li>
<li>1 or 2 &rarr; write the phonon eigenvectors;</li>
<li>4 &rarr; generate output files for band2eps (drawing tool for the phonon band structure);</li>
</ul>
<h2 id="elaflag"><strong>elaflag</strong><a class="headerlink" href="#elaflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ELAstic tensor FLAG<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute elastic, piezoelectric and internal strain tensors from DFPT" data-toggle="popover" href="/topics/Elastic">topic_Elastic</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [6/74] in all anaddb tests, [3/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="The input file for the anaddb code" data-toggle="popover" href="/tests/tutorespfn/Input/telast_3.abi" target="_blank">telast_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_3.abi" target="_blank">tpolarization_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #67 ,which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to doc/theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #69, which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to Infos/Theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Highly Strained Si (diamond) structure.
Using the DDB file merged by test2, this test computed the elastic
constant (relaxed ion) considering the correction from remaining
stresses in the unit cell. Voigt symmetry will be broken.
Please refer to: doc/theory/elasticity-oganov.pdf." data-toggle="popover" href="/tests/v4/Input/t83.abi" target="_blank">t83.abi</a></li>
</ul>
</details>
<p>Flag for calculation of elastic and compliance tensors</p>
<ul>
<li>0 &rarr; No elastic or compliance tensor will be calculated.</li>
<li>1 &rarr; Only clamped-ion elastic and compliance tensors will be calculated.
    Requirements for preceding response-function DDB generation run: Strain perturbation.
    Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> to 1, 2, or 3. Note that <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a>=3 is recommended so that responses
    to both uniaxial and shear strains will be computed.</li>
<li>2 &rarr; Both relaxed- and clamped-ion elastic and compliance tensor will be calculated,
    but only the relaxed-ion quantities will be printed. The input variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a> should also be set to 1,
    because the internal-strain tensor is needed to compute the relaxed-ion corrections.
    Requirements for preceding response-function DDB generation run:
    Strain and atomic-displacement responses at Q=0. Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> = 1, 2, or 3 (preferably 3).
    Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> to do a full calculation of phonons at Q=0
    (needed because the inverse of force-constant tensor is required).</li>
<li>3 &rarr; Both relaxed and clamped-ion elastic and compliance tensors will be printed out.
   The input variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a> should also be set to 1.
   Requirements for preceding response-function DDB generation run: Same as for <strong>elaflag</strong> =2.</li>
<li>4 &rarr; Calculate the elastic and compliance tensors (relaxed ion) at fixed displacement field,
    the relaxed-ion tensors at fixed electric field will be printed out too, for comparison.
    When <strong>elaflag</strong> =4, we need the information of internal strain and relaxed-ion dielectric tensor
    to build the whole tensor, so we need set <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a>=1 and <a class="wikilink codevar-wikilink" href="/variables/anaddb#dieflag">dieflag</a>=3 or 4 .</li>
<li>5 &rarr; Calculate the relaxed ion elastic and compliance tensors, considering the stress left inside cell.
    At the same time, bare relaxed ion tensors will still be printed out for comparison.
    In this calculation, stress tensor is needed to compute the correction term, so one is supposed
    to merge the first order derivative data base (DDB file) with the second order derivative data base (DDB file)
    into a new DDB file, which can contain both information. And the program will also check for the users.</li>
</ul>
<h2 id="elph_fermie"><strong>elph_fermie</strong><a class="headerlink" href="#elph_fermie" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ELectron-PHonon FERMI Energy<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [2/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: change Fermi energy reference to probe e-p coupling of unocc states" data-toggle="popover" href="/tests/v5/Input/t93.abi" target="_blank">t93.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a></li>
</ul>
</details>
<p>If non-zero, will fix artificially the value of the Fermi energy (e.g. for semiconductors),
in the electron-phonon case. Note that <a class="wikilink codevar-wikilink" href="/variables/anaddb#elph_fermie">elph_fermie</a> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#ep_extrael">ep_extrael</a> should not be used at the same time.
(<a class="wikilink codevar-wikilink" href="/variables/anaddb#elphflag">elphflag</a>=1).</p>
<h2 id="elphflag"><strong>elphflag</strong><a class="headerlink" href="#elphflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ELectron-PHonon FLAG<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [15/74] in all anaddb tests, [3/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: no symmetrization of e-p matrix elements" data-toggle="popover" href="/tests/v5/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: output auxiliary files and change default smearings" data-toggle="popover" href="/tests/v5/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: integrate over window of bands instead of energies" data-toggle="popover" href="/tests/v5/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: change Fermi energy reference to probe e-p coupling of unocc states" data-toggle="popover" href="/tests/v5/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb electron-phonon run: instead of using uniform grid of q-points, treat only a given list" data-toggle="popover" href="/tests/v5/Input/t94.abi" target="_blank">t94.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test rifcsph cutoff radius for IFC Fourier transform. Use output from t85-87" data-toggle="popover" href="/tests/v5/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb run for Ni, from t96 t97 t98. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t99.abi" target="_blank">t99.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>If <strong>elphflag</strong> is 1, anaddb performs an analysis of the electron-phonon coupling.</p>
<h2 id="elphsmear"><strong>elphsmear</strong><a class="headerlink" href="#elphsmear" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ELectron-PHonon SMEARing factor<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.01 Hartree<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [2/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a></li>
</ul>
</details>
<p>Smearing width for the Fermi surface integration (in Hartree by default).</p>
<h2 id="enunit"><strong>enunit</strong><a class="headerlink" href="#enunit" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ENergy UNITs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [11/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Phonon band structure of Al, from DDB of test 27.
The parameters were really too low in test 26, so that some
phonon unstabilities are present close to Gamma. These
do not appear anymore in test 29." data-toggle="popover" href="/tests/v2/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Phonon band structure of Al. Similar to test 28,
except that the DDB was generated with parameters much better
than those of test 26, the better parameters are mentioned
in the t26.in file, for information. The convergence is not complete
though, but the frequencies compare already rather well with those
in Quong and Klein, PRB 46, 10734 (1992), except
close to Gamma (still, no instability is observed, unlike in test 28)." data-toggle="popover" href="/tests/v2/Input/t29.abi" target="_blank">t29.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. (Test of Na Sai&#x27;s technique)
To impose a polarization on AlAs:
compute new values of the cell parameters and atomic positions.
(in practical calculations, these operations must be repeated until convergence is reached)" data-toggle="popover" href="/tests/v4/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Phonon band structure of Al, from DDB of test 78.
The parameters were really too low in test 78, so that some
phonon unstabilities are present close to Gamma.
Similar to Tv2#28" data-toggle="popover" href="/tests/v6/Input/t80.abi" target="_blank">t80.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Use output from t78 to test qrefine: trivially start with 1x1x1 q-point grid and add the 2x2x2
q-points after the method of Gaal Nagy. Not working yet." data-toggle="popover" href="/tests/v6/Input/t81.abi" target="_blank">t81.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 48, for the generation of
the nonlinear coefficients only." data-toggle="popover" href="/tests/v8/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond structure.
Interpolation of the DDB from a 2x2x2 q-points grid
onto a 4x4x4 q-points grid using the interatomic force constants." data-toggle="popover" href="/tests/v8/Input/t64.abi" target="_blank">t64.abi</a></li>
</ul>
</details>
<p>Give the energy for the phonon frequency output (in the output file, not in
the console log file, for which Hartree units are used).</p>
<ul>
<li>0 &rarr; Hartree and cm<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span>;</li>
<li>1 &rarr; meV and Thz;</li>
<li>2 &rarr; Hartree, cm<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span>, meV, Thz, and Kelvin.</li>
</ul>
<h2 id="ep_b_max"><strong>ep_b_max</strong><a class="headerlink" href="#ep_b_max" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron Phonon integration Band MAXimum<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: integrate over window of bands instead of energies" data-toggle="popover" href="/tests/v5/Input/t92.abi" target="_blank">t92.abi</a></li>
</ul>
</details>
<p>When set, and <a class="wikilink codevar-wikilink" href="/variables/anaddb#telphint">telphint</a> is equal to 2, this variable determines the
k-point integration weights which are used in the electron-phonon part of the
code. Instead of weighting according to a distance from the Fermi surface, an
equal weight is given to all k-points, for all bands between
<a class="wikilink codevar-wikilink" href="/variables/anaddb#ep_b_min">ep_b_min</a> and <strong>ep_b_max</strong>.</p>
<h2 id="ep_b_min"><strong>ep_b_min</strong><a class="headerlink" href="#ep_b_min" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron Phonon integration Band MINimum<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: integrate over window of bands instead of energies" data-toggle="popover" href="/tests/v5/Input/t92.abi" target="_blank">t92.abi</a></li>
</ul>
</details>
<p>As for <a class="wikilink codevar-wikilink" href="/variables/anaddb#ep_b_max">ep_b_max</a>, but <strong>ep_b_min</strong> is the lower bound on the band
integration, instead of the upper bound. See also <a class="wikilink codevar-wikilink" href="/variables/anaddb#telphint">telphint</a>.</p>
<h2 id="ep_extrael"><strong>ep_extrael</strong><a class="headerlink" href="#ep_extrael" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron-Phonon EXTRA ELectrons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>If non-zero, will fix artificially the number of extra electrons per unit cell
(positive for electron doping), according to a doped case. (e.g. for
semiconductors), in the electron-phonon case. This field can also be filled
with doping concentration, in the units of cm<span><span class="MathJax_Preview">^{-3}</span><script type="math/tex">^{-3}</script></span> (negative for electron
doping). Note that <strong>ep_extrael</strong> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#elph_fermie">elph_fermie</a> should not be
used at the same time. (<a class="wikilink codevar-wikilink" href="/variables/anaddb#elphflag">elphflag</a>=1).</p>
<h2 id="ep_int_gkk"><strong>ep_int_gkk</strong><a class="headerlink" href="#ep_int_gkk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron-Phonon INTerpolation of GKK<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>This flag determines whether the interpolation of the electron-phonon matrix
elements over the coarse k-grid is done ( <strong>ep_int_gkk</strong> 1) before summing
with appropriate Fermi Surface weights. In this way, the two integration
weights are treated symmetrically.</p>
<h2 id="ep_keepbands"><strong>ep_keepbands</strong><a class="headerlink" href="#ep_keepbands" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron-Phonon KEEP dependence on electron BANDS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [5/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>This flag determines whether the dependency of the electron-phonon matrix
elements on the electron band index is kept ( <strong>ep_keepbands</strong> 1), or whether
it is summed over immediately with appropriate Fermi Surface weights. For
transport calculations <strong>ep_keepbands</strong> must be set to 1.</p>
<h2 id="ep_nqpt"><strong>ep_nqpt</strong><a class="headerlink" href="#ep_nqpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron Phonon Number of Q PoinTs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb electron-phonon run: instead of using uniform grid of q-points, treat only a given list" data-toggle="popover" href="/tests/v5/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>In case a non-uniform grid of q-points is being used, for direct calculation
of the electron-phonon quantities without interpolation, this specifies the
number of q-points to be found in the GKK file, independently of the normal anaddb input (ngqpt)</p>
<h2 id="ep_nspline"><strong>ep_nspline</strong><a class="headerlink" href="#ep_nspline" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron Phonon Number for SPLINE interpolation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 20<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>The scale factor for cubic spline interpolation, only used in the relaxation
time approximation (<a class="wikilink codevar-wikilink" href="/variables/anaddb#ifltransport">ifltransport</a>=3).</p>
<h2 id="ep_prt_yambo"><strong>ep_prt_yambo</strong><a class="headerlink" href="#ep_prt_yambo" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron Phonon PRinTout YAMBO data<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the matrix elements of the electron-phonon interaction" data-toggle="popover" href="/topics/ElPhonInt">topic_ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: output auxiliary files and change default smearings" data-toggle="popover" href="/tests/v5/Input/t91.abi" target="_blank">t91.abi</a></li>
</ul>
</details>
<p>For electron-phonon calculations, print out matrix elements for use by the yambo code.</p>
<h2 id="ep_qptlist"><strong>ep_qptlist</strong><a class="headerlink" href="#ep_qptlist" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron Phonon Q PoinT LIST<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="/variables/anaddb#ep_nqpt">ep_nqpt</a>)<br />
<em>Default value:</em> (3*<a class="wikilink codevar-wikilink" href="/variables/anaddb#ep_nqpt">ep_nqpt</a>)<em>0<br />
*Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb electron-phonon run: instead of using uniform grid of q-points, treat only a given list" data-toggle="popover" href="/tests/v5/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>In case a non-uniform grid of q-points is being used, for direct calculation
of the electron-phonon quantities without interpolation, this specifies the
q-points to be found in the GKK file, independently of the normal anaddb input
(ngqpt), in reduced coordinates of the reciprocal space lattice.</p>
<h2 id="ep_scalprod"><strong>ep_scalprod</strong><a class="headerlink" href="#ep_scalprod" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DO SCALar PRODuct for gkk matrix elements<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [4/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>The input variable <strong>ep_scalprod</strong> is a flag determining whether the scalar
product of the electron-phonon matrix elements (gkk) with the phonon
displacement vectors is done before or after interpolation. Doing so before (
<strong>ep_scalprod</strong> 1) makes phonon linewidths smoother but introduces an error,
as the interpolated phonons and gkk are not diagonalized in the same basis.
Doing so afterwards ( <strong>ep_scalprod</strong> 0) eliminates the diagonalization error,
but sometimes gives small spikes in the phonon linewidths near band crossings
or high symmetry points. I do not know why&hellip;</p>
<h2 id="eph_prefix"><strong>eph_prefix</strong><a class="headerlink" href="#eph_prefix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EPH PREFIX<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> string<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>This variable specifies the prefix for the elphon output files when anaddb is invoked with the new syntax:</p>
<div class="codehilite"><pre><span></span><code>anaddb t01.in &gt; log 2&gt; err
</code></pre></div>

<p>instead of the legacy mode based on the files file.
This variable is optional and used for performing EPH calculation with <a class="wikilink codevar-wikilink" href="/variables/anaddb#elphflag">elphflag@anaddb</a>.</p>
<h2 id="flexoflag"><strong>flexoflag</strong><a class="headerlink" href="#flexoflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FLEXOelectric tensor FLAG<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute spatial dispersion properties with the longwave DFPT approach." data-toggle="popover" href="/topics/longwave">topic_longwave</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for flexoelectric tensor calculation." data-toggle="popover" href="/tests/tutorespfn/Input/tlw_3.abi" target="_blank">tlw_3.abi</a></li>
</ul>
</details>
<p>Flag for calculation of bulk flexoelectrics tensors</p>
<ul>
<li>0 &rarr; No flexoelectric tensor is calculated.</li>
<li>1 &rarr; All the contributions to the bulk flexoelectric tensor (clamped-ion, mixed and lattice-mediated) and
          related quantities (piezoelectric and flexoelectric internal strain tensors and Lagrange elastic tensors)
          are calculated. Requires a preceding generation of 2<sup>nd</sup> and 3<sup>rd</sup> order DDB with a <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_flexo">lw_flexo</a> = 1 run.</li>
<li>2 &rarr; The clamped-ion flexoelectric tensor is printed. Requires a preceding generation of 2<sup>nd</sup> and 3<sup>rd</sup> order
          DDB with a <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_flexo">lw_flexo</a> = 1 or 2 run.</li>
<li>3 &rarr; The mixed flexoelectric tensor is calculated and printed along with the piezoelectric internal strain tensors.
          Requires a preceding generation of 2<sup>nd</sup> and 3<sup>rd</sup> order DDB with a <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_flexo">lw_flexo</a> = 1 or 3 run.</li>
<li>4 &rarr; The lattice-mediated flexoelectric tensor is calculated and printed along with the piezoelectric and flexoelectric
          internal strain tensors and the Lagrange elastic tensors.
          Requires a preceding generation of 2<sup>nd</sup> and 3<sup>rd</sup> order DDB with a <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_flexo">lw_flexo</a> = 1 or 4 run.</li>
</ul>
<h2 id="freeze_displ"><strong>freeze_displ</strong><a class="headerlink" href="#freeze_displ" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FREEZE DISPLacement of phonons into supercells<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>If different from zero, <strong>freeze_displ</strong> will be used as the amplitude of a
phonon displacement. For each q-point and mode in the <a class="wikilink codevar-wikilink" href="/variables/anaddb#qph1l">qph1l</a> list, a
file will be created containing a supercell of atoms with the corresponding
phonon displacements frozen in. This is typically useful to freeze a soft
phonon mode, then let it relax in abinit afterwards.</p>
<p><strong>freeze_displ</strong> is unitless (for abinit), but has a physical meaning: it is related to the
Bose distribution <span><span class="MathJax_Preview">n_B</span><script type="math/tex">n_B</script></span> and the frequency <span><span class="MathJax_Preview">\omega_{qs}</span><script type="math/tex">\omega_{qs}</script></span> of the phonon mode. At a given
temperature <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>, <strong>freeze_displ</strong> will give the root mean square displacement of
atoms (along with the displacement vectors, which are in <em>Bohr</em>). In atomic
units <strong>freeze_displ</strong> = <span><span class="MathJax_Preview">\sqrt{&lt; \hat{x}^2 &gt;} = \sqrt{(0.5 + n_B(\omega_{qs}/kT))/ \omega_{qs}}</span><script type="math/tex">\sqrt{< \hat{x}^2 >} = \sqrt{(0.5 + n_B(\omega_{qs}/kT))/ \omega_{qs}}</script></span>
where <span><span class="MathJax_Preview">\hat{x}\propto \hat{a} + \hat{a}^\dagger</span><script type="math/tex">\hat{x}\propto \hat{a} + \hat{a}^\dagger</script></span> is the
displacement operator and <span><span class="MathJax_Preview">a^\dagger</span><script type="math/tex">a^\dagger</script></span> and <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> are the phonon creation and annihilation operators respectively.
Typical values are 50-200 for a frequency of a few hundred cm<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span> and room temperature.
If all you want is to break the symmetry in the right direction, any reasonable value
(10-50) should be ok.</p>
<p><strong>WARNING</strong>: this will create a <em>lot</em> of files (3*natom*nph1l), so it should
be used with a small number <a class="wikilink codevar-wikilink" href="/variables/anaddb#nph1l">nph1l</a> of q-points for interpolation.</p>
<h2 id="frmax"><strong>frmax</strong><a class="headerlink" href="#frmax" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FRequency MAXimum<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>Value of the largest frequency for the frequency-dependent dielectric tensor, in Hartree.</p>
<h2 id="frmin"><strong>frmin</strong><a class="headerlink" href="#frmin" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FRequency MINimum<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>Value of the lowest frequency for the frequency-dependent dielectric tensor, in Hartree.</p>
<h2 id="gkk_filepath"><strong>gkk_filepath</strong><a class="headerlink" href="#gkk_filepath" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GKK PATH<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> string<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>This variable specifies the name of the GKK file when anaddb is invoked with the new syntax:</p>
<div class="codehilite"><pre><span></span><code>anaddb t01.in &gt; log 2&gt; err
</code></pre></div>

<p>instead of the legacy mode based on the files file.
This variable is optional and used for performing EPH calculation with <a class="wikilink codevar-wikilink" href="/variables/anaddb#elphflag">elphflag@anaddb</a>.</p>
<h2 id="gkqwrite"><strong>gkqwrite</strong><a class="headerlink" href="#gkqwrite" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GKk for input Q grid to be WRITtEn to disk<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the matrix elements of the electron-phonon interaction" data-toggle="popover" href="/topics/ElPhonInt">topic_ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: output auxiliary files and change default smearings" data-toggle="popover" href="/tests/v5/Input/t91.abi" target="_blank">t91.abi</a></li>
</ul>
</details>
<p>Flag to write out the reciprocal space matrix elements to a disk file named
gkqfile. This reduces strongly the memory needed for an electron-phonon run.</p>
<h2 id="gruns_ddbs"><strong>gruns_ddbs</strong><a class="headerlink" href="#gruns_ddbs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GRUNeiSen DDBS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute vibrational free energy, entropy, specific heat, thermal expansion, as well as atomic temperature factors" data-toggle="popover" href="/topics/Temperature">topic_Temperature</a><br />
<em>Variable type:</em> string<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/anaddb#gruns_nddbs">gruns_nddbs</a>)<br />
<em>Default value:</em> Empty<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a></li>
</ul>
</details>
<p>List of strings with the paths of the DDB files used for the calculation of
the Gruneisen parameters. Each string must be enclosed by quotation marks. The
number of DDB files is defined by <a class="wikilink codevar-wikilink" href="/variables/anaddb#gruns_nddbs">gruns_nddbs</a> (possible values are:
3,5,7,9) The DDB files correspond to phonon calculations performed at
different volumes (usually ± 1% of the equilibrium volume). The DDB files must
be ordered according to the volume of the unit cell (the DDB with smallest
volume comes first) and the volume increment must be constant to a precision of
better than 1 part in <span><span class="MathJax_Preview">10^4</span><script type="math/tex">10^4</script></span>. The code
computes the derivative of the dynamical matrix wrt the volume using central finite difference.</p>
<h2 id="gruns_nddbs"><strong>gruns_nddbs</strong><a class="headerlink" href="#gruns_nddbs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GRUNeiSen Number of DDB files<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute vibrational free energy, entropy, specific heat, thermal expansion, as well as atomic temperature factors" data-toggle="popover" href="/topics/Temperature">topic_Temperature</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a></li>
</ul>
</details>
<p>This variable defines the number of DDB files (read from <a class="wikilink codevar-wikilink" href="/variables/anaddb#gruns_ddbs">gruns_ddbs</a>)
used for the calculation of the Gruneisen parameters. Note that computation of
the Grunheisen parameters is currently incompatible with many other features of
ANADDB, and so should be computed in a separate run from calculation of other
possible responses.</p>
<h2 id="iatfix"><strong>iatfix</strong><a class="headerlink" href="#iatfix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Indices of the AToms that are FIXed<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to optimize the geometry under constrained polarization" data-toggle="popover" href="/topics/ConstrainedPol">topic_ConstrainedPol</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/anaddb#natfix">natfix</a>)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>Indices of the atoms that are fixed during a structural relaxation at
constrained polarization. See <a class="wikilink codevar-wikilink" href="/variables/anaddb#polflag">polflag</a>.</p>
<h2 id="iatprj_bs"><strong>iatprj_bs</strong><a class="headerlink" href="#iatprj_bs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Indices of the AToms for the PRoJection of the phonon Band Structure<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/anaddb#natprj_bs">natprj_bs</a>)<br />
<em>Default value:</em> 0*&rsquo;<a class="wikilink codevar-wikilink" href="/variables/anaddb#natprj_bs">natprj_bs</a>&lsquo;<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>Indices of the atoms that are chosen for projection of the phonon
eigenvectors, giving a weighted phonon band structure file.</p>
<h2 id="ifcana"><strong>ifcana</strong><a class="headerlink" href="#ifcana" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> IFC ANAlysis<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [32/74] in all anaddb tests, [4/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
IFCs are computed as in test 16, but by limiting artificially
the number of allowed interacting shells to 2. The total number
of atoms to be taken into account is 17 (1 for the shell 0,
4 for the shell 1, and 12 for the shell 2).
The frequencies at X and L points are again computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1)
in the above-mentioned paper. The number are close, with
small differences at the level of 0.001 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Phonon band structure of Al, from DDB of test 78.
The parameters were really too low in test 78, so that some
phonon unstabilities are present close to Gamma.
Similar to Tv2#28" data-toggle="popover" href="/tests/v6/Input/t80.abi" target="_blank">t80.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Use output from t78 to test qrefine: trivially start with 1x1x1 q-point grid and add the 2x2x2
q-points after the method of Gaal Nagy. Not working yet." data-toggle="popover" href="/tests/v6/Input/t81.abi" target="_blank">t81.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
</ul>
</details>
<ul>
<li>0 &rarr; no analysis of interatomic force constants;</li>
<li>1 &rarr; analysis of interatomic force constants.</li>
</ul>
<p>If the analysis is activated, one get the trace of the matrices between pairs
of atoms, if <a class="wikilink codevar-wikilink" href="/variables/anaddb#dipdip">dipdip</a> is 1, get also the trace of the short-range and
electrostatic part, and calculate the ratio with the full matrix; then define
a local coordinate reference (using the next-neighbour coordinates), and
express the interatomic force constant matrix between pairs of atoms in that
local coordinate reference (the first vector is along the bond; the second
vector is along the perpendicular force exerted on the generic atom by a
longitudinal displacement of the neighbouring atom - in case it does not
vanish; the third vector is perpendicular to the two others). Also calculate
ratios with respect to the longitudinal force constant ( the (1,1) element of
the matrix in local coordinates).</p>
<h2 id="ifcflag"><strong>ifcflag</strong><a class="headerlink" href="#ifcflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Interatomic Force Constants FLAG<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [60/74] in all anaddb tests, [9/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
IFCs are computed as in test 16, but by limiting artificially
the number of allowed interacting shells to 2. The total number
of atoms to be taken into account is 17 (1 for the shell 0,
4 for the shell 1, and 12 for the shell 2).
The frequencies at X and L points are again computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1)
in the above-mentioned paper. The number are close, with
small differences at the level of 0.001 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=3, 1D - rotational invariance for anaddb. This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC 8-atom supercell. Fake smooth pseudopotential.
Follow-up of test 58. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 57. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775401E-03  (bands 1 to 6)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970636E-03  (bands 7 and 8)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (bands 9 to 14)" data-toggle="popover" href="/tests/v6/Input/t59.abi" target="_blank">t59.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon frequncies at Gamma. The selected DDB can raise an error for large tolsym in symanal, that is called for symmetry analysis at gamma." data-toggle="popover" href="/tests/v9/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test whether one can read a DDB with the dynamical quadrupole section that is not the last block.
The order of the blocks indeed depend on the list of files passed to mrgddb and the internal implementation
should not assume any particular order" data-toggle="popover" href="/tests/v9/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a> &hellip;</li>
</ul>
</details>
<ul>
<li>0 &rarr; do all calculations directly from the DDB, without the use of the interatomic force constant.</li>
<li>1 &rarr; calculate and use the interatomic force constants for interpolating the phonon spectrum
    and dynamical matrices at every q wavevector, and eventually analyse the interatomic force constants,
    according to the informations given by <a class="wikilink codevar-wikilink" href="/variables/anaddb#atifc">atifc</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#dipdip">dipdip</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcana">ifcana</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcout">ifcout</a>,
    <a class="wikilink codevar-wikilink" href="/variables/anaddb#natifc">natifc</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#nsphere">nsphere</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#rifcsph">rifcsph</a></li>
</ul>
<p>More detailed explanations: if the dynamical matrices are known on a regular
set of wavevectors, they can be used to get the interatomic forces, which are
simply their Fourier transform. When non-analyticities can been removed by the
use of effective charge at Gamma (option offered by putting <a class="wikilink codevar-wikilink" href="/variables/anaddb#dipdip">dipdip</a> to 1),
the interatomic forces are known to decay rather fast (in real space).</p>
<p>The interatomic forces generated from a small set of dynamical matrices could
be of sufficient range to allow the remaining interatomic forces to be
neglected. This gives a practical way to interpolate the content of a small
set of dynamical matrices, because dynamical matrices can everywhere be
generated starting from this set of interatomic force constants. It is
suggested to always use <strong>ifcflag</strong> =1. The <strong>ifcflag</strong> =0 option is available
for checking purpose, and if there is not enough information in the DDB.</p>
<h2 id="ifcout"><strong>ifcout</strong><a class="headerlink" href="#ifcout" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> IFC OUTput<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [44/74] in all anaddb tests, [7/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
IFCs are computed as in test 16, but by limiting artificially
the number of allowed interacting shells to 2. The total number
of atoms to be taken into account is 17 (1 for the shell 0,
4 for the shell 1, and 12 for the shell 2).
The frequencies at X and L points are again computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1)
in the above-mentioned paper. The number are close, with
small differences at the level of 0.001 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC 8-atom supercell. Fake smooth pseudopotential.
Follow-up of test 58. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 57. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775401E-03  (bands 1 to 6)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970636E-03  (bands 7 and 8)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (bands 9 to 14)" data-toggle="popover" href="/tests/v6/Input/t59.abi" target="_blank">t59.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
</ul>
</details>
<p>For each atom in the list <a class="wikilink codevar-wikilink" href="/variables/anaddb#atifc">atifc</a> (generic atoms), <strong>ifcout</strong> give
the number of neighbouring atoms for which the ifc&rsquo;s will be output (written)
and eventually analysed. The neighbouring atoms are selected by decreasing
distance with respect to the generic atom.</p>
<h2 id="ifltransport"><strong>ifltransport</strong><a class="headerlink" href="#ifltransport" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> IFLag for TRANSPORT<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [5/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>if <strong>ifltransport</strong> =1 (LOVA) or <strong>ifltransport</strong> =2 (non-LOVA), anaddb calculates the
transport properties: electrical and thermal resistivities from electron-
phonon interactions in the variational approach. If <strong>ifltransport</strong> =3, anaddb
calculates the k-dependent relaxation time. (needs <a class="wikilink codevar-wikilink" href="/variables/anaddb#elphflag">elphflag</a> = 1)</p>
<h2 id="instrflag"><strong>instrflag</strong><a class="headerlink" href="#instrflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> INternal STRain FLAG<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute elastic, piezoelectric and internal strain tensors from DFPT" data-toggle="popover" href="/topics/Elastic">topic_Elastic</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [6/74] in all anaddb tests, [3/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="The input file for the anaddb code" data-toggle="popover" href="/tests/tutorespfn/Input/telast_3.abi" target="_blank">telast_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_3.abi" target="_blank">tpolarization_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #67 ,which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to doc/theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #69, which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to Infos/Theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Highly Strained Si (diamond) structure.
Using the DDB file merged by test2, this test computed the elastic
constant (relaxed ion) considering the correction from remaining
stresses in the unit cell. Voigt symmetry will be broken.
Please refer to: doc/theory/elasticity-oganov.pdf." data-toggle="popover" href="/tests/v4/Input/t83.abi" target="_blank">t83.abi</a></li>
</ul>
</details>
<p>Internal strain tensor flag.</p>
<ul>
<li>0 &rarr; No internal-strain calculation.</li>
<li>1 &rarr; Print out both force-response and displacement-response internal-strain tensor.
    Requirements for preceding response-function DDB generation run: Strain and full atomic-displacement responses.
    Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> = 1, 2, or 3 (preferably 3). Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> to do a full calculation of phonons at Q=0.</li>
</ul>
<h2 id="istrfix"><strong>istrfix</strong><a class="headerlink" href="#istrfix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Index of STRain FIXed<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to optimize the geometry under constrained polarization" data-toggle="popover" href="/topics/ConstrainedPol">topic_ConstrainedPol</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/anaddb#nstrfix">nstrfix</a>)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
</ul>
</details>
<p>Indices of the elements of the strain tensor that are fixed during a
structural relaxation at constrained polarisation:</p>
<ul>
<li>0 &rarr; No elastic or compliance tensor will be calculated.</li>
<li>1 &rarr; Only clamped-ion elastic and compliance tensors will be calculated. Requirements for
    preceding response-function DDB generation run: Strain perturbation. Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> to 1, 2, or 3.
    Note that <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a>&gt;=3 is recommended so that responses to both uniaxial and shear strains will be computed.</li>
<li>2 &rarr; Both relaxed- and clamped-ion elastic and compliance tensor will be calculated, but only
    the relaxed-ion quantities will be printed. The input variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a> should also be set to 1,
    because the internal-strain tensor is needed to compute the relaxed-ion corrections.
    Requirements for preceding response-function DDB generation run: Strain and atomic-displacement responses at Q=0.
    Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> = 1, 2, or 3 (preferably 3). Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> to do a full calculation
    of phonons at Q=0 (needed because the inverse of force-constant tensor is required).</li>
<li>3 &rarr; Both relaxed and clamped-ion elastic and compliance tensors will be printed out.
    The input variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a> should also be set to 1.
    Requirements for preceding response-function DDB generation run: Same as for <a class="wikilink codevar-wikilink" href="/variables/anaddb#elaflag">elaflag</a>=2.</li>
<li>4 &rarr; Calculate the elastic and compliance tensors (relaxed ion) at fixed displacement field,
    the relaxed-ion tensors at fixed electric field will be printed out too, for comparison.
    When <a class="wikilink codevar-wikilink" href="/variables/anaddb#elaflag">elaflag</a>=4, we need the information of internal strain and relaxed-ion dielectric tensor
    to build the whole tensor, so we need to set <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a>=1 and <a class="wikilink codevar-wikilink" href="/variables/anaddb#dieflag">dieflag</a>=3 or 4.</li>
<li>5 &rarr; Calculate the relaxed ion elastic and compliance tensors, considering the stress left inside cell.
    At the same time, bare relaxed ion tensors will still be printed out for comparison.
    In this calculation, stress tensor is needed to compute the correction term, so one supposed
    to merge the first order derivative data base (DDB file) with the second order derivative data base (DDB file)
    into a new DDB file, which can contain both information. And the program will also check for the users.</li>
</ul>
<p>See <a class="wikilink codevar-wikilink" href="/variables/anaddb#polflag">polflag</a>.</p>
<h2 id="kptrlatt"><strong>kptrlatt</strong><a class="headerlink" href="#kptrlatt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K PoinT Reciprocal LATTice<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,3)<br />
<em>Default value:</em> 9*0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [5/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>Unnormalized lattice vectors for the k-point grid in reciprocal space (see
 <strong>kptrlatt</strong>  abinit variable definition as well). Input needed in electron-phonon
calculations using nesting functions or tetrahedron integration.</p>
<h2 id="kptrlatt_fine"><strong>kptrlatt_fine</strong><a class="headerlink" href="#kptrlatt_fine" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K PoinT Reciprocal LATTice for FINE grid<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,3)<br />
<em>Default value:</em> 9*0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>As kptrlatt above, but for a finer grid of k-points. Under development.
Does not work yet, as ofNovember 05, 2024.</p>
<h2 id="lwf_anchor_ibands"><strong>lwf_anchor_ibands</strong><a class="headerlink" href="#lwf_anchor_ibands" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Lattice Wannier Function: the ANCHOR Indices of BANDS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to build and run Lattice Wannier function Models" data-toggle="popover" href="/topics/LatticeWannier">topic_LatticeWannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/anaddb#lwf_nwann">lwf_nwann</a>)<br />
<em>Default value:</em> [&lsquo;[0]<em><a class="wikilink codevar-wikilink" href="/variables/anaddb#lwf_nwann">lwf_nwann</a>&rsquo;]<br />
*Added in version:</em> 9.8.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>The indices of bands of the anchor points. Together with the <a class="wikilink codevar-wikilink" href="/variables/anaddb#lwf_anchor_qpt">lwf_anchor_qpt</a>, it gives the phonon modes used as anchor points. For example, lwf_anchor_qpt = 0.0 0.0 0.0 and lwf_anchor_ibands= 0 1 2  means the lowest three modes are used as anchor points. The number of anchor ibands should be equal to the number of Wannier functions.</p>
<h2 id="lwf_anchor_proj"><strong>lwf_anchor_proj</strong><a class="headerlink" href="#lwf_anchor_proj" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Lattice Wannier Function ANCHOR point PROJection<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to build and run Lattice Wannier function Models" data-toggle="popover" href="/topics/LatticeWannier">topic_LatticeWannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.8.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<p>Whether to multiply the projection to the anchor points when calculating the weight for the disentanglement when constructing Lattice Wannier function.</p>
<ul>
<li>
<p>0 &rarr; Do not multiply the projection.</p>
</li>
<li>
<p>1 &rarr; Multiply the projection.</p>
</li>
</ul>
<h2 id="lwf_anchor_qpt"><strong>lwf_anchor_qpt</strong><a class="headerlink" href="#lwf_anchor_qpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Lattice Wannier Function: the ANCHOR QPoinTs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to build and run Lattice Wannier function Models" data-toggle="popover" href="/topics/LatticeWannier">topic_LatticeWannier</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Added in version:</em> 9.8.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [2/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a></li>
</ul>
</details>
<p>The q-point of the anchor points. Together with the <a class="wikilink codevar-wikilink" href="/variables/anaddb#lwf_anchor_ibands">lwf_anchor_ibands</a>, it gives the phonon modes used as anchor points. For example, lwf_anchor_qpt = 0.0 0.0 0.0 and lwf_anchor_ibands= 0 1 2  means the lowest three modes are used as anchor points.</p>
<h2 id="lwf_disentangle"><strong>lwf_disentangle</strong><a class="headerlink" href="#lwf_disentangle" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Lattice Wannier Function DISENTANGLE function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to build and run Lattice Wannier function Models" data-toggle="popover" href="/topics/LatticeWannier">topic_LatticeWannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.8.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<p>Type of weight function used in the &ldquo;disentanglement via entanglement&rdquo; method. For any phonon mode, the weight function
to represent the importance of the eigen mode, is a defined as a function of the eigen value (\lambda).</p>
<ul>
<li>
<p>0 &rarr;  The unity function, equals to 1 for any energy.</p>
</li>
<li>
<p>1 &rarr; The Erfc function, $f(\lambda)=\frac{1}{2} erfc(\frac{\lambda-\mu}{\sigma}) $.</p>
</li>
<li>
<p>2 &rarr; The Gaussian function <span><span class="MathJax_Preview">f(\lambda) = exp(\frac{-(\lambda-\mu)^2}{\sigma^2})</span><script type="math/tex">f(\lambda) = exp(\frac{-(\lambda-\mu)^2}{\sigma^2})</script></span>.</p>
</li>
</ul>
<p>The value of <span><span class="MathJax_Preview">\mu</span><script type="math/tex">\mu</script></span> and <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> are defined with <a class="wikilink codevar-wikilink" href="/variables/anaddb#lwf_mu">lwf_mu</a> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#lwf_sigma">lwf_sigma</a>, respectively.</p>
<h2 id="lwf_mu"><strong>lwf_mu</strong><a class="headerlink" href="#lwf_mu" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Lattice Wannier Function: the MU value<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to build and run Lattice Wannier function Models" data-toggle="popover" href="/topics/LatticeWannier">topic_LatticeWannier</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> 9.8.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [2/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<p>The mu (<span><span class="MathJax_Preview">\mu</span><script type="math/tex">\mu</script></span>) parameter in the Lattice Wannier function disentanglement function.
See <a class="wikilink codevar-wikilink" href="/variables/anaddb#lwf_disentangle">lwf_disentangle</a> for more details.</p>
<h2 id="lwf_ngqpt"><strong>lwf_ngqpt</strong><a class="headerlink" href="#lwf_ngqpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Lattice Wannier Function: the Number of Grid of Q-PoinTs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to build and run Lattice Wannier function Models" data-toggle="popover" href="/topics/LatticeWannier">topic_LatticeWannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Added in version:</em> 9.8.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<p>The Monkhorst-Pack grid used for construction Lattice Wannier functions.</p>
<h2 id="lwf_nwann"><strong>lwf_nwann</strong><a class="headerlink" href="#lwf_nwann" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Lattice Wannier Function: Number of WANNier functions<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to build and run Lattice Wannier function Models" data-toggle="popover" href="/topics/LatticeWannier">topic_LatticeWannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.8.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<p>The number of Lattice Wannier functions to be constructed.</p>
<h2 id="lwf_projector"><strong>lwf_projector</strong><a class="headerlink" href="#lwf_projector" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Lattice Wannier Function: the PROJECTORs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to build and run Lattice Wannier function Models" data-toggle="popover" href="/topics/LatticeWannier">topic_LatticeWannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/anaddb#lwf_nwann">lwf_nwann</a>)<br />
<em>Default value:</em> [&lsquo;[0]<em><a class="wikilink codevar-wikilink" href="/variables/anaddb#lwf_nwann">lwf_nwann</a>&rsquo;]<br />
*Added in version:</em> 9.8.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<p>The indices of atomic displacements used as projectors in the construction of Lattice Wannier function with the projected Wannier function method.
For each atom, there are three displacements along x, y, and z in the cartesian coordinate. The list of the displacements are thus (atom 1, x), (atoms 1, y), (atom 1, z), (atom 2, x), etc. The lwf_projector option specifies the indices of the se displacement to be used as projectors. The number of the projectors should equal the number of wannier functions.</p>
<h2 id="lwf_sigma"><strong>lwf_sigma</strong><a class="headerlink" href="#lwf_sigma" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Lattice Wannier Function: the sigma value<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to build and run Lattice Wannier function Models" data-toggle="popover" href="/topics/LatticeWannier">topic_LatticeWannier</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> 9.8.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [2/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<p>The sigma (<span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span>) parameter in the Lattice Wannier function disentanglement function.
See <a class="wikilink codevar-wikilink" href="/variables/anaddb#lwf_disentangle">lwf_disentangle</a> for more details.</p>
<h2 id="lwfflag"><strong>lwfflag</strong><a class="headerlink" href="#lwfflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Lattice Wannier Function Flag<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to build and run Lattice Wannier function Models" data-toggle="popover" href="/topics/LatticeWannier">topic_LatticeWannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 9.8.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<p>Lattice Wannier function flag.</p>
<ul>
<li>
<p>0 &rarr; No Lattice Wannier function constructed.</p>
</li>
<li>
<p>1 &rarr; Lattice Wannier function constructed.</p>
</li>
</ul>
<h2 id="mustar"><strong>mustar</strong><a class="headerlink" href="#mustar" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MU STAR<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [15/74] in all anaddb tests, [3/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: no symmetrization of e-p matrix elements" data-toggle="popover" href="/tests/v5/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: output auxiliary files and change default smearings" data-toggle="popover" href="/tests/v5/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: integrate over window of bands instead of energies" data-toggle="popover" href="/tests/v5/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: change Fermi energy reference to probe e-p coupling of unocc states" data-toggle="popover" href="/tests/v5/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb electron-phonon run: instead of using uniform grid of q-points, treat only a given list" data-toggle="popover" href="/tests/v5/Input/t94.abi" target="_blank">t94.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test rifcsph cutoff radius for IFC Fourier transform. Use output from t85-87" data-toggle="popover" href="/tests/v5/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb run for Ni, from t96 t97 t98. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t99.abi" target="_blank">t99.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>Average electron-electron interaction strength, for the computation of the
superconducting Tc using Mc-Millan&rsquo;s formula.</p>
<h2 id="natfix"><strong>natfix</strong><a class="headerlink" href="#natfix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of AToms FIXed<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to optimize the geometry under constrained polarization" data-toggle="popover" href="/topics/ConstrainedPol">topic_ConstrainedPol</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>Number of atoms that are fixed during a structural optimisation at constrained
polarization. See <a class="wikilink codevar-wikilink" href="/variables/anaddb#polflag">polflag</a>.</p>
<h2 id="natifc"><strong>natifc</strong><a class="headerlink" href="#natifc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of AToms for IFC analysis<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [31/74] in all anaddb tests, [4/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for BaTiO3, same as test18, but IFCs are
obtained from a 2x2x2 non-shifted grid (referred to as M1
in the above-mentioned paper by Ghosez et al).
At q(1/8 1/8 1/8), the lowest frequency is  i 178.8 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Phonon band structure of Al, from DDB of test 78.
The parameters were really too low in test 78, so that some
phonon unstabilities are present close to Gamma.
Similar to Tv2#28" data-toggle="popover" href="/tests/v6/Input/t80.abi" target="_blank">t80.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Use output from t78 to test qrefine: trivially start with 1x1x1 q-point grid and add the 2x2x2
q-points after the method of Gaal Nagy. Not working yet." data-toggle="popover" href="/tests/v6/Input/t81.abi" target="_blank">t81.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
</ul>
</details>
<p>Give the number of atoms for which IFCs are written and eventually analysed.
The list of these atoms is provided by <a class="wikilink codevar-wikilink" href="/variables/anaddb#atifc">atifc</a>.</p>
<h2 id="natprj_bs"><strong>natprj_bs</strong><a class="headerlink" href="#natprj_bs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of AToms for PRoJection of the Band Structure<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>Give the number of atoms for which atomic-projected phonon band structures
will be output. The list of these atoms is provided by <a class="wikilink codevar-wikilink" href="/variables/anaddb#iatprj_bs">iatprj_bs</a>.</p>
<h2 id="nchan"><strong>nchan</strong><a class="headerlink" href="#nchan" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of CHANnels<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 800<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [7/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>The number of channels of width 1 cm<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span> used in calculating the phonon density
of states through the histogram method, or, equivalently, the largest
frequency sampled. The first channel begins at 0.</p>
<h2 id="ndivsm"><strong>ndivsm</strong><a class="headerlink" href="#ndivsm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of DIVisions for the SMallest segment<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 20<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [9/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the AlAs DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_5.abi" target="_blank">trf2_5.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new inteergration weights" data-toggle="popover" href="/tests/v8/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new inteergration weights" data-toggle="popover" href="/tests/v8/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Debye-Waller tensor." data-toggle="popover" href="/tests/v8/Input/t58.abi" target="_blank">t58.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<p>This variable defines the number of divisions used to sample the smallest
segment of the q-path used for the phonon band structure. If <a class="wikilink codevar-wikilink" href="/variables/anaddb#ndivsm">ndivsm</a> is
specified in the input file, the code will automatically generate the points
along the path using the coordinates given in the array <a class="wikilink codevar-wikilink" href="/variables/anaddb#qpath">qpath</a>.</p>
<h2 id="nfreq"><strong>nfreq</strong><a class="headerlink" href="#nfreq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of FREQuencies<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>Number of frequencies wanted for the frequency-dependent dielectric tensor.
Should be positive. See <a class="wikilink codevar-wikilink" href="/variables/anaddb#dieflag">dieflag</a>. The code will take <strong>nfreq</strong>
equidistant values from <a class="wikilink codevar-wikilink" href="/variables/anaddb#frmin">frmin</a> to <a class="wikilink codevar-wikilink" href="/variables/anaddb#frmax">frmax</a>.</p>
<h2 id="ng2qpt"><strong>ng2qpt</strong><a class="headerlink" href="#ng2qpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Grids points for Q PoinTs (grid 2)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [21/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: no symmetrization of e-p matrix elements" data-toggle="popover" href="/tests/v5/Input/t90.abi" target="_blank">t90.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
</ul>
</details>
<p>The Monkhorst-Pack grid linear dimensions, for the finer of the series of fine grids.
Used for the integration of thermodynamical functions (Bose-Einstein distribution) or for the DOS.</p>
<h2 id="ngqpt"><strong>ngqpt</strong><a class="headerlink" href="#ngqpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Grids points for Q PoinTs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [59/74] in all anaddb tests, [8/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
IFCs are computed as in test 16, but by limiting artificially
the number of allowed interacting shells to 2. The total number
of atoms to be taken into account is 17 (1 for the shell 0,
4 for the shell 1, and 12 for the shell 2).
The frequencies at X and L points are again computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1)
in the above-mentioned paper. The number are close, with
small differences at the level of 0.001 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=3, 1D - rotational invariance for anaddb. This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction of electronic structure." data-toggle="popover" href="/tests/v7/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test whether one can read a DDB with the dynamical quadrupole section that is not the last block.
The order of the blocks indeed depend on the list of files passed to mrgddb and the internal implementation
should not assume any particular order" data-toggle="popover" href="/tests/v9/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a> &hellip;</li>
</ul>
</details>
<p>The Monkhorst-Pack grid linear dimensions (coarse grid).
Should correspond to the grid of points available in the DDB or to a sub-grid.</p>
<h2 id="ngrids"><strong>ngrids</strong><a class="headerlink" href="#ngrids" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of GRIDS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [7/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>This number define the series of grids that will be used for the estimation of
the phonon DOS. The coarsest will be tried first, then the next, &hellip; then the
one described by <a class="wikilink codevar-wikilink" href="/variables/anaddb#ng2qpt">ng2qpt</a>. The intermediate grids are defined for
igrid=1&hellip; <a class="wikilink codevar-wikilink" href="/variables/anaddb#ngrids">ngrids</a>, by the numbers
ngqpt_igrid(ii)=(igrid ng2qpt(ii))/<a class="wikilink codevar-wikilink" href="/variables/anaddb#ngrids">ngrids</a>s</p>
<h2 id="nlflag"><strong>nlflag</strong><a class="headerlink" href="#nlflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Non-Linear FLAG<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [5/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 48, for the generation of
the nonlinear coefficients only." data-toggle="popover" href="/tests/v8/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond structure.
Interpolation of the DDB from a 2x2x2 q-points grid
onto a 4x4x4 q-points grid using the interatomic force constants." data-toggle="popover" href="/tests/v8/Input/t64.abi" target="_blank">t64.abi</a></li>
</ul>
</details>
<p>Non-linear properties flag.</p>
<ul>
<li>0 &rarr; do not compute non-linear properties ;</li>
<li>1 &rarr; the electrooptic tensor, Raman susceptibilities and non-linear optical susceptibilities are calculated;</li>
<li>2 &rarr; only the non-linear optical susceptibilities and first-order changes of the dielectric tensor
    induced by an atomic displacement are calculated;</li>
<li>3 &rarr; only the non-linear optical susceptibility is calculated.</li>
</ul>
<h2 id="nph1l"><strong>nph1l</strong><a class="headerlink" href="#nph1l" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of PHonons in List 1<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [55/74] in all anaddb tests, [5/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a simple DDB for quartz, but do not test interatomic
force constants (see test 15 for this). Compute phonon frequencies
at gamma with and without LO-TO splitting." data-toggle="popover" href="/tests/v2/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #67 ,which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to doc/theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t68.abi" target="_blank">t68.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=3, 1D - rotational invariance for anaddb. This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction of electronic structure." data-toggle="popover" href="/tests/v7/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond structure.
Interpolation of the DDB from a 2x2x2 q-points grid
onto a 4x4x4 q-points grid using the interatomic force constants." data-toggle="popover" href="/tests/v8/Input/t64.abi" target="_blank">t64.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon frequncies at Gamma. The selected DDB can raise an error for large tolsym in symanal, that is called for symmetry analysis at gamma." data-toggle="popover" href="/tests/v9/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test whether one can read a DDB with the dynamical quadrupole section that is not the last block.
The order of the blocks indeed depend on the list of files passed to mrgddb and the internal implementation
should not assume any particular order" data-toggle="popover" href="/tests/v9/Input/t67.abi" target="_blank">t67.abi</a> &hellip;</li>
</ul>
</details>
<p>The number of wavevectors in phonon list 1, used for interpolation of the
phonon frequencies. The values of these wavevectors will be specified by
<a class="wikilink codevar-wikilink" href="/variables/anaddb#qph1l">qph1l</a>. The dynamical matrix for these wavevectors, obtained either
directly from the DDB - if <a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcflag">ifcflag</a>=0 - or through the interatomic
forces interpolation - if <a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcflag">ifcflag</a>=1 -), will be diagonalized, and
the corresponding eigenfrequencies will be printed.</p>
<h2 id="nph2l"><strong>nph2l</strong><a class="headerlink" href="#nph2l" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of PHonons in List 2<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [25/74] in all anaddb tests, [3/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code with dipole-quadrupole and quadrupole-quadrupole interactions." data-toggle="popover" href="/tests/tutorespfn/Input/tlw_6.abi" target="_blank">tlw_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the AlAs DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_5.abi" target="_blank">trf2_5.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a simple DDB for quartz, but do not test interatomic
force constants (see test 15 for this). Compute phonon frequencies
at gamma with and without LO-TO splitting." data-toggle="popover" href="/tests/v2/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for BaTiO3 (see also tests 19 and 20). Here,
no use of IFCs is done. Phonon frequencies at the
Gamma, X, M, R and along the Gamma-R line are obtained
directly from the DDB. They are to be compared
with the data in the TABLE II of Ghosez et al, Ferroelectrics,
206-207, 205 (1998), as well as FIGURE I.
At q(1/8 1/8 1/8), the lowest frequency is  i 136.7 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t18.abi" target="_blank">t18.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #67 ,which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to doc/theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t68.abi" target="_blank">t68.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
VN in FCC. Phonon analysis using ANADDB." data-toggle="popover" href="/tests/v6/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
VN in FCC. Phonon analysis using ANADDB.
Differs from test 70 by the modification of acell and rprim inside the DDB." data-toggle="popover" href="/tests/v6/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new inteergration weights" data-toggle="popover" href="/tests/v8/Input/t53.abi" target="_blank">t53.abi</a> &hellip;</li>
</ul>
</details>
<p>The number of wavevectors in phonon list 2, defining the directions along
which the non-analytical splitting of phonon frequencies at Gamma will be
calculated. The actual values of the wavevector directions will be specified
by <a class="wikilink codevar-wikilink" href="/variables/anaddb#qph2l">qph2l</a>. These are actually all wavectors at Gamma, but obtained
by a limit along a different direction in the Brillouin-zone. It is important
to note that non-analyticities in the dynamical matrices are present at Gamma,
due to the long-range Coulomb forces. So, going to Gamma along different
directions can give different results.</p>
<p>The wavevectors in list 2 will be used to:</p>
<ul>
<li>generate and diagonalize a dynamical matrix, and print the corresponding eigenvalues.</li>
<li>calculate the generalized Lyddane-Sachs-Teller relation. Note that if the
  three first numbers are zero, then the code will do a calculation at Gamma without non-analyticities.</li>
</ul>
<h2 id="nqpath"><strong>nqpath</strong><a class="headerlink" href="#nqpath" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Q wavevectors defining a PATH<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [24/74] in all anaddb tests, [4/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: no symmetrization of e-p matrix elements" data-toggle="popover" href="/tests/v5/Input/t90.abi" target="_blank">t90.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a> &hellip;</li>
</ul>
</details>
<p>Number of q-points in the array <a class="wikilink codevar-wikilink" href="/variables/anaddb#qpath">qpath</a> defining the path along which
the phonon band structure and phonon linewidths are interpolated.</p>
<h2 id="nqshft"><strong>nqshft</strong><a class="headerlink" href="#nqshft" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Q SHiFTs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [56/74] in all anaddb tests, [8/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
IFCs are computed as in test 16, but by limiting artificially
the number of allowed interacting shells to 2. The total number
of atoms to be taken into account is 17 (1 for the shell 0,
4 for the shell 1, and 12 for the shell 2).
The frequencies at X and L points are again computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1)
in the above-mentioned paper. The number are close, with
small differences at the level of 0.001 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=3, 1D - rotational invariance for anaddb. This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction of electronic structure." data-toggle="popover" href="/tests/v7/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new inteergration weights" data-toggle="popover" href="/tests/v8/Input/t53.abi" target="_blank">t53.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a> &hellip;</li>
</ul>
</details>
<p>The number of vector shifts of the simple Monkhorst and Pack grid, needed to
generate the coarse grid of q points (for the series of fine grids, the number
of shifts it is always taken to be 1). Usually, put it to 1. Use 2 if BCC
sampling (Warning: not BCC lattice, BCC <em>sampling</em>), and 4 for FCC sampling
(Warning: not FCC lattice, FCC <em>sampling</em>).</p>
<h2 id="nsphere"><strong>nsphere</strong><a class="headerlink" href="#nsphere" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of atoms in SPHERe<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [5/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
IFCs are computed as in test 16, but by limiting artificially
the number of allowed interacting shells to 2. The total number
of atoms to be taken into account is 17 (1 for the shell 0,
4 for the shell 1, and 12 for the shell 2).
The frequencies at X and L points are again computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1)
in the above-mentioned paper. The number are close, with
small differences at the level of 0.001 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t17.abi" target="_blank">t17.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>Number of atoms included in the cut-off sphere for interatomic force constant,
see also the alternative <a class="wikilink codevar-wikilink" href="/variables/anaddb#rifcsph">rifcsph</a>. If <strong>nsphere</strong> = 0: maximum
extent allowed by the grid. If <strong>nsphere</strong> = -1: the code analyzes different
values of nsphere and find the value that does not lead to unstable
frequencies in a small sphere around Gamma. The truncated IFCs are then used
for further post-processing. The results of the test are reported in the main
output file. This option is useful to obtain a initial guess of nsphere: the
value that leads to stable frequencies and gives linear dispersion for the
acoustic modes around Gamma is usually smaller that the one reported by nsphere -1.</p>
<p>This number defines the atoms for which the short range part of the
interatomic force constants, after imposition of the acoustic sum rule, will
not be put to zero. This option is available for testing purposes (evaluate
the range of the interatomic force constants), because the acoustic sum rule
will be violated if some atoms are no more included in the inverse Fourier Transform.</p>
<h2 id="nstrfix"><strong>nstrfix</strong><a class="headerlink" href="#nstrfix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of STRain components FIXed<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to optimize the geometry under constrained polarization" data-toggle="popover" href="/topics/ConstrainedPol">topic_ConstrainedPol</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
</ul>
</details>
<p>Number of strain component that are fixed during a structural optimisation at
constrained polarization. See <a class="wikilink codevar-wikilink" href="/variables/anaddb#polflag">polflag</a>.</p>
<h2 id="ntemper"><strong>ntemper</strong><a class="headerlink" href="#ntemper" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of TEMPERatures<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute vibrational free energy, entropy, specific heat, thermal expansion, as well as atomic temperature factors" data-toggle="popover" href="/topics/Temperature">topic_Temperature</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [12/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction of electronic structure." data-toggle="popover" href="/tests/v7/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>Number of temperatures at which the thermodynamical quantities have to be
evaluated. Now also used for the output of transport quantities in electron-
phonon calculations. The full grid is specified with the <a class="wikilink codevar-wikilink" href="/variables/anaddb#tempermin">tempermin</a>
and <a class="wikilink codevar-wikilink" href="/variables/anaddb#temperinc">temperinc</a> variables. The default temperature grid goes from
100K to 1000K by step of 100K. For the largest temperatures, for most solids,
anharmonic effects not accounted in the harmonic approximation implemented in
anaddb will be important. For weakly bounded systems (e.g. Van der Waals
solids), such anharmonic effects might be important already at room temperature.</p>
<h2 id="nwchan"><strong>nwchan</strong><a class="headerlink" href="#nwchan" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Widths of CHANnels<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [7/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>The width of the largest channel used to sample the frequencies. The
code will generate different sets of channels, with decreasing widths (by step
of 1 cm<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span>), from this channel width to 1, eventually. It considers to have
converged when the convergence criterion based on <a class="wikilink codevar-wikilink" href="/variables/anaddb#dostol">dostol</a> and
<a class="wikilink codevar-wikilink" href="/variables/anaddb#thmtol">thmtol</a> have been fulfilled.</p>
<h2 id="outboltztrap"><strong>outboltztrap</strong><a class="headerlink" href="#outboltztrap" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OUTput files for BOLTZTRAP code<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a></li>
</ul>
</details>
<p>If set to 1, the phonon frequencies on the <a class="wikilink codevar-wikilink" href="/variables/anaddb#ngqpt">ngqpt</a> grid are output in a format
legible by the BoltzTrap code, which does band interpolation and gets group
velocities. The output file will be appended _BTRAP</p>
<h2 id="outdata_prefix"><strong>outdata_prefix</strong><a class="headerlink" href="#outdata_prefix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OUTput DATA PREFIX<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> string<br />
<em>Dimensions:</em> string<br />
<em>Default value:</em> <br />
<em>Added in version:</em> 9.2.2  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [3/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="!Input file for the anaddb code. Analysis of the AlAs DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_4.abi" target="_blank">trf2_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the AlAs DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_5.abi" target="_blank">trf2_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
</ul>
</details>
<p>This variable specifies the prefix name of the output files when anaddb is invoked with the new syntax:</p>
<div class="codehilite"><pre><span></span><code>anaddb t01.in &gt; log 2&gt; err
</code></pre></div>

<p>instead of the legacy mode based on the files file. Example:</p>
<div class="codehilite"><pre><span></span><code>outdata_prefix = &quot;t01_o&quot;
</code></pre></div>

<p>See also <a class="wikilink codevar-wikilink" href="/variables/files#outdata_prefix">outdata_prefix@abinit</a></p>
<h2 id="output_file"><strong>output_file</strong><a class="headerlink" href="#output_file" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OUTPUT FILE<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> string<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [4/74] in all anaddb tests, [3/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="!Input file for the anaddb code. Analysis of the AlAs DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_4.abi" target="_blank">trf2_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the AlAs DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_5.abi" target="_blank">trf2_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a></li>
</ul>
</details>
<p>This variable specifies the name of the output file when anaddb is invoked with the new syntax:</p>
<div class="codehilite"><pre><span></span><code>anaddb t01.in &gt; log 2&gt; err
</code></pre></div>

<p>instead of the legacy mode based on the files file. Example:</p>
<div class="codehilite"><pre><span></span><code>output = &quot;t01.out&quot;
</code></pre></div>

<h2 id="outscphon"><strong>outscphon</strong><a class="headerlink" href="#outscphon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OUTput files for Self Consistent PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>If set to 1, the phonon frequency and eigenvector files needed for a Self
Consistent phonon run (as in <a class="wikilink citation-wikilink" data-tippy-content="Entropy Driven Stabilization of Energetically Unstable Crystal Structures Explained from First Principles Theory" data-toggle="popover" href="/theory/bibliography#souvatzis2008">[Souvatzis2008]</a>) will be output to
files appended _PHFRQ and _PHVEC. The third file needed is appended _PCINFO
for Primitive Cell INFOrmation.</p>
<h2 id="piezoflag"><strong>piezoflag</strong><a class="headerlink" href="#piezoflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PIEZOelectric tensor FLAG<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute elastic, piezoelectric and internal strain tensors from DFPT" data-toggle="popover" href="/topics/Elastic">topic_Elastic</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [5/74] in all anaddb tests, [3/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="The input file for the anaddb code" data-toggle="popover" href="/tests/tutorespfn/Input/telast_3.abi" target="_blank">telast_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_3.abi" target="_blank">tpolarization_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #67 ,which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to doc/theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #69, which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to Infos/Theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t70.abi" target="_blank">t70.abi</a></li>
</ul>
</details>
<p>Flag for calculation of piezoelectric tensors</p>
<ul>
<li>0 &rarr; No piezoelectric tensor will be calculated.</li>
<li>1 &rarr; Only the clamped-ion piezoelectric tensor is computed and printed.
    Requirements for preceding response-function DDB generation run: Strain and electric-field responses.
    For the electric-field part, one needs results from a prior &lsquo;ddk perturbation&rsquo; run.
    Note that even if only a limited number of piezoelectric tensor terms are wanted
    (as determined by <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> in this calculation) it is necessary to set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> = 1 1 1
    in the d/dk calculation for most structures. The only obvious exception to this requirement
    is cases in which the primitive lattice vectors are all aligned with the cartesian axes.
    The code will omit terms in the output piezoelectric tensor for which the available d/dk set is incomplete.
    Thus: Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> to 1, 2, or 3 (preferably 3)</li>
<li>2 &rarr; Both relaxed- and clamped-ion elastic and compliance tensor will be calculated,
    but only the relaxed-ion quantities will be printed. The input variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a>
    should also be set to 1, because the internal-strain tensor is needed to compute the relaxed-ion corrections.
    Requirements for preceding response-function DDB generation run: Strain, electric-field and full atomic-displacement
    responses at Q=0. Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> = 1, 2, or 3 (preferably 3). Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> = 3.
    Set <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a> and &lt;<a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> to do a full calculation of phonons at Q=0
    (needed because the inverse of force-constant tensor is required).</li>
<li>3 &rarr; Both relaxed and clamped-ion piezoelectric tensors will be printed out.
    The input variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a> should also be set to 1.
    Requirements for preceding response-function DDB generation run: Same as for <strong>piezoflag</strong> =2.</li>
<li>4 &rarr; Calculate the piezoelectric d tensor (relaxed ion). In order to calculate the piezoelectric d tensor,
    we need information of internal strain and elastic tensor (relaxed ion).
    So we should set <a class="wikilink codevar-wikilink" href="/variables/anaddb#elaflag">elaflag</a>= 2,3,4, or 5 and <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a>=1.
    The subroutine will also do a check for you, and print warning message without stopping even if flags were not correctly set.</li>
<li>5 &rarr; Calculate the piezoelectric g tensor (relaxed ion). In this computation,
    we need information of internal strain, elastic tensor (relaxed ion) and dielectric tensor (relaxed ion).
    So we should set: <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a>=1, <a class="wikilink codevar-wikilink" href="/variables/anaddb#elaflag">elaflag</a>=2,3,4 or 5, <a class="wikilink codevar-wikilink" href="/variables/anaddb#dieflag">dieflag</a>=3 or 4.
    The subroutine will also do a check for you, and print warning message without stopping even if flags were not correctly set.</li>
<li>6 &rarr; Calculate the piezoelectric h tensor (relaxed ion). In this calculation, we need information
    of internal strain and dielectric tensor (relaxed ion). So we need set: <a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a>=1
    and <a class="wikilink codevar-wikilink" href="/variables/anaddb#dieflag">dieflag</a>=3 or 4. The subroutine will also do a check for you, and print warning message
    without stopping even if flags were not correctly set.</li>
<li>7 &rarr; calculate all the possible piezoelectric tensors, including e (clamped and relaxed ion), d, g and h tensors.
    The flags should be set to satisfy the above rules from 1 to 6.</li>
</ul>
<h2 id="polflag"><strong>polflag</strong><a class="headerlink" href="#polflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> POLarization FLAG<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to optimize the geometry under constrained polarization" data-toggle="popover" href="/topics/ConstrainedPol">topic_ConstrainedPol</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Use ANADDB to compute the polarization of the previous two tests in cartesian coordinates." data-toggle="popover" href="/tests/v4/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. (Test of Na Sai&#x27;s technique)
To impose a polarization on AlAs:
compute new values of the cell parameters and atomic positions.
(in practical calculations, these operations must be repeated until convergence is reached)" data-toggle="popover" href="/tests/v4/Input/t77.abi" target="_blank">t77.abi</a></li>
</ul>
</details>
<p>If activated, compute polarization in cartesian coordinates, and update
lattice constants and atomic positions in order to perform a structural
optimization at constrained polarization.</p>
<p>More detailed explanation: ANADDB can use the formalism described in
<a class="wikilink citation-wikilink" data-tippy-content="Theory of structural response to macroscopic electric fields in ferroelectric systems" data-toggle="popover" href="/theory/bibliography#sai2002">[Sai2002]</a>, to perform structural relaxations under the
constraint that the polarization is equal to a value specified by the input
variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#targetpol">targetpol</a>. The user starts from a given configuration of a
crystal and performs a ground-state calculation of the Hellman-Feynman forces
and stresses and the Berry phase polarization as well as a linear response
calculation of the whole matrix of second-order energy derivatives with
respect to atomic displacement, strains and electric field.
In case <strong>polflag</strong> =1, ANADDB solves the linear system of equations (13) in
<a class="wikilink citation-wikilink" data-tippy-content="Theory of structural response to macroscopic electric fields in ferroelectric systems" data-toggle="popover" href="/theory/bibliography#sai2002">[Sai2002]</a>, and computes new atomic positions (if <a class="wikilink codevar-wikilink" href="/variables/anaddb#relaxat">relaxat</a>=1)
and lattice constant (if <a class="wikilink codevar-wikilink" href="/variables/anaddb#relaxstr">relaxstr</a>=1). Then, the user uses these
parameters to perform a new ground-state and linear-response calculation. This
must be repeated until convergence is reached. The user can also fix some
atomic positions, or strains, thanks to the input variables <a class="wikilink codevar-wikilink" href="/variables/anaddb#natfix">natfix</a>,
<a class="wikilink codevar-wikilink" href="/variables/anaddb#nstrfix">nstrfix</a>,<a class="wikilink codevar-wikilink" href="/variables/anaddb#iatfix">iatfix</a>,<a class="wikilink codevar-wikilink" href="/variables/anaddb#istrfix">istrfix</a>.
In case both <a class="wikilink codevar-wikilink" href="/variables/anaddb#relaxat">relaxat</a> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#relaxstr">relaxstr</a> are 0, while
<strong>polflag</strong> =1, ANADDB only computes the polarization in cartesian coordinates.</p>
<p>As described in <a class="wikilink citation-wikilink" data-tippy-content="Theory of structural response to macroscopic electric fields in ferroelectric systems" data-toggle="popover" href="/theory/bibliography#sai2002">[Sai2002]</a>, it is important to use the finite
difference expression of the ddk (<a class="wikilink codevar-wikilink" href="/variables/ffield#berryopt">berryopt</a>=2 or -2) in the linear response
calculation of the effective charges and the piezoelectric tensor.</p>
<h2 id="prt_ifc"><strong>prt_ifc</strong><a class="headerlink" href="#prt_ifc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the Interatomic Force Constants<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Flag to print out the Interatomic Force Constants in real space to a file.
The available options are:</p>
<ul>
<li>0 &rarr; do nothing (IFC are printed to the log file);</li>
<li>1 &rarr; write out the IFC in file ifcinfo.out (the name is fixed) to be used by AI2PS from John Rehr&rsquo;s group</li>
</ul>
<h2 id="prtbltztrp"><strong>prtbltztrp</strong><a class="headerlink" href="#prtbltztrp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT input files for BoLTZTRaP code.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<ul>
<li>0 &rarr; do not write the BoltzTraP input files;</li>
<li>1 &rarr; write out the input files for BoLTZTRaP code.</li>
</ul>
<h2 id="prtddb"><strong>prtddb</strong><a class="headerlink" href="#prtddb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the Derivative DataBase files<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond structure.
Interpolation of the DDB from a 2x2x2 q-points grid
onto a 4x4x4 q-points grid using the interatomic force constants." data-toggle="popover" href="/tests/v8/Input/t64.abi" target="_blank">t64.abi</a></li>
</ul>
</details>
<p>Flag to print out the DDB file interpolated with the Interatomic Force Constants.</p>
<p>The available options are:</p>
<ul>
<li>0 &rarr; no output of DDB;</li>
<li>1 &rarr; Interpolate the DDB and write out the DDB and DDB.nc files.</li>
</ul>
<h2 id="prtdos"><strong>prtdos</strong><a class="headerlink" href="#prtdos" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the phonon Density Of States<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [13/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: no symmetrization of e-p matrix elements" data-toggle="popover" href="/tests/v5/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: output auxiliary files and change default smearings" data-toggle="popover" href="/tests/v5/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: integrate over window of bands instead of energies" data-toggle="popover" href="/tests/v5/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: change Fermi energy reference to probe e-p coupling of unocc states" data-toggle="popover" href="/tests/v5/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb electron-phonon run: instead of using uniform grid of q-points, treat only a given list" data-toggle="popover" href="/tests/v5/Input/t94.abi" target="_blank">t94.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test rifcsph cutoff radius for IFC Fourier transform. Use output from t85-87" data-toggle="popover" href="/tests/v5/Input/t95.abi" target="_blank">t95.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new inteergration weights" data-toggle="popover" href="/tests/v8/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new inteergration weights" data-toggle="popover" href="/tests/v8/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Debye-Waller tensor." data-toggle="popover" href="/tests/v8/Input/t58.abi" target="_blank">t58.abi</a></li>
</ul>
</details>
<p>The <strong>prtdos</strong> variable is used to calculate the phonon density of states,
PHDOS, by Fourier interpolating the interatomic force constants on the (dense)
q-mesh defined by <a class="wikilink codevar-wikilink" href="/variables/anaddb#ng2qpt">ng2qpt</a>. Note that the variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcflag">ifcflag</a>
must be set to 1 since the interatomic force constants are supposed to be known.</p>
<p>The available options are:</p>
<ul>
<li>0 &rarr; No output of PHDOS (default);</li>
<li>1 &rarr; Calculate PHDOS using the gaussian method and the broadening defined by <a class="wikilink codevar-wikilink" href="/variables/anaddb#dossmear">dossmear</a>. This is the recommended technique, as usually the interpolation q-point grid is very fine.</li>
<li>2 &rarr; Calculate PHDOS using the tetrahedron method. The tetrahedron DOS has Van Hove singularities, and this might yield problems with further post-treatment of the DOS.</li>
</ul>
<p>The step of the frequency grid employed to calculate the DOS can be defined
through the input variable <a class="wikilink codevar-wikilink" href="/variables/anaddb#dosdeltae">dosdeltae</a>.</p>
<h2 id="prtfsurf"><strong>prtfsurf</strong><a class="headerlink" href="#prtfsurf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the Fermi SURFace<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>Only for electron-phonon calculations. The available options are:</p>
<ul>
<li>0 &rarr; do not write the Fermi Surface;</li>
<li>1 &rarr; write out the Fermi Surface in the BXSF format used by <a href="http://www.xcrysden.org">XCrySDen</a>.</li>
</ul>
<p>Further comments:</p>
<p>a) Only the eigenvalues for k-points inside the Irreducible Brillouin zone are
required. As a consequence it is possible to use <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> =1 during the GS
calculation to reduce the computational effort.</p>
<p>b) Only unshifted k-grids that are orthogonal in reduced space are supported
by <a href="http://www.xcrysden.org">XCrySDen</a>. This implies that <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> must be
set to (0,0,0) during the GS calculation with <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a>=1. Furthermore if
<a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> is used to generate the k-grid, all the off-diagonal elements of
this array must be zero.</p>
<h2 id="prtmbm"><strong>prtmbm</strong><a class="headerlink" href="#prtmbm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT Mode-By-Mode decomposition of the electrooptic tensor<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<ul>
<li>0 &rarr; do not write the mode-by-mode decomposition of the electrooptic tensor;</li>
<li>1 &rarr; write out the contribution of the individual zone-center phonon modes to the electrooptic tensor.</li>
</ul>
<h2 id="prtnest"><strong>prtnest</strong><a class="headerlink" href="#prtnest" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the NESTing function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [5/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>Only for electron-phonon calculations. This input variable is used to
calculate the nesting function defined as:</p>
<div>
<div class="MathJax_Preview">
\chi_{nm}(q) = \sum_k\delta(\epsilon_{k,n}-\epsilon_F) \delta(\epsilon_{k+q,m}-\epsilon_F).
</div>
<script type="math/tex; mode=display">
\chi_{nm}(q) = \sum_k\delta(\epsilon_{k,n}-\epsilon_F) \delta(\epsilon_{k+q,m}-\epsilon_F).
</script>
</div>
<p>The nesting factor is calculated for every point of the k-grid employed during the
previous GS calculation. The values are subsequently interpolated along the
trajectory in q space defined by <a class="wikilink codevar-wikilink" href="/variables/anaddb#qpath">qpath</a>, and written in the <code>kpluq</code>
file using the X-Y format ( <strong>prtnest</strong> =1). It is also possible to analyze
the behavior of the function in the reciprocal unit cell saving the values in
the NEST_XSF file that can be read using <a href="http://www.xcrysden.org">XCrySDen</a> (<strong>prtnest</strong> =2).</p>
<p>Note that in the present implementation what is really
printed to file is the &ldquo;total nesting&rdquo; defined as <span><span class="MathJax_Preview">\sum_{nm} \chi_{nm}(q)</span><script type="math/tex">\sum_{nm} \chi_{nm}(q)</script></span>.
Limitations: the k-grid defined by <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> must be orthogonal in
reciprocal space, moreover off-diagonal elements are not allowed, i.e. <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>
4 0 0 0 4 0 0 0 4 is fine while <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> = 1 0 0 0 1 1 0 -1 1 will not work.</p>
<ul>
<li>0 &rarr; do not write the nesting function;</li>
<li>1 &rarr; write only the nesting function along the q-path in the X-Y format;</li>
<li>2 &rarr; write out the nesting function both in the X-Y and in the XSF format.</li>
</ul>
<h2 id="prtphbands"><strong>prtphbands</strong><a class="headerlink" href="#prtphbands" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT PHonon BANDS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a></li>
</ul>
</details>
<p>Only if <a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcflag">ifcflag</a>=1. This option specifies the file format for the
phonon band structure. Possible values:</p>
<ul>
<li>1 Write frequencies in xmgrace format. A file with extension <code>PHBANDS.agr</code> is produced.
     Use <code>xmgrace file_PHBANDS.agr</code> to visualize the data</li>
<li>2 Write frequencies in gnuplot format. The code produces a <code>PHBANDS.dat</code> file with the eigenvalues
    and a <code>PHBANDS.gnuplot</code> script. Use <code>gnuplot file_PHBANDS.gnuplot</code> to visualize the phonon band structure.</li>
</ul>
<h2 id="prtsrlr"><strong>prtsrlr</strong><a class="headerlink" href="#prtsrlr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the Short-Range/Long-Range decomposition of phonon FREQuencies<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>Only if <a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcflag">ifcflag</a>=1. The available options are:</p>
<ul>
<li>0 &rarr; do not write the SR/LR decomposition of phonon frequencies;</li>
<li>1 &rarr; write out the SR/LR decomposition of the square of phonon frequencies at each q-point specified in <a class="wikilink codevar-wikilink" href="/variables/anaddb#qph1l">qph1l</a>.</li>
</ul>
<p>For details see <a class="wikilink citation-wikilink" data-tippy-content="Coulomb interaction and ferroelectric instability of BaTiO3" data-toggle="popover" href="/theory/bibliography#ghosez1996">[Ghosez1996]</a>.
See also <a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcflag">ifcflag</a> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#dipdip">dipdip</a>.</p>
<h2 id="prtvol"><strong>prtvol</strong><a class="headerlink" href="#prtvol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT VOLume<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute vibrational free energy, entropy, specific heat, thermal expansion, as well as atomic temperature factors" data-toggle="popover" href="/topics/Temperature">topic_Temperature</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a></li>
</ul>
</details>
<p>Control the volume of printed output.</p>
<h2 id="q1shft"><strong>q1shft</strong><a class="headerlink" href="#q1shft" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q shifts for the grid number 1<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [56/74] in all anaddb tests, [8/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
IFCs are computed as in test 16, but by limiting artificially
the number of allowed interacting shells to 2. The total number
of atoms to be taken into account is 17 (1 for the shell 0,
4 for the shell 1, and 12 for the shell 2).
The frequencies at X and L points are again computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1)
in the above-mentioned paper. The number are close, with
small differences at the level of 0.001 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=3, 1D - rotational invariance for anaddb. This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction of electronic structure." data-toggle="popover" href="/tests/v7/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new inteergration weights" data-toggle="popover" href="/tests/v8/Input/t53.abi" target="_blank">t53.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a> &hellip;</li>
</ul>
</details>
<p>This vector gives the shifts needed to define the coarse q-point grid.</p>
<p>a) Case <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>=1 In general, 0.5 0.5 0.5 with the ngqpt&rsquo;s even will give
very economical grids. On the other hand, is it sometimes better for phonons to
have the Gamma point in the grid. In that case, 0.0 0.0 0.0 should be OK. For
the hexagonal lattice, the above mentioned quantities become 0.0 0.0 0.5 and
0.0 0.0 0.0 .</p>
<p>b) Case <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>=2 The two q1shft vectors must form a BCC lattice. For
example, use 0.0 0.0 0.0 and 0.5 0.5 0.5</p>
<p>c) Case <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>=4 The four q1shft vectors must form a FCC lattice. For
example, use 0.0 0.0 0.0, 0.0 0.5 0.5, 0.5 0.0 0.5, 0.5 0.5 0.0 or 0.5 0.5 0.5,
0.0 0.0 0.5, 0.0 0.5 0.0, 0.5 0.0 0.0 (the latter is referred to as shifted)</p>
<p>Further comments: by using this technique, it is possible to increase smoothly
the number of q-points, at least less abruptly than relying on series of grids
like (for the full cubic symmetry):</p>
<p>1x1x1 &rarr; (0 0 0)
2x2x2 (shifted) &rarr; (.25 .25 .25)
2x2x2 &rarr; 1x1x1 + (.5 0 0) (.5 .5 0) (.5 .5 0)
4x4x4 &rarr; 2x2x2 + (.25 0 0) (.25 .25 0) (.25 .5 0) (.25 .25 .25) (.25 .25 .5)
(.25 .5 .5)
&hellip;</p>
<p>with respectively 1, 1, 4 and 10 q-points, corresponding to a number of points
in the full BZ of 1, 8, 8 and 64. Indeed, the following grids are made
available:
1x1x1 with <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>=2 &rarr; (0 0 0) (.5 .5 .5)
1x1x1 with <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>=4 &rarr; (0 0 0) (.5 .5 0)
1x1x1 with <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>=4 (shifted) &rarr; (.5 0 0) (.5 .5 .5)
2x2x2 with <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>=2 &rarr; 2x2x2 + (.25 .25 .25)
2x2x2 with <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>=4 &rarr; 2x2x2 + (.25 .25 0) (.25 .25 .5)
2x2x2 with <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>=4 (shifted) &rarr; (.25 0 0) (.25 .25 .25) (.5 .5 .25) (.25 .5 0)
&hellip;</p>
<p>with respectively 2, 2, 2, 5, 6 and 4 q-points, corresponding to a number of
points in the full BZ of 2, 4, 4, 16, 32 and 32.</p>
<p>For a FCC lattice, it is possible to sample only the Gamma point by using a
1x1x1 BCC sampling (<a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a>=2).</p>
<h2 id="q2shft"><strong>q2shft</strong><a class="headerlink" href="#q2shft" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q points SHiFTs for the grids 2<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3* 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [4/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a></li>
</ul>
</details>
<p>Similar to <a class="wikilink codevar-wikilink" href="/variables/anaddb#q1shft">q1shft</a>, but for the series of fine grids.</p>
<p>Note that <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqshft">nqshft</a> for this series of grids corresponds to 1.</p>
<h2 id="qgrid_type"><strong>qgrid_type</strong><a class="headerlink" href="#qgrid_type" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q GRID TYPE<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb electron-phonon run: instead of using uniform grid of q-points, treat only a given list" data-toggle="popover" href="/tests/v5/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>If <strong>qgrid_type</strong> is set to 1, the electron-phonon part of anaddb will use the
<a class="wikilink codevar-wikilink" href="/variables/anaddb#ep_nqpt">ep_nqpt</a> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#ep_qptlist">ep_qptlist</a> variables to determine which
q-points to calculate the electron-phonon coupling for. This is an alternative
to a regular grid as in the rest of anaddb (using <a class="wikilink codevar-wikilink" href="/variables/anaddb#ngqpt">ngqpt</a>).</p>
<h2 id="qpath"><strong>qpath</strong><a class="headerlink" href="#qpath" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q wavevectors defining a PATH<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="/variables/anaddb#nqpath">nqpath</a>)<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [24/74] in all anaddb tests, [4/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: no symmetrization of e-p matrix elements" data-toggle="popover" href="/tests/v5/Input/t90.abi" target="_blank">t90.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a> &hellip;</li>
</ul>
</details>
<p>It is used to generate the path along which the phonon band structure and
phonon linewidths are interpolated. There are <a class="wikilink codevar-wikilink" href="/variables/anaddb#nqpath">nqpath</a>-1 segments to
be defined, each of which starts from the end point of the previous one. The
number of divisions in each segment is automatically calculated inside the
code to respect the proportion between the segments. The same circuit is used
for the output of the nesting function if <a class="wikilink codevar-wikilink" href="/variables/anaddb#prtnest">prtnest</a>=1.</p>
<h2 id="qph1l"><strong>qph1l</strong><a class="headerlink" href="#qph1l" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q for PHonon List 1<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (4,<a class="wikilink codevar-wikilink" href="/variables/anaddb#nph1l">nph1l</a>)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [54/74] in all anaddb tests, [5/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron-phonon calculation." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_4.abi" target="_blank">teph_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a simple DDB for quartz, but do not test interatomic
force constants (see test 15 for this). Compute phonon frequencies
at gamma with and without LO-TO splitting." data-toggle="popover" href="/tests/v2/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #67 ,which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to doc/theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t68.abi" target="_blank">t68.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tests asr=3, 1D - rotational invariance for anaddb. This algorithm has never been finalized." data-toggle="popover" href="/tests/v5/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond structure.
Interpolation of the DDB from a 2x2x2 q-points grid
onto a 4x4x4 q-points grid using the interatomic force constants." data-toggle="popover" href="/tests/v8/Input/t64.abi" target="_blank">t64.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon frequncies at Gamma. The selected DDB can raise an error for large tolsym in symanal, that is called for symmetry analysis at gamma." data-toggle="popover" href="/tests/v9/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test whether one can read a DDB with the dynamical quadrupole section that is not the last block.
The order of the blocks indeed depend on the list of files passed to mrgddb and the internal implementation
should not assume any particular order" data-toggle="popover" href="/tests/v9/Input/t67.abi" target="_blank">t67.abi</a> &hellip;</li>
</ul>
</details>
<p>List of <a class="wikilink codevar-wikilink" href="/variables/anaddb#nph1l">nph1l</a> wavevectors, at which the phonon frequencies will be
interpolated. Defined by 4 numbers: the wavevector is made by the three first
numbers divided by the fourth one (a normalisation factor). The coordinates
are defined with respect to the unit vectors that spans the Brillouin zone.
Note that this set of axes can be non-orthogonal and not normed. The
normalisation factor makes easier the input of wavevector such as
(&#8531;,&#8531;,&#8531;), represented by 1.0 1.0 1.0 3.0 .
The internal representation of this array is as follows: for each wavevector,
the three first numbers are stored in the array qph1l(3,nph1l), while the
fourth is stored in the array qnrml1(nph1l).</p>
<h2 id="qph2l"><strong>qph2l</strong><a class="headerlink" href="#qph2l" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PHonon List 2<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (4,<a class="wikilink codevar-wikilink" href="/variables/anaddb#nph2l">nph2l</a>)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [25/74] in all anaddb tests, [3/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code with dipole-quadrupole and quadrupole-quadrupole interactions." data-toggle="popover" href="/tests/tutorespfn/Input/tlw_6.abi" target="_blank">tlw_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the AlAs DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_5.abi" target="_blank">trf2_5.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a simple DDB for quartz, but do not test interatomic
force constants (see test 15 for this). Compute phonon frequencies
at gamma with and without LO-TO splitting." data-toggle="popover" href="/tests/v2/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for BaTiO3 (see also tests 19 and 20). Here,
no use of IFCs is done. Phonon frequencies at the
Gamma, X, M, R and along the Gamma-R line are obtained
directly from the DDB. They are to be compared
with the data in the TABLE II of Ghosez et al, Ferroelectrics,
206-207, 205 (1998), as well as FIGURE I.
At q(1/8 1/8 1/8), the lowest frequency is  i 136.7 cm-1 ." data-toggle="popover" href="/tests/v2/Input/t18.abi" target="_blank">t18.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
BaTiO3, cubic structure.
Test the use of eivec=4, to produces files from which the
phonon band structure can be plotted (test 51). However, due
to problems of portability, the output files of this tests are
NOT used for the next one. Rather, files produced on one specific
platforms have been fixed as input of the next test, and are present
as t51_band2eps.displ and t51_band2eps.freq." data-toggle="popover" href="/tests/v4/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is the anaddb calculation for the case #67 ,which uses DDB file
generated by previous calculation. In this run, several tensors under
different boundary conditions are computed. They are respectly: relaxed ion
dielectric tensor, free-stress dielectric tensor; relaxed ion elastic
(and compliance) tensors under fixed-electric and under fixed-
displacement field boundary conditions; internal strain tensors (
force response and displacement response); relaxed ion  piezoelectric
tensors of several different definations (e, d, g, h tensors).
Please refer to doc/theory/vanderbilt-anaddb-notes.pdf for details.
In the previous version, only relaxed(clamped) ion dielectric, piezoelectric,
elastic tensors and internal strain tensors were computed. In this new version,
piezoelectric (d, g, h tensors), free-stress dielectric tensor, elastic
tensors at fixed displacement filed and elastic tensor with stress correction
are the new abilities of anaddb." data-toggle="popover" href="/tests/v4/Input/t68.abi" target="_blank">t68.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
VN in FCC. Phonon analysis using ANADDB." data-toggle="popover" href="/tests/v6/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
VN in FCC. Phonon analysis using ANADDB.
Differs from test 70 by the modification of acell and rprim inside the DDB." data-toggle="popover" href="/tests/v6/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new integration weights" data-toggle="popover" href="/tests/v8/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolerance in the new inteergration weights" data-toggle="popover" href="/tests/v8/Input/t53.abi" target="_blank">t53.abi</a> &hellip;</li>
</ul>
</details>
<p>List of phonon wavevector <em>directions</em> along which the non-analytical
correction to the Gamma-point phonon frequencies will be calculated (for
insulators). Four numbers, as for <a class="wikilink codevar-wikilink" href="/variables/anaddb#qph1l">qph1l</a>, but where the last one,
that correspond to the normalisation factor, is 0.0 For the anaddb code, this
has the meaning that the three previous values define a direction. The
direction is in CARTESIAN COORDINATES, unlike the non-Gamma wavevectors
defined in the first list of vectors&hellip;</p>
<p>Note that if the three first numbers are zero, then the code will do a
calculation at Gamma without non-analyticities.</p>
<p>Also note that the code automatically sets the imaginary part of the dynamical
matrix to zero. This is useful to compute the phonon frequencies when half of
the k-points has been used, by the virtue of the time-reversal symmetry (which
may induce parasitic imaginary parts&hellip;).
The internal representation of this array is as follows: for each wavevector,
the three first numbers are stored in the array qph2l(3,nph2l), while the
fourth is stored in the array qnrml2(nph2l).</p>
<h2 id="qrefine"><strong>qrefine</strong><a class="headerlink" href="#qrefine" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q-point REFINEment order (experimental)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Use output from t78 to test qrefine: trivially start with 1x1x1 q-point grid and add the 2x2x2
q-points after the method of Gaal Nagy. Not working yet." data-toggle="popover" href="/tests/v6/Input/t81.abi" target="_blank">t81.abi</a></li>
</ul>
</details>
<p>If <strong>qrefine</strong> is superior to 1, attempts to initialize a first set of
dynamical matrices from the DDB file, with a q-point grid which is
<a class="wikilink codevar-wikilink" href="/variables/anaddb#ngqpt">ngqpt</a> divided by <strong>qrefine</strong> (e.g. ngqpt 4 4 2 qrefine 2 2 1 starts
with a 2x2x2 grid). The dynamical matrices are interpolated onto the full
<a class="wikilink codevar-wikilink" href="/variables/anaddb#ngqpt">ngqpt</a> grid and any additional information found in the DDB file is
imposed, before proceeding to normal band structure and other interpolations.
Should implement Gaal-Nagy&rsquo;s algorithm in <a class="wikilink citation-wikilink" data-tippy-content="Phonons in the $\beta$-tin,Imma, and sh phases of silicon from ab initio calculations" data-toggle="popover" href="/theory/bibliography#gaalnagy2006">[GaalNagy2006]</a>.</p>
<h2 id="quadquad"><strong>quadquad</strong><a class="headerlink" href="#quadquad" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> QUADdrupole-QUADdrupole interaction<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute spatial dispersion properties with the longwave DFPT approach." data-toggle="popover" href="/topics/longwave">topic_longwave</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [4/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code with dipole-quadrupole and quadrupole-quadrupole interactions." data-toggle="popover" href="/tests/tutorespfn/Input/tlw_6.abi" target="_blank">tlw_6.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method." data-toggle="popover" href="/tests/tutorial/Input/tlwf_1.abi" target="_blank">tlwf_1.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with SCDM-k method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t110.abi" target="_blank">t110.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Construct Lattice Wannier functions from phonon with projected WF method,
disentangle function 2 (Erfc),and generate PHFRQ file." data-toggle="popover" href="/tests/v9/Input/t111.abi" target="_blank">t111.abi</a></li>
</ul>
</details>
<ul>
<li>0 &rarr; the quadrupole-quadrupole interaction is not handled separately in the treatment of the interatomic forces.</li>
<li>1 &rarr; the quadrupole-quadrupole interaction is subtracted from the dynamical matrices before Fourier transform,
  so that only the short-range part is handled in real space. Of course, it is reintroduced analytically
  when the phonon spectrum is interpolated. Requires a preceding generation of 3<sup>rd</sup> order DDB with a <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_qdrpl">lw_qdrpl</a> = 1
  or a <a class="wikilink codevar-wikilink" href="/variables/dfpt#lw_flexo">lw_flexo</a> = 1 or 2 run.</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The default value is 1.
This means that the quadrupole-quadrupole interaction is always included <strong>provided</strong> the DDB file contains
the dynamical quadrupoles.
If the DDB file does not contain the dynamical quadrupoles, this variable is automatically set to zero at runtime.</p>
</div>
<h2 id="ramansr"><strong>ramansr</strong><a class="headerlink" href="#ramansr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RAMAN Sum-Rule<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute Raman intensity, and the related electro-optic coefficients" data-toggle="popover" href="/topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>Governs the imposition of the sum-rule on the Raman tensors.
As in the case of the Born effective charges, the first-order derivatives of
the linear dielectric susceptibility with respect to an atomic displacement
must vanish when they are summed over all atoms. This sum rule is broken in
most calculations. By putting <strong>ramansr</strong> equal to 1 or 2, this sum rule is
imposed by giving each atom a part of the discrepancy.</p>
<ul>
<li>0 &rarr; no sum rule is imposed;</li>
<li>1 &rarr; impose the sum rule on the Raman tensors, giving each atom an equal part of the discrepancy;</li>
<li>2 &rarr; impose the sum rule on the Raman tensors, giving each atom a part of the discrepancy
    proportional to the magnitude of its contribution to the Raman tensor.</li>
</ul>
<p>For the time being, <strong>ramansr</strong> =1 is the preferred choice.</p>
<h2 id="relaxat"><strong>relaxat</strong><a class="headerlink" href="#relaxat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RELAXation of AToms<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to optimize the geometry under constrained polarization" data-toggle="popover" href="/topics/ConstrainedPol">topic_ConstrainedPol</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Use ANADDB to compute the polarization of the previous two tests in cartesian coordinates." data-toggle="popover" href="/tests/v4/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. (Test of Na Sai&#x27;s technique)
To impose a polarization on AlAs:
compute new values of the cell parameters and atomic positions.
(in practical calculations, these operations must be repeated until convergence is reached)" data-toggle="popover" href="/tests/v4/Input/t77.abi" target="_blank">t77.abi</a></li>
</ul>
</details>
<p>If <strong>relaxat</strong> =1, relax atomic positions during a structural relaxation at
constrained polarization. See <a class="wikilink codevar-wikilink" href="/variables/anaddb#polflag">polflag</a>.</p>
<h2 id="relaxstr"><strong>relaxstr</strong><a class="headerlink" href="#relaxstr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RELAXation of STRain<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to optimize the geometry under constrained polarization" data-toggle="popover" href="/topics/ConstrainedPol">topic_ConstrainedPol</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [3/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Use ANADDB to compute the polarization of the previous two tests in cartesian coordinates." data-toggle="popover" href="/tests/v4/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. (Test of Na Sai&#x27;s technique)
To impose a polarization on AlAs:
compute new values of the cell parameters and atomic positions.
(in practical calculations, these operations must be repeated until convergence is reached)" data-toggle="popover" href="/tests/v4/Input/t77.abi" target="_blank">t77.abi</a></li>
</ul>
</details>
<p>If <strong>relaxstr</strong> =1, relax lattice constants (lengths/angles) during a
structural relaxation at constrained polarization. See <a class="wikilink codevar-wikilink" href="/variables/anaddb#polflag">polflag</a>.</p>
<h2 id="rfmeth"><strong>rfmeth</strong><a class="headerlink" href="#rfmeth" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response-Function METHod<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [8/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_3.abi" target="_blank">tpolarization_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. (Test of Na Sai&#x27;s technique)
To impose a polarization on AlAs:
compute new values of the cell parameters and atomic positions.
(in practical calculations, these operations must be repeated until convergence is reached)" data-toggle="popover" href="/tests/v4/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 48, for the generation of
the nonlinear coefficients only." data-toggle="popover" href="/tests/v8/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond structure.
Interpolation of the DDB from a 2x2x2 q-points grid
onto a 4x4x4 q-points grid using the interatomic force constants." data-toggle="popover" href="/tests/v8/Input/t64.abi" target="_blank">t64.abi</a></li>
</ul>
</details>
<p>Select a particular set of Data Blocks in the DDB. (PRESENTLY, ONLY OPTION 1 IS AVAILABLE)</p>
<ul>
<li>1 &rarr; Blocks obtained by a non-stationary formulation.</li>
<li>2 &rarr; Blocks obtained by a stationary formulation.</li>
</ul>
<p>For more detailed explanations, see <a class="wikilink user-guide-wikilink" href="/guide/abinit">abinit help file</a>. If the information in the
DDB is available, always use the option 2. If not, you can try option 1, which is less accurate.</p>
<h2 id="rifcsph"><strong>rifcsph</strong><a class="headerlink" href="#rifcsph" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Radius of the Interatomic Force Constant SPHere<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> zero<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test rifcsph cutoff radius for IFC Fourier transform. Use output from t85-87" data-toggle="popover" href="/tests/v5/Input/t95.abi" target="_blank">t95.abi</a></li>
</ul>
</details>
<p>Cut-off radius for the sphere for interatomic force constant, see also the
alternative <a class="wikilink codevar-wikilink" href="/variables/anaddb#nsphere">nsphere</a>. If <strong>rifcsph</strong> = 0: maximum extent allowed by the grid.</p>
<p>This number defines the atoms for which the short range part of the
interatomic force constants, after imposition of the acoustic sum rule, will
not be put to zero.</p>
<h2 id="selectz"><strong>selectz</strong><a class="headerlink" href="#selectz" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SeLECT Z<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [7/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. (Test of Na Sai&#x27;s technique)
To impose a polarization on AlAs:
compute new values of the cell parameters and atomic positions.
(in practical calculations, these operations must be repeated until convergence is reached)" data-toggle="popover" href="/tests/v4/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 48, for the generation of
the nonlinear coefficients only." data-toggle="popover" href="/tests/v8/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond structure.
Interpolation of the DDB from a 2x2x2 q-points grid
onto a 4x4x4 q-points grid using the interatomic force constants." data-toggle="popover" href="/tests/v8/Input/t64.abi" target="_blank">t64.abi</a></li>
</ul>
</details>
<p>Select some parts of the effective charge tensor. (This is done after the
application or non-application of the ASR for effective charges). The
transformed effective charges are then used for all the subsequent
calculations.</p>
<ul>
<li>0 &rarr; The effective charge tensor is left as it is.</li>
<li>1 &rarr; For each atom, the effective charge tensor is made isotropic, by calculating the
    trace of the matrix, dividing it by 3, and using this number in a diagonal effective charge tensor.</li>
<li>2 &rarr; For each atom, the effective charge tensor is made symmetric, by simply averaging on symmetrical elements.</li>
</ul>
<p>Note: this is for analysis the effect of anisotropy in the effective charge.
The result with non-zero <strong>selectz</strong> are unphysical.</p>
<h2 id="symdynmat"><strong>symdynmat</strong><a class="headerlink" href="#symdynmat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SYMmetrize the DYNamical MATrix<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Comment:</em> (was 0 before v5.3)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [11/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a simple DDB for quartz, but do not test interatomic
force constants (see test 15 for this). Compute phonon frequencies
at gamma with and without LO-TO splitting." data-toggle="popover" href="/tests/v2/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BaSr(TiO3)2 FCC unit cell. Show how to use only the q Gamma point
to obtain symmetric IFCs using Anaddb." data-toggle="popover" href="/tests/v2/Input/t39.abi" target="_blank">t39.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run for Al, from t85 t86 t87. Calculate e-p coupling" data-toggle="popover" href="/tests/v5/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: no symmetrization of e-p matrix elements" data-toggle="popover" href="/tests/v5/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: output auxiliary files and change default smearings" data-toggle="popover" href="/tests/v5/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: integrate over window of bands instead of energies" data-toggle="popover" href="/tests/v5/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: change Fermi energy reference to probe e-p coupling of unocc states" data-toggle="popover" href="/tests/v5/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb electron-phonon run: instead of using uniform grid of q-points, treat only a given list" data-toggle="popover" href="/tests/v5/Input/t94.abi" target="_blank">t94.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test rifcsph cutoff radius for IFC Fourier transform. Use output from t85-87" data-toggle="popover" href="/tests/v5/Input/t95.abi" target="_blank">t95.abi</a></li>
</ul>
</details>
<p>If <strong>symdynmat</strong> is equal to 1, the dynamical matrix is symmetrized before the diagonalization.
This is especially useful when the set of primitive vectors of the unit cell
and their opposite do not reflect the symmetries of the Bravais lattice
(typical case: body-centered tetragonal lattices ; FCC and BCC lattices might
be treated with the proper setting of the <a class="wikilink codevar-wikilink" href="/variables/anaddb#brav">brav</a> variable), and the
interpolation procedure based on interatomic force constant is used: there are
some slight symmetry breaking effects. The latter can be bypassed by this additional symmetrization.</p>
<h2 id="symgkq"><strong>symgkq</strong><a class="headerlink" href="#symgkq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SYMmetrize the GKk matrix elements for each Q<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the matrix elements of the electron-phonon interaction" data-toggle="popover" href="/topics/ElPhonInt">topic_ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: no symmetrization of e-p matrix elements" data-toggle="popover" href="/tests/v5/Input/t90.abi" target="_blank">t90.abi</a></li>
</ul>
</details>
<p>If <strong>symgkq</strong> is equal to 1, the electron-phonon matrix elements are
symmetrized over the small group of the q-point they correspond to. This
should always be used, except for debugging or test purposes.</p>
<h2 id="targetpol"><strong>targetpol</strong><a class="headerlink" href="#targetpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TARGET POLarization<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to optimize the geometry under constrained polarization" data-toggle="popover" href="/topics/ConstrainedPol">topic_ConstrainedPol</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [2/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. (Test of Na Sai&#x27;s technique)
To impose a polarization on AlAs:
compute new values of the cell parameters and atomic positions.
(in practical calculations, these operations must be repeated until convergence is reached)" data-toggle="popover" href="/tests/v4/Input/t77.abi" target="_blank">t77.abi</a></li>
</ul>
</details>
<p>Target value of the polarization in cartesian coordinates and in C/m<span><span class="MathJax_Preview">^2</span><script type="math/tex">^2</script></span>. See <a class="wikilink codevar-wikilink" href="/variables/anaddb#polflag">polflag</a>.</p>
<h2 id="telphint"><strong>telphint</strong><a class="headerlink" href="#telphint" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Technique for ELectron-PHonon INTegration<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute transport properties that are determined by the electron-phonon interaction (electrical resistivity, superconductivity, thermal conductivity)" data-toggle="popover" href="/topics/ElPhonTransport">topic_ElPhonTransport</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [6/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb Input file for electron-phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_5.abi" target="_blank">teph_legacy_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run: integrate over window of bands instead of energies" data-toggle="popover" href="/tests/v5/Input/t92.abi" target="_blank">t92.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC 8-atom supercell. Fake smooth pseudopotential.
Follow-up of test 58. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 57. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775401E-03  (bands 1 to 6)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970636E-03  (bands 7 and 8)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (bands 9 to 14)" data-toggle="popover" href="/tests/v6/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a reasonably large box
Analysis of the test 68 results, using anaddb." data-toggle="popover" href="/tests/v6/Input/t69.abi" target="_blank">t69.abi</a></li>
</ul>
</details>
<p>Flag controlling the Fermi surface integration technique used for electron-phonon quantities.</p>
<ul>
<li>0 = tetrahedron method (no adjustable parameter)</li>
<li>1 = Gaussian smearing (see <a class="wikilink codevar-wikilink" href="/variables/anaddb#elphsmear">elphsmear</a>)</li>
<li>2 = uniformly weighted band window between <a class="wikilink codevar-wikilink" href="/variables/anaddb#ep_b_min">ep_b_min</a> and <a class="wikilink codevar-wikilink" href="/variables/anaddb#ep_b_max">ep_b_max</a>, for all k-points</li>
</ul>
<h2 id="temperinc"><strong>temperinc</strong><a class="headerlink" href="#temperinc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TEMPERature INCrease<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute vibrational free energy, entropy, specific heat, thermal expansion, as well as atomic temperature factors" data-toggle="popover" href="/topics/Temperature">topic_Temperature</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 100.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [12/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction of electronic structure." data-toggle="popover" href="/tests/v7/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>Increment of the temperature in Kelvin, for thermodynamical and el-phon
transport properties. See the associated <a class="wikilink codevar-wikilink" href="/variables/anaddb#tempermin">tempermin</a> and
<a class="wikilink codevar-wikilink" href="/variables/anaddb#ntemper">ntemper</a> variables. The default temperature grid goes from 100K to
1000K by step of 100K. For the largest temperatures, for most solids,
anharmonic effects not accounted in the harmonic approximation implemented in
anaddb will be important. For weakly bounded systems (e.g. Van der Waals
solids), such anharmonic effects might be important already at room temperature.</p>
<h2 id="tempermin"><strong>tempermin</strong><a class="headerlink" href="#tempermin" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TEMPERature MINimum<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute vibrational free energy, entropy, specific heat, thermal expansion, as well as atomic temperature factors" data-toggle="popover" href="/topics/Temperature">topic_Temperature</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 100.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [12/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file for electron phonon calculations." data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_6.abi" target="_blank">teph_legacy_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb electron-phonon run with transport" data-toggle="popover" href="/tests/v5/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb run using standard integration method
also tests the *atprj_bs variables, for atomic projections of the phonon band structure" data-toggle="popover" href="/tests/v6/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="anaddb test electron phonon coupling with shifted fermi level of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
anaddb test electron phonon coupling with extra number of electons of hcp Ti" data-toggle="popover" href="/tests/v6/Input/t94.abi" target="_blank">t94.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction of electronic structure." data-toggle="popover" href="/tests/v7/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>Lowest temperature (Kelvin) at which the thermodynamical quantities have to be
evaluated. Cannot be zero when <a class="wikilink codevar-wikilink" href="/variables/anaddb#thmflag">thmflag</a> is 1.</p>
<p>The highest temperature is defined using <a class="wikilink codevar-wikilink" href="/variables/anaddb#temperinc">temperinc</a> and
<a class="wikilink codevar-wikilink" href="/variables/anaddb#ntemper">ntemper</a>. The default temperature grid goes from 100K to 1000K by
step of 100K. For the largest temperatures, for most solids, anharmonic
effects not accounted in the harmonic approximation implemented in anaddb will
be important. For weakly bounded systems (e.g. Van der Waals solids), such
anharmonic effects might be important already at room temperature.</p>
<h2 id="thermal_supercell"><strong>thermal_supercell</strong><a class="headerlink" href="#thermal_supercell" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> THERMALized SUPERCELL lattice vectors<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective charges, IR reflectivity ..." data-toggle="popover" href="/topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,3)<br />
<em>Default value:</em> (/(/0,0,0/),  (/0,0,0/),  (/0,0,0/)/)<br />
<em>Comment:</em> do not calculate any thermalized supercells<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test cutoff of IFCs with nsphere - 1. The vibrational spectrum obtained without cutoff
shows instabilities around Gamma and unphysical oscillation due to the long-range behavior.
A cutoff is needed in order to recover the linear dispersion of the acoustic modes and
nsphere -1 gives the first value of nsphere that does not lead to vibrational instabilites." data-toggle="popover" href="/tests/v8/Input/t46.abi" target="_blank">t46.abi</a></li>
</ul>
</details>
<p>Thermal_supercell defines the real space supercell in which a thermalized
atomic configuration should be produced, following the prescription of
<a class="wikilink citation-wikilink" data-tippy-content="One-shot calculation of temperature-dependent optical spectra and phonon-induced band-gap renormalization" data-toggle="popover" href="/theory/bibliography#zacharias2016">[Zacharias2016]</a>. The displacements are chosen
for each phonon mode according to a temperature, and the displacements are
alternated in sign/direction to obtain maximal compensation of the linear
electron phonon coupling. In this way in <a class="wikilink citation-wikilink" data-tippy-content="One-shot calculation of temperature-dependent optical spectra and phonon-induced band-gap renormalization" data-toggle="popover" href="/theory/bibliography#zacharias2016">[Zacharias2016]</a> dielectric properties at
finite T can be obtained from a single supercell calculation instead of lots
of MD and configuration averaging.</p>
<p>The supercell vectors are not constrained to be collinear with the normal
lattice vectors: this effect is obtained by using a diagonal
thermal_supercell. The lines of the matrix describe the linear combination of
the primitive cell lattice vectors yielding the supercell vectors, as for <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>.</p>
<p>For the moment this feature is under development and it looks like the
relative phases of the displacements are not fixed properly yet&hellip; (Aug 2017)</p>
<h2 id="thmflag"><strong>thmflag</strong><a class="headerlink" href="#thmflag" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> THerMal FLAG<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute vibrational free energy, entropy, specific heat, thermal expansion, as well as atomic temperature factors" data-toggle="popover" href="/topics/Temperature">topic_Temperature</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [17/74] in all anaddb tests, [2/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="anaddb input file." data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_4.abi" target="_blank">tnlo_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Test the computation of the thermal eigenvalue corrections using anaddb and
the merged second order eigenvalue file, from test 27.
NOTE : the DDB is actually taken from the Input directory, not from the test 26.
- I find this a bit misleading, XG -." data-toggle="popover" href="/tests/v5/Input/t28.abi" target="_blank">t28.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction." data-toggle="popover" href="/tests/v6/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 50. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 57 and 59.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775400E-03  (kpt 2, band 1)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970638E-03  (kpt 1, band 1)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (kpt 1, bands 2 to 4)
Note that the k point grid is shifted, but not the q point grid." data-toggle="popover" href="/tests/v6/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
Follow-up of test 54. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 59. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775406E-03  (kpt 1, bands 1 and 2)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970635E-03  (kpt 4, bands 1 and 2)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291346E-03  (kpt 1, bands 3 to 8)" data-toggle="popover" href="/tests/v6/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC 8-atom supercell. Fake smooth pseudopotential.
Follow-up of test 58. Analyse (anaddb) the DDB and EIGR2D files.
Compute the electron-phonon modifications of the electronic structure.
Result to be compared with test 53 and 57. Agreement at the level of the sixth digit.
For the lowest eigenenergy, with -0.19671 Ha, ZP correction is -1.775401E-03  (bands 1 to 6)
For the HOMO,               with  0.09747 Ha, ZP correction is  1.970636E-03  (bands 7 and 8)
For the LUMO,               with  0.46242 Ha, ZP correction is -3.291344E-03  (bands 9 to 14)" data-toggle="popover" href="/tests/v6/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a reasonably large box
Analysis of the test 68 results, using anaddb." data-toggle="popover" href="/tests/v6/Input/t69.abi" target="_blank">t69.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Use anaddb to compute the T-dependent correction of electronic structure." data-toggle="popover" href="/tests/v7/Input/t54.abi" target="_blank">t54.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 48, for the generation of
the nonlinear coefficients only." data-toggle="popover" href="/tests/v8/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond structure.
Interpolation of the DDB from a 2x2x2 q-points grid
onto a 4x4x4 q-points grid using the interatomic force constants." data-toggle="popover" href="/tests/v8/Input/t64.abi" target="_blank">t64.abi</a></li>
</ul>
</details>
<p>Flag controlling the calculation of thermal quantities.</p>
<ul>
<li>When <strong>thmflag</strong> == 1, the code will compute, using the histogram method:<ul>
<li>the normalized phonon DOS</li>
<li>the phonon internal energy, free energy, entropy, constant volume heat capacity as a function of the temperature</li>
<li>the Debye-Waller factors (tensors) for each atom, as a function of the temperature</li>
<li>the mean-square velocity tensor for each atom, as a function of temperature</li>
<li>the &ldquo;average frequency&rdquo; as a function of the temperature</li>
</ul>
</li>
<li>When <strong>thmflag</strong> == 2, all the phonon frequencies for the q points in the second grid are printed.</li>
<li>When <strong>thmflag</strong> == 3, 5 or 7, the thermal corrections to the electronic eigenvalues are calculated. If <strong>thmflag</strong> ==3, the list of phonon wavevector from the first list is used (with equal weight for all wavevectors in this list), while if <strong>thmflag</strong> ==5 or 7, the first grid of wavevectors is used, possibly folded to the irreducible Brillouin Zone if symmetry operations are present, or if they are recomputed (this happens for <strong>thmflag</strong> ==7).</li>
<li>When <strong>thmflag</strong> == 4 or 6, the temperature broadening (electron lifetime) of the electronic eigenvalues is calculated. If <strong>thmflag</strong> ==4, the list of phonon wavevector from the first list is used (with equal weight for all wavevectors in this list), while if <strong>thmflag</strong> ==6, the first grid of wavevectors is used, possibly folded to the irreducible Brillouin Zone if symmetry operations are present or if they are recomputed (this happens for <strong>thmflag</strong> ==8).</li>
</ul>
<p>WARNING: The use of symmetries for the temperature dependence of the
eigenenergies is tricky ! It can only be valid for the k points that respect
the symmetries (i.e. the Gamma point), provided one also averages over the
degenerate states.</p>
<p>Input variables that may be needed if this flag is activated:
<a class="wikilink codevar-wikilink" href="/variables/anaddb#dostol">dostol</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#nchan">nchan</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#ntemper">ntemper</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#temperinc">temperinc</a>,
<a class="wikilink codevar-wikilink" href="/variables/anaddb#tempermin">tempermin</a>, as well as the wavevector grid number 2 definition,
<a class="wikilink codevar-wikilink" href="/variables/anaddb#ng2qpt">ng2qpt</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#ngrids">ngrids</a>, <a class="wikilink codevar-wikilink" href="/variables/anaddb#q2shft">q2shft</a>.</p>
<h2 id="thmtol"><strong>thmtol</strong><a class="headerlink" href="#thmtol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> THerModynamic TOLerance<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute vibrational free energy, entropy, specific heat, thermal expansion, as well as atomic temperature factors" data-toggle="popover" href="/topics/Temperature">topic_Temperature</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.05<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [7/74] in all anaddb tests, [1/12] in anaddb tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Input file for the anaddb code. Analysis of the SiO2 DDB" data-toggle="popover" href="/tests/tutorespfn/Input/trf2_7.abi" target="_blank">trf2_7.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze the DDB for quartz build in test 14.
Compute the interatomic force constants, the phonon Density of States,
different thermodynamical functions of temperature,
phonon frequencies in the whole Brillouin zone,
oscillator strengths and mode effective charges at q(0 0 0),
the electronic dielectric tensor, and the (full) dielectric tensor
at zero frequency (so including atomic displacements and
related polarization)." data-toggle="popover" href="/tests/v2/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom.
Here, IFCs are obtained, and can be compared to those
published in Table I of Rignanese et al, PRB53, 4488 (1996).
For example, the atoms numbers for NN=0,1,2,5 in Table I
are found as atoms 1,5,17,20. The numbers are equal in the
paper or in the output of the code.
The frequencies at X and L points are also computed. They
can be compared with those provided in TABLE II (TA(X) mode
at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1)
in the above-mentioned paper. The numbers are equal in the
paper or in the output of the code.
Thermodynamic quantities are also obtained. The input
parameters of the code does not give particularly well
converged quantities (one needs reasonable CPU time for testing !),
but it is OK for comparison with the paper.
In the output of the code, a mole corresponds
to the number of Avogadro times one CELL. As a Silicon cell contains
2 atoms, caution must be taken in the comparison with experiment !
We will refer to the numbers given by the code as being given
for a mole-cell (in short a mol-c). The distinction between
the usual definition of a mole (Avogadro number times 1
Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom)
was unfortunately the source of errors in the paper by
Rignanese et al (our thanks to Steve Erwin for noticing
this - an errata should be written). From the output of the code
( zero Kelvin is approximated by results at 1 Kelvin) :
the zero point contribution to the Helmholtz free energy
is 11.90 kJ/mol-c , so 5.95 kJ/mole ; the entropy at 298.15K
is 38.25 J/(mol-c.K), so 19.12 J/(mole.K) ; the constant-volume
specific heat at 298.15K is 39.59 J/(mol-c.K), so 19.80 J/(mole.K) ;
the change in F (Helmholtz free energy) from 1 K to 298.15 K is
-4.91 kJ/mol-c, so -2.45 kJ/mole ; the change in E (internal energy)
from 1 K to 298.15 K is 6.49 kJ/mol-c, so 3.25 kJ/mole. Supposing
that we take the usual definition of a mole (Avogadro number times 1
Silicon atom), then, in the above-mentioned paper, the FIG. 3, 5 and 8
should be rescaled, as well as the zero-point contribution to the
Helmholtz free energy (5.95 kJ/mole, and not 12 J/mole - the &#x27;k&#x27; was
also missing), that is only 1.25% of the cohesive energy.
The output of the code is now more clear than in 1995, and this
kind of error should not appear anymore." data-toggle="popover" href="/tests/v2/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test 53, for the generation of
the electro-optic tensor, and Raman susceptibility coefficients." data-toggle="popover" href="/tests/v4/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tetragonal PbTiO3. Use ANADDB to impose a polarization with fixed in-plane lattice constant" data-toggle="popover" href="/tests/v4/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiO2 alpha-quartz with 9 atoms per cell.
Compute the atomic temperature factors." data-toggle="popover" href="/tests/v5/Input/t22.abi" target="_blank">t22.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure. Code anaddb
Analyse the DDB from test t48, for the generation of
the nonlinear coefficients and the first order change of the
dielectric tensor." data-toggle="popover" href="/tests/v8/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>The relative tolerance on the thermodynamical functions This number will
determine when the series of channel widths with which the DOS is calculated
can be stopped, i.e. the mean of the relative change going from one grid to
the next bigger is smaller than <strong>thmtol</strong>.</p>
<h2 id="use_k_fine"><strong>use_k_fine</strong><a class="headerlink" href="#use_k_fine" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE K-grid FINEr than the coarse k-grid<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the linewidth (or lifetime) of phonons, due to the electron-phonon interaction" data-toggle="popover" href="/topics/PhononWidth">topic_PhononWidth</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/74] in all anaddb tests, [0/12] in anaddb tutorials</summary></details>
<p>When set, <a class="wikilink codevar-wikilink" href="/variables/anaddb#kptrlatt_fine">kptrlatt_fine</a> is suggested to be given. For the present
version, both eigenvalues (denser grid GKK, obtained from mrggkk with only the
GS WFK file) and electronic velocities(GKK files from DDK calculation) are
needed. Note that the coarse k-grid must be a subset of the fine k-grid.</p>
<h2 id="vs_qrad_tolkms"><strong>vs_qrad_tolkms</strong><a class="headerlink" href="#vs_qrad_tolkms" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Speed of Sound Q-radius, TOLerance KiloMeter/Second<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute phonon bands, density of states, interatomic force constants, sound velocity ..." data-toggle="popover" href="/topics/PhononBands">topic_PhononBands</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> 2*0.0d0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [1/74] in all anaddb tests, [0/12] in anaddb tutorials</summary><ul>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Gruneisen parameters." data-toggle="popover" href="/tests/v8/Input/t45.abi" target="_blank">t45.abi</a></li>
</ul>
</details>
<p>This variable activates the calculation of the speed of sound (requires
<a class="wikilink codevar-wikilink" href="/variables/anaddb#ifcflag">ifcflag</a> = 1). The first entry of the array defines the radius of
the small sphere around the Gamma point (Bohr<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span>). The second entry gives the
absolute tolerance in kilometer/second. The speed of sound is evaluated by
performing a spherical average on the small sphere using Lebedev-Laikov grids
(typical values for q-radius: 0.1 Bohr<span><span class="MathJax_Preview">^{-1}</span><script type="math/tex">^{-1}</script></span>) The number of radial points is
increased until the integration converges twice withing the tolerance
specified by the user (typical values for tolkms: 0.05 km/s).</p>
<p>The default values will not work.</p>
                
                  
                
              

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/"
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../w90/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Wannier90
            </div>
          </div>
        </a>
      
      
        <a href="../atdep/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              aTDEP
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version b'10.2.3-dirty'</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "b'10.2.3-dirty'"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>