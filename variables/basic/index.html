
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="basic input variables">
      
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://docs.abinit.org/variables/basic/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Basic - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#basic-input-variables" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Basic
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../topics/features/" class="md-tabs__link">
        Topics
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Variables
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorial/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
        FAQ
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../theory/geometry/" class="md-tabs__link">
        Theory
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        User Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        NewUser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        Abinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        Abitk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        Cut3d
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        Fold2Bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        Mrgddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        Mrgscr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        Respfn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        Spacegroup
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_15" type="checkbox" id="__nav_1_15" >
      
      <label class="md-nav__link" for="__nav_1_15">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_15">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        HowTo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        EasyBuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        Topic List
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        Abipy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        APPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        Artificial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        AtomCentered
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        AtomManipulator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        AtomTypes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        Bader
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        Band2eps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        Berry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        BandOcc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        BSE
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        BoundingProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        ConstrainedDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        ConstrainedPol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        Control
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        Coulomb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        CrossingBarriers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        CalcUJ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        DeltaSCF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        DensityPotential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        Dev
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        DynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        EffectiveMass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        EFG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        Elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        ElPhonInt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        ElPhonTransport
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        ElecDOS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        ElecBandStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        ExtFPMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        FileFormats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        FitProcess
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        ForcesStresses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        FrequencyMeshMBPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        GeoConstraints
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        GeoOpt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        GSintroduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        GWR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        GWls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        Hybrids
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        Install
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        K points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        LatticeModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        LatticeWannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        LWFModel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        LDAminushalf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        LOTF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        Longwave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        Macroave
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        MagField
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        MagMom
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        MolecularDynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        Multidtset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        NMR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        Nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        PIMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        Planewaves
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        Phonons
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        PhononBands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        PhononWidth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        PortabilityNonRegression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        Positron
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        Printing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        PseudosPAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        Q points
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        RandStopPow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        Recursion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        RPACorrEn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        SCFControl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        SCFAlgorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        SelfEnergy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        SmartSymm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        Spinpolarisation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        SpinDynamicsMultibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        STM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        Susceptibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        TDDFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        TDepES
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        Temperature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        TransPath
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        TuningSpeedMem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        Unfolding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        UnitCell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        Vdw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        Verification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        Wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        Wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        Xc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        External Resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        All Variables
      </a>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" checked>
      
      <label class="md-nav__link" for="__nav_3_2">
        Abinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Abinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Basic
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Basic
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#accuracy" class="md-nav__link">
    accuracy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acell" class="md-nav__link">
    acell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#angdeg" class="md-nav__link">
    angdeg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecut" class="md-nav__link">
    ecut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#einterp" class="md-nav__link">
    einterp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iscf" class="md-nav__link">
    iscf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ixc" class="md-nav__link">
    ixc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jdtset" class="md-nav__link">
    jdtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kpt" class="md-nav__link">
    kpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptnrm" class="md-nav__link">
    kptnrm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptopt" class="md-nav__link">
    kptopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natom" class="md-nav__link">
    natom
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nband" class="md-nav__link">
    nband
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nbandhf" class="md-nav__link">
    nbandhf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ndtset" class="md-nav__link">
    ndtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngkpt" class="md-nav__link">
    ngkpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpath" class="md-nav__link">
    nkpath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpt" class="md-nav__link">
    nkpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpthf" class="md-nav__link">
    nkpthf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nshiftk" class="md-nav__link">
    nshiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nsppol" class="md-nav__link">
    nsppol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nstep" class="md-nav__link">
    nstep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nsym" class="md-nav__link">
    nsym
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntypat" class="md-nav__link">
    ntypat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#occopt" class="md-nav__link">
    occopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rprim" class="md-nav__link">
    rprim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rprimd" class="md-nav__link">
    rprimd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scalecart" class="md-nav__link">
    scalecart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shiftk" class="md-nav__link">
    shiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symrel" class="md-nav__link">
    symrel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tnons" class="md-nav__link">
    tnons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toldfe" class="md-nav__link">
    toldfe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toldff" class="md-nav__link">
    toldff
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolrff" class="md-nav__link">
    tolrff
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolvrs" class="md-nav__link">
    tolvrs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolwfr" class="md-nav__link">
    tolwfr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolwfr_diago" class="md-nav__link">
    tolwfr_diago
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typat" class="md-nav__link">
    typat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#udtset" class="md-nav__link">
    udtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usewvl" class="md-nav__link">
    usewvl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wtk" class="md-nav__link">
    wtk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_hgrid" class="md-nav__link">
    wvl_hgrid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xcart" class="md-nav__link">
    xcart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xred" class="md-nav__link">
    xred
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#znucl" class="md-nav__link">
    znucl
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dev/" class="md-nav__link">
        Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eph/" class="md-nav__link">
        Electron-Phonon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ffield/" class="md-nav__link">
        Varff
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../files/" class="md-nav__link">
        File-handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../geo/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gstate/" class="md-nav__link">
        Ground-State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gw/" class="md-nav__link">
        GW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paral/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../paw/" class="md-nav__link">
        PAW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rlx/" class="md-nav__link">
        Relaxation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../vdw/" class="md-nav__link">
        VdW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../w90/" class="md-nav__link">
        Wannier90
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../anaddb/" class="md-nav__link">
        Anaddb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../atdep/" class="md-nav__link">
        aTDEP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        Multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        Optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aim/" class="md-nav__link">
        Aim
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../external_parameters/" class="md-nav__link">
        External Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../varset_stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Basic tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base1/" class="md-nav__link">
        basic1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base2/" class="md-nav__link">
        basic2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base3/" class="md-nav__link">
        basic3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base4/" class="md-nav__link">
        basic4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/abinit_build/" class="md-nav__link">
        ABINIT_build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw1/" class="md-nav__link">
        PAW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin/" class="md-nav__link">
        Spin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/polarization/" class="md-nav__link">
        Polarization & finite field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf1/" class="md-nav__link">
        DFPT1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf2/" class="md-nav__link">
        DFPT2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/basepar/" class="md-nav__link">
        Parallelism
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      <label class="md-nav__link" for="__nav_4_10">
        ABINIT postprocessors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ABINIT postprocessors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          ABINIT postprocessors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/atdep1/" class="md-nav__link">
        aTDEP1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/cut3d/" class="md-nav__link">
        cut3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/fold2bloch/" class="md-nav__link">
        fold2bloch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/optic/" class="md-nav__link">
        optic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/wannier90/" class="md-nav__link">
        wannier90
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/z2pack/" class="md-nav__link">
        Z2pack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      <label class="md-nav__link" for="__nav_4_11">
        DFT beyond basics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFT beyond basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          DFT beyond basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nuc/" class="md-nav__link">
        properties at the nucleus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dftu/" class="md-nav__link">
        DFT+U
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/ucalc_crpa/" class="md-nav__link">
        cRPA U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lruj/" class="md-nav__link">
        Linear Response U(J)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw2/" class="md-nav__link">
        PAW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw3/" class="md-nav__link">
        PAW3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/positron/" class="md-nav__link">
        positron
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      <label class="md-nav__link" for="__nav_4_12">
        Many-Body Theory & excitations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Many-Body Theory & excitations" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Many-Body Theory & excitations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw1/" class="md-nav__link">
        GW1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw2/" class="md-nav__link">
        GW2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr_intro/" class="md-nav__link">
        GWR_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr1/" class="md-nav__link">
        GWR1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dmft/" class="md-nav__link">
        DMFT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/tddft/" class="md-nav__link">
        TDDFT (Casida)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      <label class="md-nav__link" for="__nav_4_13">
        DFPT & electron-phonon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DFPT & electron-phonon" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          DFPT & electron-phonon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/elastic/" class="md-nav__link">
        elastic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nlo/" class="md-nav__link">
        nonlinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_wannier/" class="md-nav__link">
        lattice_wannier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lw_quad/" class="md-nav__link">
        quadrupoles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_intro/" class="md-nav__link">
        eph_intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4mob/" class="md-nav__link">
        eph for mobilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4zpr/" class="md-nav__link">
        eph for zero-point renormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_legacy/" class="md-nav__link">
        eph_legacy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_tdep_legacy/" class="md-nav__link">
        eph_tdep_legacy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" >
      
      <label class="md-nav__link" for="__nav_4_14">
        Multibinit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Multibinit" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          Multibinit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/multibinit/" class="md-nav__link">
        introduction to multibinit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_model/" class="md-nav__link">
        lattice_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin_model/" class="md-nav__link">
        spin_model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lwf_model/" class="md-nav__link">
        lwf_model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_15" type="checkbox" id="__nav_4_15" >
      
      <label class="md-nav__link" for="__nav_4_15">
        Advanced parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced parallelism" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_15">
          <span class="md-nav__icon md-icon"></span>
          Advanced parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_bandpw/" class="md-nav__link">
        paral_band_PW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_gswvl/" class="md-nav__link">
        paral_wavelets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_moldyn/" class="md-nav__link">
        paral_MD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_images/" class="md-nav__link">
        paral_images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_dfpt/" class="md-nav__link">
        paral_DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_mbt/" class="md-nav__link">
        paral_MBPT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        Configuration and compilation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        General questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        Pre/Post processing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        Ground state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        DFPT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        Troubleshooting (old-dokuwiki)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        Tuning (old-dokuwiki)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Theory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        Spherical Harmonics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        Wavefunctions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        Noncollinear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        Pseudopotentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        Many-Body Perturbation Theory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        Bethe-Salpeter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        Documents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        Acronyms
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Developers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        Git and Gitlab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        HowTo for developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        Abimkdocs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Test Suite
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test Suite" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Test Suite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        Test list
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        Test Suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        YAML-based test suite Howto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        YAML-based test suite Python tools and API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        XgType
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      <label class="md-nav__link" for="__nav_7_7">
        Pseudos
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pseudos" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Pseudos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        psp1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        psp3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        psp45
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        psp5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        psp6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        psp8
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        Code stats
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        Autoconf_examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        Test Page for linkcheck
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#accuracy" class="md-nav__link">
    accuracy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acell" class="md-nav__link">
    acell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#angdeg" class="md-nav__link">
    angdeg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecut" class="md-nav__link">
    ecut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#einterp" class="md-nav__link">
    einterp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iscf" class="md-nav__link">
    iscf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ixc" class="md-nav__link">
    ixc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jdtset" class="md-nav__link">
    jdtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kpt" class="md-nav__link">
    kpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptnrm" class="md-nav__link">
    kptnrm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptopt" class="md-nav__link">
    kptopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natom" class="md-nav__link">
    natom
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nband" class="md-nav__link">
    nband
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nbandhf" class="md-nav__link">
    nbandhf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ndtset" class="md-nav__link">
    ndtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngkpt" class="md-nav__link">
    ngkpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpath" class="md-nav__link">
    nkpath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpt" class="md-nav__link">
    nkpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpthf" class="md-nav__link">
    nkpthf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nshiftk" class="md-nav__link">
    nshiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nsppol" class="md-nav__link">
    nsppol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nstep" class="md-nav__link">
    nstep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nsym" class="md-nav__link">
    nsym
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntypat" class="md-nav__link">
    ntypat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#occopt" class="md-nav__link">
    occopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rprim" class="md-nav__link">
    rprim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rprimd" class="md-nav__link">
    rprimd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scalecart" class="md-nav__link">
    scalecart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shiftk" class="md-nav__link">
    shiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symrel" class="md-nav__link">
    symrel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tnons" class="md-nav__link">
    tnons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toldfe" class="md-nav__link">
    toldfe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toldff" class="md-nav__link">
    toldff
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolrff" class="md-nav__link">
    tolrff
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolvrs" class="md-nav__link">
    tolvrs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolwfr" class="md-nav__link">
    tolwfr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolwfr_diago" class="md-nav__link">
    tolwfr_diago
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typat" class="md-nav__link">
    typat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#udtset" class="md-nav__link">
    udtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usewvl" class="md-nav__link">
    usewvl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wtk" class="md-nav__link">
    wtk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_hgrid" class="md-nav__link">
    wvl_hgrid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xcart" class="md-nav__link">
    xcart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xred" class="md-nav__link">
    xred
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#znucl" class="md-nav__link">
    znucl
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/variables/basic.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->
<h1 id="basic-input-variables">basic input variables<a class="headerlink" href="#basic-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
basic input variables to be used in the input file for the abinit executable.</p>
<h2 id="accuracy"><strong>accuracy</strong><a class="headerlink" href="#accuracy" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ACCURACY<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform numerically precise calculations with planewaves or projector- augmented waves and pseudopotentials" data-toggle="popover" href="/topics/Planewaves">topic_Planewaves</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/1245] in all abinit tests, [3/159] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in hypothetical wurzite (hexagonal) structure
Structural optimization run" data-toggle="popover" href="/tests/tutorespfn/Input/telast_1.abi" target="_blank">telast_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlP in hypothetical wurzite (hexagonal) structure
Response function calculation for:
* rigid-atom elastic tensor
* rigid-atom piezoelectric tensor
* interatomic force constants at gamma
* Born effective charges" data-toggle="popover" href="/tests/tutorespfn/Input/telast_2.abi" target="_blank">telast_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlP in hypothetical wurzite (hexagonal) structure
Alternative response function calculation for some rigid-atom
piezoelectric tensor elements." data-toggle="popover" href="/tests/tutorespfn/Input/telast_5.abi" target="_blank">telast_5.abi</a></li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated like a metal (there is a degeneracy at the Fermi level),
occopt=4 and tsmear=0.04 , with nsppol=2 .
Use spinat to polarize the molecule at start.
Gives total energy of -32.09317 Hartree
This test can be used to check the accuracy of stresses in the
spin-polarized case. Setting acell(1:2) to 7.005 and 6.995
gives ETOT -32.090846193972 and -32.095501753750,
ucvol  441.63023 and 440.37023
so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03,
to be compared with sigma(1)=3.6949713786E-03
and sigma(2)=3.6949681083E-03 from the present test
(the degeneracy is slightly lifted because of incomplete convergence,
using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both
sigma values)." data-toggle="popover" href="/tests/v1/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Helium FCC solid, using bare potential, but a relatively low cut-off.
Cell parameter is 6.505 Bohr , 2 k points are used.  PBE GGA.
Combined with test 29, it is used to test the accuracy of
the stress calculation. Output of the code are as follows :
Energy=-2.835212586 Ha, volume=68.814809 Bohr^3,
stress=6.03381838E-04 Ha/Bohr^3" data-toggle="popover" href="/tests/v1/Input/t28.abi" target="_blank">t28.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box : compute VERY accurately
the derivatives of the energy, by both symmetric finite-differences and
direct computation of forces and 2DTE.
Also test the interplay between istwfk/=1 in the GS calculation
and istwfk==1 in the RF calculation (istwfk/=1 is not yet-991020-
allowed for RF, which is a shame)
1) Computation of the first-order derivative of the total energy
With delta(xred)=0.0002, one gets delta(etot)/delta(xred)=-3.145846551
With delta(xred)=0.0001, one gets delta(etot)/delta(xred)=-3.145836932
The combination of both results, in a higher-order finite difference
formula gives -3.145833726 . The direct computation of forces
at the target geometry gives -3.145833725869 . The agreement is perfect,
taking into account the &quot;limited&quot; number of digits (10) of the
finite-difference result.
2) Computation of the second-order derivative of the total energy
With delta(xred)=0.0002, one gets delta(dedt)/delta(xred)=188.73875
With delta(xred)=0.0001, one gets delta(dedt)/delta(xred)=188.73837
The combination of both results, in a higher-order finite difference
formula gives 188.73824613 . The direct computation of 2DTE
at the target geometry gives 188.73824613046 . The agreement at the
level of 11 digits is also perfect." data-toggle="popover" href="/tests/v2/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Again H2 molecule in a big box (like test 33).
With the same configuration and parameters as test 33,
investigate the treatment of unoccupied states :
use nband 2 and occopt 1 , causing occ 2.0 1.0 . The same results
as with test 33 are obtained." data-toggle="popover" href="/tests/v2/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box.
Comparison of the modified Broyden algorithm (ionmov=3) with the
original one (ionmov=2). Start with different values
of xcart, from 0.6 to 1.1, by step of 0.1 . The number of Broyden
steps needed to reach acceptable residual forces
with the ionmov=3 algorithm are : 3, 2, 2, 3, 3, 4, while
with the ionmov=2 algorithms, one get : 4, 3, 2, 5, and then,
either the algorithm does not converge within 8 steps, or it
converges to a saddle point of the energy !
This test was hard to make portable. This is why the tolerance
for fldiff is very large." data-toggle="popover" href="/tests/v2/Input/t48.abi" target="_blank">t48.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tin in the diamond structure, with 2 special points
Test the effect of spin-orbit coupling, especially the
electronic structure.
Degeneracies at Gamma are correct !
(note that ecut and nkpt are too low for quantitative accuracy)
Without spin-orbit (in eV), dataset 4:
-8.82682  1.26955 (x3) 1.30262 3.45296 (x3)
With spin-orbit (in eV), dataset 6:
-8.82682  0.75225      1.30262 1.50965 (x2) 3.07128 3.62556 (x2)" data-toggle="popover" href="/tests/v2/Input/t74.abi" target="_blank">t74.abi</a></li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2, and preceeding test,
but use the full XC PBE functional.
Also, tolvrs is better.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.81162533 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.81213804 Ha
with delta(xred)=0.0001, 188.81175352 Ha .
Combining the results gives 188.81162525 Ha." data-toggle="popover" href="/tests/v3/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 8 of v3
but use the revPBE XC functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.66748730880 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.66799915 Ha
with delta(xred)=0.0001, 188.66761529 Ha .
Combining the results gives 188.66748734 Ha.
Excellent." data-toggle="popover" href="/tests/v3/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 8 of v3
but use the RPBE XC functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.92567363225 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.92618485 Ha
with delta(xred)=0.0001, 188.92580145 Ha
Combining the results gives 188.92567365 Ha
Excellent" data-toggle="popover" href="/tests/v3/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point. Testing GS  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t93.abi" target="_blank">t93.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and Wu-Cohen GGA.
Similar to test v3#08
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.49410411 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.4945677  Ha
with delta(xred)=0.0001, 189.49422003  Ha .
Combining the results gives 189.4941041 Ha. Perfect !" data-toggle="popover" href="/tests/v5/Input/t29.abi" target="_blank">t29.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of input variable &quot;accuracy&quot; (F. Jollet)" data-toggle="popover" href="/tests/v7/Input/t64.abi" target="_blank">t64.abi</a></li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a></li>
</ul>
</details>
<p>Allows to tune the accuracy of a ground-state or DFPT calculation <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>=0 or 1, by setting automatically the
variables according to the following table:</p>
<table>
<thead>
<tr>
<th>accuracy</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
</tr>
</thead>
<tbody>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a></td>
<td>E_min</td>
<td>E_med</td>
<td>E_med</td>
<td>E_max</td>
<td>E_max</td>
<td>E_max</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/paw#pawecutdg">pawecutdg</a></td>
<td>ecut</td>
<td>ecut</td>
<td>1.2 * ecut</td>
<td>1.5 * ecut</td>
<td>2 * ecut</td>
<td>2 * ecut</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/gstate#fband">fband</a></td>
<td>0.5</td>
<td>0.5</td>
<td>0.5</td>
<td>0.5</td>
<td>0.75</td>
<td>0.75</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/gstate#boxcutmin">boxcutmin</a></td>
<td>1.5</td>
<td>1.8</td>
<td>1.8</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/paw#bxctmindg">bxctmindg</a></td>
<td>1.5</td>
<td>1.8</td>
<td>1.8</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/paw#pawxcdev">pawxcdev</a></td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/paw#pawmixdg">pawmixdg</a></td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/paw#pawovlp">pawovlp</a></td>
<td>10</td>
<td>7</td>
<td>7</td>
<td>5</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/paw#pawnhatxc">pawnhatxc</a></td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a></td>
<td>1.0d-3</td>
<td>1.0d-5</td>
<td>1.0d-7</td>
<td>1.0d-9</td>
<td>1.0d-10</td>
<td>1.0d-12</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/rlx#tolmxf">tolmxf</a></td>
<td>1.0d-3</td>
<td>5.0d-4</td>
<td>1.0d-4</td>
<td>5.0d-5</td>
<td>1.0d-6</td>
<td>1.0d-6</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/dev#optforces">optforces</a></td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/gstate#timopt">timopt</a></td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/dev#npulayit">npulayit</a></td>
<td>4</td>
<td>7</td>
<td>7</td>
<td>7</td>
<td>15</td>
<td>15</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a></td>
<td>30</td>
<td>30</td>
<td>30</td>
<td>30</td>
<td>50</td>
<td>50</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/files#prteig">prteig</a></td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="/variables/files#prtden">prtden</a></td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><em>accuracy</em> = 4 corresponds to the default tuning of ABINIT. It is already a very accurate tuning.
For a parallel calculation, <a class="wikilink codevar-wikilink" href="/variables/gstate#timopt">timopt</a> is enforced to be 0.
E_min, E_med and E_max may be read from the pseudopotential file (available
only for XML PAW atomic data files). If E_min, E_med and E_max are not given
in the pseudopotential file, <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> must be given in the input file and E_max=E_med=E_max=ecut.
If the user wants to modify one of the input variable automatically tuned by <em>accuracy</em>,
they must put it in the input file. The other input variables automatically tuned
by <em>accuracy</em> will not be affected.
<em>accuracy</em> = 0 means that this input variable is deactivated.</p>
<p>For the other values of <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a>, many of the above input variables have no meaning,
so the accuracy has to be tuned by the user (e.g. for GW calculations, perform convergence studies
with respect to <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> and other relevant input variables).</p>
<h2 id="acell"><strong>acell</strong><a class="headerlink" href="#acell" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CELL lattice vector scaling<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">EVOLVING</a>, <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the unit cell" data-toggle="popover" href="/topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Commentdims:</em> represented internally as acell(3,<a class="wikilink codevar-wikilink" href="/variables/rlx#nimage">nimage</a>)<br />
<em>Default value:</em> 3 * 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1218/1245] in all abinit tests, [147/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the length scales by which dimensionless primitive translations (<a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>)
are to be multiplied. By default, given in Bohr atomic units (1
Bohr=0.5291772108 Angstroms), although Angstrom can be specified, if
preferred, since <em>acell</em> has the <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a> characteristics. See further
description of <em>acell</em> related to the <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a> input variable, the
<a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a> input variable, and the associated internal <a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a> input variable.</p>
<p>Note that <em>acell</em> is <strong>NOT</strong> the length of the conventional orthogonal basis
vectors, but the scaling factors of the primitive vectors. Use <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>
to scale the cartesian coordinates.</p>
<h2 id="angdeg"><strong>angdeg</strong><a class="headerlink" href="#angdeg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ANGles in DEGrees<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the unit cell" data-toggle="popover" href="/topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> None<br />
<em>Comment:</em> deduced from &lsquo;<a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>&lsquo;<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [64/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, rhombohedral.
Test finite electric field
Check the corectness of the symmetry operations with non-zero tnons." data-toggle="popover" href="/tests/seq/Input/tsv4_55.abi" target="_blank">tsv4_55.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al2O3 cell in rhombohedric cell with different axes.
Dataset 1 : Rhombohedral axes; full set of symmetries and full set of atoms
Dataset 2 : Rhombohedral axes; irreducible unit cell and space group
Dataset 3 : Hexagonal axes; irreducible unit cell and space group
Dataset 4 : Hexagonal axes; full unit cell and space group
The results are equivalent for Dataset 1 and 2 and Dataset 3 and 4." data-toggle="popover" href="/tests/v1/Input/t96.abi" target="_blank">t96.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Arsenic in rhombohedral structure.
Optimization of unit cell size and shape.
With 4x4x4 k point grid, ecut 3.0, occopt 4 and tsmear 0.06d0,
one get acell 3*7.325  angdeg 3*57.36 and xred 0.2277
These input parameters are too small, but still give a realistic
geometry, since with the much better parameters
12x12x12 k point grid, ecut 12.0, occopt 4 and tsmear 0.04d0,
one gets acell 3*7.633  angdeg 3*54.95 and xred 0.2296, while
the experimental values are
acell 3*7.751   angdeg 3*54.554 and xred 0.2276" data-toggle="popover" href="/tests/v2/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the symmetry finder for all the Bravais lattices,
with different input formats (rprim or angdeg), and for
non-conventional choices of axes as well.
Uses only one atom, placed at (0 0 0)" data-toggle="popover" href="/tests/v2/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the symmetry finder for all the Bravais lattices,
with different input formats (rprim or angdeg), and for
non-conventional choices of axes as well.
Uses two different atoms, placed at (0 0 0) and (0.1 0 0), thus
breaking many symmetries." data-toggle="popover" href="/tests/v2/Input/t53.abi" target="_blank">t53.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
First dataset : compute the density
Second dataset : compute the spinor wfs at one k point,
non-self consistently
Third dataset : use the spinor wfs of the previous dataset
to restart computations at symmetric k points." data-toggle="popover" href="/tests/v3/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with spin-orbit. Should give the same answer
than test 2, except that the k point grid is now
defined automatically.
Dataset 8 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
Warning : the output file of this test
is machine-dependent, although the final
result is not. This is because the
degeneracy of the GS wavefunctions with
different spin orientation has not been broken." data-toggle="popover" href="/tests/v3/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
H based fake crystals : magnetic groups, Shubnikov type III
Test the generation and recognition of the
orthorhombic space groups (part I : spgroup 16 to 46)" data-toggle="popover" href="/tests/v4/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H based fake crystals : magnetic groups, Shubnikov type III
Test the generation and recognition of the
orthorhombic space groups (part II : spgroup 47 to 62)" data-toggle="popover" href="/tests/v4/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H based fake crystals : magnetic groups, Shubnikov type III
Test the generation and recognition of the
orthorhombic space groups (part III : spgroup 63 to 74)" data-toggle="popover" href="/tests/v4/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using PAW, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the spin-orbit coupling
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)
Also tests spnorbscl and pawcpxocc variables reserved to exp. users." data-toggle="popover" href="/tests/v5/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GeTe in rhombohedral structure
Test the computation of phonons, dielectric tensor and Born effective
charges, with and without spin-orbit coupling." data-toggle="popover" href="/tests/v5/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-toggle="popover" href="/tests/v6/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for simple cubic Ti crystal, for reference purposes (conventional = primitive unit cell for symmetry ops)" data-toggle="popover" href="/tests/v6/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the symmetry finder for all the Bravais lattices,
with different input formats (rprim or angdeg), and for
non-conventional choices of axes as well.
Uses only one atom, placed at (0.6 0 0)
Similar to test v2#52, except for the choice of the location" data-toggle="popover" href="/tests/v6/Input/t15.abi" target="_blank">t15.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fake body-centered tetragonal crystal
This test checks the capability of ABINIT to identify and correct inaccurate primitive vectors
using the tolsym input variable." data-toggle="popover" href="/tests/v7/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of the elastic constants and internal strains for
distorded h-BN (to get non-zero internal strains)
vdW-DFT-D3 corrections with Becke-Jonhson damping (DFT-D3(BJ))
Only the pair-wise is computed (3-body term not implemented)
In this test the following properties are thus tested: contribution
to the energy and to the stress of DFT-D3(BJ) as well as
the contribution to the elastic constants and internal strains" data-toggle="popover" href="/tests/v7/Input/t99.abi" target="_blank">t99.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
ZrS2 effective mass tensor at \Gamma. Also compute the Frohlich average of the effective mass
and also the Frohlich ZPR from the general formula." data-toggle="popover" href="/tests/v8/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the 0D and 2D Coulomb cut-off functionality
in the ground state  for graphene." data-toggle="popover" href="/tests/v9/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
h-BN single layer using 2D cut-off method of Beigi :
compute the first order derivative of the total energy
With delta(xred)=0.0002, one gets delta(etot)/delta(xred)=-0,0050208160
With delta(xred)=0.0001, one gets delta(etot)/delta(xred)=-0,0050213750
The combination of both results, in a higher-order finite difference
formula gives -0,0050215613 . The direct computation of forces
at the target geometry gives -0,0050217263 when converged values are used.
The agreement falls within (6) digits of the finite-difference result." data-toggle="popover" href="/tests/v9/Input/t132.abi" target="_blank">t132.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ga50In50N, GGA, PAW.
Test correct treatment of atomic positions that are slightly inaccurate
Was mistreated prior to ABINITv9.2" data-toggle="popover" href="/tests/v9/Input/t191.abi" target="_blank">t191.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the angles between directions of primitive vectors of the unit cell (in
degrees), as an <strong>alternative</strong> to the input array <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>. Will be used to set
up <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>, that, together with the array <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>, will be used to define
the primitive vectors.</p>
<ul>
<li><em>angdeg(1)</em> is the angle between the 2<sup>nd</sup> and 3<sup>rd</sup> vectors,</li>
<li><em>angdeg(2)</em> is the angle between the 1<sup>st</sup> and 3<sup>rd</sup> vectors,</li>
<li><em>angdeg(3)</em> is the angle between the 1<sup>st</sup> and 2<sup>nd</sup> vectors,</li>
</ul>
<p>If the three angles are equal within 1.0d-12 (except if they are exactly 90
degrees), the three primitive vectors are chosen so that the trigonal symmetry
that exchange them is along the z cartesian axis:</p>
<div class="codehilite"><pre><span></span><code>R1 = ( a,    0,           c)
R2 = (-a/2,  sqrt(3)/2*a, c)
R3 = (-a/2, -sqrt(3)/2*a, c)
</code></pre></div>

<p>where a  2 + c 2 = 1.0
If the angles are not all equal (or if they are all 90 degrees), one will have
the following generic form:</p>
<ul>
<li>R1 = (1, 0, 0)</li>
<li>R2 = (a, b, 0)</li>
<li>R3 = (c, d, e)</li>
</ul>
<p>where each of the vectors is normalized, and form the desired angles with the others.</p>
<h2 id="ecut"><strong>ecut</strong><a class="headerlink" href="#ecut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Energy CUToff<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform numerically precise calculations with planewaves or projector- augmented waves and pseudopotentials" data-toggle="popover" href="/topics/Planewaves">topic_Planewaves</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> None<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1245/1245] in all abinit tests, [159/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Used to define the kinetic energy cutoff which controls the number of planewaves at given k point. The allowed
plane waves are those with kinetic energy lower than <strong>ecut</strong>, which translates to the following constraint
on the planewave vector <span><span class="MathJax_Preview">\vec{G}</span><script type="math/tex">\vec{G}</script></span> in reciprocal space</p>
<div>
<div class="MathJax_Preview">\frac{1}{2}(2\pi)^2 (\vec{k}+\vec{G})^2 &lt; \text{ecut}.</div>
<script type="math/tex; mode=display">\frac{1}{2}(2\pi)^2 (\vec{k}+\vec{G})^2 < \text{ecut}.</script>
</div>
<p>All planewaves inside this <strong>basis sphere</strong> centered at k are included in the basis (except if <a class="wikilink codevar-wikilink" href="/variables/rlx#dilatmx">dilatmx</a> is defined).
The cutoff can be specified in Ha units (the default), Ry, eV or Kelvin, since <strong>ecut</strong> has the
<a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics. (1 Ha = 27.2113845 eV)</p>
<p>This is the single parameter which can have an enormous effect on the quality
of a calculation; basically the larger <strong>ecut</strong> is, the better converged the
calculation is. For fixed geometry, the total energy MUST always decrease as
<strong>ecut</strong> is raised because of the variational nature of the problem.</p>
<p><em>Usually one runs at least several calculations at various <strong>ecut</strong> to
investigate the convergence needed for reliable results.</em></p>
<p>For k-points whose coordinates are build from 0 or &frac12;, the implementation of
time-reversal symmetry that links coefficients of the wavefunctions in
reciprocal space has been realized. See the input variable <a class="wikilink codevar-wikilink" href="/variables/dev#istwfk">istwfk</a>. If
activated (which corresponds to the default mode), this input variable
<a class="wikilink codevar-wikilink" href="/variables/dev#istwfk">istwfk</a> will allow to divide the number of plane wave (npw) treated
explicitly by a factor of two. Still, the final result should be identical
with the &lsquo;full&rsquo; set of plane waves.</p>
<p>See the input variable <a class="wikilink codevar-wikilink" href="/variables/rlx#ecutsm">ecutsm</a>, for the smoothing of the kinetic energy,
needed to optimize unit cell parameters.</p>
<h2 id="einterp"><strong>einterp</strong><a class="headerlink" href="#einterp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron bands INTERPolation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-toggle="popover" href="/topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (4)<br />
<em>Default value:</em> [0, 0, 0, 0]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-toggle="popover" href="/tests/libxc/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Computation of isotropic Migdal-Eliashberg Tc" data-toggle="popover" href="/tests/tutorespfn/Input/teph4isotc_3.abi" target="_blank">teph4isotc_3.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t62.abi" target="_blank">t62.abi</a></li>
</ul>
</details>
<p>This variable activates the interpolation of the electronic eigenvalues. It
can be used to interpolate KS eigenvalues at the end of the GS run or to
interpolate GW energies in sigma calculations (<a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 4). The k-path
can be specified with <a class="wikilink codevar-wikilink" href="/variables/gstate#kptbounds">kptbounds</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#nkpath">nkpath</a>.
einterp consists of 4 entries.
The first element specifies the interpolation method.</p>
<ul>
<li>0 &rarr; No interpolation (default)</li>
<li>1 &rarr; Star-function interpolation (modified Shankland-Koelling-Wood Fourier interpolation scheme, see <a class="wikilink citation-wikilink" data-tippy-content="Smooth Fourier interpolation of periodic functions" data-toggle="popover" href="/theory/bibliography#pickett1988">[Pickett1988]</a>).</li>
</ul>
<p>The meaning of the other entries depend on the interpolation technique selected.
In the case of star-function interpolation:</p>
<ul>
<li>einterp(2): Number of star-functions per ab-initio k-point</li>
<li>einterp(3): If non-zero, activate Fourier filtering according to Eq. 9 of <a class="wikilink citation-wikilink" data-tippy-content="Calculations of transport properties with the linearized augmented plane-wave method" data-toggle="popover" href="/theory/bibliography#uehara2000">[Uehara2000]</a>.
    In this case, rcut is given by einterp(2) * Rmax where Rmax is the maximum length of
    the lattice vectors included in the star expansion</li>
<li>einterp(4): Used if einterp(3) /= 0. It defines rsigma in Eq. 9</li>
</ul>
<h2 id="iscf"><strong>iscf</strong><a class="headerlink" href="#iscf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for Self-Consistent-Field cycles<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform time-dependent density-functional theory calculations of neutral excitation energies" data-toggle="popover" href="/topics/TDDFT">topic_TDDFT</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 17 if <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1,
0 if <a class="wikilink codevar-wikilink" href="/variables/basic#usewvl">usewvl</a> == 1,
7 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [348/1245] in all abinit tests, [53/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure writting the KB form factors to output. This is a two data set run,
the first dataset being a ground state calculation and the writes the WFs + KB form factors" data-toggle="popover" href="/tests/etsf_io/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
Run non-scf (iscf=-2) on 2 special points by reading t5o_DEN.
Eigenvalues should now agree among 05, 06, and 08, except that 08 will
include some unoccupied bands." data-toggle="popover" href="/tests/fast/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Run non-scf (iscf=-2) for Gamma, X, L band structure for Si." data-toggle="popover" href="/tests/fast/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as 11 but with mkmem = 0, mffmem=0 (out-of-core)." data-toggle="popover" href="/tests/fast/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Helium atom in a box. NC, only local potential (too smooth to reproduce experiment).
Simple system for testing Hartree-Fock and the SCF algorithms with OpenMP GPU. Start from PBE." data-toggle="popover" href="/tests/gpu_omp/Input/t29.abi" target="_blank">t29.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Carbon atom
Test the mGGA functionals generating directly XC potentials.
To make the test more poratble, we generate GGA-PBE wave functions as starting point.
Similar to test 08, but with smaller acell and ecut.
Without the use of a &quot;large&quot; xc_denpos, Tran-Blaha is hard to converge. Hypothesis : there is a strong non-linear
region, preventing the Anderson method to work effectively.
Note that the default iscf (=7) does not allow to converge with the default xc_denpos !
By contrast, things are much better behaved with xc_denpos on the order of 1.0e-7 ." data-toggle="popover" href="/tests/libxc/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Argon solid, experimental lattice parameter.
Realistic parameters are used (ecut=20, ngkpt=2x2x2 shifted 4 times, but centered on Gamma).
Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
The LDA gap is observed at Gamma : 8.071 eV, is in reasonable agreement with the gap from the TB paper PRL 102, 226401 (2009),
where it is mentioned to be 8.16 eV.
The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV.
The reading of the kinetic energy density, to start a non-SCF calculation is not yet implemented,
as of ABINITv6.12.0 .
This test was used to examine the speed of the convergence in case of elongated cells, up to 16 atoms.
The mGGA convergence was found to be similar to the LDA convergence.
Also, test non-self-consistent mGGA calculation, with reading of the previously produced _DEN and _KDEN files." data-toggle="popover" href="/tests/libxc/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of various XC functionals for the response functions
(thus, the XC kernel is also tested).
The test includes 3 different functionals:
1) Perdew-Zunger: ixc=2 and ixc=-001009
2) PBE: ixc=11 and ixc=-101130
3) Perdew-Wang92: ixc=7, ixc=-001012, and ixc=-001013
The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent
unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting
some lines indicated by GMR.
Note that the underlying FFT grid does not have the symmetry of the
lattice." data-toggle="popover" href="/tests/libxc/Input/t81.abi" target="_blank">t81.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Total energy vs. cell size for bulk FCC aluminium, to compare with the
PSML results of t08 and t12" data-toggle="popover" href="/tests/psml/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium" data-toggle="popover" href="/tests/psml/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon

Computation of the band structure.
First, a SCF density computation, then a non-SCF band structure calculation." data-toggle="popover" href="/tests/tutorial/Input/tbase3_5.abi" target="_blank">tbase3_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-toggle="popover" href="/tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections
Dataset 1: ground state calculation to get the density
Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ
Dataset 3: calculation of the screening (epsilon^-1 matrix for W)
Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)" data-toggle="popover" href="/tests/tutorial/Input/tgw1_1.abi" target="_blank">tgw1_1.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the option ionmov=4. 8-atom Si cube, non spin-polarized.
Same test as number 22a of fast, except for the change
of ionmov, no reading of wavefunctions, iscf to 2, and different
tolerance criteria." data-toggle="popover" href="/tests/v1/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the option ionmov=4. Si2 molecule, spin-polarized.
Same test as number 16 of fast, except for the change
of ionmov, no reading of wavefunctions, iscf to 2, and different
tolerance criteria.

Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential
version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v1/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized. Take the wavefunctions from test 45,
and converge them further for initialisation of test 47.
Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential
version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v1/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
(see test.si.chain of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si crystal (diamond structure), 2 atoms per unit cell.
Computation of responses to atomic displacements
and homogeneous electric field at Gamma,
giving access to the dynamical matrix at q(0 0 0), including
its non-analytical behaviour (effective charges
do not vanish completely due to lack of convergence),
the associated phonon frequencies, and the macroscopic
dielectric constant.
(see test.si.gamma of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs crystal (zinc-blende structure), 2 atoms per unit cell.
Computation of responses to atomic displacements
with X-point wavevector, giving the dynamical matrix and
the associated phonon frequencies.
Can be compared to the test gaas.x of RESPFN, provided
the cut-off energy is changed (here 3Ha, in RESPFN, 6Ha)." data-toggle="popover" href="/tests/v2/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Yb (1 atom per unit cell),
using a l=3 psp with s local part.
Crazy cut-off and number of k points.
Shows that the derivative of the eigenenergies
with respect to the wavevector can be obtained
both by finite differences and analytical means
(from a preliminary computation in the
treatment of the ddk perturbation).
For the (0.25,0.25,0.25) k point,
the tenth band eigenvalue is -3.01209 eV.
Going to the (0.251,0.251,0.251) k point
it becomes -3.00562 eV, with finite-difference
estimation of the derivative with respect
to ONE wavevector change (all three
components changed) being 0.00647 eV/0.001/3=2.157 eV
This value is unchanged when using the
data at the (0.253,0.253,0.253) k point.
The analytical value is 2.15566 eV." data-toggle="popover" href="/tests/v3/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
First dataset : compute the density
Second dataset : compute the spinor wfs at one k point,
non-self consistently
Third dataset : use the spinor wfs of the previous dataset
to restart computations at symmetric k points." data-toggle="popover" href="/tests/v3/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si crystal. GGA + non-linear XC core correction.
Compute the interatomic force constant for the displacement of the second atom along (111).
RF calculation of the 2DTE gives 7.51663417 Ha
while finite differences gives: with delta(xred)=0.0001, 7.15663267 Ha.
The agreement is quite good, and might likely be improved by combining finite differences.
Also compute the ddk and electric field responses. The number of k points is much too small to
obtain physical values, but are quite comparable to the result of test v2 #6" data-toggle="popover" href="/tests/v3/Input/t16.abi" target="_blank">t16.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in arbitrary structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to test the differents mixing scheme in PAW formalism.
Different values of iscf, pawmixdg and pawoptmix are choosen.
Features tested:
- mixing on density or potential (mod(iscf,10))
- different mixing schemes (iscf)
- inclusion of spherical part in residual (pawoptmix)
- mixing on coarse or fine grid (pawmixdg)
- mixing factor for spherical part (pawsphmix)
All mixing schemes give the same total energy." data-toggle="popover" href="/tests/v4/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the pspcod=8 input format (contributed by D.R. Hamann)
This format is primarily intended to offer a flexible platform
for those who wish to experiment with their own features in
norm-conserving pseudopotentials.  A full description and discussion
is given on the ABINIT wiki
https://wiki.abinit.org/doku.php?id=developers:pseudos:psp8_format
This test case, CaO, is an
example of self-interaction-corrected pseudopotentials in the
style of D. Vogel, P. Krueger, and J. Pollmann, Phys. Rev. B 52,
14 316 (1995).  The bandgap (direct) in the test example, 11.2eV,
is in excellent agreement with experiment, but is rather strongly
dependent on the radius at which the self-interaction-correction
of Ca is (smoothly) cut off.  The sic pseudopotentials used in
this test should not be considered anything but early-stage
experiments and should not be used for any other purpose." data-toggle="popover" href="/tests/v4/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Print out geometry and eigenvalue files for analysis by the BoltzTraP code, for transport coefficients,
Seebeck, etc... Tests the prtbltztrp input variable" data-toggle="popover" href="/tests/v6/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
MgB2, space group P6/m m m (#191); Bravais hP (primitive hexag.)
GS calculation followed by a band structure calculation in which the
k-path is automatically defined via the ndivsm input variable.
The third dataset tests the calculation and the output of the Fermi surface (prtfsurf=1)
in the Xcrysden format." data-toggle="popover" href="/tests/v6/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of berrystep
Al-As cristal, zinc-blende structure
Compute the polarization along strings
of k-points parallel to the primitive vectors of the reciprocal
lattice, and using multiple step berry phase calculation.
(Tests 21-30 are related to geometry optimization, molecular dynamics, etc)

Cannot be executed in parallel:
chkint_prt: ERROR -
Context : the value of the variable nproc is 2.
The value of the input variable berrystep is 5, while it must be
equal to 1" data-toggle="popover" href="/tests/v6/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the WFK, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-toggle="popover" href="/tests/v67mbpt/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials.
W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV.
First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian, then
the Haydock iterative method is employed to calculate the macroscopic dielectric function.
The last dataset solves the BSE problem including the coupling between resonant and
anti-resonant transition via brute force diagonalization." data-toggle="popover" href="/tests/v67mbpt/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiF. Optical properties within BSE and PAW (Haydock method)." data-toggle="popover" href="/tests/v67mbpt/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the extension of the pspcod=8 input format to include
spin-orbit coupling with multiple non-local projectors.  The
band structure of fcc Pt is computed at Gamma, X, and L.
The pseudopotential used in the test is generated by the open-source
ONCVPSP code, which is available at www.mat-simresearch.com, and
described in D. R. Hamann, Phys. Rev. B 88, 085177 (2013).
The relativistic extension is documented in the code package.
The Pt 5s and 5p semi-cores are treated as valence, and the band
structure is well-converged at the ecut used in the test (20 Ha).
A complete description of the input format is avaiable in
doc/psp_infos/psp8_info.txt." data-toggle="popover" href="/tests/v7/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silicon, DDK computation to prepare &#x27;optic&#x27;" data-toggle="popover" href="/tests/v7/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
20-electron PAW pseudo (4f in the core, but 4d10 as semi-core : 4d10 5s2 5p6 (5d0) 6s2 )
Test of computation of dielectric tensor, Born effective charges, dynamical matrix.
To keep the CPU time to a reasonable level, the responses are computed
with minimal parameters (nstep and the kpoint grid are too small,
ecut might be increased, and also pawecutdg).
Note: Charge neutrality is not achieved with the present dataset for Born Effective Charges,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 6 6 6,  ecut 40. pawecutdg 40.) gives Z(Eu)=2.5085, Z(O)=-2.4982" data-toggle="popover" href="/tests/v7/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/v8/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test of velocity verlet integrator" data-toggle="popover" href="/tests/v8/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-toggle="popover" href="/tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions." data-toggle="popover" href="/tests/wannier90/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
</ul>
</details>
<p>Controls the self-consistency algorithm.</p>
<p>Positive values correspond to the usual choice for doing the usual ground state
(GS) calculations or for structural relaxations, where the potential has to be
determined self-consistently while negative values correspond to non-self-consistent calculations.</p>
<p>Different SCF algorithms (&gt; 0) can be selected:</p>
<ul>
<li>0 &rarr; SCF cycle, direct minimization scheme on the gradient of the wavefunctions. This algorithm is faster than diagonalisation and mixing but is working only for systems with a gap. It is implemented only on the wavelet basis set, when <a class="wikilink codevar-wikilink" href="/variables/basic#usewvl">usewvl</a> = 1.</li>
<li>
<p>1 &rarr; get the largest eigenvalue of the SCF cycle
(<a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a> option, used with <a class="wikilink codevar-wikilink" href="/variables/files#irdwfk">irdwfk</a> = 1 or <a class="wikilink codevar-wikilink" href="/variables/files#irdwfq">irdwfq</a> = 1)</p>
</li>
<li>
<p>2 &rarr; SCF cycle, simple mixing of the potential with the preconditioned potential residual (in the usual case, the latter is defined by <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#diemac">diemac</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#dielng">dielng</a>)</p>
</li>
<li>3 &rarr; SCF cycle, Anderson mixing of the potential</li>
<li>4 &rarr; SCF cycle, Anderson mixing of the potential based on the two previous iterations</li>
<li>5 &rarr; SCF cycle, CG based on the minim. of the energy with respect to the potential</li>
<li>6 &rarr; SCF cycle, CG based on the minim. of the energy with respect to the potential (alternate algo., <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a>)</li>
<li>7 &rarr; SCF cycle, Pulay mixing of the potential based on the <a class="wikilink codevar-wikilink" href="/variables/dev#npulayit">npulayit</a> previous iterations</li>
<li>12 &rarr; SCF cycle, simple mixing of the density</li>
<li>13 &rarr; SCF cycle, Anderson mixing of the density</li>
<li>14 &rarr; SCF cycle, Anderson mixing of the density based on the two previous iterations</li>
<li>15 &rarr; SCF cycle, CG based on the minim. of the energy with respect to the density</li>
<li>16 &rarr; SCF cycle, CG based on the minim. of the energy with respect to the potential (alternate algo., <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a>)</li>
<li>17 &rarr; SCF cycle, Pulay mixing of the density based on the <a class="wikilink codevar-wikilink" href="/variables/dev#npulayit">npulayit</a> previous iterations</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Other positive values, including zero ones, are not allowed.</p>
</div>
<p>Such algorithms for treating the &ldquo;SCF iteration history&rdquo; should be coupled
with accompanying algorithms for the SCF &ldquo;preconditioning&rdquo;. See the input
variable <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a>. The default value <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> = 0 is often a good choice,
but for inhomogeneous systems, you might gain a lot with <a class="wikilink codevar-wikilink" href="/variables/gstate#iprcel">iprcel</a> = 45.</p>
<p>(Warning: if <strong>iscf</strong> &gt; 10, at present (v4.6), the energy printed at each SCF
cycle is not variational - this should not affect the other properties, and at
convergence, all values are OK)</p>
<ul>
<li>In the norm-conserving case, the default option is <strong>iscf</strong> = 7, which is a
compromise between speed and reliability. The value <strong>iscf</strong> =  2 is safer but slower.</li>
<li>In the PAW case, default option is <strong>iscf</strong> = 17. In PAW you have the
possibility to mix density/potential on the fine or coarse FFT grid (see <a class="wikilink codevar-wikilink" href="/variables/paw#pawmixdg">pawmixdg</a>).</li>
<li>Note 1: a Pulay mixing (<strong>iscf</strong> = 7 or 17) with <a class="wikilink codevar-wikilink" href="/variables/dev#npulayit">npulayit</a> = 1 (resp. 2)
is equivalent to an Anderson mixing with <strong>iscf</strong> = 3 or 13 (resp. 4 or 14).</li>
<li>Note 2: when a mixing of the density is activated ( <strong>iscf</strong> &gt;=10) the density residual
correction added to forces (see <a class="wikilink codevar-wikilink" href="/variables/dev#densfor_pred">densfor_pred</a>) needs the second derivative of the
exchange-correlation functionnal (namely Kxc). When the latter is not provided,  <strong>iscf</strong> 
is automatically switched to select the coresponding mixing of the potential ( <strong>iscf</strong> &lt;10).</li>
<li>Also note that:</li>
<li>when mixing is done on potential (iscf &lt; 10), total energy is computed by &ldquo;direct&rdquo; decomposition.</li>
<li>when mixing is done on density (iscf &gt;= 10), total energy is computed by &ldquo;double counting&rdquo; decomposition.
&ldquo;Direct&rdquo; and &ldquo;double counting&rdquo; decomposition of energy are equal when SCF
cycle is converged. Note that, when using GGA XC functionals, these
decompositions of energy can be slightly different due to imprecise
computation of density gradients on FFT grid (difference decreases as size of
FFT grid increases - see <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> for NC pseudopotentials, <a class="wikilink codevar-wikilink" href="/variables/paw#pawecutdg">pawecutdg</a> for PAW).</li>
</ul>
<p>Other (<strong>negative</strong>) options:</p>
<ul>
<li>
<p>-2 &rarr; a non-self-consistent calculation is to be done;
    in this case an electron density rho(r) on a real space grid (produced in a previous calculation)
    will be read from a disk file (automatically if <a class="wikilink codevar-wikilink" href="/variables/basic#ndtset">ndtset</a> = 0, or according to the value of <a class="wikilink codevar-wikilink" href="/variables/files#getden">getden</a> if <a class="wikilink codevar-wikilink" href="/variables/basic#ndtset">ndtset</a>/=0).
    The name of th density file must be given as indicated <a class="wikilink user-guide-wikilink" href="/guide/abinit#files-file">here</a>.
    <strong>iscf</strong> = -2 would be used for band structure calculations, to permit
    computation of the eigenvalues of occupied and unoccupied states at arbitrary
    k points in the fixed self consistent potential produced by some integration
    grid of k points. Due to this typical use, ABINIT insist that either
    <a class="wikilink codevar-wikilink" href="/variables/files#prtvol">prtvol</a> &gt; 2 or <a class="wikilink codevar-wikilink" href="/variables/files#prteig">prteig</a> does not vanish when there are more than 50 k points.
    To compute the eigenvalues (and wavefunctions) of unoccupied states in a
    separate (non-selfconsistent) run, the user should save the self-consistent
    rho(r) and then run <strong>iscf</strong> = -2 for the intended set of k-points and bands.
    To prepare a run with <strong>iscf</strong> = -2, a density file can be produced using the
    parameter <a class="wikilink codevar-wikilink" href="/variables/files#prtden">prtden</a> (see its description). When a self-consistent set of
    wavefunctions is already available, abinit can be used with <a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a> = 0
    and the adequate value of <a class="wikilink codevar-wikilink" href="/variables/files#prtden">prtden</a>, see tests/v2/Input/t47.abi .</p>
</li>
<li>
<p>-3 &rarr; like -2, but initialize <a class="wikilink codevar-wikilink" href="/variables/gstate#occ">occ</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#wtk">wtk</a>, directly or indirectly
    (using <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>) depending on the value of <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>.
    For GS, this option might be used to generate Density-of-states (thanks to
    <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a>), or to produce STM charge density map (thanks to <a class="wikilink codevar-wikilink" href="/variables/files#prtstm">prtstm</a>).
    For RF, this option is needed to compute the response to ddk perturbation.</p>
</li>
<li>
<p>-1 &rarr; like -2, but the non-self-consistent calculation is followed by the determination of excited states within TDDFT.
    This is only possible for <a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a> = 1, with <a class="wikilink codevar-wikilink" href="/variables/basic#kpt">kpt</a> = 0 0 0.
    Note that the oscillator strength needs to be defined with respect to an origin of coordinate,
    thanks to the input variable <a class="wikilink codevar-wikilink" href="/variables/gstate#boxcenter">boxcenter</a>. The maximal number of Kohn-Sham excitations to be used
    to build the excited state TDDFT matrix can be defined by <a class="wikilink codevar-wikilink" href="/variables/dfpt#td_mexcit">td_mexcit</a>, or indirectly
    by the maximum Kohn-Sham excitation energy <a class="wikilink codevar-wikilink" href="/variables/dfpt#td_maxene">td_maxene</a>. Only &ldquo;LDA-like&rdquo; XC kernels are implemented,
    from native ABINIT XC functionals with specific values of <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>=[0,1,7,8,20,21,22]. In case you use a XC functional from the libxc,
    corresponding to these values, there is no automatic translation, so that you have to specify explicitly
    the <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a> value among the above ones. As an example, if the <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a> from your pseudopotentiel is -1012,
    this corresponds to the same functional (LDA - Perdew Wang 1992) as <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>=7, and you should specify <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>=7.</p>
</li>
</ul>
<h2 id="ixc"><strong>ixc</strong><a class="headerlink" href="#ixc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Index of eXchange-Correlation functional<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform time-dependent density-functional theory calculations of neutral excitation energies" data-toggle="popover" href="/topics/TDDFT">topic_TDDFT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Comment:</em> Default corresponds to Teter parametrization. However, if all the pseudopotentials have the same value of pspxc, the initial value of ixc will be that common value<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [423/1245] in all abinit tests, [23/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Water molecule in a big box" data-toggle="popover" href="/tests/bigdft/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC" data-toggle="popover" href="/tests/built-in/Input/testin_libxc.abi" target="_blank">testin_libxc.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LOBPCG, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock with time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock without time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using old, rather inaccurate psps.
Computation of the Berry phase.
Test the doubling of the step of the sampling." data-toggle="popover" href="/tests/seq/Input/tsv3_04.abi" target="_blank">tsv3_04.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use...
example for post-processing mode of ABINIT-Wannier90 with wfk_task" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_7.abi" target="_blank">tw90_7.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparatory steps for computing phonon-limited mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_1.abi" target="_blank">teph4mob_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Generation of WFK files on dense k-meshes to prepare mobility calculations" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_4.abi" target="_blank">teph4mob_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_1.abi" target="_blank">tlw_1.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom (see below). Treated without any XC energy (ixc=0).
The total energy is -1.9442 Ha.
10.-20. Isolated Helium atom tests.
These tests exercise different xc functionals, in the spin-unpolarized case.
The helium atom is isolated in a box of size 5x5x5, with one
special point (1/4 1/4 1/4), 200 Ha cut-off, used with
a potential close to the bare He potential
(erfc with 0.001 bohr decay length). Errors due to the smallness
of the supercell size are on the order of 1 mHa, as well as those
due to the representation of the Coulomb potential by a erfc function.
The remaining is due to finiteness of the basis set.
The estimation of the latter errors is presented in the test_cases
17 and 18. In all these tests, intxc=0." data-toggle="popover" href="/tests/v1/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom. Treated with LDA, Teter rational polynomial parametrization (4/93) (ixc=1).
The total energy is -2.8275 Ha." data-toggle="popover" href="/tests/v1/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom. Treated with LDA, Perdew-Zunger-Ceperley-Alder (ixc=2).
The total energy is -2.8278 Ha.
For speed-up, it begins with the wavefunctions from test 11." data-toggle="popover" href="/tests/v1/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbFCl in the matlockite structure P4/nmm. 6 atoms per cell.
Compute a set of matrix elements of the dynamical matrix,
for q wavevector 0.5 0.5 0.5 .
In this test case, the symmetry operations have an important
non-symmorphic character. There was a bug in the treatment
of this material, prior to v5.2.4 ." data-toggle="popover" href="/tests/v5/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-toggle="popover" href="/tests/v5/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom.
Treated with GGA C09x exchange functional (ixc=24).
The total energy is -0.429523 Ha.
Also additional tests concerning the kinetic energy density calculation,
the gradient of electronic density calculation and
the Laplacian of electronic density calculation are performed.
Test taken from v1/t21.in." data-toggle="popover" href="/tests/v6/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated hydrogen atom
Calculation of the HF levels with different ways to integrate the Coulomb divergence" data-toggle="popover" href="/tests/v67mbpt/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with temperature-dependent renormalization
WARNING: This feature is still under testing, files and variables could change in the next versions" data-toggle="popover" href="/tests/v67mbpt/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with temperature-dependent renormalization
WARNING: This feature is still under testing, files and variables could change in the next versions" data-toggle="popover" href="/tests/v67mbpt/Input/t51.abi" target="_blank">t51.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Boron, 32 atoms - Thomas-Fermi method (without orbitals)
Test the temperature-dependent XC functional (ixc=50)
(Ichimaru et al Phys. Rep. 149, 91-205 (1987)
Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-toggle="popover" href="/tests/v7/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
27-electron PAW pseudo (4f and 5d are explicitly treated : 4d10 4f7 5s2 5p6 (5d0) 6s2 )
Test of initialisation using occopt=1 (the default) with non-zero spinmagntarget,
and also metallic occopt. Also test pawxcdev=0" data-toggle="popover" href="/tests/v7/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiH rocksalt structure with a negative lithium vacancy
test thee potential alignement usepotzero=0,1" data-toggle="popover" href="/tests/v7/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom." data-toggle="popover" href="/tests/v8/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom along one direction." data-toggle="popover" href="/tests/v8/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
test the use of LDA-1/2 on silicon." data-toggle="popover" href="/tests/v8/Input/t32.abi" target="_blank">t32.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
InN non-primitive cell, doubled wurtzite, rather inaccurate rprimd and xred.
Test disabling all checks and fixes of atomic positions or cell parameters. Otherwise, similar to v9#17" data-toggle="popover" href="/tests/v9/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-toggle="popover" href="/tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-toggle="popover" href="/tests/v9/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Controls the choice of exchange and correlation (xc). The list of XC
functionals is given below. Positive values are for ABINIT native library of
XC functionals, while negative values are for calling the much wider set of
functionals from the ETSF LibXC library (by M. Marques), available at the <a href="http://octopus-code.org/wiki/Libxc">
LibXC home page </a>
Note that the choice made here should preferably agree with the choice made in
generating the original pseudopotential, except for  <strong>ixc</strong>  = 0 (usually only
used for debugging). A warning is issued if this is not the case.
Unfortunately, pseudopotential (or PAW) generators for hybrid functionals and
mGGA are currently under development, so that one usually uses GGA or LDA
pseudopotentials instead. The error should be limited when GGA or LDA
pseudopotentials with semi-core states are used.
Still this is a non-controlled error. Moreover, the choices  <strong>ixc</strong>  = 1, 2, 3 and 7 are fits to the
same data, from Ceperley-Alder, and are rather similar, at least for spin-unpolarized systems.
The choice between the non-spin-polarized and spin-polarized case is governed
by the value of <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> (see below).</p>
<p><strong>Native ABINIT XC functionals</strong></p>
<p>NOTE: in the implementation of the spin-dependence of these functionals, and
in order to avoid divergences in their derivatives, the interpolating function
between spin-unpolarized and fully-spin-polarized function has been slightly
modified, by including a zeta rescaled by 1.d0-1.d-6. This should affect total
energy at the level of 1.d-6Ha, and should have an even smaller effect on
differences of energies, or derivatives.
The value  <strong>ixc</strong>  = 10 is used internally: gives the difference between
 <strong>ixc</strong>  = 7 and  <strong>ixc</strong>  = 9, for use with an accurate RPA correlation energy.</p>
<ul>
<li>
<p>0 &rarr; NO xc.</p>
</li>
<li>
<p>1 &rarr; LDA or LSD, Teter Pade parametrization (4/93, published in <a class="wikilink citation-wikilink" data-tippy-content="Separable dual-space Gaussian pseudopotentials" data-toggle="popover" href="/theory/bibliography#goedecker1996">[Goedecker1996]</a>, which reproduces Perdew-Wang 92 <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a> (which reproduces Ceperley-Alder <a class="wikilink citation-wikilink" data-tippy-content="Ground State of the Electron Gas by a Stochastic Method" data-toggle="popover" href="/theory/bibliography#ceperley1980">[Ceperley1980]</a>!).</p>
</li>
<li>2 &rarr; LDA, Perdew-Zunger-Ceperley-Alder (no spin-polarization) <a class="wikilink citation-wikilink" data-tippy-content="Self-interaction correction to density-functional approximations for many-electron systems" data-toggle="popover" href="/theory/bibliography#perdew1981">[Perdew1981]</a></li>
<li>3 &rarr; LDA, old Teter rational polynomial parametrization (4/91) fit to Ceperley-Alder data (no spin-polarization) <a class="wikilink citation-wikilink" data-tippy-content="Ground State of the Electron Gas by a Stochastic Method" data-toggle="popover" href="/theory/bibliography#ceperley1980">[Ceperley1980]</a></li>
<li>4 &rarr; LDA, Wigner functional (no spin-polarization)</li>
<li>5 &rarr; LDA, Hedin-Lundqvist functional (no spin-polarization) <a class="wikilink citation-wikilink" data-tippy-content="Explicit local exchange-correlation potentials" data-toggle="popover" href="/theory/bibliography#hedin1971">[Hedin1971]</a></li>
<li>6 &rarr; LDA, &ldquo;X-alpha&rdquo; functional (no spin-polarization)</li>
<li>7 &rarr; LDA or LSD, Perdew-Wang 92 functional <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a></li>
<li>8 &rarr; LDA or LSD, x-only part of the Perdew-Wang 92 functional <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a></li>
<li>
<p>9 &rarr; LDA or LSD, x- and RPA correlation part of the Perdew-Wang 92 functional <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a></p>
</li>
<li>
<p>11 &rarr; GGA, Perdew-Burke-Ernzerhof GGA functional <a class="wikilink citation-wikilink" data-tippy-content="Generalized Gradient Approximation Made Simple" data-toggle="popover" href="/theory/bibliography#perdew1996">[Perdew1996]</a></p>
</li>
<li>12 &rarr; GGA, x-only part of Perdew-Burke-Ernzerhof GGA functional <a class="wikilink citation-wikilink" data-tippy-content="Generalized Gradient Approximation Made Simple" data-toggle="popover" href="/theory/bibliography#perdew1996">[Perdew1996]</a></li>
<li>13 &rarr; GGA potential of van Leeuwen-Baerends <a class="wikilink citation-wikilink" data-tippy-content="Exchange-correlation potential with correct asymptotic behavior" data-toggle="popover" href="/theory/bibliography#vanleeuwen1994">[VanLeeuwen1994]</a>, while for energy, Perdew-Wang 92 functional <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a></li>
<li>14 &rarr; GGA, revPBE of <a class="wikilink citation-wikilink" data-tippy-content="Comment on Generalized Gradient Approximation Made Simple" data-toggle="popover" href="/theory/bibliography#zhang1998">[Zhang1998]</a></li>
<li>15 &rarr; GGA, RPBE of <a class="wikilink citation-wikilink" data-tippy-content="Improved adsorption energetics within density-functional theory using revised Perdew-Burke-Ernzerhof functionals" data-toggle="popover" href="/theory/bibliography#hammer1999">[Hammer1999]</a></li>
<li>16 &rarr; GGA, HTCH93 of <a class="wikilink citation-wikilink" data-tippy-content="Development and assessment of new exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#hamprecht1998">[Hamprecht1998]</a></li>
<li>17 &rarr; GGA, HTCH120 of <a class="wikilink citation-wikilink" data-tippy-content="New generalized gradient approximation functionals" data-toggle="popover" href="/theory/bibliography#boese2000">[Boese2000]</a> - The usual HCTH functional.</li>
<li>18 &rarr; (NOT AVAILABLE: used internally for GGA BLYP pseudopotentials from <a class="wikilink citation-wikilink" data-tippy-content="Pseudopotentials for H to Kr optimized for gradient-corrected exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#krack2005">[Krack2005]</a>, available from the <a href="https://github.com/cp2k/cp2k/tree/master/data/POTENTIAL"> CP2K repository </a> - use the LibXC instead, with  <strong>ixc</strong>  = -106131.</li>
<li>
<p>19 &rarr; (NOT AVAILABLE: used internally for GGA BP86 pseudopotentials from <a class="wikilink citation-wikilink" data-tippy-content="Pseudopotentials for H to Kr optimized for gradient-corrected exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#krack2005">[Krack2005]</a>, available from the <a href="https://github.com/cp2k/cp2k/tree/master/data/POTENTIAL"> CP2K repository </a> - use the LibXC instead, with  <strong>ixc</strong>  = -106132.</p>
</li>
<li>
<p>20 &rarr; Fermi-Amaldi xc ( -1/N Hartree energy, where N is the number of electrons per cell; G=0 is not taken into account however),
                            for TDDFT tests. No spin-pol. Does not work for RF.</p>
</li>
<li>21 &rarr; same as 20, except that the xc-kernel is the LDA ( <strong>ixc</strong>  = 1) one, for TDDFT tests.</li>
<li>22 &rarr; same as 20, except that the xc-kernel is the Burke-Petersilka-Gross hybrid, for TDDFT tests.</li>
<li>23 &rarr; GGA of <a class="wikilink citation-wikilink" data-tippy-content="More accurate generalized gradient approximation for solids" data-toggle="popover" href="/theory/bibliography#wu2006">[Wu2006]</a>.</li>
<li>24 &rarr; GGA, C09x exchange of <a class="wikilink citation-wikilink" data-tippy-content="Van der Waals density functional: An appropriate exchange functional" data-toggle="popover" href="/theory/bibliography#cooper2010">[Cooper2010]</a>.</li>
<li>26 &rarr; GGA, HTCH147 of <a class="wikilink citation-wikilink" data-tippy-content="New generalized gradient approximation functionals" data-toggle="popover" href="/theory/bibliography#boese2000">[Boese2000]</a>.</li>
<li>27 &rarr; GGA, HTCH407 of <a class="wikilink citation-wikilink" data-tippy-content="A new parametrization of exchange--correlation generalized gradient approximation functionals" data-toggle="popover" href="/theory/bibliography#boese2001">[Boese2001]</a>.</li>
<li>
<p>28 &rarr; (NOT AVAILABLE: used internally for GGA OLYP pseudopotentials from <a class="wikilink citation-wikilink" data-tippy-content="Pseudopotentials for H to Kr optimized for gradient-corrected exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#krack2005">[Krack2005]</a>, available from the <a href="https://github.com/cp2k/cp2k/tree/master/data/POTENTIAL"> CP2K repository </a> - use the LibXC instead, with  <strong>ixc</strong>  = -110131.</p>
</li>
<li>
<p>40 &rarr; Hartree-Fock</p>
</li>
<li>41 &rarr; PBE0, <a class="wikilink citation-wikilink" data-tippy-content="Toward reliable density functional methods without adjustable parameters: The PBE0 model" data-toggle="popover" href="/theory/bibliography#adamo1999">[Adamo1999]</a>.</li>
<li>42 &rarr; PBE0-&#8531;, <a class="wikilink citation-wikilink" data-tippy-content="Communication: One third: A new recipe for the PBE0 paradigm" data-toggle="popover" href="/theory/bibliography#guido2013">[Guido2013]</a>.</li>
<li>50 &rarr; IIT temperature-dependent Free Energy functional of <a class="wikilink citation-wikilink" data-tippy-content="Statistical physics of dense plasmas: Thermodynamics, transport coefficients and dynamic correlations" data-toggle="popover" href="/theory/bibliography#ichimaru1987">[Ichimaru1987]</a> (designed for warm dense matter). The electronic temperature is taken from the <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a> if <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>=3 or 9 (Fermi-Dirac), from <a class="wikilink codevar-wikilink" href="/variables/gstate#tphysel">tphysel</a> otherwise.</li>
</ul>
<p><strong>ETSF Lib XC functionals</strong></p>
<p>Note that you must compile ABINIT with the LibXC plug-in in order to be able
to access these functionals.
The LibXC functionals are accessed by <strong>negative values</strong> of  <strong>ixc</strong> . The
LibXC contains functional forms for either exchange-only functionals,
correlation-only functionals, or combined exchange and correlation
functionals. Each of them is to be specified by a three-digit number. In case
of a combined exchange and correlation functional, only one such three-digit
number has to be specified as value of  <strong>ixc</strong> , with a minus sign (to indicate
that it comes from the LibXC). In the case of separate exchange functional
(let us represent its identifier by XXX) and correlation functional (let us
represent its identified by CCC), a six-digit number will have to be specified
for  <strong>ixc</strong> , by concatenation, be it XXXCCC or CCCXXX. As an example,
 <strong>ixc</strong>  = -1012 gives the Perdew-Wang 1992 LDA ( <strong>ixc</strong> =7 as well),
 <strong>ixc</strong>  = -020 gives the Teter93 LDA ( <strong>ixc</strong> =1 as well),
while  <strong>ixc</strong>  = -101130 gives the PBE GGA ( <strong>ixc</strong> =11 as well).
Note that for a meta-GGA, the kinetic energy density is needed.
This means having <a class="wikilink codevar-wikilink" href="/variables/gstate#usekden">usekden</a> = 1.</p>
<p><mark>(S)LDA functionals</mark> (do not forget to add a minus sign, as discussed above)</p>
<ul>
<li>001 &rarr; XC_LDA_X  <a class="wikilink citation-wikilink" data-tippy-content="Note on Exchange Phenomena in the Thomas Atom" data-toggle="popover" href="/theory/bibliography#dirac1930">[Dirac1930]</a>, <a class="wikilink citation-wikilink" data-tippy-content="Bemerkung zur Elektronentheorie des Ferromagnetismus und der elektrischen Leitfähigkeit" data-toggle="popover" href="/theory/bibliography#bloch1929">[Bloch1929]</a></li>
<li>002 &rarr; XC_LDA_C_WIGNER  Wigner parametrization <a class="wikilink citation-wikilink" data-tippy-content="Effects of the electron interaction on the energy levels of electrons in metals" data-toggle="popover" href="/theory/bibliography#wigner1938">[Wigner1938]</a></li>
<li>003 &rarr; XC_LDA_C_RPA  Random Phase Approximation <a class="wikilink citation-wikilink" data-tippy-content="Correlation Energy of an Electron Gas at High Density" data-toggle="popover" href="/theory/bibliography#gellmann1957">[GellMann1957]</a></li>
<li>004 &rarr; XC_LDA_C_HL  Hedin &amp; Lundqvist <a class="wikilink citation-wikilink" data-tippy-content="Explicit local exchange-correlation potentials" data-toggle="popover" href="/theory/bibliography#hedin1971">[Hedin1971]</a></li>
<li>005 &rarr; XC_LDA_C_GL  Gunnarson &amp; Lundqvist <a class="wikilink citation-wikilink" data-tippy-content="Exchange and correlation in atoms, molecules, and solids by the spin-density-functional formalism" data-toggle="popover" href="/theory/bibliography#gunnarsson1976">[Gunnarsson1976]</a></li>
<li>006 &rarr; XC_LDA_C_XALPHA  Slaters Xalpha</li>
<li>007 &rarr; XC_LDA_C_VWN  <a class="wikilink citation-wikilink" data-tippy-content="Accurate spin-dependent electron liquid correlation energies for local spin density calculations: A critical analysis" data-toggle="popover" href="/theory/bibliography#vosko1980">[Vosko1980]</a></li>
<li>008 &rarr; XC_LDA_C_VWN_RPA  <a class="wikilink citation-wikilink" data-tippy-content="Accurate spin-dependent electron liquid correlation energies for local spin density calculations: A critical analysis" data-toggle="popover" href="/theory/bibliography#vosko1980">[Vosko1980]</a></li>
<li>009 &rarr; XC_LDA_C_PZ  Perdew &amp; Zunger <a class="wikilink citation-wikilink" data-tippy-content="Self-interaction correction to density-functional approximations for many-electron systems" data-toggle="popover" href="/theory/bibliography#perdew1981">[Perdew1981]</a></li>
<li>010 &rarr; XC_LDA_C_PZ_MOD  Perdew &amp; Zunger (Modified) <a class="wikilink citation-wikilink" data-tippy-content="Self-interaction correction to density-functional approximations for many-electron systems" data-toggle="popover" href="/theory/bibliography#perdew1981">[Perdew1981]</a> Modified to improve the matching between the low and high rs part</li>
<li>011 &rarr; XC_LDA_C_OB_PZ  Ortiz &amp; Ballone (PZ) <a class="wikilink citation-wikilink" data-tippy-content="Correlation energy, structure factor, radial distribution function, and momentum distribution of the spin-polarized uniform electron gas" data-toggle="popover" href="/theory/bibliography#ortiz1994">[Ortiz1994]</a> <a class="wikilink citation-wikilink" data-tippy-content="Erratum: Correlation energy, structure factor, radial distribution function, and momentum distribution of the spin-polarized uniform electron gas [Phys. Rev. B50, 1391 (1994)]" data-toggle="popover" href="/theory/bibliography#ortiz1997">[Ortiz1997]</a> <a class="wikilink citation-wikilink" data-tippy-content="Self-interaction correction to density-functional approximations for many-electron systems" data-toggle="popover" href="/theory/bibliography#perdew1981">[Perdew1981]</a></li>
<li>012 &rarr; XC_LDA_C_PW  Perdew &amp; Wang <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a></li>
<li>013 &rarr; XC_LDA_C_PW_MOD  Perdew &amp; Wang (Modified) <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a>; Added extra digits to some constants as in the PBE routine.</li>
<li>014 &rarr; XC_LDA_C_OB_PW  Ortiz &amp; Ballone (PW) <a class="wikilink citation-wikilink" data-tippy-content="Correlation energy, structure factor, radial distribution function, and momentum distribution of the spin-polarized uniform electron gas" data-toggle="popover" href="/theory/bibliography#ortiz1994">[Ortiz1994]</a> <a class="wikilink citation-wikilink" data-tippy-content="Erratum: Correlation energy, structure factor, radial distribution function, and momentum distribution of the spin-polarized uniform electron gas [Phys. Rev. B50, 1391 (1994)]" data-toggle="popover" href="/theory/bibliography#ortiz1997">[Ortiz1997]</a> <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a></li>
<li>017 &rarr; XC_LDA_C_vBH  von Barth &amp; Hedin <a class="wikilink citation-wikilink" data-tippy-content="A local exchange-correlation potential for the spin polarized case. i" data-toggle="popover" href="/theory/bibliography#barth1972">[Barth1972]</a></li>
<li>020 &rarr; XC_LDA_XC_TETER93  Teter 93 parametrization <a class="wikilink citation-wikilink" data-tippy-content="Separable dual-space Gaussian pseudopotentials" data-toggle="popover" href="/theory/bibliography#goedecker1996">[Goedecker1996]</a></li>
<li>022 &rarr; XC_LDA_C_ML1  Modified LSD (version 1) of Proynov and Salahub <a class="wikilink citation-wikilink" data-tippy-content="Simple but efficient correlation functional from a model pair-correlation function" data-toggle="popover" href="/theory/bibliography#proynov1994">[Proynov1994]</a></li>
<li>023 &rarr; XC_LDA_C_ML2  Modified LSD (version 2) of Proynov and Salahub <a class="wikilink citation-wikilink" data-tippy-content="Simple but efficient correlation functional from a model pair-correlation function" data-toggle="popover" href="/theory/bibliography#proynov1994">[Proynov1994]</a></li>
<li>024 &rarr; XC_LDA_C_GOMBAS  Gombas parametrization <a class="wikilink citation-wikilink" data-tippy-content="Pseudopotentiale" data-toggle="popover" href="/theory/bibliography#gombas1967">[Gombas1967]</a></li>
<li>025 &rarr; XC_LDA_C_PW_RPA  Perdew &amp; Wang fit of the RPA <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a></li>
<li>027 &rarr; XC_LDA_C_RC04  Ragot-Cortona <a class="wikilink citation-wikilink" data-tippy-content="Correlation energy of many-electron systems: A modified Colle--Salvetti approach" data-toggle="popover" href="/theory/bibliography#ragot2004">[Ragot2004]</a></li>
<li>028 &rarr; XC_LDA_C_VWN_1  Vosko, Wilk, &amp; Nussair (1) <a class="wikilink citation-wikilink" data-tippy-content="Accurate spin-dependent electron liquid correlation energies for local spin density calculations: A critical analysis" data-toggle="popover" href="/theory/bibliography#vosko1980">[Vosko1980]</a></li>
<li>029 &rarr; XC_LDA_C_VWN_2  Vosko, Wilk, &amp; Nussair (2) <a class="wikilink citation-wikilink" data-tippy-content="Accurate spin-dependent electron liquid correlation energies for local spin density calculations: A critical analysis" data-toggle="popover" href="/theory/bibliography#vosko1980">[Vosko1980]</a></li>
<li>030 &rarr; XC_LDA_C_VWN_3  Vosko, Wilk, &amp; Nussair (3) <a class="wikilink citation-wikilink" data-tippy-content="Accurate spin-dependent electron liquid correlation energies for local spin density calculations: A critical analysis" data-toggle="popover" href="/theory/bibliography#vosko1980">[Vosko1980]</a></li>
<li>031 &rarr; XC_LDA_C_VWN_4  Vosko, Wilk, &amp; Nussair (4) <a class="wikilink citation-wikilink" data-tippy-content="Accurate spin-dependent electron liquid correlation energies for local spin density calculations: A critical analysis" data-toggle="popover" href="/theory/bibliography#vosko1980">[Vosko1980]</a></li>
</ul>
<p><mark>LDA temperature-dependent functionals</mark> (do not forget to add a minus sign, as discussed above)
  The electronic temperature is taken from the <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a> if <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>=3 or 9 (Fermi-Dirac), from <a class="wikilink codevar-wikilink" href="/variables/gstate#tphysel">tphysel</a> otherwise.
  Use of <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>=3 is recommended to have a physical meaning of the temperature.
  As these functionals do not provide Kxc (2<sup>nd</sup> derivative of Exc), a SCF mixing
  of the potential is automatically selected (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&lt;10).</p>
<ul>
<li>259 &rarr; XC_LDA_XC_KSDT, LDA T-dependent functional: Karasiev, Sjostrom, Dufty, &amp; Trickey <a class="wikilink citation-wikilink" data-tippy-content="Accurate Homogeneous Electron Gas Exchange-Correlation Free Energy for Local Spin-Density Calculations" data-toggle="popover" href="/theory/bibliography#karasiev2014">[Karasiev2014]</a></li>
<li>318 &rarr; XC_LDA_XC_CORRKSDT, corrected KSDT by Karasiev, Dufty, &amp; Trickey <a class="wikilink citation-wikilink" data-tippy-content="Nonempirical Semilocal Free-Energy Density Functional for Matter under Extreme Conditions" data-toggle="popover" href="/theory/bibliography#karasiev2018">[Karasiev2018]</a></li>
<li>577 &rarr; XC_LDA_XC_GDSMFB, LDA T-dependent functional: Groth, Dornheim, Sjostrom, Malone, Foulkes, &amp; Bonitz <a class="wikilink citation-wikilink" data-tippy-content="Ab initio Exchange-Correlation Free Energy of the Uniform Electron Gas at Warm Dense Matter Conditions" data-toggle="popover" href="/theory/bibliography#groth2017">[Groth2017]</a></li>
</ul>
<p><mark>GGA functionals</mark> (do not forget to add a minus sign, as discussed above)</p>
<ul>
<li>084 &rarr; XC_GGA_C_OP_XALPHA  one-parameter progressive functional (G96 version) <a class="wikilink citation-wikilink" data-tippy-content="A reexamination of exchange energy functionals" data-toggle="popover" href="/theory/bibliography#tsuneda1999">[Tsuneda1999]</a></li>
<li>085 &rarr; XC_GGA_C_OP_G96  one-parameter progressive functional (G96 version) <a class="wikilink citation-wikilink" data-tippy-content="A reexamination of exchange energy functionals" data-toggle="popover" href="/theory/bibliography#tsuneda1999">[Tsuneda1999]</a></li>
<li>086 &rarr; XC_GGA_C_OP_PBE  one-parameter progressive functional (PBE version) <a class="wikilink citation-wikilink" data-tippy-content="A reexamination of exchange energy functionals" data-toggle="popover" href="/theory/bibliography#tsuneda1999">[Tsuneda1999]</a></li>
<li>087 &rarr; XC_GGA_C_OP_B88  one-parameter progressive functional (B88 version) <a class="wikilink citation-wikilink" data-tippy-content="A reexamination of exchange energy functionals" data-toggle="popover" href="/theory/bibliography#tsuneda1999">[Tsuneda1999]</a></li>
<li>088 &rarr; XC_GGA_C_FT97  Filatov &amp; Thiel correlation <a class="wikilink citation-wikilink" data-tippy-content="A new gradient-corrected exchange-correlation density functional" data-toggle="popover" href="/theory/bibliography#filatov1997a">[Filatov1997a]</a>  <a class="wikilink citation-wikilink" data-tippy-content="A nonlocal correlation energy density functional from a Coulomb hole model" data-toggle="popover" href="/theory/bibliography#filatov1997">[Filatov1997]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>this functional is not tested. Use at your own risks.</p>
</div>
<ul>
<li>089 &rarr; XC_GGA_C_SPBE  PBE correlation to be used with the SSB exchange <a class="wikilink citation-wikilink" data-tippy-content="A new all-round density functional based on spin states and $S_N2$ barriers" data-toggle="popover" href="/theory/bibliography#swart2009">[Swart2009]</a></li>
<li>090 &rarr; XC_GGA_X_SSB_SW  Swart, Sola and Bickelhaupt correction to PBE <a class="wikilink citation-wikilink" data-tippy-content="Switching between OPTX and PBE exchange functionals" data-toggle="popover" href="/theory/bibliography#swart2009a">[Swart2009a]</a></li>
<li>091 &rarr; XC_GGA_X_SSB  <a class="wikilink citation-wikilink" data-tippy-content="A new all-round density functional based on spin states and $S_N2$ barriers" data-toggle="popover" href="/theory/bibliography#swart2009">[Swart2009]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functional gives NaN on IBM (XG20130608).</p>
</div>
<ul>
<li>092 &rarr;  XC_GGA_X_SSB_D  <a class="wikilink citation-wikilink" data-tippy-content="A new all-round density functional based on spin states and $S_N2$ barriers" data-toggle="popover" href="/theory/bibliography#swart2009">[Swart2009]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functional gives NaN on IBM (XG20130608).</p>
</div>
<ul>
<li>093 &rarr;  XC_GGA_XC_HCTH_407P  HCTH/407+ <a class="wikilink citation-wikilink" data-tippy-content="From ab initio quantum chemistry to molecular dynamics: The delicate case of hydrogen bonding in ammonia" data-toggle="popover" href="/theory/bibliography#boese2003">[Boese2003]</a></li>
<li>094 &rarr;  XC_GGA_XC_HCTH_P76  HCTH p=7/6 <a class="wikilink citation-wikilink" data-tippy-content="Emphasizing the exchange-correlation potential in functional development" data-toggle="popover" href="/theory/bibliography#menconi2001">[Menconi2001]</a></li>
<li>095 &rarr;  XC_GGA_XC_HCTH_P14  HCTH p=&frac14; <a class="wikilink citation-wikilink" data-tippy-content="Emphasizing the exchange-correlation potential in functional development" data-toggle="popover" href="/theory/bibliography#menconi2001">[Menconi2001]</a></li>
<li>096 &rarr;  XC_GGA_XC_B97_GGA1  Becke 97 GGA-1 <a class="wikilink citation-wikilink" data-tippy-content="Assessment of exchange correlation functionals" data-toggle="popover" href="/theory/bibliography#cohen2000">[Cohen2000]</a></li>
<li>097 &rarr;  XC_GGA_XC_HCTH_A  HCTH-A <a class="wikilink citation-wikilink" data-tippy-content="Development and assessment of new exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#hamprecht1998">[Hamprecht1998]</a></li>
<li>098 &rarr;  XC_GGA_X_BPCCAC  BPCCAC (GRAC for the energy) <a class="wikilink citation-wikilink" data-tippy-content="Generalized gradient exchange functionals based on the gradient-regulated connection: A new member of the TCA family" data-toggle="popover" href="/theory/bibliography#bremond2012">[Bremond2012]</a></li>
<li>099 &rarr;  XC_GGA_C_REVTCA  Tognetti, Cortona, Adamo (revised) <a class="wikilink citation-wikilink" data-tippy-content="Increasing physical constraints and improving performances in a parameter-free GGA functional" data-toggle="popover" href="/theory/bibliography#tognetti2008">[Tognetti2008]</a></li>
<li>100 &rarr;  XC_GGA_C_TCA  Tognetti, Cortona, Adamo <a class="wikilink citation-wikilink" data-tippy-content="A new parameter-free correlation functional based on an average atomic reduced density gradient analysis" data-toggle="popover" href="/theory/bibliography#tognetti2008a">[Tognetti2008a]</a></li>
<li>101 &rarr;  XC_GGA_X_PBE  Perdew, Burke &amp; Ernzerhof exchange <a class="wikilink citation-wikilink" data-tippy-content="Generalized Gradient Approximation Made Simple" data-toggle="popover" href="/theory/bibliography#perdew1996">[Perdew1996]</a>  <a class="wikilink citation-wikilink" data-tippy-content="Generalized Gradient Approximation Made Simple [Phys. Rev. Lett. 77, 3865 (1996)]" data-toggle="popover" href="/theory/bibliography#perdew1997">[Perdew1997]</a></li>
<li>102 &rarr;  XC_GGA_X_PBE_R  Perdew, Burke &amp; Ernzerhof exchange (revised) <a class="wikilink citation-wikilink" data-tippy-content="Comment on Generalized Gradient Approximation Made Simple" data-toggle="popover" href="/theory/bibliography#zhang1998">[Zhang1998]</a></li>
<li>103 &rarr;  XC_GGA_X_B86  Becke 86 Xalfa,beta,gamma <a class="wikilink citation-wikilink" data-tippy-content="Density functional calculations of molecular bond energies" data-toggle="popover" href="/theory/bibliography#becke1986">[Becke1986]</a></li>
<li>104 &rarr;  XC_GGA_X_HERMAN  Herman Xalphabeta GGA <a class="wikilink citation-wikilink" data-tippy-content="Improved Statistical Exchange Approximation for Inhomogeneous Many-Electron Systems" data-toggle="popover" href="/theory/bibliography#herman1969">[Herman1969]</a>  <a class="wikilink citation-wikilink" data-tippy-content="A method for improving the physical realism of first-principles band structure calculations" data-toggle="popover" href="/theory/bibliography#herman2009">[Herman2009]</a></li>
<li>105 &rarr;  XC_GGA_X_B86_MGC  Becke 86 Xalfa,beta,gamma (with mod. grad. correction) <a class="wikilink citation-wikilink" data-tippy-content="Density functional calculations of molecular bond energies" data-toggle="popover" href="/theory/bibliography#becke1986">[Becke1986]</a>  <a class="wikilink citation-wikilink" data-tippy-content="On the large-gradient behavior of the density functional exchange energy" data-toggle="popover" href="/theory/bibliography#becke1986a">[Becke1986a]</a></li>
<li>106 &rarr;  XC_GGA_X_B88  Becke 88 <a class="wikilink citation-wikilink" data-tippy-content="Density-functional exchange-energy approximation with correct asymptotic behavior" data-toggle="popover" href="/theory/bibliography#becke1988">[Becke1988]</a></li>
<li>107 &rarr;  XC_GGA_X_G96  Gill 96 <a class="wikilink citation-wikilink" data-tippy-content="A new gradient-corrected exchange functional" data-toggle="popover" href="/theory/bibliography#gill1996">[Gill1996]</a></li>
<li>108 &rarr;  XC_GGA_X_PW86  Perdew &amp; Wang 86 <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple density functional for the electronic exchange energy: Generalized gradient approximation" data-toggle="popover" href="/theory/bibliography#perdew1986a">[Perdew1986a]</a></li>
<li>109 &rarr;  XC_GGA_X_PW91  Perdew &amp; Wang 91 [JP Perdew, in Proceedings of the 21<sup>st</sup> Annual International Symposium on the Electronic Structure of Solids, ed. by P Ziesche and H Eschrig (Akademie Verlag, Berlin, 1991), p. 11. ]  <a class="wikilink citation-wikilink" data-tippy-content="Atoms, molecules, solids, and surfaces: Applications of the generalized gradient approximation for exchange and correlation" data-toggle="popover" href="/theory/bibliography#perdew1992">[Perdew1992]</a>  <a class="wikilink citation-wikilink" data-tippy-content="Erratum: Atoms, molecules, solids, and surfaces: Applications of the generalized gradient approximation for exchange and correlation" data-toggle="popover" href="/theory/bibliography#perdew1993">[Perdew1993]</a></li>
<li>110 &rarr;  XC_GGA_X_OPTX  Handy &amp; Cohen OPTX 01 <a class="wikilink citation-wikilink" data-tippy-content="Left-right correlation energy" data-toggle="popover" href="/theory/bibliography#handy2001">[Handy2001]</a></li>
<li>111 &rarr;  XC_GGA_X_DK87_R1  dePristo &amp; Kress 87 (version R1) <a class="wikilink citation-wikilink" data-tippy-content="Rational function representation for accurate exchange energy functionals" data-toggle="popover" href="/theory/bibliography#depristo1987">[DePristo1987]</a></li>
<li>112 &rarr;  XC_GGA_X_DK87_R2  dePristo &amp; Kress 87 (version R2) <a class="wikilink citation-wikilink" data-tippy-content="Rational function representation for accurate exchange energy functionals" data-toggle="popover" href="/theory/bibliography#depristo1987">[DePristo1987]</a></li>
<li>113 &rarr;  XC_GGA_X_LG93  Lacks &amp; Gordon 93 <a class="wikilink citation-wikilink" data-tippy-content="Pair interactions of rare-gas atoms as a test of exchange-energy-density functionals in regions of large density gradients" data-toggle="popover" href="/theory/bibliography#lacks1993">[Lacks1993]</a></li>
<li>114 &rarr;  XC_GGA_X_FT97_A  Filatov &amp; Thiel 97 (version A) <a class="wikilink citation-wikilink" data-tippy-content="A new gradient-corrected exchange-correlation density functional" data-toggle="popover" href="/theory/bibliography#filatov1997a">[Filatov1997a]</a></li>
<li>115 &rarr;  XC_GGA_X_FT97_B  Filatov &amp; Thiel 97 (version B) <a class="wikilink citation-wikilink" data-tippy-content="A new gradient-corrected exchange-correlation density functional" data-toggle="popover" href="/theory/bibliography#filatov1997a">[Filatov1997a]</a></li>
<li>116 &rarr;  XC_GGA_X_PBE_SOL  Perdew, Burke &amp; Ernzerhof exchange (solids) <a class="wikilink citation-wikilink" data-tippy-content="Restoring the Density-Gradient Expansion for Exchange in Solids and Surfaces" data-toggle="popover" href="/theory/bibliography#perdew2008">[Perdew2008]</a></li>
<li>117 &rarr;  XC_GGA_X_RPBE  Hammer, Hansen &amp; Norskov (PBE-like) <a class="wikilink citation-wikilink" data-tippy-content="Improved adsorption energetics within density-functional theory using revised Perdew-Burke-Ernzerhof functionals" data-toggle="popover" href="/theory/bibliography#hammer1999">[Hammer1999]</a></li>
<li>118 &rarr;  XC_GGA_X_WC  Wu &amp; Cohen <a class="wikilink citation-wikilink" data-tippy-content="More accurate generalized gradient approximation for solids" data-toggle="popover" href="/theory/bibliography#wu2006">[Wu2006]</a></li>
<li>119 &rarr;  XC_GGA_X_mPW91  Modified form of PW91 by Adamo &amp; Barone <a class="wikilink citation-wikilink" data-tippy-content="Exchange functionals with improved long-range behavior and adiabatic connection methods without adjustable parameters: The m$PW$ and m$PW1PW$ models" data-toggle="popover" href="/theory/bibliography#adamo1998">[Adamo1998]</a></li>
<li>120 &rarr;  XC_GGA_X_AM05  Armiento &amp; Mattsson 05 exchange <a class="wikilink citation-wikilink" data-tippy-content="Functional designed to include surface effects in self-consistent density functional theory" data-toggle="popover" href="/theory/bibliography#armiento2005">[Armiento2005]</a>  <a class="wikilink citation-wikilink" data-tippy-content="The AM05 density functional applied to solids" data-toggle="popover" href="/theory/bibliography#mattsson2008">[Mattsson2008]</a></li>
<li>121 &rarr;  XC_GGA_X_PBEA  Madsen (PBE-like) <a class="wikilink citation-wikilink" data-tippy-content="Functional form of the generalized gradient approximation for exchange: The PBE $\alpha$ functional" data-toggle="popover" href="/theory/bibliography#madsen2007">[Madsen2007]</a></li>
<li>122 &rarr;  XC_GGA_X_MPBE  Adamo &amp; Barone modification to PBE <a class="wikilink citation-wikilink" data-tippy-content="Physically motivated density functionals with improved performances: The modified Perdew--Burke--Ernzerhof model" data-toggle="popover" href="/theory/bibliography#adamo2002">[Adamo2002]</a></li>
<li>123 &rarr;  XC_GGA_X_XPBE  xPBE reparametrization by Xu &amp; Goddard <a class="wikilink citation-wikilink" data-tippy-content="The extended Perdew-Burke-Ernzerhof functional with improved accuracy for thermodynamic and electronic properties of molecular systems" data-toggle="popover" href="/theory/bibliography#xu2004">[Xu2004]</a></li>
<li>125 &rarr;  XC_GGA_X_BAYESIAN  Bayesian best fit for the enhancement factor <a class="wikilink citation-wikilink" data-tippy-content="Bayesian Error Estimation in Density-Functional Theory" data-toggle="popover" href="/theory/bibliography#mortensen2005">[Mortensen2005]</a></li>
<li>126 &rarr;  XC_GGA_X_PBE_JSJR  PBE JSJR reparametrization by Pedroza, Silva &amp; Capelle <a class="wikilink citation-wikilink" data-tippy-content="Gradient-dependent density functionals of the Perdew-Burke-Ernzerhof type for atoms, molecules, and solids" data-toggle="popover" href="/theory/bibliography#pedroza2009">[Pedroza2009]</a></li>
<li>130 &rarr;  XC_GGA_C_PBE  Perdew, Burke &amp; Ernzerhof correlation <a class="wikilink citation-wikilink" data-tippy-content="Generalized Gradient Approximation Made Simple" data-toggle="popover" href="/theory/bibliography#perdew1996">[Perdew1996]</a>  <a class="wikilink citation-wikilink" data-tippy-content="Generalized Gradient Approximation Made Simple [Phys. Rev. Lett. 77, 3865 (1996)]" data-toggle="popover" href="/theory/bibliography#perdew1997">[Perdew1997]</a></li>
<li>131 &rarr;  XC_GGA_C_LYP  Lee, Yang &amp; Parr <a class="wikilink citation-wikilink" data-tippy-content="Development of the Colle-Salvetti correlation-energy formula into a functional of the electron density" data-toggle="popover" href="/theory/bibliography#lee1988">[Lee1988]</a>  <a class="wikilink citation-wikilink" data-tippy-content="Results obtained with the correlation energy density functionals of becke and Lee, Yang and Parr" data-toggle="popover" href="/theory/bibliography#miehlich1989">[Miehlich1989]</a></li>
<li>132 &rarr;  XC_GGA_C_P86  Perdew 86 <a class="wikilink citation-wikilink" data-tippy-content="Density-functional approximation for the correlation energy of the inhomogeneous electron gas" data-toggle="popover" href="/theory/bibliography#perdew1986">[Perdew1986]</a></li>
<li>133 &rarr;  XC_GGA_C_PBE_SOL  Perdew, Burke &amp; Ernzerhof correlation SOL <a class="wikilink citation-wikilink" data-tippy-content="Restoring the Density-Gradient Expansion for Exchange in Solids and Surfaces" data-toggle="popover" href="/theory/bibliography#perdew2008">[Perdew2008]</a></li>
<li>134 &rarr;  XC_GGA_C_PW91  Perdew &amp; Wang 91 <a class="wikilink citation-wikilink" data-tippy-content="Atoms, molecules, solids, and surfaces: Applications of the generalized gradient approximation for exchange and correlation" data-toggle="popover" href="/theory/bibliography#perdew1992">[Perdew1992]</a></li>
<li>135 &rarr;  XC_GGA_C_AM05  Armiento &amp; Mattsson 05 correlation <a class="wikilink citation-wikilink" data-tippy-content="Functional designed to include surface effects in self-consistent density functional theory" data-toggle="popover" href="/theory/bibliography#armiento2005">[Armiento2005]</a>  <a class="wikilink citation-wikilink" data-tippy-content="The AM05 density functional applied to solids" data-toggle="popover" href="/theory/bibliography#mattsson2008">[Mattsson2008]</a></li>
<li>136 &rarr;  XC_GGA_C_XPBE  xPBE reparametrization by Xu &amp; Goddard <a class="wikilink citation-wikilink" data-tippy-content="The extended Perdew-Burke-Ernzerhof functional with improved accuracy for thermodynamic and electronic properties of molecular systems" data-toggle="popover" href="/theory/bibliography#xu2004">[Xu2004]</a></li>
<li>137 &rarr;  XC_GGA_C_LM  Langreth and Mehl correlation <a class="wikilink citation-wikilink" data-tippy-content="Easily Implementable Nonlocal Exchange-Correlation Energy Functional" data-toggle="popover" href="/theory/bibliography#langreth1981">[Langreth1981]</a></li>
<li>138 &rarr;  XC_GGA_C_PBE_JRGX  JRGX reparametrization by Pedroza, Silva &amp; Capelle <a class="wikilink citation-wikilink" data-tippy-content="Gradient-dependent density functionals of the Perdew-Burke-Ernzerhof type for atoms, molecules, and solids" data-toggle="popover" href="/theory/bibliography#pedroza2009">[Pedroza2009]</a></li>
<li>139 &rarr;  XC_GGA_X_OPTB88_VDW  Becke 88 reoptimized to be used with vdW functional of Dion et al <a class="wikilink citation-wikilink" data-tippy-content="Van der Waals density functionals applied to solids" data-toggle="popover" href="/theory/bibliography#klimes2011">[Klimes2011]</a></li>
<li>140 &rarr;  XC_GGA_X_PBEK1_VDW  PBE reparametrization for vdW <a class="wikilink citation-wikilink" data-tippy-content="Van der Waals density functionals applied to solids" data-toggle="popover" href="/theory/bibliography#klimes2011">[Klimes2011]</a></li>
<li>141 &rarr;  XC_GGA_X_OPTPBE_VDW  PBE reparametrization for vdW <a class="wikilink citation-wikilink" data-tippy-content="Van der Waals density functionals applied to solids" data-toggle="popover" href="/theory/bibliography#klimes2011">[Klimes2011]</a></li>
<li>142 &rarr;  XC_GGA_X_RGE2  Regularized PBE <a class="wikilink citation-wikilink" data-tippy-content="Regularized Gradient Expansion for Atoms, Molecules, and Solids" data-toggle="popover" href="/theory/bibliography#ruzsinszky2009">[Ruzsinszky2009]</a></li>
<li>143 &rarr;  XC_GGA_C_RGE2  Regularized PBE <a class="wikilink citation-wikilink" data-tippy-content="Regularized Gradient Expansion for Atoms, Molecules, and Solids" data-toggle="popover" href="/theory/bibliography#ruzsinszky2009">[Ruzsinszky2009]</a></li>
<li>144 &rarr;  XC_GGA_X_RPW86  refitted Perdew &amp; Wang 86 <a class="wikilink citation-wikilink" data-tippy-content="Investigation of Exchange Energy Density Functional Accuracy for Interacting Molecules" data-toggle="popover" href="/theory/bibliography#murray2009">[Murray2009]</a></li>
<li>145 &rarr;  XC_GGA_X_KT1  Keal and Tozer version 1 <a class="wikilink citation-wikilink" data-tippy-content="The exchange-correlation potential in Kohn--Sham nuclear magnetic resonance shielding calculations" data-toggle="popover" href="/theory/bibliography#keal2003">[Keal2003]</a></li>
<li>146 &rarr;  XC_GGA_XC_KT2 Keal and Tozer version 2 <a class="wikilink citation-wikilink" data-tippy-content="The exchange-correlation potential in Kohn--Sham nuclear magnetic resonance shielding calculations" data-toggle="popover" href="/theory/bibliography#keal2003">[Keal2003]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functional gives NaN on IBM (XG20130608).</p>
</div>
<ul>
<li>147 &rarr;  XC_GGA_C_WL  Wilson &amp; Levy <a class="wikilink citation-wikilink" data-tippy-content="Nonlocal Wigner-like correlation-energy density functional through coordinate scaling" data-toggle="popover" href="/theory/bibliography#wilson1990">[Wilson1990]</a></li>
<li>148 &rarr;  XC_GGA_C_WI  Wilson &amp; Ivanov <a class="wikilink citation-wikilink" data-tippy-content="A new Wigner-like correlation-energy functional from coordinate scaling requirements" data-toggle="popover" href="/theory/bibliography#wilson1998">[Wilson1998]</a></li>
<li>149 &rarr;  XC_GGA_X_MB88  Modified Becke 88 for proton transfer <a class="wikilink citation-wikilink" data-tippy-content="Optimized GGA Functional for Proton Transfer Reactions" data-toggle="popover" href="/theory/bibliography#tognetti2009">[Tognetti2009]</a></li>
<li>150 &rarr;  XC_GGA_X_SOGGA  Second-order generalized gradient approximation <a class="wikilink citation-wikilink" data-tippy-content="Construction of a generalized gradient approximation by restoring the density-gradient expansion and enforcing a tight Lieb--Oxford bound" data-toggle="popover" href="/theory/bibliography#zhao2008">[Zhao2008]</a></li>
<li>151 &rarr;  XC_GGA_X_SOGGA11  Second-order generalized gradient approximation 2011 <a class="wikilink citation-wikilink" data-tippy-content="Generalized Gradient Approximation That Recovers the Second-Order Density-Gradient Expansion with Optimized Across-the-Board Performance" data-toggle="popover" href="/theory/bibliography#peverati2011">[Peverati2011]</a></li>
<li>152 &rarr;  XC_GGA_C_SOGGA11  Second-order generalized gradient approximation 2011 <a class="wikilink citation-wikilink" data-tippy-content="Generalized Gradient Approximation That Recovers the Second-Order Density-Gradient Expansion with Optimized Across-the-Board Performance" data-toggle="popover" href="/theory/bibliography#peverati2011">[Peverati2011]</a></li>
<li>153 &rarr;  XC_GGA_C_WI0  Wilson &amp; Ivanov initial version <a class="wikilink citation-wikilink" data-tippy-content="A new Wigner-like correlation-energy functional from coordinate scaling requirements" data-toggle="popover" href="/theory/bibliography#wilson1998">[Wilson1998]</a></li>
<li>154 &rarr;  XC_GGA_XC_TH1  Tozer and Handy v. 1 <a class="wikilink citation-wikilink" data-tippy-content="The development of new exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#tozer1998">[Tozer1998]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functional is not tested. Use at your own risks.</p>
</div>
<ul>
<li>155 &rarr;  XC_GGA_XC_TH2  Tozer and Handy v. 2 <a class="wikilink citation-wikilink" data-tippy-content="Development of New Exchange-Correlation Functionals. 2" data-toggle="popover" href="/theory/bibliography#tozer1998a">[Tozer1998a]</a></li>
<li>156 &rarr;  XC_GGA_XC_TH3  Tozer and Handy v. 3 <a class="wikilink citation-wikilink" data-tippy-content="The development of new exchange-correlation functionals: 3" data-toggle="popover" href="/theory/bibliography#handy1998">[Handy1998]</a></li>
<li>157 &rarr;  XC_GGA_XC_TH4  Tozer and Handy v. 4 <a class="wikilink citation-wikilink" data-tippy-content="The development of new exchange-correlation functionals: 3" data-toggle="popover" href="/theory/bibliography#handy1998">[Handy1998]</a></li>
<li>158 &rarr;  XC_GGA_X_C09X  C09x to be used with the VdW of Rutgers-Chalmers <a class="wikilink citation-wikilink" data-tippy-content="Van der Waals density functional: An appropriate exchange functional" data-toggle="popover" href="/theory/bibliography#cooper2010">[Cooper2010]</a></li>
<li>159 &rarr;  XC_GGA_C_SOGGA11_X  To be used with hyb_gga_x_SOGGA11-X <a class="wikilink citation-wikilink" data-tippy-content="Communication: A global hybrid generalized gradient approximation to the exchange-correlation functional that satisfies the second-order density-gradient constraint and has broad applicability in chemistry" data-toggle="popover" href="/theory/bibliography#peverati2011a">[Peverati2011a]</a></li>
<li>161 &rarr;  XC_GGA_XC_HCTH_93  HCTH functional fitted to 93 molecules <a class="wikilink citation-wikilink" data-tippy-content="Development and assessment of new exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#hamprecht1998">[Hamprecht1998]</a></li>
<li>162 &rarr;  XC_GGA_XC_HCTH_120  HCTH functional fitted to 120 molecules <a class="wikilink citation-wikilink" data-tippy-content="New generalized gradient approximation functionals" data-toggle="popover" href="/theory/bibliography#boese2000">[Boese2000]</a></li>
<li>163 &rarr;  XC_GGA_XC_HCTH_147  HCTH functional fitted to 147 molecules <a class="wikilink citation-wikilink" data-tippy-content="New generalized gradient approximation functionals" data-toggle="popover" href="/theory/bibliography#boese2000">[Boese2000]</a></li>
<li>164 &rarr;  XC_GGA_XC_HCTH_407  HCTH functional fitted to 407 molecules <a class="wikilink citation-wikilink" data-tippy-content="A new parametrization of exchange--correlation generalized gradient approximation functionals" data-toggle="popover" href="/theory/bibliography#boese2001">[Boese2001]</a></li>
<li>165 &rarr;  XC_GGA_XC_EDF1  Empirical functionals from Adamson, Gill, and Pople <a class="wikilink citation-wikilink" data-tippy-content="Empirical density functionals" data-toggle="popover" href="/theory/bibliography#adamson1998">[Adamson1998]</a></li>
<li>166 &rarr;  XC_GGA_XC_XLYP  XLYP functional <a class="wikilink citation-wikilink" data-tippy-content="From The Cover: The X3LYP extended density functional for accurate descriptions of nonbond interactions, spin states, and thermochemical properties" data-toggle="popover" href="/theory/bibliography#xu2004a">[Xu2004a]</a></li>
<li>167 &rarr;  XC_GGA_XC_B97  Becke 97 <a class="wikilink citation-wikilink" data-tippy-content="Density-functional thermochemistry. V. Systematic optimization of exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#becke1997">[Becke1997]</a></li>
<li>168 &rarr;  XC_GGA_XC_B97_1  Becke 97-1 <a class="wikilink citation-wikilink" data-tippy-content="Development and assessment of new exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#hamprecht1998">[Hamprecht1998]</a>  <a class="wikilink citation-wikilink" data-tippy-content="Density-functional thermochemistry. V. Systematic optimization of exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#becke1997">[Becke1997]</a></li>
<li>169 &rarr;  XC_GGA_XC_B97_2  Becke 97-2 <a class="wikilink citation-wikilink" data-tippy-content="Density-functional thermochemistry. V. Systematic optimization of exchange-correlation functionals" data-toggle="popover" href="/theory/bibliography#becke1997">[Becke1997]</a></li>
<li>170 &rarr;  XC_GGA_XC_B97_D  Grimme functional to be used with C6 vdW term <a class="wikilink citation-wikilink" data-tippy-content="Semiempirical GGA-type density functional constructed with a long-range dispersion correction" data-toggle="popover" href="/theory/bibliography#grimme2006">[Grimme2006]</a></li>
<li>171 &rarr;  XC_GGA_XC_B97_K  Boese-Martin for Kinetics <a class="wikilink citation-wikilink" data-tippy-content="Development of density functionals for thermochemical kinetics" data-toggle="popover" href="/theory/bibliography#boese2004">[Boese2004]</a></li>
<li>172 &rarr;  XC_GGA_XC_B97_3  Becke 97-3 <a class="wikilink citation-wikilink" data-tippy-content="Semiempirical hybrid functional with improved performance in an extensive chemical assessment" data-toggle="popover" href="/theory/bibliography#keal2005">[Keal2005]</a></li>
<li>173 &rarr;  XC_GGA_XC_PBE1W  Functionals fitted for water <a class="wikilink citation-wikilink" data-tippy-content="Improved Density Functionals for Water" data-toggle="popover" href="/theory/bibliography#dahlke2005">[Dahlke2005]</a></li>
<li>174 &rarr;  XC_GGA_XC_MPWLYP1W  Functionals fitted for water <a class="wikilink citation-wikilink" data-tippy-content="Improved Density Functionals for Water" data-toggle="popover" href="/theory/bibliography#dahlke2005">[Dahlke2005]</a></li>
<li>175 &rarr;  XC_GGA_XC_PBELYP1W  Functionals fitted for water <a class="wikilink citation-wikilink" data-tippy-content="Improved Density Functionals for Water" data-toggle="popover" href="/theory/bibliography#dahlke2005">[Dahlke2005]</a></li>
<li>176 &rarr;  XC_GGA_XC_SB98_1a  Schmider-Becke 98 parameterization 1a <a class="wikilink citation-wikilink" data-tippy-content="Optimized density functionals from the extended G2 test set" data-toggle="popover" href="/theory/bibliography#schmider1998">[Schmider1998]</a></li>
<li>177 &rarr;  XC_GGA_XC_SB98_1b  Schmider-Becke 98 parameterization 1b <a class="wikilink citation-wikilink" data-tippy-content="Optimized density functionals from the extended G2 test set" data-toggle="popover" href="/theory/bibliography#schmider1998">[Schmider1998]</a></li>
<li>178 &rarr;  XC_GGA_XC_SB98_1c  Schmider-Becke 98 parameterization 1c <a class="wikilink citation-wikilink" data-tippy-content="Optimized density functionals from the extended G2 test set" data-toggle="popover" href="/theory/bibliography#schmider1998">[Schmider1998]</a></li>
<li>179 &rarr;  XC_GGA_XC_SB98_2a  Schmider-Becke 98 parameterization 2a <a class="wikilink citation-wikilink" data-tippy-content="Optimized density functionals from the extended G2 test set" data-toggle="popover" href="/theory/bibliography#schmider1998">[Schmider1998]</a></li>
<li>180 &rarr;  XC_GGA_XC_SB98_2b  Schmider-Becke 98 parameterization 2b <a class="wikilink citation-wikilink" data-tippy-content="Optimized density functionals from the extended G2 test set" data-toggle="popover" href="/theory/bibliography#schmider1998">[Schmider1998]</a></li>
<li>181 &rarr;  XC_GGA_XC_SB98_2c  Schmider-Becke 98 parameterization 2c <a class="wikilink citation-wikilink" data-tippy-content="Optimized density functionals from the extended G2 test set" data-toggle="popover" href="/theory/bibliography#schmider1998">[Schmider1998]</a></li>
<li>183 &rarr;  XC_GGA_X_OL2  Exchange form based on Ou-Yang and Levy v.2 <a class="wikilink citation-wikilink" data-tippy-content="Further evidence of the conjoint correction to the local kinetic and exchange energy density functionals" data-toggle="popover" href="/theory/bibliography#fuentealba1995">[Fuentealba1995]</a>  <a class="wikilink citation-wikilink" data-tippy-content="Approximate noninteracting kinetic energy functionals from a nonuniform scaling requirement" data-toggle="popover" href="/theory/bibliography#ouyang1991">[OuYang1991]</a></li>
<li>184 &rarr;  XC_GGA_X_APBE  mu fixed from the semiclassical neutral atom <a class="wikilink citation-wikilink" data-tippy-content="Semiclassical Neutral Atom as a Reference System in Density Functional Theory" data-toggle="popover" href="/theory/bibliography#constantin2011">[Constantin2011]</a></li>
<li>186 &rarr;  XC_GGA_C_APBE  mu fixed from the semiclassical neutral atom <a class="wikilink citation-wikilink" data-tippy-content="Semiclassical Neutral Atom as a Reference System in Density Functional Theory" data-toggle="popover" href="/theory/bibliography#constantin2011">[Constantin2011]</a></li>
<li>191 &rarr;  XC_GGA_X_HTBS  Haas, Tran, Blaha, and Schwarz <a class="wikilink citation-wikilink" data-tippy-content="Construction of an optimal GGA functional for molecules and solids" data-toggle="popover" href="/theory/bibliography#haas2011">[Haas2011]</a></li>
<li>192 &rarr;  XC_GGA_X_AIRY  Constantin et al based on the Airy gas <a class="wikilink citation-wikilink" data-tippy-content="Exchange-correlation energy functional based on the Airy-gas reference system" data-toggle="popover" href="/theory/bibliography#constantin2009">[Constantin2009]</a></li>
<li>193 &rarr;  XC_GGA_X_LAG  Local Airy Gas <a class="wikilink citation-wikilink" data-tippy-content="Exchange energy in the local Airy gas approximation" data-toggle="popover" href="/theory/bibliography#vitos2000">[Vitos2000]</a></li>
<li>194 &rarr;  XC_GGA_XC_MOHLYP  Functional for organometallic chemistry <a class="wikilink citation-wikilink" data-tippy-content="Density Functionals for Inorganometallic and Organometallic Chemistry" data-toggle="popover" href="/theory/bibliography#schultz2005">[Schultz2005]</a></li>
<li>195 &rarr;  XC_GGA_XC_MOHLYP2  Functional for barrier heights <a class="wikilink citation-wikilink" data-tippy-content="The DBH24/08 Database and Its Use to Assess Electronic Structure Model Chemistries for Chemical Reaction Barrier Heights" data-toggle="popover" href="/theory/bibliography#zheng2009">[Zheng2009]</a></li>
<li>196 &rarr;  XC_GGA_XC_TH_FL  Tozer and Handy v. FL <a class="wikilink citation-wikilink" data-tippy-content="Exchange-correlation functionals from ab initio electron densities" data-toggle="popover" href="/theory/bibliography#tozer1997">[Tozer1997]</a></li>
<li>197 &rarr;  XC_GGA_XC_TH_FC  Tozer and Handy v. FC <a class="wikilink citation-wikilink" data-tippy-content="Exchange-correlation functionals from ab initio electron densities" data-toggle="popover" href="/theory/bibliography#tozer1997">[Tozer1997]</a></li>
<li>198 &rarr;  XC_GGA_XC_TH_FCFO  Tozer and Handy v. FCFO <a class="wikilink citation-wikilink" data-tippy-content="Exchange-correlation functionals from ab initio electron densities" data-toggle="popover" href="/theory/bibliography#tozer1997">[Tozer1997]</a></li>
<li>199 &rarr;  XC_GGA_XC_TH_FCO  Tozer and Handy v. FCO <a class="wikilink citation-wikilink" data-tippy-content="Exchange-correlation functionals from ab initio electron densities" data-toggle="popover" href="/theory/bibliography#tozer1997">[Tozer1997]</a></li>
<li>200 &rarr;  XC_GGA_C_OPTC  Optimized correlation functional of Cohen and Handy <a class="wikilink citation-wikilink" data-tippy-content="Dynamic correlation" data-toggle="popover" href="/theory/bibliography#cohen2001">[Cohen2001]</a></li>
<li>(for MetaGGA and Hybrid functionals, with indices in the 200-499 range, see the later sections)</li>
<li>524 &rarr;  XC_GGA_X_WPBEH  short-range version of the PBE <a class="wikilink citation-wikilink" data-tippy-content="Hybrid functionals based on a screened Coulomb potential" data-toggle="popover" href="/theory/bibliography#heyd2003">[Heyd2003]</a></li>
<li>525 &rarr;  XC_GGA_X_HJS_PBE  HJS screened exchange PBE version <a class="wikilink citation-wikilink" data-tippy-content="Generalized gradient approximation model exchange holes for range-separated hybrids" data-toggle="popover" href="/theory/bibliography#henderson2008">[Henderson2008]</a></li>
<li>526 &rarr;  XC_GGA_X_HJS_PBE_SOL  HJS screened exchange PBE_SOL version <a class="wikilink citation-wikilink" data-tippy-content="Generalized gradient approximation model exchange holes for range-separated hybrids" data-toggle="popover" href="/theory/bibliography#henderson2008">[Henderson2008]</a></li>
<li>527 &rarr;  XC_GGA_X_HJS_B88  HJS screened exchange B88 version <a class="wikilink citation-wikilink" data-tippy-content="Generalized gradient approximation model exchange holes for range-separated hybrids" data-toggle="popover" href="/theory/bibliography#henderson2008">[Henderson2008]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functional is not tested. Use at your own risks.</p>
</div>
<ul>
<li>528 &rarr;  XC_GGA_X_HJS_B97X  HJS screened exchange B97x version <a class="wikilink citation-wikilink" data-tippy-content="Generalized gradient approximation model exchange holes for range-separated hybrids" data-toggle="popover" href="/theory/bibliography#henderson2008">[Henderson2008]</a></li>
<li>529 &rarr;  XC_GGA_X_ITYH  short-range recipe for exchange GGA functionals <a class="wikilink citation-wikilink" data-tippy-content="A long-range correction scheme for generalized-gradient-approximation exchange functionals" data-toggle="popover" href="/theory/bibliography#iikura2001">[Iikura2001]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functional is not tested. Use at your own risks.</p>
</div>
<p><mark>MetaGGA functionals</mark> (do not forget to add a minus sign, as discussed above).
See <a class="wikilink citation-wikilink" data-tippy-content="Self-consistent meta-generalized gradient approximation within the projector-augmented-wave method" data-toggle="popover" href="/theory/bibliography#sun2011">[Sun2011]</a> for the formulas.</p>
<ul>
<li>202 &rarr;  XC_MGGA_X_TPSS  Tao, Perdew, Staroverov &amp; Scuseria <a class="wikilink citation-wikilink" data-tippy-content="Climbing the Density Functional Ladder: Nonempirical Meta--Generalized Gradient Approximation Designed for Molecules and Solids" data-toggle="popover" href="/theory/bibliography#tao2003">[Tao2003]</a>  <a class="wikilink citation-wikilink" data-tippy-content="Meta-generalized gradient approximation: Explanation of a realistic nonempirical density functional" data-toggle="popover" href="/theory/bibliography#perdew2004">[Perdew2004]</a></li>
<li>203 &rarr;  XC_MGGA_X_M06L  Zhao, Truhlar exchange <a class="wikilink citation-wikilink" data-tippy-content="A new local density functional for main-group thermochemistry, transition metal bonding, thermochemical kinetics, and noncovalent interactions" data-toggle="popover" href="/theory/bibliography#zhao2006">[Zhao2006]</a>  <a class="wikilink citation-wikilink" data-tippy-content="The M06 suite of density functionals for main group thermochemistry, thermochemical kinetics, noncovalent interactions, excited states, and transition elements: Two new functionals and systematic testing of four M06-class functionals and 12 other functionals" data-toggle="popover" href="/theory/bibliography#zhao2007">[Zhao2007]</a></li>
<li>204 &rarr;  XC_MGGA_X_GVT4  GVT4 (X part of VSXC) from van Voorhis and Scuseria <a class="wikilink citation-wikilink" data-tippy-content="A novel form for the exchange-correlation energy functional" data-toggle="popover" href="/theory/bibliography#voorhis1998">[Voorhis1998]</a></li>
<li>205 &rarr;  XC_MGGA_X_TAU_HCTH  tau-HCTH from Boese and Handy <a class="wikilink citation-wikilink" data-tippy-content="New exchange-correlation density functionals: The role of the kinetic-energy density" data-toggle="popover" href="/theory/bibliography#boese2002">[Boese2002]</a></li>
<li>207 &rarr;  XC_MGGA_X_BJ06  Becke &amp; Johnson correction to Becke-Roussel 89 <a class="wikilink citation-wikilink" data-tippy-content="A simple effective potential for exchange" data-toggle="popover" href="/theory/bibliography#becke2006">[Becke2006]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92 <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a>, hence  <strong>ixc</strong> =-12208 ..</p>
</div>
<ul>
<li>208 &rarr;  XC_MGGA_X_TB09  Tran-blaha - correction to Becke &amp; Johnson correction to Becke-Roussel 89 <a class="wikilink citation-wikilink" data-tippy-content="Accurate Band Gaps of Semiconductors and Insulators with a Semilocal Exchange-Correlation Potential" data-toggle="popover" href="/theory/bibliography#tran2009">[Tran2009]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92 <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a>.</p>
</div>
<ul>
<li>209 &rarr;  XC_MGGA_X_RPP09  Rasanen, Pittalis, and Proetto correction to Becke &amp; Johnson <a class="wikilink citation-wikilink" data-tippy-content="Universal correction for the Becke--Johnson exchange potential" data-toggle="popover" href="/theory/bibliography#rasanen2010">[Rasanen2010]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92 <a class="wikilink citation-wikilink" data-tippy-content="Accurate and simple analytic representation of the electron-gas correlation energy" data-toggle="popover" href="/theory/bibliography#perdew1992a">[Perdew1992a]</a>.</p>
</div>
<ul>
<li>232 &rarr;  XC_MGGA_C_VSXC  VSxc from Van Voorhis and Scuseria (correlation part) <a class="wikilink citation-wikilink" data-tippy-content="A novel form for the exchange-correlation energy functional" data-toggle="popover" href="/theory/bibliography#voorhis1998">[Voorhis1998]</a></li>
</ul>
<p><mark>Hybrid functionals</mark> (do not forget to add a minus sign, as discussed above).</p>
<ul>
<li>402 &rarr;  XC_HYB_GGA_XC_B3LYP  The (in)famous B3LYP <a class="wikilink citation-wikilink" data-tippy-content="Ab Initio Calculation of Vibrational Absorption and Circular Dichroism Spectra Using Density Functional Force Fields" data-toggle="popover" href="/theory/bibliography#stephens1994">[Stephens1994]</a></li>
<li>406 &rarr;  XC_HYB_GGA_XC_PBEH  PBEH (PBE0) <a class="wikilink citation-wikilink" data-tippy-content="Toward reliable density functional methods without adjustable parameters: The PBE0 model" data-toggle="popover" href="/theory/bibliography#adamo1999">[Adamo1999]</a>  <a class="wikilink citation-wikilink" data-tippy-content="Assessment of the Perdew--Burke--Ernzerhof exchange-correlation functional" data-toggle="popover" href="/theory/bibliography#ernzerhof1999">[Ernzerhof1999]</a></li>
<li>427 &rarr;  XC_HYB_GGA_XC_HSE03  The 2003 version of the screened hybrid HSE
                                  (this case corresponds to <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_fock">hyb_range_fock</a>=<span><span class="MathJax_Preview">\omega^{HF} = 0.15/\sqrt{2}</span><script type="math/tex">\omega^{HF} = 0.15/\sqrt{2}</script></span>
                                  and <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_dft">hyb_range_dft</a>=<span><span class="MathJax_Preview">\omega^{PBE} = 0.15*(2.0)^{1/3}</span><script type="math/tex">\omega^{PBE} = 0.15*(2.0)^{1/3}</script></span> )</li>
<li>428 &rarr;  XC_HYB_GGA_XC_HSE06  The 2006 version of the screened hybrid HSE
                                  (this case corresponds to <a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_fock">hyb_range_fock</a>=<a class="wikilink codevar-wikilink" href="/variables/gstate#hyb_range_dft">hyb_range_dft</a>=<span><span class="MathJax_Preview">\omega^{HF} = \omega^{PBE} = 0.11</span><script type="math/tex">\omega^{HF} = \omega^{PBE} = 0.11</script></span>)
                                  <a class="wikilink citation-wikilink" data-tippy-content="Hybrid functionals based on a screened Coulomb potential" data-toggle="popover" href="/theory/bibliography#heyd2003">[Heyd2003]</a> <a class="wikilink citation-wikilink" data-tippy-content="Erratum: hybrid functionals based on a screened Coulomb potential - J. Chem. Phys. 118, 8207 (2003)" data-toggle="popover" href="/theory/bibliography#heyd2006">[Heyd2006]</a> <a class="wikilink citation-wikilink" data-tippy-content="Influence of the exchange screening parameter on the performance of screened hybrid functionals" data-toggle="popover" href="/theory/bibliography#krukau2006">[Krukau2006]</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>(The following section is taken from the LibXC sources. In ABINIT, we stick to the LibXC choice.)</p>
<p>Note that there is an enormous mess in the literature
concerning the values of omega in HSE. This is due to an error in the original
paper that stated that they had used <span><span class="MathJax_Preview">\omega=0.15</span><script type="math/tex">\omega=0.15</script></span>. This was in fact not true,
and the real value used was <span><span class="MathJax_Preview">\omega^{HF} = 0.15 / \sqrt{2} \sim 0.1061</span><script type="math/tex">\omega^{HF} = 0.15 / \sqrt{2} \sim 0.1061</script></span>
and <span><span class="MathJax_Preview">\omega^{PBE} = 0.15 * (2.0)^{1/3} \sim 0.1890</span><script type="math/tex">\omega^{PBE} = 0.15 * (2.0)^{1/3} \sim 0.1890</script></span>.</p>
<p>In 2006 Krukau et al <a class="wikilink citation-wikilink" data-tippy-content="Influence of the exchange screening parameter on the performance of screened hybrid functionals" data-toggle="popover" href="/theory/bibliography#krukau2006">[Krukau2006]</a> tried
to clarify the situation, called HSE03 the above choice of parameters,
and called HSE06 to the functional where <span><span class="MathJax_Preview">\omega^{HF}=\omega^{PBE}</span><script type="math/tex">\omega^{HF}=\omega^{PBE}</script></span>. By testing
several properties for atoms they reached the conclusion that the best value
for <span><span class="MathJax_Preview">\omega=0.11</span><script type="math/tex">\omega=0.11</script></span>. Of course, codes are just as messy as the papers. In Quantum Espresso
HSE06 has the value <span><span class="MathJax_Preview">\omega=0.106.</span><script type="math/tex">\omega=0.106.</script></span> VASP, on the other hand, uses for HSE03 the
same value <span><span class="MathJax_Preview">\omega^{HF} = \omega^{PBE} = 0.3 (A^{-1}) \sim 0.1587</span><script type="math/tex">\omega^{HF} = \omega^{PBE} = 0.3 (A^{-1}) \sim 0.1587</script></span>,
and for HSE06 <span><span class="MathJax_Preview">\omega^{HF} = \omega^{PBE} = 0.2 (A^{-1}) \sim 0.1058</span><script type="math/tex">\omega^{HF} = \omega^{PBE} = 0.2 (A^{-1}) \sim 0.1058</script></span>.</p>
</div>
<ul>
<li>456 &rarr;  XC_HYB_GGA_XC_PBE0_13  PBE0-&#8531; <a class="wikilink citation-wikilink" data-tippy-content="Note: Theoretical mixing coefficients for hybrid functionals" data-toggle="popover" href="/theory/bibliography#cortona2012">[Cortona2012]</a></li>
</ul>
<h2 id="jdtset"><strong>jdtset</strong><a class="headerlink" href="#jdtset" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> index -J- for DaTaSETs<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a multi dataset calculation" data-toggle="popover" href="/topics/multidtset">topic_multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ndtset">ndtset</a>)<br />
<em>Default value:</em> [ {&lsquo;start&rsquo;: 1, &lsquo;stop&rsquo;: &lsquo;<a class="wikilink codevar-wikilink" href="/variables/basic#ndtset">ndtset</a>&rsquo;}; -&gt;<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [134/1245] in all abinit tests, [8/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock with time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock without time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Test functionals from libXC that have been added in ABINITv6 or were untested in ABINITv5 (LDAs and GGAs).
This is to check the portability for different platform.
Extremely quick (nstep=1, nline=1). Less than 10 secs to test 2 functionals ..." data-toggle="popover" href="/tests/libxc/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Test functionals from libXC that have been added in ABINITv6 or were untested in ABINITv5 (LDAs and GGAs).
Spin-polarized case.
This is to check the portability for different platform.
Extremely quick (nstep=1, nline=1). Less than 2 secs to test 10 functionals ..." data-toggle="popover" href="/tests/libxc/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, rhombohedral.
Test finite electric field
Check the corectness of the symmetry operations with non-zero tnons." data-toggle="popover" href="/tests/seq/Input/tsv4_55.abi" target="_blank">tsv4_55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Finite electric field calculation
In order to perform a first-principles calculation in an electric
field, the wavefunctions must be initialized properly. Therefore,
I do first a GS calculation to obtain the WF in the whole BZ under
zero electric field. Then, I increase the electric field slowly in
successive datasets. The calculation for each dataset is initialized
using the WF of a previous one.
I consider both positive and negative electric fields.
WARNING : HAS BEEN TRANSFERRED TO tests/seq" data-toggle="popover" href="/tests/seq/Input/tsv4_78.abi" target="_blank">tsv4_78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CrystallIne AlAs
first three runs are for calculation of ground state at finite electric field
the fourth run gets the gs wavefunction and then do response calculation
the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-toggle="popover" href="/tests/seq/Input/tsv4_80.abi" target="_blank">tsv4_80.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_1.abi" target="_blank">tucalc_crpa_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Finite difference calculation of the Born effective charges of AlP" data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_1.abi" target="_blank">tpolarization_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Finite electric field calculation of AlP at clamped atomic positions" data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_6.abi" target="_blank">tpolarization_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Structural optimisation" data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_1.abi" target="_blank">tnlo_1.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test multi-dataset mode. Si diamond.
2 datasets, with index 2 and 57 (!). No advanced features like get variables.
Rather fast." data-toggle="popover" href="/tests/v1/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test multi-dataset mode. Al metal, 10 k points.
Start from the output wfs of the previous dataset. Compute tsmear=0.01.
Test the idea of using one input file for different runs.
The input file is the same as for test 63, except for the addition of one dataset." data-toggle="popover" href="/tests/v1/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H atom, similar to test 87, except that the box is not cubic,
but only parallelipipedic (not even a rectangle parallelipiped).
However, the primitive vectors describe the same lattice as
in case 87, so that the results must be identical
to those of test 87, even if a different FFT grid is used.
That is what is observed." data-toggle="popover" href="/tests/v1/Input/t88.abi" target="_blank">t88.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 28. The chosen grid (too coarse, though) is
(0 0 0), (1/4 1/4 0), (1/2 1/2 0), (1/2 0 0),
(1/2 1/4 1/4), (1/2 -1/4 1/4)  (in reduced coordinates).
The ecut and nkpt parameters are really too low (see test 28),
but parameters suitable for physical results (see test 29)
are also provided in the input files." data-toggle="popover" href="/tests/v2/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth, treated as a metal, with 2 special points
Test the effect of spin-orbit coupling, especially the forces.
The dataset 1 to 3 are related to the nspinor=1 case. The forces
are computed from finite differences of energy :
abs(etotal3-etotal1)=0.00090461 Ha
abs(xcart3-xcart1)=0.089970092 (taking into account both atoms)
Their ratio is 0.01005456 Ha/Bohr, to be compared with
fcart2=1.0049850156E-02 Ha/Bohr
The dataset 4 checks the case nspinor=2, pspso=1 (no spin-orbit yet)
The dataset 5 to 7 try to reproduce the comparison of forces
with spin-orbit :
abs(etotal7-etotal5)=0.000445155 Ha
abs(xcart7-xcart5)=0.089970092 (taking into account both atoms)
Their ratio is 3.83633E-03 Ha/Bohr ...
A better finite-difference scheme incorporating also data from
half-displacement, lead to 3.81832E-03 Ha/Bohr.
This is in excellent agreement with
fcart6=3.8183150850E-03 Ha/Bohr" data-toggle="popover" href="/tests/v2/Input/t75.abi" target="_blank">t75.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 diatomic molecule. Spin-polarized (ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=1 (Teter LSDA)
From dataset 2 and 3, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 10.88934274 Ha, while the direct computation,
in dataset 4 gives 10.88933963 Ha .

Cannot be executed in parallel

chkinp: Checking input parameters for consistency, jdtset= 3.

--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number :
1 The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential version
of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v3/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with spin-orbit. Should give the same answer
than test 2, except that the k point grid is now
defined automatically.
Dataset 8 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
Warning : the output file of this test
is machine-dependent, although the final
result is not. This is because the
degeneracy of the GS wavefunctions with
different spin orientation has not been broken." data-toggle="popover" href="/tests/v3/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs (zinc-blende structure).
Compute different response functions, then
perform a computation of 3rd derivative of total energy.
(to be described in more detail)" data-toggle="popover" href="/tests/v3/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Code abinit (gstate+respfn+nonlinear)
Generate the linear and non-linear coefficients, in two DDBs,
to be merged and analysed in the tests 53 and 54." data-toggle="popover" href="/tests/v4/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure
Compute the polarization along strings
of k-points parallel to the primitive vectors of the reciprocal
lattice. The Berry phase calculations are performed
in three different datasets. For each datatset, ABINIT writes
the polarization in reduced coordinates to a DDB." data-toggle="popover" href="/tests/v4/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure (Test of Na Sai&#x27;s technique)
To compute the polarization, the finite
difference expression of the ddk and the second-order
energy derivatives." data-toggle="popover" href="/tests/v4/Input/t75.abi" target="_blank">t75.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbFCl in the matlockite structure P4/nmm. 6 atoms per cell.
Compute a set of matrix elements of the dynamical matrix,
for q wavevector 0.5 0.5 0.5 .
In this test case, the symmetry operations have an important
non-symmorphic character. There was a bug in the treatment
of this material, prior to v5.2.4 ." data-toggle="popover" href="/tests/v5/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline rhombohedral Antimonium. CP2K PBE pseudopotential.
Optimization of the atomic positions with ionmov 2. In the input file
several datasets are defined but actually only one of them is chosen for
the calculation. The provided xred (one for each dataset) are already the
equilibrium position, so the calculation should use only one optimization
step per dataset." data-toggle="popover" href="/tests/v5/Input/t55.abi" target="_blank">t55.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of berrystep
Al-As cristal, zinc-blende structure
Compute the polarization along strings
of k-points parallel to the primitive vectors of the reciprocal
lattice, and using multiple step berry phase calculation.
(Tests 21-30 are related to geometry optimization, molecular dynamics, etc)

Cannot be executed in parallel:
chkint_prt: ERROR -
Context : the value of the variable nproc is 2.
The value of the input variable berrystep is 5, while it must be
equal to 1" data-toggle="popover" href="/tests/v6/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield tutorial.)
Cannot be executed with more than 1 MPI node." data-toggle="popover" href="/tests/v6/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-toggle="popover" href="/tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test new integration method and grid options for the integral
along the imaginary axis in contour deformation calculations." data-toggle="popover" href="/tests/v67mbpt/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: GW band gap with vertex corrections in W; Gygi-Baldereschi aux function" data-toggle="popover" href="/tests/v67mbpt/Input/t36.abi" target="_blank">t36.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/v8/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk=1)." data-toggle="popover" href="/tests/v9/Input/t206.abi" target="_blank">t206.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Same as t206 but with nspinor=2. Compare chebfi2 with respect to other algorithms." data-toggle="popover" href="/tests/v9/Input/t207.abi" target="_blank">t207.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the dataset index of each of the datasets. This index will be used:</p>
<ul>
<li>to determine which input variables are specific to each dataset, since the variable names for this dataset will be made from the bare variable name concatenated with this index, and only if such a composite variable name does not exist, the code will consider the bare variable name, or even, the Default;</li>
<li>to characterize output variable names, if their content differs from dataset to dataset;</li>
<li>to characterize output files ( root names appended with _DSx where &lsquo;x&rsquo; is the dataset index ).</li>
</ul>
<p>The allowed index values are between 1 and 9999.
An input variable name appended with 0 is not allowed.
When <a class="wikilink codevar-wikilink" href="/variables/basic#ndtset">ndtset</a> == 0, this array is not used, and moreover, no input variable
name appended with a digit is allowed. This array might be initialized thanks
to the use of the input variable <a class="wikilink codevar-wikilink" href="/variables/basic#udtset">udtset</a>. In this case,  <strong>jdtset</strong>  cannot be used.</p>
<h2 id="kpt"><strong>kpt</strong><a class="headerlink" href="#kpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K - PoinTs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Comment:</em> Adequate for one molecule in a supercell<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1235/1245] in all abinit tests, [159/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Contains the k points in terms of reciprocal space primitive translations (NOT
in cartesian coordinates!).
Needed ONLY if <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 0, otherwise deduced from other input variables.</p>
<p>It contains dimensionless numbers in terms of which the cartesian coordinates
would be:
k_cartesian = k1*G1+k2*G2+k3*G3
where  (k1,k2,k3)  represent the dimensionless &ldquo;reduced coordinates&rdquo; and  G1,
G2, G3  are the cartesian coordinates of the primitive translation vectors.
G1,G2,G3 are related to the choice of direct space primitive translation
vectors made in <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>. Note that an overall norm for the k points is
supplied by <a class="wikilink codevar-wikilink" href="/variables/basic#kptnrm">kptnrm</a>. This allows one to avoid supplying many digits for the
k points to represent such points as (1,1,1)/3.
Note: one of the algorithms used to set up the sphere of G vectors for the
basis needs components of k-points in the range [-1,1], so the remapping is
easily done by adding or subtracting 1 from each component until it is in the
range [-1,1]. That is, given the k point normalization <a class="wikilink codevar-wikilink" href="/variables/basic#kptnrm">kptnrm</a> described
below, each component must lie in [ -<a class="wikilink codevar-wikilink" href="/variables/basic#kptnrm">kptnrm</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#kptnrm">kptnrm</a> ].
Note: a global shift can be provided by <a class="wikilink codevar-wikilink" href="/variables/internal#qptn">%qptn</a>
Not read if <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>/=0.</p>
<h2 id="kptnrm"><strong>kptnrm</strong><a class="headerlink" href="#kptnrm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K - PoinTs NoRMalization<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [107/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as 03 but run with newer Troullier-Martins psp
with core density PseudosTM_pwteter/14si.pspnc.  Start from wf.03 and run irdwfk=1.
Also iterated to convergence." data-toggle="popover" href="/tests/fast/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Restart 05 with wf.05 (irdwfk=1).  Instant convergence." data-toggle="popover" href="/tests/fast/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Oxygen atom
Test a few functionals for which HGH pseudopotentials are available (from M. Krack),
that are present also in the lib XC, but not in the native ABINIT set of functionals." data-toggle="popover" href="/tests/libxc/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : print the pwfn.data file,
for use in a subsequent run of the CASINO code." data-toggle="popover" href="/tests/seq/Input/tsv4_90.abi" target="_blank">tsv4_90.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgO FCC crystal, with very low cut-off, and 32 k points.
Pseudopotentials WITHOUT a non-linear core correction.
Compute the dynamical matrices at q(0.25 0.5 0.498) and q(0.25 0.5 0.5).
The results should be very close to each other, but were not in pre v2.1
versions, because the symmetry was not treated correctly for the
highest-symmetry q vector q(0.25 0.5 0.5) (test case found by PTepesch)." data-toggle="popover" href="/tests/v2/Input/t37.abi" target="_blank">t37.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
(HeH)+ in a big box. Computation of excitation energies in TDDFT,
in the following approximations : TDxOEP/xOEP, TDLDA/xOEP,
BPG hybrid/xOEP." data-toggle="popover" href="/tests/v2/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Output the SCF density, then partial densities that
correspond to the 1st, 2nd, 3rd and 4th valence bands,
then the density that corresponds to the 1st conduction band,
then the density of the lowest conduction state at 1/4 1/4 1/4, then
the density of the highest valence state at 0 0 0 .
Also test the symmetry finder." data-toggle="popover" href="/tests/v2/Input/t47.abi" target="_blank">t47.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Same as test v1 #1, except use different energy and length units.
Test the use of dimensional input variables." data-toggle="popover" href="/tests/v3/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
(HeH)+ in a big box. Computation of oscillator strengths,
in the TDxOEP/xOEP approximation. Use a different geometry
than in test 42 of test/v2.
The Thomas-Reiche-Kuhn sum rule (sum of oscillator strengths
should be the number of electrons, that is, two in this case)
should be valid, since
we are using local pseudopotentials. However, the number
of bands needed to get it is huge :
nbands     sum rule
20         1.34   (present case)
30         1.45
40         1.61
60         1.68
80         1.74
100        1.77
120        1.82
160        1.88
200        1.90
240        1.92" data-toggle="popover" href="/tests/v3/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Make a simple geometry relaxation and validate the XML output (testing prtxml)." data-toggle="popover" href="/tests/v5/Input/t79.abi" target="_blank">t79.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with and without PAW XML data (FJollet)" data-toggle="popover" href="/tests/v7/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for PWPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t61.abi" target="_blank">t61.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for GPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Simple input (from fast/t03) to test nblock_lobpcg variable" data-toggle="popover" href="/tests/v9/Input/t205.abi" target="_blank">t205.abi</a> &hellip;</li>
</ul>
</details>
<p>Establishes a normalizing denominator for each k point. Needed only if
<a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>&lt;=0, otherwise deduced from other input variables.
The k point coordinates as fractions of reciprocal lattice translations are
therefore <a class="wikilink codevar-wikilink" href="/variables/basic#kpt">kpt</a>(mu,ikpt)/ <strong>kptnrm</strong> .  <strong>kptnrm</strong>  defaults to 1 and can be
ignored by the user. It is introduced to avoid the need for many digits in
representing numbers such as &#8531;. It cannot be smaller than 1.0</p>
<h2 id="kptopt"><strong>kptopt</strong><a class="headerlink" href="#kptopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> KPoinTs OPTion<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generate the electronic band structure related topics" data-toggle="popover" href="/topics/ElecBandStructure">topic_ElecBandStructure</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 4 if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> == 4,
1 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1021/1245] in all abinit tests, [100/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Controls the set up of the k-points list. The aim will be to initialize, by
straight reading or by a preprocessing approach based on other input
variables, the following input variables, giving the k points, their number,
and their weight: <a class="wikilink codevar-wikilink" href="/variables/basic#kpt">kpt</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#kptnrm">kptnrm</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>, and, for <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>/=-2, <a class="wikilink codevar-wikilink" href="/variables/basic#wtk">wtk</a>.</p>
<p>Often, the k points will form a lattice in reciprocal space. In this case, one
will also aim at initializing input variables that give the reciprocal of this
k-point lattice, as well as its shift with respect to the origin: <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> or
<a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>, as well as on <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>.</p>
<p>A global additional shift can be provided by <a class="wikilink codevar-wikilink" href="/variables/internal#qptn">%qptn</a></p>
<p>The use of symmetries (spatial and/or time-reversal) is crucial to determine the action of  <strong>kptopt</strong> .</p>
<ul>
<li>0 &rarr; read directly <a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#kpt">kpt</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#kptnrm">kptnrm</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#wtk">wtk</a>.</li>
<li>
<p>1 &rarr; rely on <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>, as well as on <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> to set up the k points.
    Take fully into account the symmetry to generate the k points in the Irreducible Brillouin Zone only,
    with the appropriate weights. (This is the usual mode for GS calculations)</p>
</li>
<li>
<p>2 &rarr; rely on <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>, as well as on <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> to set up the k points.
    Take into account only the time-reversal symmetry: k points will be generated in half the Brillouin zone,
    with the appropriate weights.
    (This is the usual mode when preparing or executing a RF calculation at q=(0 0 0) without non-collinear magnetism)</p>
</li>
<li>
<p>3 &rarr; rely on <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>, as well as on <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> to set up the k points.
    Do not take into account any symmetry: k points will be generated in the full Brillouin zone, with the appropriate weights.
    (This is the usual mode when preparing or executing a RF calculation at non-zero q, or with non-collinear magnetism)</p>
</li>
<li>
<p>4 &rarr; rely on <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>, as well as on <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> to set up the k points.
   Take into account all the symmetries EXCEPT the time-reversal symmetry to generate the k points
   in the Irreducible Brillouin Zone, with the appropriate weights.
   This has to be used when performing calculations with non-collinear magnetism allowed (<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 4)</p>
</li>
<li>
<p>A negative value  &rarr; rely on <a class="wikilink codevar-wikilink" href="/variables/gstate#kptbounds">kptbounds</a>, and <a class="wikilink codevar-wikilink" href="/variables/gstate#ndivsm">ndivsm</a> (or <a class="wikilink codevar-wikilink" href="/variables/gstate#ndivk">ndivk</a>) to set up a band structure calculation
    along different lines (allowed only for <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> == -2). The absolute value of  <strong>kptopt</strong>  gives
    the number of segments of the band structure. Weights are usually irrelevant with this option,
    and will be left to their default value.</p>
</li>
</ul>
<p>In the case of a grid of k points, the auxiliary variables <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlen">kptrlen</a>,
<a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> and <a class="wikilink codevar-wikilink" href="/variables/files#prtkpt">prtkpt</a> might help you to select the optimal grid.</p>
<h2 id="natom"><strong>natom</strong><a class="headerlink" href="#natom" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of ATOMs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to use the symetry information to build the system from the irreducible part of the primitive cell" data-toggle="popover" href="/topics/SmartSymm">topic_SmartSymm</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1220/1245] in all abinit tests, [147/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the total number of atoms in the unit cell. Default is 1 but you will
obviously want to input this value explicitly.
Note that  <strong>natom</strong>  refers to all atoms in the unit cell, not only to the
irreducible set of atoms in the unit cell (using symmetry operations, this set
allows one to recover all atoms). If you want to specify only the irreducible set
of atoms, use the symmetriser, see the input variable <a class="wikilink codevar-wikilink" href="/variables/geo#natrd">natrd</a>.</p>
<h2 id="nband"><strong>nband</strong><a class="headerlink" href="#nband" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of BANDs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify bands and occupation numbers, for metals or insulators" data-toggle="popover" href="/topics/BandOcc">topic_BandOcc</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a GW calculation, including self-consistency" data-toggle="popover" href="/topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to calculate the RPA correlation energy" data-toggle="popover" href="/topics/RPACorrEn">topic_RPACorrEn</a>, <a class="wikilink topic-wikilink" data-tippy-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-toggle="popover" href="/topics/Susceptibility">topic_Susceptibility</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> None<br />
<em>Comment:</em>  the estimated number of occupied bands +1 (TODO provide the mathematical formulation)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1092/1245] in all abinit tests, [132/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
KSS file generation for silicon with a different number of bands in the KSS
computation compared to ground-state." data-toggle="popover" href="/tests/etsf_io/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H atom in a big box
Same file as tbase1_1.abi, except that natom, typat, and xcart were changed,
and that the input variables nband, nsppol, occ and occopt are used." data-toggle="popover" href="/tests/tutorial/Input/tbase1_5.abi" target="_blank">tbase1_5.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives number of bands, occupied plus possibly unoccupied, for which
wavefunctions are being computed along with eigenvalues.
Note: if the parameter <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> (see below) is not set to 2,  <strong>nband</strong>  is a
scalar integer, but if the parameter <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> is set to 2, then  <strong>nband</strong> 
must be an array  <strong>nband</strong> (<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>* <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>) giving the number of bands
explicitly for each k point. This option is provided in order to allow the
number of bands treated to vary from k point to k point.
For the values of <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> not equal to 0 or 2,  <strong>nband</strong>  can be omitted.
The number of bands will be set up thanks to the use of the variable
<a class="wikilink codevar-wikilink" href="/variables/gstate#fband">fband</a>. The present Default will not be used.</p>
<p>If <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> is 2, nband must be even for each k point.</p>
<p>In the case of a GW calculation (<a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 3 or 4),  <strong>nband</strong>  gives the
number of bands to be treated to generate the screening (susceptibility and
dielectric matrix), as well as the self-energy. However, to generate the _KSS
file (see <a class="wikilink codevar-wikilink" href="/variables/files#kssform">kssform</a>) the relevant number of bands is given by <a class="wikilink codevar-wikilink" href="/variables/gw#nbandkss">nbandkss</a>.</p>
<h2 id="nbandhf"><strong>nbandhf</strong><a class="headerlink" href="#nbandhf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of BANDs for (Hartree)-Fock exact exchange<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> None<br />
<em>Comment:</em> the estimated number of occupied bands (TODO: provide the mathematical formulation)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 with GPU, norm conserving, from LibXC" data-toggle="popover" href="/tests/gpu_omp/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 with GPU, PAW, from LibXC" data-toggle="popover" href="/tests/gpu_omp/Input/t27.abi" target="_blank">t27.abi</a></li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 in sequential case, norm conserving, from LibXC" data-toggle="popover" href="/tests/libxc/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of HSE06 and HSE03 in sequential case, norm conserving, from LibXC
XG170501 : I would have expected HSE06 and HSE03 total energies to be quite close to each other, which is not true,
as LDA gives -7.867332Ha, HSE06 gives -7.887495 Ha and HSE03 gives -7.963222 Ha . Might be a problem ?" data-toggle="popover" href="/tests/libxc/Input/t52.abi" target="_blank">t52.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 in sequential case" data-toggle="popover" href="/tests/v7/Input/t65.abi" target="_blank">t65.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 in sequential case" data-toggle="popover" href="/tests/v7/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with auxiliary XC functional." data-toggle="popover" href="/tests/v7/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and NC psps" data-toggle="popover" href="/tests/v7/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and PAW" data-toggle="popover" href="/tests/v7/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with RMM-DIIS and NC psps
The energy computation is not variational. While residm and vres2 converge
quite fast, the total energy convergence is lagging behind ..." data-toggle="popover" href="/tests/v7/Input/t72.abi" target="_blank">t72.abi</a></li>
</ul>
</details>
<p>Gives the maximum number of occupied bands with which Fock exact exchange is
being computed for the wavefunctions.</p>
<h2 id="ndtset"><strong>ndtset</strong><a class="headerlink" href="#ndtset" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of DaTaSETs<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a multi dataset calculation" data-toggle="popover" href="/topics/multidtset">topic_multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [861/1245] in all abinit tests, [93/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si single atom with fractional occupation." data-toggle="popover" href="/tests/bigdft/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for real space computation (using a wavelet based poisson solver),
no forces, just an H atom in an empty box. The cut-off is unrealistic. This
test tests the following part of the code :
* psp spline generation for real space ;
* local part of potential from pseudo ;
* ion-ion interaction computation (instead of Ewald) ;
* Hartree potential with Poisson&#x27;s solver." data-toggle="popover" href="/tests/bigdft/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H in isolated boundary conditions (plane waves, NC).
Similar to t20.in but check that non cubic boxs can be used with equivalent x, y and z directions." data-toggle="popover" href="/tests/bigdft/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure writting the KB form factors to output. This is a two data set run,
the first dataset being a ground state calculation and the writes the WFs + KB form factors" data-toggle="popover" href="/tests/etsf_io/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Oxygen atom
Test a few functionals for which HGH pseudopotentials are available (from M. Krack),
that are present also in the lib XC, but not in the native ABINIT set of functionals." data-toggle="popover" href="/tests/libxc/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, with PAW.
Test the IO routines with paral_kgb in [1, 0] and different combinations
of parameters (npfft, npband, np_spkpt).
Test the plane wave load balancing procedure (pw_unbal_thresh).
Test also the computation of PJDOS." data-toggle="popover" href="/tests/mpiio/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Total energy vs. cell size for bulk FCC aluminium, to compare with the
PSML results of t08 and t12" data-toggle="popover" href="/tests/psml/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-toggle="popover" href="/tests/tutoparal/Input/tmbt_1.abi" target="_blank">tmbt_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom." data-toggle="popover" href="/tests/tutorial/Input/tbase2_1.abi" target="_blank">tbase2_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom.
Here, a double loop has been used." data-toggle="popover" href="/tests/tutorial/Input/tbase2_2.abi" target="_blank">tbase2_2.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom. Treated with the Fermi-Amaldi correction (ixc=20), so that this
corresponds to exact cancellation of the Hartree and XC contributions,
as it should for Hydrogen atom.
Examine the 1s-2s splitting, that should be equal to 0.375 Ha,
and is obtained at 0.368 Ha (so within 2%), with the chosen ecut and acell.
This quantity converges much faster to the correct value than either the total
energy or the 1s eigenenergy.
Also test effmass_free. A value 10 times bigger than the usual electron mass
leads to a 10-fold contraction of the system. The 1s-2s splitting is
multiplied by 10 exactly, provided ecut, acell and the smearing of the
potential at origin are scaled appropriately." data-toggle="popover" href="/tests/v1/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3H2 molecule with distant atoms : probe the use of the spinat variable
Use spin-polarized mode, spinor mode, as well as antiferromagnetic mode.
Even consider an initialization with reather crazy, nearly ferromagnetic spinat.
Use PseudosGTH_pwteter/01h.pspgth, in a 8 8 16 box, with 15 Ha cut-off.
Separation is 4 bohr.
Consider anti-parallel spin configuration,  which is the favoured one
for this distance. Get total energy of -0.981 839  Ha .
Note that the spin-polarization is not complete.
Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-toggle="popover" href="/tests/v1/Input/t39.abi" target="_blank">t39.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the geometry builder, and the non-ordering of atoms  :
Same thing as test 42, but with an other order for the input of atoms.
Also permutes objects a and b , to check whether everything is OK." data-toggle="popover" href="/tests/v1/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivative of the total energy
with respect to a atomic displacement perpendicular to
the chain, with q(0 0 1/2) wavevector.
(see test.si.chain of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Si2 molecules (2 atoms per unit cell),
using a separable pseudopotential, with ixc=3.
Computation of the second derivatives of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector, as well as to an homogeneous
electric field. The computed derivatives include the
mixed derivative wrt the two perturbations.
(see test.si.elfd of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="test partial dos calculation with spinors (previously not enabled) and spin
polarization while we are at it" data-toggle="popover" href="/tests/v7/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-toggle="popover" href="/tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions." data-toggle="popover" href="/tests/wannier90/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the number of data sets to be treated.
If 0, means that the multi-data set treatment is not used, so that the root
filenames will not be appended with _DSx, where &lsquo;x&rsquo; is the dataset index
defined by the input variable <a class="wikilink codevar-wikilink" href="/variables/basic#jdtset">jdtset</a>, and also that input names with a
dataset index are not allowed. Otherwise,  <strong>ndtset</strong>  = 0 is equivalent to  <strong>ndtset</strong>  = 1.</p>
<h2 id="ngkpt"><strong>ngkpt</strong><a class="headerlink" href="#ngkpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Grid points for K PoinTs generation<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> &gt;=0,<br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [751/1245] in all abinit tests, [126/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
KSS file generation for silicon with a different number of bands in the KSS
computation compared to ground-state." data-toggle="popover" href="/tests/etsf_io/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
To make the test more portable, we generate GGA-PBE wave functions as starting point." data-toggle="popover" href="/tests/libxc/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite (a polymorph of SiO2)
Test PBEsol in the PAW formalism, using PAW datasets created with atompaw linked with libxc.
Note that the value of ixc is not present in the input file, but it is present in the ATOMPAW dataset (pspxc = -116133)" data-toggle="popover" href="/tests/libxc/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Argon solid, experimental lattice parameter.
Realistic parameters are used (ecut=20, ngkpt=2x2x2 shifted 4 times, but centered on Gamma).
Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
The LDA gap is observed at Gamma : 8.071 eV, is in reasonable agreement with the gap from the TB paper PRL 102, 226401 (2009),
where it is mentioned to be 8.16 eV.
The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV.
The reading of the kinetic energy density, to start a non-SCF calculation is not yet implemented,
as of ABINITv6.12.0 .
This test was used to examine the speed of the convergence in case of elongated cells, up to 16 atoms.
The mGGA convergence was found to be similar to the LDA convergence.
Also, test non-self-consistent mGGA calculation, with reading of the previously produced _DEN and _KDEN files." data-toggle="popover" href="/tests/libxc/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , parallel IO. Test of ground state
Only with 4 procs, no sequential version (tests accesswf 1)" data-toggle="popover" href="/tests/mpiio/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline silicon: computation of the total energy" data-toggle="popover" href="/tests/tutorial/Input/tbase3_1.abi" target="_blank">tbase3_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon: computation of the total energy
This input file will NOT work: nkpt does not agree
with ngkpt and shiftk. The error message will be given
in the &quot;log&quot; file." data-toggle="popover" href="/tests/tutorial/Input/tbase3_2.abi" target="_blank">tbase3_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : computation of the total energy
Convergence with respect to the number of k points." data-toggle="popover" href="/tests/tutorial/Input/tbase3_3.abi" target="_blank">tbase3_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al2O3 cell in rhombohedric cell with different axes.
Dataset 1 : Rhombohedral axes; full set of symmetries and full set of atoms
Dataset 2 : Rhombohedral axes; irreducible unit cell and space group
Dataset 3 : Hexagonal axes; irreducible unit cell and space group
Dataset 4 : Hexagonal axes; full unit cell and space group
The results are equivalent for Dataset 1 and 2 and Dataset 3 and 4." data-toggle="popover" href="/tests/v1/Input/t96.abi" target="_blank">t96.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
Compares with frozen-phonon calculations. Examine two cases:
varying occupation numbers, and fixed occupation numbers.
A. Varying occupation numbers (occopt=4):
RF calculation in dataset 5 gives
2DE equal to -3.812577 Ha, while finite difference of &quot;TOTAL&quot;
energy (datasets 6 and 7, including entropy term) gives -3.812230 Ha
(the agreement could be better with better finite difference)
B. Fixed occupation numbers (occopt=2):
RF calculation in dataset 8 gives
2DE equal to +5.431807 Ha, while finite difference of total
energy (no entropy term is present with occopt=2) gives +5.431857 Ha
(the agreement could be better with better finite difference)" data-toggle="popover" href="/tests/v2/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 28. The chosen grid (too coarse, though) is
(0 0 0), (1/4 1/4 0), (1/2 1/2 0), (1/2 0 0),
(1/2 1/4 1/4), (1/2 -1/4 1/4)  (in reduced coordinates).
The ecut and nkpt parameters are really too low (see test 28),
but parameters suitable for physical results (see test 29)
are also provided in the input files." data-toggle="popover" href="/tests/v2/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for GaAs (zinc-blende).
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 32. The chosen grid (too coarse, though) has only two
special q points : 1/4 1/4 1/4 and 1/4 1/2 1/2 (in reduced coordinates).
The Gamma point is also needed, especially for the computation of
dielectric matric and effective charges, needed to get the asymptotic
behaviour of the interatomic force constants. To generate
the different responses, the following steps are followed,
with each of them corresponding to a different dataset (the multi-dataset
mode allows to have only one input file) :
1) ground state calculation, with a k-point sampling in the irreducible
Brillouin zone only;
2) using the density of 1), computation of the wavefunctions for the
grid of k-points in the full Brillouin zone; (not really needed in v3.0)
3) computation of the ddk response, in preparation to the electric field
response ;
4) computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
5) using the density of 1), computation of the GS wavefunctions
at k+q where q is 1/4 1/4 1/4 ;
6) computation of the dynamical matrix at 1/4 1/4 1/4 ;
7) using the density of 1), computation of the GS wavefunctions
at k+q where q is 1/4 1/2 1/2 ;
8) computation of the dynamical matrix at 1/4 1/2 1/2 ." data-toggle="popover" href="/tests/v2/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
First dataset : compute the density
Second dataset : compute the spinor wfs at one k point,
non-self consistently
Third dataset : use the spinor wfs of the previous dataset
to restart computations at symmetric k points." data-toggle="popover" href="/tests/v3/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with spin-orbit. Should give the same answer
than test 2, except that the k point grid is now
defined automatically.
Dataset 8 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
Warning : the output file of this test
is machine-dependent, although the final
result is not. This is because the
degeneracy of the GS wavefunctions with
different spin orientation has not been broken." data-toggle="popover" href="/tests/v3/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in BCC structure. Low cut-offs and few k-points.
This test is done within GGA and (ferro-)magnetism in PAW formalism.
The same job is done twice with two differents PAW datasets.
First PAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed analytically.
SecondPAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed numerically." data-toggle="popover" href="/tests/v4/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in HCP structure. Low cut-offs and few k-points.
This test is done within GGA and no magnetism in PAW formalism.
The same job is done twice with two differents values of mkmem." data-toggle="popover" href="/tests/v4/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen dimer in a big cell.
Produce different files (_DEN, _POT, _VHXC, _VHA), for subsequent analysis by CUT3D (see next run).
Note the following values, that will allow to check the correctness of the subsequent analysis :
Kinetic energy  =  1.02998395409183E+00
Hartree energy  =  8.05073794254872E-01
Loc. psp. energy= -2.53949740885919E+00
Band energy (Ha)=  -7.2732761066E-01
Also, the mean of the Vxc potential is announced to be
Average Vxc (hartree)=  -0.05293" data-toggle="popover" href="/tests/v6/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl molecule in a big box.
Test of the computation of the polarisation with the routine berryphase_new,
for different k-point grids : only 1 k-point, a line of k-points, and a full mesh of k-points.
Results with acell 20 10 10 are : -9.727 C/m^2, -9.975 C/m^2, -9.503 C/m^2
multiplied by the volume (in a.u.), gives -19454, -19950, -19006
Test provided by S. Leroux
Going to bigger cells make these results converge to the same value :
Results with acell 30 20 20 are : -1.771 C/m^2, -1.746 C/m^2, -1.747 C/m^2
multiplied by the volume (in a.u.), gives -21252, -20952, -20964
Results with acell 40 20 20 are : -1.3167C/m^2, -1.3057C/m^2, -1.3062C/m^2
multiplied by the volume (in a.u.), gives -21067, -20891, -20899
Results with acell 50 20 20 are : -1.0502C/m^2, -1.0444C/m^2, -1.0450C/m^2
multiplied by the volume (in a.u.), gives -21004, -20888, -20900" data-toggle="popover" href="/tests/v6/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-toggle="popover" href="/tests/v6/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-toggle="popover" href="/tests/v8/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Used when <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> &gt;= 0, if <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> has not been defined (<a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>
and  <strong>ngkpt</strong>  are exclusive of each other).
Its three positive components give the number of k points of Monkhorst-Pack
grids (defined with respect to primitive axis in reciprocal space) in each of
the three dimensions.  <strong>ngkpt</strong>  will be used to generate the corresponding
<a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> input variable. The use of <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>, allows one to
generate shifted grids, or Monkhorst-Pack grids defined with respect to
conventional unit cells.</p>
<p>When <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> is initialized as a diagonal (3x3) matrix,
whose diagonal elements are the three values  <strong>ngkpt</strong> (1:3). When <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a>
is greater than 1, ABINIT will try to generate <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> on the basis of
the primitive vectors of the k-lattice: the number of shifts might be reduced,
in which case <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> will not be diagonal anymore.</p>
<p>Monkhorst-Pack grids are usually the most efficient when their defining
integer numbers are even. For a measure of the efficiency, see the input
variable <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlen">kptrlen</a>.</p>
<h2 id="nkpath"><strong>nkpath</strong><a class="headerlink" href="#nkpath" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of K-points defining the PATH<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-toggle="popover" href="/tests/libxc/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a></li>
</ul>
</details>
<p>This variable is used to define the number of high-symmetry k-points in the
<a class="wikilink codevar-wikilink" href="/variables/gstate#kptbounds">kptbounds</a> array when <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> &gt; 0. Historically, <a class="wikilink codevar-wikilink" href="/variables/gstate#kptbounds">kptbounds</a> is used
in conjuction with a negative value of <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> when performing a NSCF band
structure calculation. In this case, the number of k-points in kptbounds is
given by abs(kptopt) + 1. There are, however, other cases in which one has to
specify a k-path in the input file in order to activate some kind of post-
processing tool. Typical examples are the interpolation of the GW corrections
at the end of the sigma run or the interpolation of the KS eigenvalues along a
path at the end of the SCF run (see also <a class="wikilink codevar-wikilink" href="/variables/basic#einterp">einterp</a>) In a nutshell, nkpath
replaces <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> when we are not performing a NSCF calculation. Note that,
unlike <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>, nkpath represents the total number of points in the
<a class="wikilink codevar-wikilink" href="/variables/gstate#kptbounds">kptbounds</a> array.</p>
<h2 id="nkpt"><strong>nkpt</strong><a class="headerlink" href="#nkpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of K - Points<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> == 0,
0 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [572/1245] in all abinit tests, [42/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
KSS file generation for silicon with a different number of bands in the KSS
computation compared to ground-state." data-toggle="popover" href="/tests/etsf_io/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LOBPCG, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Gold with one vacancy (107 atoms of gold)." data-toggle="popover" href="/tests/tutoparal/Input/tparal_bandpw_01.abi" target="_blank">tparal_bandpw_01.abi</a>, <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutoparal/Input/tparal_bandpw_02.abi" target="_blank">tparal_bandpw_02.abi</a>, <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutoparal/Input/tparal_bandpw_03.abi" target="_blank">tparal_bandpw_03.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="ZPR computation at the Gamma point for MgO." data-toggle="popover" href="/tests/tutorespfn/Input/teph4zpr_4.abi" target="_blank">teph4zpr_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="ZPR computation at Gamma for MgO. Convergence of ZPR wrt nband" data-toggle="popover" href="/tests/tutorespfn/Input/teph4zpr_5.abi" target="_blank">teph4zpr_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Convergence of ZPR wrt nband with the Sternheimer method" data-toggle="popover" href="/tests/tutorespfn/Input/teph4zpr_6.abi" target="_blank">teph4zpr_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the extension of the pspcod=8 input format to include
spin-orbit coupling with multiple non-local projectors.  The
band structure of fcc Pt is computed at Gamma, X, and L.
The pseudopotential used in the test is generated by the open-source
ONCVPSP code, which is available at www.mat-simresearch.com, and
described in D. R. Hamann, Phys. Rev. B 88, 085177 (2013).
The relativistic extension is documented in the code package.
The Pt 5s and 5p semi-cores are treated as valence, and the band
structure is well-converged at the ecut used in the test (20 Ha).
A complete description of the input format is avaiable in
doc/psp_infos/psp8_info.txt." data-toggle="popover" href="/tests/v7/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Boron, 32 atoms - Thomas-Fermi method (without orbitals)
Test the temperature-dependent XC functional (ixc=50)
(Ichimaru et al Phys. Rep. 149, 91-205 (1987)
Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-toggle="popover" href="/tests/v7/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (spin-polarized, non-linear XC core correction, LDA)
Fixed occupation numbers. The parameters have been artifically tuned
with the goal to find a small system that reproduces the typical 1D-configuration coordinate diagram,
with a first total energy curve that shows a minimum, a second (different occupations) total energy curve
that shows a slightly higher minimum, at a slightly larger interatomic distance, and then the two total energy curves
cross at an even slightly larger interatomic distance.
This system will be used as a test bed for the next tests" data-toggle="popover" href="/tests/v8/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (spin-polarized, non-linear XC core correction, LDA)
Test the input variable imgwfstor.
In itimimage=2, the SCF cycle and the Broyden optimization are indeed immediately fulfilled." data-toggle="popover" href="/tests/v8/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (spin-polarized, non-linear XC core correction, LDA)
Fixed occupation numbers. imgmov 6 + ionmov 2 algorithm.
dataset 1 : Broyden for one image
dataset 2 : Broyden for two images, but only the first one has non-zero weight.
dataset 3 : Broyden for two images, but only the second one has non-zero weight.
dataset 4 : Broyden for two images, with weights such that the first image has still lower energy than the second
dataset 5 : Broyden for two images, with weights such that the second image has now lower energy than the first.
Geometries that mimimize the linear combination of energy at fixed Lagrange parameters can thus be found." data-toggle="popover" href="/tests/v8/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-toggle="popover" href="/tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-toggle="popover" href="/tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-toggle="popover" href="/tests/v9/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>If non-zero,  <strong>nkpt</strong>  gives the number of k points in the k point array
<a class="wikilink codevar-wikilink" href="/variables/basic#kpt">kpt</a>. These points are used either to sample the Brillouin zone, or to
build a band structure along specified lines.</p>
<p>If  <strong>nkpt</strong>  is zero, the code deduces from other input variables (see the list
in the description of <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>) the number of k points, which is possible
only when <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>/=0. If <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>/=0 and the input value of  <strong>nkpt</strong> /=0,
then ABINIT will check that the number of k points generated from the other
input variables is exactly the same than  <strong>nkpt</strong> .</p>
<p>If <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> is positive,  <strong>nkpt</strong>  must be coherent with the values of
<a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>.
For ground state calculations, one should select the k point in the
irreducible Brillouin Zone (obtained by taking into account point symmetries
and the time-reversal symmetry).
For response function calculations, one should select k points in the full
Brillouin zone, if the wavevector of the perturbation does not vanish, or in a
half of the Brillouin Zone if q=0. The code will automatically decrease the
number of k points to the minimal set needed for each particular perturbation.</p>
<p>If <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> is negative,  <strong>nkpt</strong>  will be the sum of the number of points on
the different lines of the band structure. For example, if <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = -3, one
will have three segments; supposing <a class="wikilink codevar-wikilink" href="/variables/gstate#ndivk">ndivk</a> is 10 12 17, the total number of
k points of the circuit will be 10+12+17+1(for the final point)=40.</p>
<h2 id="nkpthf"><strong>nkpthf</strong><a class="headerlink" href="#nkpthf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of K - Points for (Hartree) Fock exact exchange<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> None<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 with GPU, norm conserving, from LibXC" data-toggle="popover" href="/tests/gpu_omp/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 with GPU, PAW, from LibXC" data-toggle="popover" href="/tests/gpu_omp/Input/t27.abi" target="_blank">t27.abi</a></li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 in sequential case, norm conserving, from LibXC" data-toggle="popover" href="/tests/libxc/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of HSE06 and HSE03 in sequential case, norm conserving, from LibXC
XG170501 : I would have expected HSE06 and HSE03 total energies to be quite close to each other, which is not true,
as LDA gives -7.867332Ha, HSE06 gives -7.887495 Ha and HSE03 gives -7.963222 Ha . Might be a problem ?" data-toggle="popover" href="/tests/libxc/Input/t52.abi" target="_blank">t52.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 in sequential case" data-toggle="popover" href="/tests/v7/Input/t65.abi" target="_blank">t65.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 in sequential case" data-toggle="popover" href="/tests/v7/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with auxiliary XC functional." data-toggle="popover" href="/tests/v7/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and NC psps" data-toggle="popover" href="/tests/v7/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and PAW" data-toggle="popover" href="/tests/v7/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with RMM-DIIS and NC psps
The energy computation is not variational. While residm and vres2 converge
quite fast, the total energy convergence is lagging behind ..." data-toggle="popover" href="/tests/v7/Input/t72.abi" target="_blank">t72.abi</a></li>
</ul>
</details>
<p><strong>nkpthf</strong>  gives the number of k points used to sample the full Brillouin zone
for the Fock exact exchange contribution. It is obtained from the
specification of the wavefunction k point grid (see <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>), possibly
downfolded as specified by <a class="wikilink codevar-wikilink" href="/variables/gstate#fockdownsampling">fockdownsampling</a>.</p>
<h2 id="nshiftk"><strong>nshiftk</strong><a class="headerlink" href="#nshiftk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of SHIFTs for K point grids<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [629/1245] in all abinit tests, [110/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands." data-toggle="popover" href="/tests/built-in/Input/testin_wannier90.abi" target="_blank">testin_wannier90.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
KSS file generation for silicon with a different number of bands in the KSS
computation compared to ground-state." data-toggle="popover" href="/tests/etsf_io/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure writting the KB form factors to output. This is a two data set run,
the first dataset being a ground state calculation and the writes the WFs + KB form factors" data-toggle="popover" href="/tests/etsf_io/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (stresses), using GEMM nonlop.
Related tests: v8 t83 and gpu_omp t21 ." data-toggle="popover" href="/tests/gpu_omp/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 with GPU, norm conserving, from LibXC" data-toggle="popover" href="/tests/gpu_omp/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
To make the test more portable, we generate GGA-PBE wave functions as starting point." data-toggle="popover" href="/tests/libxc/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Argon solid, experimental lattice parameter.
Realistic parameters are used (ecut=20, ngkpt=2x2x2 shifted 4 times, but centered on Gamma).
Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
The LDA gap is observed at Gamma : 8.071 eV, is in reasonable agreement with the gap from the TB paper PRL 102, 226401 (2009),
where it is mentioned to be 8.16 eV.
The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV.
The reading of the kinetic energy density, to start a non-SCF calculation is not yet implemented,
as of ABINITv6.12.0 .
This test was used to examine the speed of the convergence in case of elongated cells, up to 16 atoms.
The mGGA convergence was found to be similar to the LDA convergence.
Also, test non-self-consistent mGGA calculation, with reading of the previously produced _DEN and _KDEN files." data-toggle="popover" href="/tests/libxc/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell.
Testing temperature-dependent libxc functionals.
Several XC functionals, several electronic temperatures." data-toggle="popover" href="/tests/libxc/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Total energy vs. cell size for bulk FCC aluminium, to compare with the
PSML results of t08 and t12" data-toggle="popover" href="/tests/psml/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium" data-toggle="popover" href="/tests/psml/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using old, rather inaccurate psps.
Computation of the Berry phase.
Test the doubling of the step of the sampling." data-toggle="popover" href="/tests/seq/Input/tsv3_04.abi" target="_blank">tsv3_04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, rhombohedral.
Test finite electric field
Check the corectness of the symmetry operations with non-zero tnons." data-toggle="popover" href="/tests/seq/Input/tsv4_55.abi" target="_blank">tsv4_55.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline silicon: computation of the total energy" data-toggle="popover" href="/tests/tutorial/Input/tbase3_1.abi" target="_blank">tbase3_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon: computation of the total energy
This input file will NOT work: nkpt does not agree
with ngkpt and shiftk. The error message will be given
in the &quot;log&quot; file." data-toggle="popover" href="/tests/tutorial/Input/tbase3_2.abi" target="_blank">tbase3_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : computation of the total energy
Convergence with respect to the number of k points." data-toggle="popover" href="/tests/tutorial/Input/tbase3_3.abi" target="_blank">tbase3_3.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Helium q close to Gamma, along Gamma-H
There is a problem with kptopt=1 or 3 for the NSC step." data-toggle="popover" href="/tests/v2/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 28. The chosen grid (too coarse, though) is
(0 0 0), (1/4 1/4 0), (1/2 1/2 0), (1/2 0 0),
(1/2 1/4 1/4), (1/2 -1/4 1/4)  (in reduced coordinates).
The ecut and nkpt parameters are really too low (see test 28),
but parameters suitable for physical results (see test 29)
are also provided in the input files." data-toggle="popover" href="/tests/v2/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for GaAs (zinc-blende).
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 32. The chosen grid (too coarse, though) has only two
special q points : 1/4 1/4 1/4 and 1/4 1/2 1/2 (in reduced coordinates).
The Gamma point is also needed, especially for the computation of
dielectric matric and effective charges, needed to get the asymptotic
behaviour of the interatomic force constants. To generate
the different responses, the following steps are followed,
with each of them corresponding to a different dataset (the multi-dataset
mode allows to have only one input file) :
1) ground state calculation, with a k-point sampling in the irreducible
Brillouin zone only;
2) using the density of 1), computation of the wavefunctions for the
grid of k-points in the full Brillouin zone; (not really needed in v3.0)
3) computation of the ddk response, in preparation to the electric field
response ;
4) computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
5) using the density of 1), computation of the GS wavefunctions
at k+q where q is 1/4 1/4 1/4 ;
6) computation of the dynamical matrix at 1/4 1/4 1/4 ;
7) using the density of 1), computation of the GS wavefunctions
at k+q where q is 1/4 1/2 1/2 ;
8) computation of the dynamical matrix at 1/4 1/2 1/2 ." data-toggle="popover" href="/tests/v2/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si crystal. GGA + non-linear XC core correction.
Compute the interatomic force constant for the displacement of the second atom along (111).
RF calculation of the 2DTE gives 7.51663417 Ha
while finite differences gives: with delta(xred)=0.0001, 7.15663267 Ha.
The agreement is quite good, and might likely be improved by combining finite differences.
Also compute the ddk and electric field responses. The number of k points is much too small to
obtain physical values, but are quite comparable to the result of test v2 #6" data-toggle="popover" href="/tests/v3/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-toggle="popover" href="/tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-toggle="popover" href="/tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in BCC structure. Low cut-offs and few k-points.
This test is done within GGA and (ferro-)magnetism in PAW formalism.
The same job is done twice with two differents PAW datasets.
First PAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed analytically.
SecondPAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed numerically." data-toggle="popover" href="/tests/v4/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in HCP structure. Low cut-offs and few k-points.
This test is done within GGA and no magnetism in PAW formalism.
The same job is done twice with two differents values of mkmem." data-toggle="popover" href="/tests/v4/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate both DEN and PAWDEN files for silicon. Note that in the PAW case, DEN files
include the valence density and compensation charge, while PAWDEN files include the
valence and on-site corrections, but not the compensation charge. Therefore, DEN files are
needed for further computations, while PAWDEN files are useful for visualization, AIM, and other
post-processing of the density.
PAW AE DEN not compatible with parallelization over atoms." data-toggle="popover" href="/tests/v5/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl molecule in a big box.
Test of the computation of the polarisation with the routine berryphase_new,
for different k-point grids : only 1 k-point, a line of k-points, and a full mesh of k-points.
Results with acell 20 10 10 are : -9.727 C/m^2, -9.975 C/m^2, -9.503 C/m^2
multiplied by the volume (in a.u.), gives -19454, -19950, -19006
Test provided by S. Leroux
Going to bigger cells make these results converge to the same value :
Results with acell 30 20 20 are : -1.771 C/m^2, -1.746 C/m^2, -1.747 C/m^2
multiplied by the volume (in a.u.), gives -21252, -20952, -20964
Results with acell 40 20 20 are : -1.3167C/m^2, -1.3057C/m^2, -1.3062C/m^2
multiplied by the volume (in a.u.), gives -21067, -20891, -20899
Results with acell 50 20 20 are : -1.0502C/m^2, -1.0444C/m^2, -1.0450C/m^2
multiplied by the volume (in a.u.), gives -21004, -20888, -20900" data-toggle="popover" href="/tests/v6/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-toggle="popover" href="/tests/v6/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for simple cubic Ti crystal, for reference purposes (conventional = primitive unit cell for symmetry ops)" data-toggle="popover" href="/tests/v6/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the extension of the pspcod=8 input format to include
spin-orbit coupling with multiple non-local projectors.  The
band structure of fcc Pt is computed at Gamma, X, and L.
The pseudopotential used in the test is generated by the open-source
ONCVPSP code, which is available at www.mat-simresearch.com, and
described in D. R. Hamann, Phys. Rev. B 88, 085177 (2013).
The relativistic extension is documented in the code package.
The Pt 5s and 5p semi-cores are treated as valence, and the band
structure is well-converged at the ecut used in the test (20 Ha).
A complete description of the input format is avaiable in
doc/psp_infos/psp8_info.txt." data-toggle="popover" href="/tests/v7/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation
in (N,V,T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested
together with the three coordinate systems (primitive, normal mode, staging).
NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with
--- Pseudopotential description --" data-toggle="popover" href="/tests/v7/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>This parameter gives the number of shifted grids to be used concurrently to
generate the full grid of k points. It can be used with primitive grids
defined either from <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>. The maximum allowed value of
 <strong>nshiftk</strong>  is 8. The values of the shifts are given by <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>.</p>
<p>The use of  <strong>nshiftk</strong> =1, 2, or 4 is quite common, see the values suggested in the
description of <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>. The other values are either for debugging purposes by experts,
or can indicate an error. Such other values are allowed only if <a class="wikilink codevar-wikilink" href="/variables/gstate#chksymbreak">chksymbreak</a>=0.</p>
<h2 id="nsppol"><strong>nsppol</strong><a class="headerlink" href="#nsppol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of SPin POLarization<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a spin-polarized calculation" data-toggle="popover" href="/topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [256/1245] in all abinit tests, [22/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
Pt single atom with semi-core electrons, Krack pseudopotentials (pspcod = 10),
and colinear spin polarisation (GGA functional)." data-toggle="popover" href="/tests/bigdft/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC" data-toggle="popover" href="/tests/built-in/Input/testin_libxc.abi" target="_blank">testin_libxc.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.  Write t17o_DEN (prtden=1)." data-toggle="popover" href="/tests/fast/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Re-run 17 but in slightly larger box, same ecut, larger ng.
(Box is still too small for proper model of Si2.)" data-toggle="popover" href="/tests/fast/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Conduct relaxation of molecule starting from wf.19, using ionmov=2. (Broyden method)." data-toggle="popover" href="/tests/fast/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Test functionals from libXC that were present in ABINITv5 (LDAs and GGAs).
This is to check the portability for different platform.
Extremely quick (nstep=1, nline=1). Less than 20 secs to test 45 functionals ..." data-toggle="popover" href="/tests/libxc/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over bands and spins:
npband*npfft*np_spkpt=2*1*2=4 processors.
In addition, we also test here various features of bandfft-kpt parallelisation
In particular, the bandpp, istwfk=2 and wfoptalg=14 variables." data-toggle="popover" href="/tests/mpiio/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization" data-toggle="popover" href="/tests/psml/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization" data-toggle="popover" href="/tests/psml/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : print the pwfn.data file,
for use in a subsequent run of the CASINO code." data-toggle="popover" href="/tests/seq/Input/tsv4_90.abi" target="_blank">tsv4_90.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test at the fixed, symmetric geometry, for reference. Of course, the cell is not primitive.

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_01.abi" target="_blank">tpsic_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test at a set of decreasing I-I interatomic distances

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_02.abi" target="_blank">tpsic_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test starts from a reasonable I-I interatomic distance, and search for the optimized polaron geometry, without constraint.

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_03.abi" target="_blank">tpsic_03.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H atom in a big box
Same file as tbase1_1.abi, except that natom, typat, and xcart were changed,
and that the input variables nband, nsppol, occ and occopt are used." data-toggle="popover" href="/tests/tutorial/Input/tbase1_5.abi" target="_blank">tbase1_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom." data-toggle="popover" href="/tests/tutorial/Input/tbase2_1.abi" target="_blank">tbase2_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom.
Here, a double loop has been used." data-toggle="popover" href="/tests/tutorial/Input/tbase2_2.abi" target="_blank">tbase2_2.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated like a metal (there is a degeneracy at the Fermi level),
occopt=4 and tsmear=0.04 , with nsppol=2 .
Use spinat to polarize the molecule at start.
Gives total energy of -32.09317 Hartree
This test can be used to check the accuracy of stresses in the
spin-polarized case. Setting acell(1:2) to 7.005 and 6.995
gives ETOT -32.090846193972 and -32.095501753750,
ucvol  441.63023 and 440.37023
so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03,
to be compared with sigma(1)=3.6949713786E-03
and sigma(2)=3.6949681083E-03 from the present test
(the degeneracy is slightly lifted because of incomplete convergence,
using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both
sigma values)." data-toggle="popover" href="/tests/v1/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated as a spin-polarized molecule, with fixed occupation
numbers (occopt=2), with nsppol=2 . Gives total energy of -32.09792 Hartree" data-toggle="popover" href="/tests/v1/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom (see above)
Treated with LSD, Teter rational polynomial parametrization (4/93) (ixc=1).
The total energy is -0.4792 Ha.
Also additional tests concerning the kinetic energy density calculation,
the gradient of electronic density calculation and
the Laplacian of electronic density calculation are performed." data-toggle="popover" href="/tests/v1/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk=1,nsppol=2." data-toggle="popover" href="/tests/v10/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (non-spin-polarized, non-linear XC core correction, GGA)
Computation of forces in the GGA, and comparison with a finite
difference of energy.
The direct computation of force (dataset 2) gives 0.627251486 Ha/Bohr
A simple finite-difference estimation (dataset 1 and 3) gives
0.627251265 Ha/Bohr. The agreement can be improved if a better
finite-difference estimation is used." data-toggle="popover" href="/tests/v2/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 17 of fast, except lower ecut.
Test ionmov=6 (Verlet) as well as ionmov=7.
Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3
Action : change nband, or use the sequential version of ABINIT.
src_file: chkinp.F90
src_line: 1181" data-toggle="popover" href="/tests/v2/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (nsppol=2, non-linear XC core correction, GGA)
Some similarities with test 41, except that nsppol=2 instead of 1.
Computation of uniaxial stresses in the GGA,
and comparison with a finite difference of energy.
The estimation of sigma(zz) stress  at acell(3)=9.0
from acell(3)=8.9991 and 9.0009
gives 1.62867d-3 Ha/Bohr**3
A simple finite-difference estimation gives
a difference in total energy of 0.123861d-3 Ha,
for a difference of volume of 0.07605 Bohr**3 leading
to a stress estimation of 1.62867d-3 Ha/Bohr**3" data-toggle="popover" href="/tests/v2/Input/t50.abi" target="_blank">t50.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 diatomic molecule. Spin-polarized (ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=1 (Teter LSDA)
From dataset 2 and 3, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 10.88934274 Ha, while the direct computation,
in dataset 4 gives 10.88933963 Ha .

Cannot be executed in parallel

chkinp: Checking input parameters for consistency, jdtset= 3.

--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number :
1 The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential version
of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v3/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 diatomic molecule. Spin-polarized (ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=7 (Perdew-Wang 92 LSDA)
From dataset 2 and 3, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 10.88283478 Ha, while the direct computation,
in dataset 4 gives 10.882832 Ha .

Cannot be executed in parallel
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v3/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 diatomic molecule. Spin-polarized (anti-ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=1 (Teter LSDA)
From datasets 3 and 4, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 6.283100652 Ha, while the direct computation,
without using Shubnikov symmetries, gives
6.282967527 Ha." data-toggle="popover" href="/tests/v3/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in BCC structure. Low cut-offs and few k-points.
This test is done within GGA and (ferro-)magnetism in PAW formalism.
The same job is done twice with two differents PAW datasets.
First PAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed analytically.
SecondPAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed numerically." data-toggle="popover" href="/tests/v4/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation with GGA  and spin polarization
This is the same as t79, bcc Fe,
but with the PBE GGA.  This calculation is restricted to one
unaxial strain, which adequately tests the polarization-dependent
parts of the strain GGA code." data-toggle="popover" href="/tests/v4/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation with spin polarization and metallic
occupation of states
Fe in the bcc structure.  This tests both the introduction of spin
polarization into strain response function calculations and an
improved treatment of the first-order fermi energy for Q=0 metallic
calculations.  Similar data (with much larger cutoffs, tighter
convergence tolerances, and larger k sample) was used test the
elastic tensor in comparison with numerical derivatives of the
stress from GS calculations." data-toggle="popover" href="/tests/v4/Input/t79.abi" target="_blank">t79.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi atom in a big supercell.
Test the application of a Zeeman field." data-toggle="popover" href="/tests/v6/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Tests series for the mGGA implementation (from 31 to 33)
Silicon bulk. Two datasets are run. One (classic) LDA calculation with ixc 7.
One with a fake native mGGA (fake1, i.e. ixc 31) and using effmass_free=1.01.
Both calculation should give the same total energy (change in kinetic energy due to
effmass_free is compensated by the fake mGGA using kinetic energy density: taur).
(Two other datasets are also run for spin polarized case)" data-toggle="popover" href="/tests/v6/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated hydrogen atom
Calculation of the HF levels with different ways to integrate the Coulomb divergence" data-toggle="popover" href="/tests/v67mbpt/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with PAW and nsppol = 2.
Use model dielectric function computed from AE PAW density (denfgr.F90)." data-toggle="popover" href="/tests/v67mbpt/Input/t29.abi" target="_blank">t29.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="test partial dos calculation with spinors (previously not enabled) and spin
polarization while we are at it" data-toggle="popover" href="/tests/v7/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the extension of the pspcod=8 input format to include
spin-orbit coupling with multiple non-local projectors.  The
band structure of fcc Pt is computed at Gamma, X, and L.
The pseudopotential used in the test is generated by the open-source
ONCVPSP code, which is available at www.mat-simresearch.com, and
described in D. R. Hamann, Phys. Rev. B 88, 085177 (2013).
The relativistic extension is documented in the code package.
The Pt 5s and 5p semi-cores are treated as valence, and the band
structure is well-converged at the ecut used in the test (20 Ha).
A complete description of the input format is avaiable in
doc/psp_infos/psp8_info.txt." data-toggle="popover" href="/tests/v7/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (spin-polarized, non-linear XC core correction, LDA)
Fixed occupation numbers. The parameters have been artifically tuned
with the goal to find a small system that reproduces the typical 1D-configuration coordinate diagram,
with a first total energy curve that shows a minimum, a second (different occupations) total energy curve
that shows a slightly higher minimum, at a slightly larger interatomic distance, and then the two total energy curves
cross at an even slightly larger interatomic distance.
This system will be used as a test bed for the next tests" data-toggle="popover" href="/tests/v8/Input/t18.abi" target="_blank">t18.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
</ul>
</details>
<p>Give the number of INDEPENDENT spin polarisations, for which there are non-
related wavefunctions. Can take the values 1 or 2.</p>
<p>If  <strong>nsppol</strong>  = 1, one has an unpolarized calculation (<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1,
<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 1) or an antiferromagnetic system (<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 2), or
a calculation in which spin up and spin down cannot be disentangled
(<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2), that is, either non-collinear magnetism or presence of spin-
orbit coupling, for which one needs spinor wavefunctions.</p>
<p>If  <strong>nsppol</strong>  = 2, one has a spin-polarized (collinear) calculation with
separate and different wavefunctions for up and down spin electrons for each
band and k point. Compatible only with <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> == 1, <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> == 2. If
 <strong>nsppol</strong>  = 2, one usually uses a metallic value for <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>, in order to
let ABINIT find the magnetization. On the contrary, if <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> == 1 is used,
the user has to impose the magnetization, using <a class="wikilink codevar-wikilink" href="/variables/ffield#spinmagntarget">spinmagntarget</a>, except for
the case of a single isolated Hydrogen atom.</p>
<p>In the present status of development, with  <strong>nsppol</strong>  = 1, all values of <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>
are allowed, while with  <strong>nsppol</strong>  = 2, some values of <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a> might not be
allowed (e.g. 2, 3, 4, 5, 6, 20, 21, 22 are not allowed).</p>
<p>See also the input variable <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> for the components of the density
matrix with respect to the spin-polarization.</p>
<h2 id="nstep"><strong>nstep</strong><a class="headerlink" href="#nstep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of (non-)self-consistent field STEPS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 30<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1161/1245] in all abinit tests, [139/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in hypothetical wurzite (hexagonal) structure
Structural optimization run" data-toggle="popover" href="/tests/tutorespfn/Input/telast_1.abi" target="_blank">telast_1.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the maximum number of cycles (or &ldquo;iterations&rdquo;) in a SCF or non-SCF run.
Full convergence from random numbers is usually achieved in 12-20 SCF
iterations. Each can take from minutes to hours. In certain difficult cases,
usually related to a small or zero band gap or magnetism, convergence
performance may be much worse. When the convergence tolerance <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> on
the wavefunctions is satisfied, iterations will stop, so for well converged
calculations you should set  <strong>nstep</strong>  to a value larger than you think will be
needed for full convergence, e.g. if using 20 steps usually converges the
system, set  <strong>nstep</strong>  to 30.
For non-self-consistent runs ( <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &lt; 0) nstep governs the number of
cycles of convergence for the wavefunctions for a fixed density and Hamiltonian.</p>
<p>NOTE that a choice of  <strong>nstep</strong>  = 0 is permitted; this will either read
wavefunctions from disk (with <a class="wikilink codevar-wikilink" href="/variables/files#irdwfk">irdwfk</a> = 1 or <a class="wikilink codevar-wikilink" href="/variables/files#irdwfq">irdwfq</a> = 1, or non-zero
<a class="wikilink codevar-wikilink" href="/variables/files#getwfk">getwfk</a> or <a class="wikilink codevar-wikilink" href="/variables/files#getwfq">getwfq</a> in the case of multi-dataset) and compute the
density, the total energy and stop, or else (with all of the above vanishing)
will initialize randomly the wavefunctions and compute the resulting density
and total energy. This is provided for testing purposes.
Also NOTE that  <strong>nstep</strong>  = 0 with <a class="wikilink codevar-wikilink" href="/variables/files#irdwfk">irdwfk</a> = 1 will exactly give the same result
as the previous run only if the latter is done with <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&lt;10 (potential mixing).
One can output the density by using <a class="wikilink codevar-wikilink" href="/variables/files#prtden">prtden</a>.
The forces and stress tensor are computed with  <strong>nstep</strong>  = 0.</p>
<h2 id="nsym"><strong>nsym</strong><a class="headerlink" href="#nsym" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of SYMmetry operations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a GW calculation, including self-consistency" data-toggle="popover" href="/topics/GW">topic_GW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [404/1245] in all abinit tests, [19/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Carbon atom
Test the mGGA functionals generating directly XC potentials.
To make the test more poratble, we generate GGA-PBE wave functions as starting point.
Similar to test 08, but with smaller acell and ecut.
Without the use of a &quot;large&quot; xc_denpos, Tran-Blaha is hard to converge. Hypothesis : there is a strong non-linear
region, preventing the Anderson method to work effectively.
Note that the default iscf (=7) does not allow to converge with the default xc_denpos !
By contrast, things are much better behaved with xc_denpos on the order of 1.0e-7 ." data-toggle="popover" href="/tests/libxc/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell.
Testing temperature-dependent libxc functionals.
Several XC functionals, several electronic temperatures." data-toggle="popover" href="/tests/libxc/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
CrystallIne AlAs
first three runs are for calculation of ground state at finite electric field
the fourth run gets the gs wavefunction and then do response calculation
the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-toggle="popover" href="/tests/seq/Input/tsv4_80.abi" target="_blank">tsv4_80.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
65-atom alkane chain of 65 atoms, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_2.abi" target="_blank">tgswvl_2.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PAW1 tutorial
Diamond at experimental volume" data-toggle="popover" href="/tests/tutorial/Input/tpaw1_1.abi" target="_blank">tpaw1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PAW1 tutorial
Diamond at experimental volume
Convergence with respect to the plane-wave cut-off" data-toggle="popover" href="/tests/tutorial/Input/tpaw1_2.abi" target="_blank">tpaw1_2.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj to test restarxf -1" data-toggle="popover" href="/tests/v10/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj restarting from HIST file using restarxf -1" data-toggle="popover" href="/tests/v10/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a conductivity calculation (test v5#t10)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 10.
It tests the following parts of the code:
optic_paw, optic_paw_core
Note that, in addition to the psp file, the core wave functions file is needed." data-toggle="popover" href="/tests/v5/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation
in (N,V,T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested
together with the three coordinate systems (primitive, normal mode, staging).
NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with
--- Pseudopotential description --" data-toggle="popover" href="/tests/v7/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-toggle="popover" href="/tests/v8/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
In t67 the ground state wfs are computed, t68 is for dfpt calculation" data-toggle="popover" href="/tests/v8/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Response of magnetic metal to external magnetic field at q/=0.
First, ground state wfs are computed, then dfpt calculation is performed." data-toggle="popover" href="/tests/v8/Input/t68.abi" target="_blank">t68.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t101)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 101.
It tests the following parts of the code:
optic_paw, optic_paw_core, optic_paw_soc
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t100.abi" target="_blank">t100.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives number of space group symmetries to be applied in this problem.
Symmetries will be input in array &ldquo;<a class="wikilink codevar-wikilink" href="/variables/basic#symrel">symrel</a>&rdquo; and (nonsymmorphic)
translations vectors will be input in array &ldquo;<a class="wikilink codevar-wikilink" href="/variables/basic#tnons">tnons</a>&rdquo;. If there is no
symmetry in the problem then set  <strong>nsym</strong>  to 1, because the identity is still
a symmetry.
In case of a RF calculation, the code is able to use the symmetries of the
system to decrease the number of perturbations to be calculated, and to
decrease of the number of special k points to be used for the sampling of the
Brillouin zone. After the response to the perturbations have been calculated,
the symmetries are used to generate as many as possible elements of the 2DTE
from those already computed.</p>
<p><strong>Symmetry finder mode</strong> (Default mode).
If  <strong>nsym</strong>  is 0, all the atomic coordinates must be explicitly given (one
cannot use the atom manipulator neither the smart symmetrizer): the code will
then find automatically the symmetry operations that leave the lattice and
each atomic sublattice invariant. It also checks whether the cell is primitive
(see <a class="wikilink codevar-wikilink" href="/variables/gstate#chkprim">chkprim</a>).
Note that the tolerance on symmetric atomic positions and lattice is rather
stringent: for a symmetry operation to be admitted, the lattice and atomic
positions must map on themselves within 1.0e-8.</p>
<p>The user is allowed to set up systems with non-primitive unit cells (i.e.
conventional FCC or BCC cells, or supercells without any distortion). In this
case, pure translations will be identified as symmetries of the system by the
symmetry finder. Then, the combined &ldquo;pure translation + usual rotation and
inversion&rdquo; symmetry operations can be very numerous. For example, a
conventional FCC cell has 192 symmetry operations, instead of the 48 ones of
the primitive cell. A maximum limit of 384 symmetry operations is hard-coded.
This corresponds to the maximum number of symmetry operations of a 2x2x2
undistorted supercell. Going beyond that number will make the code stop very
rapidly. If you want nevertheless, for testing purposes, to treat a larger
number of symmetries, change <a class="wikilink codevar-wikilink" href="/variables/dev#maxnsym">maxnsym</a>.</p>
<p>For GW calculation, the user might want to select only the symmetry operations
whose non-symmorphic translation vector <a class="wikilink codevar-wikilink" href="/variables/basic#tnons">tnons</a> is zero. This can be done
with the help of the input variable <a class="wikilink codevar-wikilink" href="/variables/dev#symmorphi">symmorphi</a></p>
<h2 id="ntypat"><strong>ntypat</strong><a class="headerlink" href="#ntypat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of TYPes of AToms<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the types of atoms that form the system" data-toggle="popover" href="/topics/AtomTypes">topic_AtomTypes</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to master the use of norm-conserving pseudopotentials and PAW atomic data, and their consequences" data-toggle="popover" href="/topics/PseudosPAW">topic_PseudosPAW</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1210/1245] in all abinit tests, [147/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=6 and tsmear=0.05.
Designed to test the treatment of metals,
with the Gaussian-Hermite smearing of Methfessel and Paxton.
Also test the use of fband instead of nband." data-toggle="popover" href="/tests/v1/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the number of types of atoms in the unit cell.
E.g. for a homopolar system (e.g. pure Si) <strong>ntypat</strong> is 1.</p>
<p>The code tries to read the same number of pseudopotential files. The first
pseudopotential is assigned type number 1, and so on&hellip;</p>
<p>There is an exception in the case of alchemical mixing of potentials. In this case,
the number of atomic types will differ from the number of pseudopotentials.
See <a class="wikilink codevar-wikilink" href="/variables/gstate#mixalch">mixalch</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#npsp">npsp</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#ntypalch">ntypalch</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#npspalch">%npspalch</a>.</p>
<h2 id="occopt"><strong>occopt</strong><a class="headerlink" href="#occopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OCCupation OPTion<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify bands and occupation numbers, for metals or insulators" data-toggle="popover" href="/topics/BandOcc">topic_BandOcc</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to obtain a Scanning Tunneling Microscopy map" data-toggle="popover" href="/topics/STM">topic_STM</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [662/1245] in all abinit tests, [75/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si single atom with fractional occupation." data-toggle="popover" href="/tests/bigdft/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Pt single atom with semi-core electrons, Krack pseudopotentials (pspcod = 10),
and colinear spin polarisation (GGA functional)." data-toggle="popover" href="/tests/bigdft/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Oxygen atom
Test a few functionals for which HGH pseudopotentials are available (from M. Krack),
that are present also in the lib XC, but not in the native ABINIT set of functionals." data-toggle="popover" href="/tests/libxc/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Total energy vs. cell size for bulk FCC aluminium, to compare with the
PSML results of t08 and t12" data-toggle="popover" href="/tests/psml/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Al fcc metal - elastic constant calculation" data-toggle="popover" href="/tests/tutorespfn/Input/telast_6.abi" target="_blank">telast_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
the sequence of datasets makes the ground states and
all of the explicit perturbations of the single
Al atom in all directions, for the irreducible
qpoints in a 2x2x2 grid.
Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_1.abi" target="_blank">teph_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_5.abi" target="_blank">teph4mob_5.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H atom in a big box
Same file as tbase1_1.abi, except that natom, typat, and xcart were changed,
and that the input variables nband, nsppol, occ and occopt are used." data-toggle="popover" href="/tests/tutorial/Input/tbase1_5.abi" target="_blank">tbase1_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom." data-toggle="popover" href="/tests/tutorial/Input/tbase2_1.abi" target="_blank">tbase2_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom.
Here, a double loop has been used." data-toggle="popover" href="/tests/tutorial/Input/tbase2_2.abi" target="_blank">tbase2_2.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj to test restarxf -1" data-toggle="popover" href="/tests/v10/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj restarting from HIST file using restarxf -1" data-toggle="popover" href="/tests/v10/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Yb (1 atom per unit cell),
using a l=3 psp with s local part.
Crazy cut-off and number of k points.
Shows that the derivative of the eigenenergies
with respect to the wavevector can be obtained
both by finite differences and analytical means
(from a preliminary computation in the
treatment of the ddk perturbation).
For the (0.25,0.25,0.25) k point,
the tenth band eigenvalue is -3.01209 eV.
Going to the (0.251,0.251,0.251) k point
it becomes -3.00562 eV, with finite-difference
estimation of the derivative with respect
to ONE wavevector change (all three
components changed) being 0.00647 eV/0.001/3=2.157 eV
This value is unchanged when using the
data at the (0.253,0.253,0.253) k point.
The analytical value is 2.15566 eV." data-toggle="popover" href="/tests/v3/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-toggle="popover" href="/tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
</ul>
</details>
<p>Controls how input parameters <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#occ">occ</a>, and <a class="wikilink codevar-wikilink" href="/variables/basic#wtk">wtk</a> are handled.
Possible values are from 0 to 9.
For gapped materials (semiconductors, molecules, &hellip;),  <strong>occopt</strong> =1 is the favourite for most usages.
For metallic situations (also molecules with degenerate levels at Fermi energy),  <strong>occopt</strong> =7 is the favourite for most usages,
and one needs moreover to control the input variable <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a>.
Use  <strong>occopt</strong> =9 for quasi-Fermi energy calculations of excited states in gapped materials.</p>
<ul>
<li>
<p><strong>occopt</strong>  = 0:
All k points and spins have the same number of bands. All k points have the same occupancies of bands for a given spin
(but these occupancies may differ for spin up and spin down - typical for ferromagnetic insulators).
<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> is given as a single number, and <a class="wikilink codevar-wikilink" href="/variables/gstate#occ">occ</a>(<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> * <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>) is an array of
<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> * <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> elements, read in by the code.
The k point weights in array <a class="wikilink codevar-wikilink" href="/variables/basic#wtk">wtk</a>(<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>) are automatically normalized by
the code to add to 1. They cannot differ for differing spins.</p>
</li>
<li>
<p><strong>occopt</strong>  = 1:
Same as  <strong>occopt</strong>  = 0, except that the array <a class="wikilink codevar-wikilink" href="/variables/gstate#occ">occ</a> is automatically generated
by the code, to give a semiconductor.
An error occurs when filling cannot be done with occupation numbers equal to 2
or 0 in each k-point (non-spin-polarized case), or with occupation numbers
equal to 1 or 0 in each k-point (spin-polarized case). If <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2 and
 <strong>occopt</strong>  == 1 is used, the user has to impose the magnetization, using
<a class="wikilink codevar-wikilink" href="/variables/ffield#spinmagntarget">spinmagntarget</a>, except for the case of a single isolated Hydrogen atom.
Unfortunately, for the time being, in response function calculations,
only <a class="wikilink codevar-wikilink" href="/variables/ffield#spinmagntarget">spinmagntarget</a>=0.0d0 or equal to the default value is allowed.</p>
</li>
<li>
<p><strong>occopt</strong>  = 2:
k points may optionally have different numbers of bands and different
occupancies. <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>(<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a> * <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a>) is given explicitly as an array of
<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a> * <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> elements. <a class="wikilink codevar-wikilink" href="/variables/gstate#occ">occ</a>() is given explicitly for all bands at
each k point, and possibly for each spin &ndash; the total number of elements is
the sum of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>(ikpt) over all k points and spins. The k point weights
<a class="wikilink codevar-wikilink" href="/variables/basic#wtk">wtk</a> (<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>) are NOT automatically normalized under this option.</p>
</li>
<li>
<p><strong>occopt</strong>  = 3 to 8 :
Metallic occupation of levels, using different occupation schemes (see below).
See the review of the different possibilities in <a class="wikilink citation-wikilink" data-tippy-content="Fermi energy determination for advanced smearing techniques" data-toggle="popover" href="/theory/bibliography#santos2023">[Santos2023]</a>, that
delivers a nice pedagogical explanation of these.
The corresponding thermal broadening, or cold smearing, is defined by the
input variable <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a> (see below: the variable <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> is the chemical potential minus the energy in Ha,
divided by <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a>).
Like for  <strong>occopt</strong>  = 1, the variable <a class="wikilink codevar-wikilink" href="/variables/gstate#occ">occ</a> is not read.
All k points have the same number of bands, <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> is given as a single
number, read by the code.
The k point weights in array <a class="wikilink codevar-wikilink" href="/variables/basic#wtk">wtk</a>(<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>) are automatically normalized by
the code to add to 1. The combination of a broadening and a physical temperature
can be obtained by using both <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#tphysel">tphysel</a>.</p>
<ul>
<li>
<p><strong>occopt</strong>  = 3:
Fermi-Dirac smearing (finite-temperature metal). Smeared delta function:
<span><span class="MathJax_Preview">\tilde{\delta}(x)=(2\cosh(x/2))^{-2}=(\exp(x/2)+\exp(-x/2))^{-2}=(2\cosh(x)+2)^{-1}</span><script type="math/tex">\tilde{\delta}(x)=(2\cosh(x/2))^{-2}=(\exp(x/2)+\exp(-x/2))^{-2}=(2\cosh(x)+2)^{-1}</script></span>.
For usual calculations, at zero temperature, do not use  <strong>occopt</strong> =3,
but  <strong>occopt</strong> =7. If you want to do a calculation at finite temperature, please also read the
information about <a class="wikilink codevar-wikilink" href="/variables/gstate#tphysel">tphysel</a>.</p>
</li>
<li>
<p><strong>occopt</strong>  = 4:
&ldquo;Cold smearing&rdquo; of N. Marzari (see his thesis work), with a=-.5634
(minimization of the bump).
Smeared delta function:
<span><span class="MathJax_Preview">\tilde{\delta}(x)= (1.5+x(-1.5a+x(-1.0+ax))) \exp(-x^2)/\sqrt{\pi}</span><script type="math/tex">\tilde{\delta}(x)= (1.5+x(-1.5a+x(-1.0+ax))) \exp(-x^2)/\sqrt{\pi}</script></span> .
Must be used with caution, see the note below.</p>
</li>
<li>
<p><strong>occopt</strong>  = 5:
&ldquo;Cold smearing&rdquo; of N. Marzari (see his thesis work), with a=-.8165 (monotonic
function in the tail).
Same smeared delta function as  <strong>occopt</strong>  = 4, with different a.
Must be used with caution, see the note below.</p>
</li>
<li>
<p><strong>occopt</strong>  = 6:
Smearing of Methfessel and Paxton <a class="wikilink citation-wikilink" data-tippy-content="High-precision sampling for Brillouin-zone integration in metals" data-toggle="popover" href="/theory/bibliography#methfessel1989">[Methfessel1989]</a> with Hermite polynomial
of degree 2, corresponding to &ldquo;Cold smearing&rdquo; of N. Marzari with a=0 (so, same
smeared delta function as  <strong>occopt</strong>  = 4, with different a).
Must be used with caution, see the note below.</p>
</li>
<li>
<p><strong>occopt</strong>  = 7:
Gaussian smearing, corresponding to the 0-order Hermite polynomial of
Methfessel and Paxton.
Smeared delta function: <span><span class="MathJax_Preview">\tilde{\delta}(x)=\exp(-x^2)/\sqrt{\pi}</span><script type="math/tex">\tilde{\delta}(x)=\exp(-x^2)/\sqrt{\pi}</script></span> .
Robust and quite efficient.</p>
</li>
<li>
<p><strong>occopt</strong>  = 8:
Uniform smearing (the delta function is replaced by a constant function of
value one over ]-&frac12;,&frac12;[ (with one-half value at the boundaries). Used for
testing purposes only.</p>
</li>
</ul>
</li>
<li>
<p><strong>occopt</strong>  = 9:
Fermi-Dirac occupation is enforced with two distinct quasi-Fermi levels: <a class="wikilink codevar-wikilink" href="/variables/gstate#nqfd">nqfd</a> holes are forced in bands 1 to <a class="wikilink codevar-wikilink" href="/variables/gstate#ivalence">ivalence</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#nqfd">nqfd</a> electrons are forced in bands with index &gt; <a class="wikilink codevar-wikilink" href="/variables/gstate#ivalence">ivalence</a>. See details in <a class="wikilink citation-wikilink" data-tippy-content="Photoinduced Phase Transitions in Ferroelectrics" data-toggle="popover" href="/theory/bibliography#paillard2019">[Paillard2019]</a>. At present, the number of holes and electrons should be the same. Note that  <strong>occopt</strong>  = 9 cannot be used with fixed magnetization calculation.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One can use metallic occupation of levels in the case of a molecule,
in order to avoid any problem with degenerate levels. However, it is advised
NOT to use  <strong>occopt</strong>  = 6 (and to a lesser extent  <strong>occopt</strong>  = 4 and 5), since the
associated number of electron versus the Fermi energy is NOT guaranteed to be
a monotonic function. For true metals, AND a sufficiently dense sampling of
the Brillouin zone, this should not happen, but be cautious ! As an indication
of this problem, a small variation of input parameters might lead to a jump of
total energy, because there might be two or even three possible values of the
Fermi energy, and the bisection algorithm finds one or the other.
See a more detailed explanation in <a class="wikilink citation-wikilink" data-tippy-content="Fermi energy determination for advanced smearing techniques" data-toggle="popover" href="/theory/bibliography#santos2023">[Santos2023]</a>.</p>
</div>
<h2 id="rprim"><strong>rprim</strong><a class="headerlink" href="#rprim" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Real space PRIMitive translations<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">EVOLVING</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the unit cell" data-toggle="popover" href="/topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,3)<br />
<em>Commentdims:</em> Internally, it is represented as rprim(3,3,<a class="wikilink codevar-wikilink" href="/variables/rlx#nimage">nimage</a>)<br />
<em>Default value:</em> [[1, 0, 0], [0, 1, 0], [0, 0, 1]]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1000/1245] in all abinit tests, [130/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
KSS file generation for silicon with a different number of bands in the KSS
computation compared to ground-state." data-toggle="popover" href="/tests/etsf_io/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Carbon atom
Test the Becke-Johnson mGGA functional, generating directly XC potentials.
Convergence parameters are quite high, and the test is reasonably portable.
To make the test more portable, we generate GGA-PBE wave functions as starting point." data-toggle="popover" href="/tests/libxc/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
To make the test more portable, we generate GGA-PBE wave functions as starting point." data-toggle="popover" href="/tests/libxc/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the `structure` variable used to specify the crystalline structure
without having to enter explicitly natom, ntypat, typat and znucl.
Different options are tested. Initialize structure from:

1) An external POSCAR file with symbols (VASP5 format)
2) An external netcdf file produced by Abinit.
3) An external txt file with Abinit variables.

Test also the prefix variables that replace the old files file." data-toggle="popover" href="/tests/v9/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 06 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 08 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Give the three dimensionless primitive translations in
real space, to be rescaled by <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>.
The three first numbers are the coordinates of the first vector, the next three numbers are the coordinates
of the second, and the last three the coordinates of the third.
It is <a class="wikilink" href="/guide/abinit#parameters">EVOLVING</a> only if <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a> == 2 or 22 and <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a>/=0, otherwise it is fixed.</p>
<p>If the Default is used, that is, <strong>rprim</strong> is the unity matrix, the three
dimensionless primitive vectors are three unit vectors in cartesian
coordinates. The coordinates (and hence the length) of each vector will be (possibly)
multiplied by the corresponding <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a> value, then (possibly) stretched along the
cartesian coordinates by the corresponding <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a> value, to give the dimensional primitive vectors, called <a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>.</p>
<p>In the general case, the dimensional cartesian coordinates of the crystal
primitive translations R1p, R2p and R3p, see <a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>, are</p>
<ul>
<li>R1p(i) = <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>(i) x  <strong>rprim</strong> (i,1) x <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(1)</li>
<li>R2p(i) = <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>(i) x  <strong>rprim</strong> (i,2) x <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(2)</li>
<li>R3p(i) = <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>(i) x  <strong>rprim</strong> (i,3) x <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(3)</li>
</ul>
<p>where i=1,2,3 is the component of the primitive translation (i.e. x, y, and z).</p>
<p>The  <strong>rprim</strong>  variable, scaled by <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>, is thus used to define
directions of the primitive vectors, that will be multiplied (so keeping the
direction unchanged) by the appropriate length scale <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(1),
<a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(2), or <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(3), respectively to give the dimensional primitive
translations in real space in cartesian coordinates.
Presently, it is requested that the mixed product (R1xR2).R3 is positive. If
this is not the case, simply exchange a pair of vectors.</p>
<p>To be more specific, keeping the default value of <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a> = 1 to simplify
the matter,  <strong>rprim</strong>  1 2 3 4 5 6 7 8 9 corresponds to input of the three
primitive translations R1=(1,2,3) (to be multiplied by <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(1)),
R2=(4,5,6) (to be multiplied by <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(2)), and R3=(7,8,9) (to be
multiplied by <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(3)).
Note carefully that the first three numbers input are the first column of
 <strong>rprim</strong> , the next three are the second, and the final three are the third.
This corresponds with the usual Fortran order for arrays. The matrix whose
columns are the reciprocal space primitive translations is the inverse
transpose of the matrix whose columns are the direct space primitive
translations.</p>
<p>Alternatively to  <strong>rprim</strong> , directions of dimensionless primitive vectors can
be specified by using the input variable <a class="wikilink codevar-wikilink" href="/variables/basic#angdeg">angdeg</a>. This is especially useful
for hexagonal lattices (with 120 or 60 degrees angles). Indeed, in order for
symmetries to be recognized, rprim must be symmetric up to <a class="wikilink codevar-wikilink" href="/variables/geo#tolsym">tolsym</a> (1.0e-5 by default),
inducing a specification such as</p>
<div class="codehilite"><pre><span></span><code>  rprim  0.86602  0.5  0.0
        -0.86602  0.5  0.0
         0.0      0.0  1.0
</code></pre></div>

<p>that can be avoided thanks to <a class="wikilink codevar-wikilink" href="/variables/basic#angdeg">angdeg</a>:</p>
<div class="codehilite"><pre><span></span><code>  angdeg 90 90 120
</code></pre></div>

<p>Note that the following might work as well:</p>
<div class="codehilite"><pre><span></span><code>  rprim  sqrt(0.75)  0.5  0.0
        -sqrt(0.75)  0.5  0.0
         0.0         0.0  1.0
</code></pre></div>

<p>Although the use of <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a> is rather equivalent when the
primitive vectors are aligned with the cartesian directions, it is not the
case for non-orthogonal primitive vectors. In particular, beginners often make
the error of trying to use <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a> to define primitive vectors in face-
centered tetragonal lattice, or body-centered tetragonal lattice, or similarly
in face or body-centered orthorhombic lattices. Let us take the example of a
body-centered tetragonal lattice, that might be defined using the following
(&ldquo;a&rdquo; and &ldquo;c&rdquo; have to be replaced by the appropriate conventional cell vector length):</p>
<div class="codehilite"><pre><span></span><code>  rprim  &quot;a&quot;      0        0
          0      &quot;a&quot;       0
         &quot;a/2&quot;   &quot;a/2&quot;    &quot;c/2&quot;
acell 3*1     scalecart 3*1    !  ( These are default values)
</code></pre></div>

<p>The following is a valid, alternative way to define the same primitive vectors:</p>
<div class="codehilite"><pre><span></span><code>  rprim   1        0       0
          0        1       0
          1/2      1/2     1/2
scalecart  &quot;a&quot;  &quot;a&quot;  &quot;c&quot;
acell 3*1    !  ( These are default values)
</code></pre></div>

<p>Indeed, the cell has been stretched along the cartesian coordinates, by &ldquo;a&rdquo;,
&ldquo;a&rdquo; and &ldquo;c&rdquo; factors.</p>
<p>At variance, the following is <strong>WRONG</strong>:</p>
<div class="codehilite"><pre><span></span><code>  rprim   1       0       0
          0       1       0
          1/2     1/2     1/2
acell  &quot;a&quot;  &quot;a&quot;  &quot;c&quot;    !   THIS IS WRONG
scalecart 3*1    !  ( These are default values)
</code></pre></div>

<p>Indeed, the latter would correspond to:</p>
<div class="codehilite"><pre><span></span><code>  rprim  &quot;a&quot;      0       0
          0      &quot;a&quot;      0
         &quot;c/2&quot;   &quot;c/2&quot;   &quot;c/2&quot;
acell 3*1     scalecart 3*1    !  ( These are default values)
</code></pre></div>

<p>Namely, the third vector has been rescaled by &ldquo;c&rdquo;. It is not at all in the
center of the tetragonal cell whose basis vectors are defined by the scaling factor &ldquo;a&rdquo;.
As another difference between <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>, note that
<a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a> is <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a>: its content will be immediately applied to
rprim, at parsing time, and then scalecart will be set to the default values
(3*1). So, in case <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a> is used, the echo of  <strong>rprim</strong>  in the output
file is not the value contained in the input file, but the value rescaled by <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>.</p>
<h2 id="rprimd"><strong>rprimd</strong><a class="headerlink" href="#rprimd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Real space PRIMitive translations, Dimensional<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INTERNAL_ONLY</a>, <a class="wikilink" href="/guide/abinit#parameters">EVOLVING</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the unit cell" data-toggle="popover" href="/topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,3)<br />
<em>Commentdims:</em> Internally, it is represented as rprimd(3,3,<a class="wikilink codevar-wikilink" href="/variables/rlx#nimage">nimage</a>).<br />
<em>Default value:</em> None<br />
<em>Added in version:</em> before_v9  </p>
<p>This internal variable gives the dimensional real space primitive vectors,
computed from <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>, and <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>.</p>
<ul>
<li>R1p(i) =  <strong>rprimd</strong> (i,1) = <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>(i) x <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>(i,1) x <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(1) for i=1,2,3 (x,y,and z)</li>
<li>R2p(i) =  <strong>rprimd</strong> (i,2) = <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>(i) x <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>(i,2) x <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(2) for i=1,2,3</li>
<li>R3p(i) =  <strong>rprimd</strong> (i,3) = <a class="wikilink codevar-wikilink" href="/variables/basic#scalecart">scalecart</a>(i) x <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>(i,3) x <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>(3) for i=1,2,3</li>
</ul>
<p>It is <a class="wikilink" href="/guide/abinit#parameters">EVOLVING</a> only if <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a> == 2 or 22 and <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a>/=0, otherwise it is fixed.</p>
<h2 id="scalecart"><strong>scalecart</strong><a class="headerlink" href="#scalecart" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SCALE CARTesian coordinates<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the unit cell" data-toggle="popover" href="/topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Set of Hydrogen atoms in a body-centered, or face-centered tetragonal, of body-centered orthorhombic lattice.
This is to test the scalecart input variable." data-toggle="popover" href="/tests/v6/Input/t16.abi" target="_blank">t16.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization." data-toggle="popover" href="/tests/v8/Input/t95.abi" target="_blank">t95.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization.
At present DS31 and DS32 do not work as expected ..." data-toggle="popover" href="/tests/v8/Input/t96.abi" target="_blank">t96.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization.
At present DS21, 31 and 32 do not work as expected. Hence the huge tolerance." data-toggle="popover" href="/tests/v8/Input/t97.abi" target="_blank">t97.abi</a></li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a></li>
</ul>
</details>
<p>Gives the scaling factors of cartesian coordinates by which dimensionless
primitive translations (in &ldquo;<a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>&rdquo;) are to be multiplied.
See the <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a> input
variable, the <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a> input variable, and the associated internal <a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>
internal variable.
Especially useful for body-centered and face-centered tetragonal lattices, as
well as body-centered and face-centered orthorhombic lattices, see <a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>.
Note that this input variable is <a class="wikilink" href="/guide/abinit#parameters">INPUT_ONLY</a>: its content will be
immediately applied to rprim, at parsing time, and then scalecart will be set
to the default values. So, it will not be echoed.</p>
<h2 id="shiftk"><strong>shiftk</strong><a class="headerlink" href="#shiftk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SHIFT for K points<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a>)<br />
<em>Default value:</em> None if <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a>&gt;1,
[0.5, 0.5, 0.5] otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [697/1245] in all abinit tests, [111/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands." data-toggle="popover" href="/tests/built-in/Input/testin_wannier90.abi" target="_blank">testin_wannier90.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
KSS file generation for silicon with a different number of bands in the KSS
computation compared to ground-state." data-toggle="popover" href="/tests/etsf_io/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure writting the KB form factors to output. This is a two data set run,
the first dataset being a ground state calculation and the writes the WFs + KB form factors" data-toggle="popover" href="/tests/etsf_io/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (stresses), using GEMM nonlop.
Related tests: v8 t83 and gpu_omp t21 ." data-toggle="popover" href="/tests/gpu_omp/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 with GPU, norm conserving, from LibXC" data-toggle="popover" href="/tests/gpu_omp/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond. Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
To make the test more portable, we generate GGA-PBE wave functions as starting point." data-toggle="popover" href="/tests/libxc/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Argon solid, experimental lattice parameter.
Realistic parameters are used (ecut=20, ngkpt=2x2x2 shifted 4 times, but centered on Gamma).
Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
The LDA gap is observed at Gamma : 8.071 eV, is in reasonable agreement with the gap from the TB paper PRL 102, 226401 (2009),
where it is mentioned to be 8.16 eV.
The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV.
The reading of the kinetic energy density, to start a non-SCF calculation is not yet implemented,
as of ABINITv6.12.0 .
This test was used to examine the speed of the convergence in case of elongated cells, up to 16 atoms.
The mGGA convergence was found to be similar to the LDA convergence.
Also, test non-self-consistent mGGA calculation, with reading of the previously produced _DEN and _KDEN files." data-toggle="popover" href="/tests/libxc/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell.
Testing temperature-dependent libxc functionals.
Several XC functionals, several electronic temperatures." data-toggle="popover" href="/tests/libxc/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Total energy vs. cell size for bulk FCC aluminium, to compare with the
PSML results of t08 and t12" data-toggle="popover" href="/tests/psml/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline silicon: computation of the total energy" data-toggle="popover" href="/tests/tutorial/Input/tbase3_1.abi" target="_blank">tbase3_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon: computation of the total energy
This input file will NOT work: nkpt does not agree
with ngkpt and shiftk. The error message will be given
in the &quot;log&quot; file." data-toggle="popover" href="/tests/tutorial/Input/tbase3_2.abi" target="_blank">tbase3_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : computation of the total energy
Convergence with respect to the number of k points." data-toggle="popover" href="/tests/tutorial/Input/tbase3_3.abi" target="_blank">tbase3_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al2O3 cell in rhombohedric cell with different axes.
Dataset 1 : Rhombohedral axes; full set of symmetries and full set of atoms
Dataset 2 : Rhombohedral axes; irreducible unit cell and space group
Dataset 3 : Hexagonal axes; irreducible unit cell and space group
Dataset 4 : Hexagonal axes; full unit cell and space group
The results are equivalent for Dataset 1 and 2 and Dataset 3 and 4." data-toggle="popover" href="/tests/v1/Input/t96.abi" target="_blank">t96.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Helium q close to Gamma, along Gamma-H
There is a problem with kptopt=1 or 3 for the NSC step." data-toggle="popover" href="/tests/v2/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 28. The chosen grid (too coarse, though) is
(0 0 0), (1/4 1/4 0), (1/2 1/2 0), (1/2 0 0),
(1/2 1/4 1/4), (1/2 -1/4 1/4)  (in reduced coordinates).
The ecut and nkpt parameters are really too low (see test 28),
but parameters suitable for physical results (see test 29)
are also provided in the input files." data-toggle="popover" href="/tests/v2/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for GaAs (zinc-blende).
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 32. The chosen grid (too coarse, though) has only two
special q points : 1/4 1/4 1/4 and 1/4 1/2 1/2 (in reduced coordinates).
The Gamma point is also needed, especially for the computation of
dielectric matric and effective charges, needed to get the asymptotic
behaviour of the interatomic force constants. To generate
the different responses, the following steps are followed,
with each of them corresponding to a different dataset (the multi-dataset
mode allows to have only one input file) :
1) ground state calculation, with a k-point sampling in the irreducible
Brillouin zone only;
2) using the density of 1), computation of the wavefunctions for the
grid of k-points in the full Brillouin zone; (not really needed in v3.0)
3) computation of the ddk response, in preparation to the electric field
response ;
4) computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
5) using the density of 1), computation of the GS wavefunctions
at k+q where q is 1/4 1/4 1/4 ;
6) computation of the dynamical matrix at 1/4 1/4 1/4 ;
7) using the density of 1), computation of the GS wavefunctions
at k+q where q is 1/4 1/2 1/2 ;
8) computation of the dynamical matrix at 1/4 1/2 1/2 ." data-toggle="popover" href="/tests/v2/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si crystal. GGA + non-linear XC core correction.
Compute the interatomic force constant for the displacement of the second atom along (111).
RF calculation of the 2DTE gives 7.51663417 Ha
while finite differences gives: with delta(xred)=0.0001, 7.15663267 Ha.
The agreement is quite good, and might likely be improved by combining finite differences.
Also compute the ddk and electric field responses. The number of k points is much too small to
obtain physical values, but are quite comparable to the result of test v2 #6" data-toggle="popover" href="/tests/v3/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-toggle="popover" href="/tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-toggle="popover" href="/tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in BCC structure. Low cut-offs and few k-points.
This test is done within GGA and (ferro-)magnetism in PAW formalism.
The same job is done twice with two differents PAW datasets.
First PAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed analytically.
SecondPAW dataset is Fe with a &quot;Bessel&quot; compensation charge
shape function expressed numerically." data-toggle="popover" href="/tests/v4/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in HCP structure. Low cut-offs and few k-points.
This test is done within GGA and no magnetism in PAW formalism.
The same job is done twice with two differents values of mkmem." data-toggle="popover" href="/tests/v4/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate both DEN and PAWDEN files for silicon. Note that in the PAW case, DEN files
include the valence density and compensation charge, while PAWDEN files include the
valence and on-site corrections, but not the compensation charge. Therefore, DEN files are
needed for further computations, while PAWDEN files are useful for visualization, AIM, and other
post-processing of the density.
PAW AE DEN not compatible with parallelization over atoms." data-toggle="popover" href="/tests/v5/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen dimer in a big cell.
Produce different files (_DEN, _POT, _VHXC, _VHA), for subsequent analysis by CUT3D (see next run).
Note the following values, that will allow to check the correctness of the subsequent analysis :
Kinetic energy  =  1.02998395409183E+00
Hartree energy  =  8.05073794254872E-01
Loc. psp. energy= -2.53949740885919E+00
Band energy (Ha)=  -7.2732761066E-01
Also, the mean of the Vxc potential is announced to be
Average Vxc (hartree)=  -0.05293" data-toggle="popover" href="/tests/v6/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl molecule in a big box.
Test of the computation of the polarisation with the routine berryphase_new,
for different k-point grids : only 1 k-point, a line of k-points, and a full mesh of k-points.
Results with acell 20 10 10 are : -9.727 C/m^2, -9.975 C/m^2, -9.503 C/m^2
multiplied by the volume (in a.u.), gives -19454, -19950, -19006
Test provided by S. Leroux
Going to bigger cells make these results converge to the same value :
Results with acell 30 20 20 are : -1.771 C/m^2, -1.746 C/m^2, -1.747 C/m^2
multiplied by the volume (in a.u.), gives -21252, -20952, -20964
Results with acell 40 20 20 are : -1.3167C/m^2, -1.3057C/m^2, -1.3062C/m^2
multiplied by the volume (in a.u.), gives -21067, -20891, -20899
Results with acell 50 20 20 are : -1.0502C/m^2, -1.0444C/m^2, -1.0450C/m^2
multiplied by the volume (in a.u.), gives -21004, -20888, -20900" data-toggle="popover" href="/tests/v6/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-toggle="popover" href="/tests/v6/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>It is used only when <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> &gt;= 0, and must be defined if <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> is
larger than 1.
 <strong>shiftk</strong> (1:3,1:<a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a>) defines <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> shifts of the homogeneous
grid of k points based on <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a>.
The shifts induced by  <strong>shiftk</strong>  corresponds to the reduced coordinates in the
coordinate system defining the k-point lattice. For example, if the k point
lattice is defined using <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>, the point whose reciprocal space reduced
coordinates are (  <strong>shiftk</strong> (1,ii)/<a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>(1)  <strong>shiftk</strong> (2,ii)/<a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>(2)
 <strong>shiftk</strong> (3,ii)/<a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>(3) ) belongs to the shifted grid number ii.</p>
<p>The user might rely on ABINIT to suggest suitable and efficient combinations
of <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlatt">kptrlatt</a> and  <strong>shiftk</strong> . The procedure to be followed is described with
the input variables <a class="wikilink codevar-wikilink" href="/variables/gstate#kptrlen">kptrlen</a>. In what follows, we suggest some interesting
values of the shifts, to be used with even values of <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>. This list is
much less exhaustive than the above-mentioned automatic procedure.</p>
<p>1) The default (shifted) Monkhorst-Pack grids are formed by using
<a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> = 1 and  <strong>shiftk</strong>  0.5 0.5 0.5. This is often the preferred k point
sampling, as the shift improves the sampling efficiency with respect
to the other simple (non-shifted) possibility <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> = 1 and  <strong>shiftk</strong>  0.0 0.0 0.0.
There are other interesting possibilities for FCC, BCC and HCP lattices, see later.
However, this default can also break symmetry, if the 111 direction
is not an axis of rotation. This happens e.g. in tetragonal or hexagonal systems.
Abinit will complain about this breaking, and
you should adapt  <strong>shiftk</strong> .
Easy back-up : use <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> = 1 and  <strong>shiftk</strong>  0.0 0.0 0.0,
to get a non-shifted Monkhorst-Pack grid, which will be compatible with all
symmetries, and is necessary for some features such as k-point interpolation.</p>
<p>2) When the primitive vectors of the lattice form a FCC lattice, with <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a></p>
<div class="codehilite"><pre><span></span><code>  0.0 0.5 0.5
  0.5 0.0 0.5
  0.5 0.5 0.0
</code></pre></div>

<p>the (very efficient) usual Monkhorst-Pack sampling will be generated by using
<a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> =  4 and  <strong>shiftk</strong> </p>
<div class="codehilite"><pre><span></span><code>  0.5 0.5 0.5
  0.5 0.0 0.0
  0.0 0.5 0.0
  0.0 0.0 0.5
</code></pre></div>

<p>3) When the primitive vectors of the lattice form a BCC lattice, with <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a></p>
<div class="codehilite"><pre><span></span><code>  -0.5  0.5  0.5
   0.5 -0.5  0.5
   0.5  0.5 -0.5
</code></pre></div>

<p>the usual Monkhorst-Pack sampling will be generated by using <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> =  2
and  <strong>shiftk</strong> </p>
<div class="codehilite"><pre><span></span><code>  0.25  0.25  0.25
 -0.25 -0.25 -0.25
</code></pre></div>

<p>However, the simple sampling <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> = 1 and  <strong>shiftk</strong>  0.5 0.5 0.5 is excellent.</p>
<p>4) For hexagonal lattices with hexagonal axes, e.g. <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a></p>
<div class="codehilite"><pre><span></span><code>  1.0  0.0       0.0
 -0.5  sqrt(3)/2 0.0
  0.0  0.0       1.0
</code></pre></div>

<p>one can use <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> =  1 and  <strong>shiftk</strong>  0.0 0.0 0.5</p>
<h2 id="structure"><strong>structure</strong><a class="headerlink" href="#structure" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> initialize the crystalline STRUCTURE from &hellip;<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> string<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [306/1245] in all abinit tests, [46/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure writting the KB form factors to output. This is a two data set run,
the first dataset being a ground state calculation and the writes the WFs + KB form factors" data-toggle="popover" href="/tests/etsf_io/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as 03 but run with newer Troullier-Martins psp
with core density PseudosTM_pwteter/14si.pspnc.  Start from wf.03 and run irdwfk=1.
Also iterated to convergence." data-toggle="popover" href="/tests/fast/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Restart 05 with wf.05 (irdwfk=1).  Instant convergence." data-toggle="popover" href="/tests/fast/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with GWR code.
Test symmetrization with time-reversal and umklapp g0 vectors" data-toggle="popover" href="/tests/gwr/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with GWR code.
Test symmetrization with time-reversal and umklapp g0 vectors
Similar to t05.abi but here Sigma is computed with convolutions in k-space." data-toggle="popover" href="/tests/gwr/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon solid, experimental lattice parameter.
Realistic parameters are used (ecut=20, ngkpt=2x2x2 shifted 4 times, but centered on Gamma).
Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson).
The LDA gap is observed at Gamma : 8.071 eV, is in reasonable agreement with the gap from the TB paper PRL 102, 226401 (2009),
where it is mentioned to be 8.16 eV.
The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV.
The reading of the kinetic energy density, to start a non-SCF calculation is not yet implemented,
as of ABINITv6.12.0 .
This test was used to examine the speed of the convergence in case of elongated cells, up to 16 atoms.
The mGGA convergence was found to be similar to the LDA convergence.
Also, test non-self-consistent mGGA calculation, with reading of the previously produced _DEN and _KDEN files." data-toggle="popover" href="/tests/libxc/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Testing TB09 XC functional within PAW approach.
Cristalline silicon
Also testing the following variables:
- xc_taupos : filtering of the kinetic energy density
- getkden   : read KE density from previous dataset
- irdkden   : read KE density from an external file" data-toggle="popover" href="/tests/libxc/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Testing TB09 XC functional within PAW approach.
Cristalline silicon
Also testing the following variables:
- xc_taupos : filtering of the kinetic energy density
- getkden   : read KE density from previous dataset
- irdkden   : read KE density from an external file" data-toggle="popover" href="/tests/libxc/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure" data-toggle="popover" href="/tests/psml/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure" data-toggle="popover" href="/tests/psml/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant by two different techniques" data-toggle="popover" href="/tests/seq/Input/tsv3_05.abi" target="_blank">tsv3_05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs, zinc-blende structure.
Finite electric field calculation
In order to perform a first-principles calculation in an electric
field, the wavefunctions must be initialized properly. Therefore,
I do first a GS calculation to obtain the WF in the whole BZ under
zero electric field. Then, I increase the electric field slowly in
successive datasets. The calculation for each dataset is initialized
using the WF of a previous one.
I consider both positive and negative electric fields.
WARNING : HAS BEEN TRANSFERRED TO tests/seq" data-toggle="popover" href="/tests/seq/Input/tsv4_78.abi" target="_blank">tsv4_78.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wannier90 interface with NC pseudopotentials" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_4.abi" target="_blank">tw90_4.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon

Computation of the band structure.
First, a SCF density computation, then a non-SCF band structure calculation." data-toggle="popover" href="/tests/tutorial/Input/tbase3_5.abi" target="_blank">tbase3_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-toggle="popover" href="/tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ytterbium, fcc structure, one atom per primitive cell,
similar to test #4 of built-in, except that nstep=1, and
the pseudopotential differs :
format 5, translated from PseudosTM_pwteter/70yb.pspnc (format 1).
The translation slightly changes the result, at the level of 2 microHa." data-toggle="popover" href="/tests/v1/Input/t38.abi" target="_blank">t38.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test multi-dataset mode. Si diamond.
2 datasets, with index 2 and 57 (!). No advanced features like get variables.
Rather fast." data-toggle="popover" href="/tests/v1/Input/t59.abi" target="_blank">t59.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si crystal (diamond structure), 2 atoms per unit cell.
Computation of responses to atomic displacements
and homogeneous electric field at Gamma,
giving access to the dynamical matrix at q(0 0 0), including
its non-analytical behaviour (effective charges
do not vanish completely due to lack of convergence),
the associated phonon frequencies, and the macroscopic
dielectric constant.
(see test.si.gamma of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs crystal (zinc-blende structure), 2 atoms per unit cell.
Computation of responses to atomic displacements
with X-point wavevector, giving the dynamical matrix and
the associated phonon frequencies.
Can be compared to the test gaas.x of RESPFN, provided
the cut-off energy is changed (here 3Ha, in RESPFN, 6Ha)." data-toggle="popover" href="/tests/v2/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 28. The chosen grid (too coarse, though) is
(0 0 0), (1/4 1/4 0), (1/2 1/2 0), (1/2 0 0),
(1/2 1/4 1/4), (1/2 -1/4 1/4)  (in reduced coordinates).
The ecut and nkpt parameters are really too low (see test 28),
but parameters suitable for physical results (see test 29)
are also provided in the input files." data-toggle="popover" href="/tests/v2/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Yb (1 atom per unit cell),
using a l=3 psp with s local part.
Crazy cut-off and number of k points.
Shows that the derivative of the eigenenergies
with respect to the wavevector can be obtained
both by finite differences and analytical means
(from a preliminary computation in the
treatment of the ddk perturbation).
For the (0.25,0.25,0.25) k point,
the tenth band eigenvalue is -3.01209 eV.
Going to the (0.251,0.251,0.251) k point
it becomes -3.00562 eV, with finite-difference
estimation of the derivative with respect
to ONE wavevector change (all three
components changed) being 0.00647 eV/0.001/3=2.157 eV
This value is unchanged when using the
data at the (0.253,0.253,0.253) k point.
The analytical value is 2.15566 eV." data-toggle="popover" href="/tests/v3/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
First dataset : compute the density
Second dataset : compute the spinor wfs at one k point,
non-self consistently
Third dataset : use the spinor wfs of the previous dataset
to restart computations at symmetric k points." data-toggle="popover" href="/tests/v3/Input/t13.abi" target="_blank">t13.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to verify that different values
of input variable &#x27;ortalg&#x27; give the same results for
total energy. &#x27;ortalg&#x27; is use in the conjugate gradient
algorithm which solves, in the case of PAW calculations,
a generalized eigenproblem (H.|Psi&gt;=Lambda.S|Psi&gt;).
Three datasets are perfomed ; they must give the same
total energies values (when converged)." data-toggle="popover" href="/tests/v4/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using PAW, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the spin-orbit coupling
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)
Also tests spnorbscl and pawcpxocc variables reserved to exp. users." data-toggle="popover" href="/tests/v5/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgB2, space group P6/m m m (#191); Bravais hP (primitive hexag.)
GS calculation followed by a band structure calculation in which the
k-path is automatically defined via the ndivsm input variable.
The third dataset tests the calculation and the output of the Fermi surface (prtfsurf=1)
in the Xcrysden format." data-toggle="popover" href="/tests/v6/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of berrystep
Al-As cristal, zinc-blende structure
Compute the polarization along strings
of k-points parallel to the primitive vectors of the reciprocal
lattice, and using multiple step berry phase calculation.
(Tests 21-30 are related to geometry optimization, molecular dynamics, etc)

Cannot be executed in parallel:
chkint_prt: ERROR -
Context : the value of the variable nproc is 2.
The value of the input variable berrystep is 5, while it must be
equal to 1" data-toggle="popover" href="/tests/v6/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Genetic algorithm structure random search.
Hydrogen has been used as an example. No physical meaning.
Number of images is only 10 but experience shows that at
least 20 are fine." data-toggle="popover" href="/tests/v6/Input/t27.abi" target="_blank">t27.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the WFK, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-toggle="popover" href="/tests/v67mbpt/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the KSS, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-toggle="popover" href="/tests/v67mbpt/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the extension of the pspcod=8 input format to include
spin-orbit coupling with multiple non-local projectors.  The
band structure of fcc Pt is computed at Gamma, X, and L.
The pseudopotential used in the test is generated by the open-source
ONCVPSP code, which is available at www.mat-simresearch.com, and
described in D. R. Hamann, Phys. Rev. B 88, 085177 (2013).
The relativistic extension is documented in the code package.
The Pt 5s and 5p semi-cores are treated as valence, and the band
structure is well-converged at the ecut used in the test (20 Ha).
A complete description of the input format is avaiable in
doc/psp_infos/psp8_info.txt." data-toggle="popover" href="/tests/v7/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Nickel ferromagnetic fcc structure with an ONCVPSP pseudo containing valence density.
We test several improvements that are available when the NC file contains the PS valence charge.
More specifically, we test the initialization of the density from atomic quantities (initro.F90),
the correction to the forces due to the residuals and the extrapolation of the density
for structural relaxations (well, xred is fixed by symmetry).
We also test the treatment of the core charge in G-space in the case of GS calculations
By default, abinit handles XCCC in real space, here we use nc_xccc_gspace==1 to treat it
in G-space using the same approach as the one used in PAW." data-toggle="popover" href="/tests/v7/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
EuO rock salt structure.
27-electron PAW pseudo (4f and 5d are explicitly treated : 4d10 4f7 5s2 5p6 (5d0) 6s2 )
Test of initialisation using occopt=1 (the default) with non-zero spinmagntarget,
and also metallic occopt. Also test pawxcdev=0" data-toggle="popover" href="/tests/v7/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (spin-polarized, non-linear XC core correction, LDA)
Fixed occupation numbers. The parameters have been artifically tuned
with the goal to find a small system that reproduces the typical 1D-configuration coordinate diagram,
with a first total energy curve that shows a minimum, a second (different occupations) total energy curve
that shows a slightly higher minimum, at a slightly larger interatomic distance, and then the two total energy curves
cross at an even slightly larger interatomic distance.
This system will be used as a test bed for the next tests" data-toggle="popover" href="/tests/v8/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (spin-polarized, non-linear XC core correction, LDA)
Test the input variable imgwfstor.
In itimimage=2, the SCF cycle and the Broyden optimization are indeed immediately fulfilled." data-toggle="popover" href="/tests/v8/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the `structure` variable used to specify the crystalline structure
without having to enter explicitly natom, ntypat, typat and znucl.
Different options are tested. Initialize structure from:

1) An external POSCAR file with symbols (VASP5 format)
2) An external netcdf file produced by Abinit.
3) An external txt file with Abinit variables.

Test also the prefix variables that replace the old files file." data-toggle="popover" href="/tests/v9/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 06 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 08 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-toggle="popover" href="/tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
</ul>
</details>
<p>This variable provides a simplified interface to build the crystalline structure from an external file.
The idea is to keep the <strong>geometry information</strong> separated from the input file so that one
can perform multiple calculations in different input files sharing the same structure
without having to copy &amp; paste the description of the unit cell inside the input.
The single source of truth is now given by an external file that can be easily shared.
As a side effect one can easily restart structure relaxations in place by reading
the structure from the output file of a previous run.</p>
<p>The  <strong>structure</strong>  variable is a string in the format <strong>filetype:filepath</strong> where:</p>
<ul>
<li>filetype specifies the format of the external file</li>
<li>filepath gives the path to the file <em>relative</em> to the directory where the input file is located.</li>
</ul>
<p>Variables such as <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#typat">typat</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#znucl">znucl</a> are automatically initialized from
the external file and need not to be specified in the ABINIT input.</p>
<p>At present (November 05, 2024 ), the allowed values for <strong>filetype</strong> are:</p>
<ul>
<li>abifile &rarr; An output file produced by Abinit (only netcdf files are supported for the time being)</li>
<li>abivars &rarr; A txt input file with Abinit variables</li>
<li>poscar  &rarr; POSCAR files in VASP-5 format (element symbol after the atomic position is required).</li>
</ul>
<p>Some examples will help clarify.</p>
<p>To read the structure from an external netcdf file produced by Abinit (e.g. <em>out_GSR.nc</em>)
use the <strong>abifile</strong> prefix and the syntax:</p>
<div class="codehilite"><pre><span></span><code>structure &quot;abifile:out_GSR.nc&quot;
</code></pre></div>

<p>Other Abinit output files such as the <code>WFK.nc</code>, the <code>DEN.nc</code> and the <code>HIST.nc</code> file
are supported as well e.g.</p>
<div class="codehilite"><pre><span></span><code>structure &quot;abifile:out_HIST.nc&quot;
</code></pre></div>

<p>In the case of structural relaxations, these files contain the final geometry (not necessarily relaxed
within the given tolerance) hence  <strong>structure</strong>  can be used to perform an in-place restart by reading
the output of a previous run.</p>
<p>To read the structure from an external file with the structure in Abinit format, use:</p>
<div class="codehilite"><pre><span></span><code><span class="n">structure</span> <span class="s2">&quot;abivars:my_text_file&quot;</span>
</code></pre></div>

<p>where <em>my_text_file</em> specifies the lattice in terms [[acell], (<a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#angdeg">angdeg</a>)
while the atomic positions are specified with <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a> and the special variable <strong>xred_symbols</strong> that
can only be used inside this external file.</p>
<div class="highlight"><pre><span></span><code># MgB2 lattice structure

acell   2*3.086  3.523 Angstrom

rprim   0.866025403784439  0.5  0.0
       -0.866025403784439  0.5  0.0
        0.0                0.0  1.0

natom   3

# Reduced positions followed by element symbol.

xred_symbols
 0.0  0.0  0.0  Mg
 1/3  2/3  0.5  B
 2/3  1/3  0.5  B
</code></pre></div>
<p>To read the structure from an external POSCAR file, use:</p>
<div class="codehilite"><pre><span></span><code>structure &quot;poscar:t04_POSCAR&quot;
</code></pre></div>

<p>where <code>t04_POSCAR</code> is the name of external file.</p>
<div class="admonition critical">
<p class="admonition-title">Critical</p>
<p>Note that the Abinit parser does not support all the possible variants of the POSCAR format.
More specifically, we assume a subset of the POSCAR specifications in VASP-5 format.
This means that the list of element symbols must be present and <strong>written on a single line</strong>.
Only the &ldquo;direct&rdquo; and &ldquo;cartesian&rdquo; keywords before the atomic positions are allowed (case insensitive).</p>
</div>
<p>A typical POSCAR file for hexagonal MgB2 looks like (ignore comments):</p>
<div class="highlight"><pre><span></span><code>Mg1 B2                           # Title string (ignored by Abinit)
1.0                              # Scaling factor for lattice vectors.
2.672554  1.543000 0.000000      # Lattice vectors in Angstrom (NOTE: ABINIT uses BOHR by default)
-2.672554 1.543000 0.000000
0.000000  0.000000 3.523000
Mg B                             # List of element symbols
1 2                              # Number of atoms for each symbol
direct                           # &quot;direct&quot; for reduced coordinates or &quot;cartesian&quot;.
0.000000 0.000000 0.0 Mg         # Coordinates followed by the chemical symbol of the atom.
0.333333 0.666667 0.5 B
0.666667 0.333333 0.5 B
</code></pre></div>
<p>A positive scaling factor can be used to rescale the lattice vectors
whereas a negative value is interpreted as the volume of the unit cell in Angstrom**3.
Obviously, zero is not allowed!</p>
<p>The <a class="wikilink codevar-wikilink" href="/variables/basic#typat">typat</a> variable is automatically initialized from the list of chemical symbols
according to their position in the list.
In this example, Mg is of type 1 while B is of type 2.</p>
<p>The ABINIT variables associated to this POSCAR are therefore:</p>
<div class="codehilite"><pre><span></span><code>ntypat 2
typat 1 2 2
znucl  12.0   5.0
</code></pre></div>

<p>These are the <strong>ONLY QUANTITIES</strong> that are initialized from the external POSCAR so please make sure that
your POSCAR resembles the example given above and do not expect ABINIT to understand other entries
such as <code>Selective dynamics</code> or velocities.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Several POSCAR files available on the internet give atomic positions and lattice vectors with ~6 digits.
The ABINIT routines use tighter tolerances to detect the space group thus it may happen that ABINIT does not
detect all the symmetry operations with a consequent <strong>INCREASE</strong> of the number of k-points in the IBZ
and the associated computational cost. This is especially true for hexagonal or rhombohedral lattices.
A possible solution is to increase the value of <a class="wikilink codevar-wikilink" href="/variables/geo#tolsym">tolsym</a> in the input file to e.g. 1e-4
so that ABINIT will automatically refine the atomic positions.</p>
</div>
<p>Note the following important remarks:</p>
<ul>
<li>
<p>The structure is initialized by the parser at the very beginning of the calculation
  hence the external files <strong>must exist</strong> when Abinit starts to analyze the input file.
  In a nutshell,  <strong>structure</strong>  variables cannot be used to pass the output geometry from one dataset
  to the next one.</p>
</li>
<li>
<p>Multidatasets are supported but mind that some variables such as
  <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#typat">typat</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#znucl">znucl</a> are tagged as <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a>.
  In other words, one can read different files via  <strong>structure</strong>  and the multi dataset syntax
  provided these quantities do not change.
  ABINIT syntax such as <code>xred+</code> are, obviously, not supported.</p>
</li>
<li>
<p>The value of <a class="wikilink codevar-wikilink" href="/variables/basic#typat">typat</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#znucl">znucl</a> given in the input file (if any) is ignored by the parser.
  The value of <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a> is checked for consistency.</p>
</li>
<li>
<p>As a rule of thumb, do not try to mix the two approaches: either use  <strong>structure</strong>  or the standard
  (more verbose) approach based on <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#typat">typat</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#znucl">znucl</a> to define the unit cell.</p>
</li>
</ul>
<p>Limitations:</p>
<ul>
<li>The specification of structures for calculations with images is not supported.</li>
<li>Alchemical mixing is not supported.</li>
<li>Reading structure from Fortran file is not yet implemented. It is just a technical problem
  that will be hopefully solved in the next releases.</li>
</ul>
<p>In all these cases in which the  <strong>structure</strong>  variable is not supported,
one has to resort to the <strong>standard approach</strong> to define the list of atoms and their type.</p>
<h2 id="symrel"><strong>symrel</strong><a class="headerlink" href="#symrel" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SYMmetry in REaL space<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,3,<a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a>)<br />
<em>Default value:</em> [[1, 0, 0], [0, 1, 0], [0, 0, 1]] if <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> == 1,
None otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [192/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as 03 but run with newer Troullier-Martins psp
with core density PseudosTM_pwteter/14si.pspnc.  Start from wf.03 and run irdwfk=1.
Also iterated to convergence." data-toggle="popover" href="/tests/fast/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and Wu-Cohen GGA.
Similar to test v3#08
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.49410411 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.4945677  Ha
with delta(xred)=0.0001, 189.49422003  Ha .
Combining the results gives 189.4941041 Ha. Perfect !" data-toggle="popover" href="/tests/v5/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential,
and the Wu-Cohen GGA.
Similar to Test v3#48
Compute the total energy and force as a
displacement of the second atom along x.
Direct calculation of the gradient with respect
to reduced coordinates gives -3.469435369425Ha
while finite differences gives :
with delta(xred)=0.0002, -3.4694479488 Ha
with delta(xred)=0.0001, -3.4694385143 Ha .
Combining the results gives -3.4694353695 Ha.
Excellent." data-toggle="popover" href="/tests/v5/Input/t48.abi" target="_blank">t48.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Make a simple geometry relaxation and validate the XML output (testing prtxml)." data-toggle="popover" href="/tests/v5/Input/t79.abi" target="_blank">t79.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom.
Treated with GGA C09x exchange functional (ixc=24).
The total energy is -0.429523 Ha.
Also additional tests concerning the kinetic energy density calculation,
the gradient of electronic density calculation and
the Laplacian of electronic density calculation are performed.
Test taken from v1/t21.in." data-toggle="popover" href="/tests/v6/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test presence of nuclear magnetic dipole moments on atomic sites" data-toggle="popover" href="/tests/v7/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with and without PAW XML data (FJollet)" data-toggle="popover" href="/tests/v7/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for PWPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t61.abi" target="_blank">t61.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Hydrogen systems for tests of symmetry recognition in the non-collinear case. Constrained DFT calculations for the magnetization." data-toggle="popover" href="/tests/v8/Input/t95.abi" target="_blank">t95.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compute U in bcc Fe in 2 atomic supercell with the ujdet
intrinsic subroutine (using a two-point linear regression)." data-toggle="popover" href="/tests/v9/Input/t106.abi" target="_blank">t106.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compute the Hund&#x27;s J in bcc Fe in 2 atom cell with ujdet
intrinsic subroutine (using a two-point linear regression); generate
input LRUJ.nc files for lruj post-processing utility" data-toggle="popover" href="/tests/v9/Input/t107.abi" target="_blank">t107.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives &ldquo;<a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a>&rdquo; 3x3 matrices expressing space group symmetries in terms of
their action on the direct (or real) space primitive translations.
It turns out that these can always be expressed as integers.
Always give the identity matrix even if no other symmetries hold, e.g.
 <strong>symrel</strong>  1 0 0 0 1 0 0 0 1.</p>
<p>Also note that for this array, as for all others, the array elements are filled
in a columnwise order as is usual for Fortran.  Explicitly,
 <strong>symrel</strong>  1 0 0 -1 -1 0 0 0 1 for symmetry operation isym is stored internally as
symrel(1,1,isym)=1, symrel(1,2)=-1, &hellip;
The atom located at xred(1:3) is send to location
xred_sym(jj)=symrel(jj,1,isym)*xred(1)+symrel(jj,2,isym)*xred(2)+symrel(jj,3,isym)*xred(3)+tnons(jj).</p>
<p>The relation between the above symmetry matrices  <strong>symrel</strong> , expressed in the
basis of primitive translations, and the same symmetry matrices expressed in
cartesian coordinates, is as follows. Denote the matrix whose columns are the
primitive translations as R, and denote the cartesian symmetry matrix as S.
Then  <strong>symrel</strong>  = R(inverse) * S * R
where matrix multiplication is implied.
When the symmetry finder is used (see <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a>),  <strong>symrel</strong>  will be computed automatically.
Also see the accompanying input variables <a class="wikilink codevar-wikilink" href="/variables/basic#tnons">tnons</a> and <a class="wikilink codevar-wikilink" href="/variables/gstate#symafm">symafm</a>, for the full definition of the symmetry operations.
Such variables are used to infer <a class="wikilink codevar-wikilink" href="/variables/geo#spgroup">spgroup</a>, <a class="wikilink codevar-wikilink" href="/variables/geo#spgroupma">spgroupma</a> and <a class="wikilink codevar-wikilink" href="/variables/geo#genafm">genafm</a> if they are not user-defined.</p>
<h2 id="tnons"><strong>tnons</strong><a class="headerlink" href="#tnons" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Translation NON-Symmorphic vectors<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a>)<br />
<em>Default value:</em> None<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [237/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as 03 but run with newer Troullier-Martins psp
with core density PseudosTM_pwteter/14si.pspnc.  Start from wf.03 and run irdwfk=1.
Also iterated to convergence." data-toggle="popover" href="/tests/fast/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LOBPCG, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, rhombohedral.
Test finite electric field
Check the corectness of the symmetry operations with non-zero tnons." data-toggle="popover" href="/tests/seq/Input/tsv4_55.abi" target="_blank">tsv4_55.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy
Determination of the surface energy of aluminum :
convergence with respect to the number of vacuum layers." data-toggle="popover" href="/tests/tutorial/Input/tbase4_7.abi" target="_blank">tbase4_7.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy

Determination of the surface energy of aluminum :
convergence with respect to the number of vacuum layers." data-toggle="popover" href="/tests/tutorial/Input/tbase4_8.abi" target="_blank">tbase4_8.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2, and preceeding test,
but use the full XC PBE functional.
Also, tolvrs is better.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.81162533 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.81213804 Ha
with delta(xred)=0.0001, 188.81175352 Ha .
Combining the results gives 188.81162525 Ha." data-toggle="popover" href="/tests/v3/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
5-atom Al slab, with three vacuum layers.
First, converge the wavefunctions, then compute the
STM charge density below and above the Fermi energy, within a 2eV range.
Also compute band-by-band decomposition of STM charge density below the Fermi energy, within a 2eV range." data-toggle="popover" href="/tests/v4/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and Wu-Cohen GGA.
Similar to test v3#08
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.49410411 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.4945677  Ha
with delta(xred)=0.0001, 189.49422003  Ha .
Combining the results gives 189.4941041 Ha. Perfect !" data-toggle="popover" href="/tests/v5/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential,
and the Wu-Cohen GGA.
Similar to Test v3#48
Compute the total energy and force as a
displacement of the second atom along x.
Direct calculation of the gradient with respect
to reduced coordinates gives -3.469435369425Ha
while finite differences gives :
with delta(xred)=0.0002, -3.4694479488 Ha
with delta(xred)=0.0001, -3.4694385143 Ha .
Combining the results gives -3.4694353695 Ha.
Excellent." data-toggle="popover" href="/tests/v5/Input/t48.abi" target="_blank">t48.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 diatomic molecule. Spin-polarized (ferromagnetic).
Test the Wu-Cohen GGA functional.
Similar to Test v3#49
Direct calculation of the gradient with respect
to reduced coordinates gives  0.344935232634 Ha
while finite differences gives :
with delta(xred)=0.002,  0.34493521   Ha

Cannot be executed in parallel
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential version
of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v5/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom.
Treated with GGA C09x exchange functional (ixc=24).
The total energy is -0.429523 Ha.
Also additional tests concerning the kinetic energy density calculation,
the gradient of electronic density calculation and
the Laplacian of electronic density calculation are performed.
Test taken from v1/t21.in." data-toggle="popover" href="/tests/v6/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with and without PAW XML data (FJollet)" data-toggle="popover" href="/tests/v7/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for PWPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t61.abi" target="_blank">t61.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test of velocity verlet integrator" data-toggle="popover" href="/tests/v8/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation with constrained charges
Constrain the charge around atom 1 to the value 0.5, then work with both atoms and larger spheres

For dataset 2, the derivative wrt the constraint, the derivative of the total energy with respect to atomic displacement
and the stress calculations have been checked, as follows.

Initially, the total energy is -0.99164352451, the target charge is 0.5, and the gradient wrt the charge is computed -0.58356219787.
Changing the target charge by +0.001 gives etotal -0.99222576777
Changing the target charge by -0.001 gives etotal -0.99105864425
Finite-difference gives -0.5835617, in excellent agreement for that level of methodology.

For atom 1, dE/dtau (=-force in reduced coordinate) is computed 8.330114676.
Changing the atomic position of the first atom from -1.1 to -1.10015
gives etotal -0.99172669330, to -1.09985 gives etotal -0.99156009221, delivering 8.330054.
The result of a similar finite-difference estimation with twice bigger values gives 8.329896.
Combining both results to eliminate the quadratic error gives 8.330107, with an agreement of 5 digits with dE/dtau.

The stress is computed 2.755820639e-4 .
Multiplying both acell and xcart by 1.001 gives etotal -0.99122698240.
Multiplying both acell and xcart by 0.999 gives etotal -0.99205366103.
The derivative of total energy wrt to strain is thus 0.41333932. Dividing by the unit cell volume (1500) gives 2.75559e-4 ,
in excellent agreement for that level of methodology." data-toggle="popover" href="/tests/v8/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the (nonsymmorphic) translation vectors associated with the symmetries
expressed in &ldquo;<a class="wikilink codevar-wikilink" href="/variables/basic#symrel">symrel</a>&rdquo;.
These may all be 0, or may be fractional (nonprimitive) translations expressed
relative to the real space primitive translations (so, using the &ldquo;reduced&rdquo;
system of coordinates, see &ldquo;<a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a>&rdquo;). If all elements of the space group
leave 0 0 0 invariant, then these are all 0.
When the symmetry finder is used (see <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a>),  <strong>tnons</strong>  is computed
automatically.</p>
<p>For the ground-state and DFPT drivers of ABINIT, the value of tnons is unrestricted.
However, for GW and BSE, the symmetry operations must leave the FFT grid invariant.
Preparatory (Ground-state) runs must also use the same atomic geometry, hence the same tnons.
As ABINIT cannot guess whether the user has in mind to do a GW or BSE run after the GS run,
a conservative approach is implemented, requiring such match of symmetry operations
and FFT grid also in the GS case. See more details in the section describing the input variable <a class="wikilink codevar-wikilink" href="/variables/gstate#chksymtnons">chksymtnons</a>.</p>
<p>See also <a class="wikilink codevar-wikilink" href="/variables/gstate#symafm">symafm</a> for the complete description of the symmetry operation.</p>
<h2 id="toldfe"><strong>toldfe</strong><a class="headerlink" href="#toldfe" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on the DiFference of total Energy<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Comment:</em> The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> can differ from zero.<br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [349/1245] in all abinit tests, [42/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
KSS file generation for silicon with a different number of bands in the KSS
computation compared to ground-state." data-toggle="popover" href="/tests/etsf_io/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 with GPU, norm conserving, from LibXC" data-toggle="popover" href="/tests/gpu_omp/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 with GPU, PAW, from LibXC" data-toggle="popover" href="/tests/gpu_omp/Input/t27.abi" target="_blank">t27.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock with time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock without time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Oxygen atom
Test a few functionals for which HGH pseudopotentials are available (from M. Krack),
that are present also in the lib XC, but not in the native ABINIT set of functionals." data-toggle="popover" href="/tests/libxc/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum, primitive cell.
Testing temperature-dependent libxc functionals.
Several XC functionals, several electronic temperatures." data-toggle="popover" href="/tests/libxc/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 in sequential case, norm conserving, from LibXC" data-toggle="popover" href="/tests/libxc/Input/t51.abi" target="_blank">t51.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over bands and spins:
npband*npfft*np_spkpt=2*1*2=4 processors.
In addition, we also test here various features of bandfft-kpt parallelisation
In particular, the bandpp, istwfk=2 and wfoptalg=14 variables." data-toggle="popover" href="/tests/mpiio/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-toggle="popover" href="/tests/paral/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Total energy vs. cell size for bulk FCC aluminium, to compare with the
PSML results of t08 and t12" data-toggle="popover" href="/tests/psml/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using old, rather inaccurate psps.
Computation of the Berry phase.
Test the doubling of the step of the sampling." data-toggle="popover" href="/tests/seq/Input/tsv3_04.abi" target="_blank">tsv3_04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiNbO3, rhombohedral.
Test finite electric field
Check the corectness of the symmetry operations with non-zero tnons." data-toggle="popover" href="/tests/seq/Input/tsv4_55.abi" target="_blank">tsv4_55.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Gold with one vacancy (107 atoms of gold)." data-toggle="popover" href="/tests/tutoparal/Input/tparal_bandpw_01.abi" target="_blank">tparal_bandpw_01.abi</a>, <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutoparal/Input/tparal_bandpw_02.abi" target="_blank">tparal_bandpw_02.abi</a>, <a class="wikilink abifile-wikilink" data-toggle="popover" href="/tests/tutoparal/Input/tparal_bandpw_03.abi" target="_blank">tparal_bandpw_03.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Finite difference calculation of the Born effective charges of AlP" data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_1.abi" target="_blank">tpolarization_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Finite difference calculation of the clamped-ion
piezoelectric constants of AlP" data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_4.abi" target="_blank">tpolarization_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Finite electric field calculation of AlP at clamped atomic positions" data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_6.abi" target="_blank">tpolarization_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated like a metal (there is a degeneracy at the Fermi level),
occopt=4 and tsmear=0.04 , with nsppol=2 .
Use spinat to polarize the molecule at start.
Gives total energy of -32.09317 Hartree
This test can be used to check the accuracy of stresses in the
spin-polarized case. Setting acell(1:2) to 7.005 and 6.995
gives ETOT -32.090846193972 and -32.095501753750,
ucvol  441.63023 and 440.37023
so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03,
to be compared with sigma(1)=3.6949713786E-03
and sigma(2)=3.6949681083E-03 from the present test
(the degeneracy is slightly lifted because of incomplete convergence,
using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both
sigma values)." data-toggle="popover" href="/tests/v1/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated as a spin-polarized molecule, with fixed occupation
numbers (occopt=2), with nsppol=2 . Gives total energy of -32.09792 Hartree" data-toggle="popover" href="/tests/v1/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond : vacancy.
This test is for testing a large number of atoms (63 atoms), with a large
number of plane waves (unlike test42).
Small number of line minimisations, of course." data-toggle="popover" href="/tests/v1/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
Compares with frozen-phonon calculations. Examine two cases:
varying occupation numbers, and fixed occupation numbers.
A. Varying occupation numbers (occopt=4):
RF calculation in dataset 5 gives
2DE equal to -3.812577 Ha, while finite difference of &quot;TOTAL&quot;
energy (datasets 6 and 7, including entropy term) gives -3.812230 Ha
(the agreement could be better with better finite difference)
B. Fixed occupation numbers (occopt=2):
RF calculation in dataset 8 gives
2DE equal to +5.431807 Ha, while finite difference of total
energy (no entropy term is present with occopt=2) gives +5.431857 Ha
(the agreement could be better with better finite difference)" data-toggle="popover" href="/tests/v2/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Al2 molecule in a big box. Treat 8 bands, occupied using occopt=4.
For a metallic occopt, the frozen-phonon (finite-difference) approach
is strictly equivalent to the RF approach only at q/=Gamma.
Here, computes the result at q=(0 0 1/2).
With delta(xred)=0.0001 (DATASET 5), one gets
delta(etot)/delta(xred)=0.42807994 .
The direct computation of 2DTE at the target geometry
gives 0.428080350 ." data-toggle="popover" href="/tests/v2/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Molybdenum. Test the k point generator : Monkhorst-Pack
grid, then band structure." data-toggle="popover" href="/tests/v2/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with spin-orbit. Should give the same answer
than test 2, except that the k point grid is now
defined automatically.
Dataset 8 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
Warning : the output file of this test
is machine-dependent, although the final
result is not. This is because the
degeneracy of the GS wavefunctions with
different spin orientation has not been broken." data-toggle="popover" href="/tests/v3/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to verify that different values
of input variable &#x27;ortalg&#x27; give the same results for
total energy. &#x27;ortalg&#x27; is use in the conjugate gradient
algorithm which solves, in the case of PAW calculations,
a generalized eigenproblem (H.|Psi&gt;=Lambda.S|Psi&gt;).
Three datasets are perfomed ; they must give the same
total energies values (when converged)." data-toggle="popover" href="/tests/v4/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to mesure the convergence of
the total energy versus the variable &#x27;ecut&#x27;.
6 datasets are performed with ecut varying from 8 Ha to 18 Ha
Cut-off for the fine grid (used to transfer data from spherical
meshes to FFt meshes) remain constant." data-toggle="popover" href="/tests/v4/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U implementation.
no forces, 2 Ni and 2 O atoms in an fcc supercell.
The cut-off is unrealistic. This test tests the
following part of the code :
* paw DFT+U (pawpupot, pawpuenergy, pawpuinit)" data-toggle="popover" href="/tests/v5/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Print out geometry and eigenvalue files for analysis by the BoltzTraP code, for transport coefficients,
Seebeck, etc... Tests the prtbltztrp input variable" data-toggle="popover" href="/tests/v6/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Set of Hydrogen atoms in a body-centered, or face-centered tetragonal, of body-centered orthorhombic lattice.
This is to test the scalecart input variable." data-toggle="popover" href="/tests/v6/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi atom in a big supercell.
Test the application of a Zeeman field." data-toggle="popover" href="/tests/v6/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials.
W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV.
First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian, then
the Haydock iterative method is employed to calculate the macroscopic dielectric function.
The last dataset solves the BSE problem including the coupling between resonant and
anti-resonant transition via brute force diagonalization." data-toggle="popover" href="/tests/v67mbpt/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-toggle="popover" href="/tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock
(only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-toggle="popover" href="/tests/v67mbpt/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff
and kpts, non collinear spin case with nspden=4 imposed. First normal case then constrain direction only
along z (DS2), along y (DS3) and impose value of vector (DS4). Then work in the collinear case, unconstrained (DS5),
with constrained direction (DS6), and constrained direction and value (DS7).
Total energy in DS1, DS2, DS3 and DS5 are identical (good). Should be also identical in DS6 , but not the case at present.
Also, the results for DS3 are NOT really portable, hence the very large tolerances.
Revised by XG" data-toggle="popover" href="/tests/v7/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="test partial dos calculation with spinors (previously not enabled) and spin
polarization while we are at it" data-toggle="popover" href="/tests/v7/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test generation of k-point mesh with kptrlatt and shiftk.
version 8.0.8b was stopping at the level of the parser." data-toggle="popover" href="/tests/v8/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test of velocity verlet integrator" data-toggle="popover" href="/tests/v8/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GS calculation with the CG + RMM-DIIS eigensolver and NC pseudos" data-toggle="popover" href="/tests/v9/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-toggle="popover" href="/tests/v9/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as t33.out but reading some checkpoint (i.e. 1, 2, and 5) files" data-toggle="popover" href="/tests/v9/Input/t34.abi" target="_blank">t34.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-toggle="popover" href="/tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>Sets a tolerance for absolute differences of total energy that, reached TWICE
successively, will cause one SCF cycle to stop (and ions to be moved).
Can be specified in Ha (the default), Ry, eV or Kelvin, since  <strong>toldfe</strong>  has
the <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics (1 Ha = 27.2113845 eV).
If set to zero, this stopping condition is ignored.
Effective only when SCF cycles are done (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&gt;0).
Because of machine precision, it is not worth to try to obtain differences in
energy that are smaller than about 1.0d-12 of the total energy. To get
accurate stresses may be quite demanding.</p>
<p>When the geometry is optimized (relaxation of atomic positions or primitive
vectors), the use of  <strong>toldfe</strong>  is to be avoided. The use of <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a>
(or <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a>) is by far preferable, in order to have a handle on the geometry
characteristics. When all forces vanish by symmetry (e.g. optimization of the
lattice parameters of a high-symmetry crystal), then place  <strong>toldfe</strong>  to
1.0d-12, or use (better) <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a>.</p>
<p>Since  <strong>toldfe</strong> , <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> are aimed
at the same goal (causing the SCF cycle to stop), they are seen as a unique
input variable at reading. Hence, it is forbidden that two of these input
variables have non-zero values for the same dataset, or generically (for all
datasets). However, a non-zero value for one such variable for one dataset
will have precedence on the non-zero value for another input variable defined
generically.</p>
<p><strong>toldfe</strong> can be coupled with <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>. In that case, SCF cycle is stopped when both criteria are satisfied.
To do so one has to specify both criteria for the same dataset.
Note that a tolerance defined generically does not couple with a criterion defined for one particular dataset.
See <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> for more details about coupling two criteria.</p>
<h2 id="toldff"><strong>toldff</strong><a class="headerlink" href="#toldff" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on the DiFference of Forces<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to tune the computation of forces and stresses" data-toggle="popover" href="/topics/ForcesStresses">topic_ForcesStresses</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Comment:</em> The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> can differ from zero.<br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [105/1245] in all abinit tests, [16/159] in abinit tutorials</summary><ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Stishovite (a polymorph of SiO2)
Test PBEsol in the PAW formalism, using PAW datasets created with atompaw linked with libxc.
Note that the value of ixc is not present in the input file, but it is present in the ATOMPAW dataset (pspxc = -116133)" data-toggle="popover" href="/tests/libxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molybdenum slab (5 atoms+3 vacuum), with ixc=1. 4 k-points, in core.
Use iprcel=45 for SCF cycle." data-toggle="popover" href="/tests/paral/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=14 (finite reduced electric field calculation,relaxing cell
parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-toggle="popover" href="/tests/seq/Input/tsv6_121.abi" target="_blank">tsv6_121.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=16 (finite reduced electric displacement field calculation,
relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-toggle="popover" href="/tests/seq/Input/tsv6_122.abi" target="_blank">tsv6_122.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=4 (finite electric field calculation, relaxing cell
parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-toggle="popover" href="/tests/seq/Input/tsv6_123.abi" target="_blank">tsv6_123.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydronium ion + NH3 molecule
Ground state calculation
keeping O and H atoms fixed" data-toggle="popover" href="/tests/tutoparal/Input/timages_01.abi" target="_blank">timages_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydronium ion + NH3 molecule
Ground state calculation
keeping O and H atoms fixed" data-toggle="popover" href="/tests/tutoparal/Input/timages_02.abi" target="_blank">timages_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydronium ion + NH3 molecule
String method
Moving the proton from H2O to NH3
keeping O and H atoms fixed" data-toggle="popover" href="/tests/tutoparal/Input/timages_03.abi" target="_blank">timages_03.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom." data-toggle="popover" href="/tests/tutorial/Input/tbase2_1.abi" target="_blank">tbase2_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom.
Here, a double loop has been used." data-toggle="popover" href="/tests/tutorial/Input/tbase2_2.abi" target="_blank">tbase2_2.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Mo surface, with 10 atom per cell. Not very large, but the
number of bands make it a medium-size problem : 36 bands." data-toggle="popover" href="/tests/v1/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the option ionmov=4. 8-atom Si cube, non spin-polarized.
Same test as number 22a of fast, except for the change
of ionmov, no reading of wavefunctions, iscf to 2, and different
tolerance criteria." data-toggle="popover" href="/tests/v1/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the option ionmov=4. Si2 molecule, spin-polarized.
Same test as number 16 of fast, except for the change
of ionmov, no reading of wavefunctions, iscf to 2, and different
tolerance criteria.

Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential
version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v1/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2) for cell optimization. PAW,istwfk=1." data-toggle="popover" href="/tests/v10/Input/t19.abi" target="_blank">t19.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (non-spin-polarized, non-linear XC core correction, GGA)
Computation of forces in the GGA, and comparison with a finite
difference of energy.
The direct computation of force (dataset 2) gives 0.627251486 Ha/Bohr
A simple finite-difference estimation (dataset 1 and 3) gives
0.627251265 Ha/Bohr. The agreement can be improved if a better
finite-difference estimation is used." data-toggle="popover" href="/tests/v2/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (non-spin-polarized, non-linear XC core correction, GGA)
Computation of uniaxial stresses in the GGA,
and comparison with a finite difference of energy.
The direct computation of sigma(zz) stress (dataset 2)
gives 0.964267876d-3 Ha/Bohr**3
A simple finite-difference estimation (dataset 1 and 3) gives
a difference in total energy of 0.085048409d-3 Ha,
for a difference of volume of 0.0882 Bohr**3 leading
to a stress estimation of 0.96426768d-3 Ha/Bohr**3
The agreement can be improved if a better finite-difference
estimation is used." data-toggle="popover" href="/tests/v2/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Arsenic in rhombohedral structure.
Optimization of unit cell size and shape.
With 4x4x4 k point grid, ecut 3.0, occopt 4 and tsmear 0.06d0,
one get acell 3*7.325  angdeg 3*57.36 and xred 0.2277
These input parameters are too small, but still give a realistic
geometry, since with the much better parameters
12x12x12 k point grid, ecut 12.0, occopt 4 and tsmear 0.04d0,
one gets acell 3*7.633  angdeg 3*54.95 and xred 0.2296, while
the experimental values are
acell 3*7.751   angdeg 3*54.554 and xred 0.2276" data-toggle="popover" href="/tests/v2/Input/t44.abi" target="_blank">t44.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
8 atoms of Si in an elongated box.
4 of them are fixed, while atoms 5 and 6
and 7 and 8 are grouped by pair, such as
the sum of their relative separations along y is constrained to 8.0 .
This is a crazy constraint, just to show that it can be done !" data-toggle="popover" href="/tests/v3/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="No description available" data-toggle="popover" href="/tests/v3/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule : examine the rotational freedom.
The present test produces the following
vibrational frequencies (with degeneracies indicated):
56.89 i cm-1 (2)
0.41   cm-1 (2)
1.05   cm-1
3800    cm-1
The large frequency corresponds to the stretching
mode, and has the right order of magnitude.
The frequencies close to 1 cm-1 corresponds
to translation modes, and are small enough
for usual applications.
The  56.89 i cm-1 mode corresponds to rotation of
the H2 molecule. The magnitude of this
frequency might seem quite
large. Here are the results of tests made to understand
this phenomenon. First, note that
ecut 12  acell 3*14
Increasing the value of ecut to 25 decreases
the magnitude of the frequency to 36.8 cm-1 .
However, in order to continue to make it smaller,
the cell size must be increased , and an oscillatory
behaviour is observed :
3*16   45.6 i cm-1
3*18   22.7   cm-1
3*20   19.1 i cm-1
3*22   15.7 i cm-1
3*24   13.7   cm-1
Many other tests have been set up. In particular,
it was observed that the frequency of the oscillatory
behaviour changes with the ecut, and also that
using the Gamma point, instead of the 1/4 1/4 1/4 k point
(used in this test) degrades the convergence.
The overall picture is as follows.
There are different reasons for the translation
and rotation modes to acquire a non-zero frequency
when plane waves and supercells are used.
Still, as concerns translations, only the
existence of a discretization of the XC grid
is important. For rotations, supercell effects
are also present :
- alignement of dipole or quadrupoles
- interaction between tails of wavefunctions, accross cells
Since the convergence in supercell size is oscillatory, we infer
that the breaking of the rotational invariance is mostly
due to interaction between wavefunction tails.
This will be checked by confining the system in a spherical
well, in a forthcoming test." data-toggle="popover" href="/tests/v3/Input/t80.abi" target="_blank">t80.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si/Ge heterojunction : 4 layer each. Output the density and potential.
Prepare the macroaverage analysis, see next tests." data-toggle="popover" href="/tests/v4/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl molecule in a big box.
Test of the computation of the polarisation with the routine berryphase_new,
for different k-point grids : only 1 k-point, a line of k-points, and a full mesh of k-points.
Results with acell 20 10 10 are : -9.727 C/m^2, -9.975 C/m^2, -9.503 C/m^2
multiplied by the volume (in a.u.), gives -19454, -19950, -19006
Test provided by S. Leroux
Going to bigger cells make these results converge to the same value :
Results with acell 30 20 20 are : -1.771 C/m^2, -1.746 C/m^2, -1.747 C/m^2
multiplied by the volume (in a.u.), gives -21252, -20952, -20964
Results with acell 40 20 20 are : -1.3167C/m^2, -1.3057C/m^2, -1.3062C/m^2
multiplied by the volume (in a.u.), gives -21067, -20891, -20899
Results with acell 50 20 20 are : -1.0502C/m^2, -1.0444C/m^2, -1.0450C/m^2
multiplied by the volume (in a.u.), gives -21004, -20888, -20900" data-toggle="popover" href="/tests/v6/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the symmetry finder for all the Bravais lattices,
with different input formats (rprim or angdeg), and for
non-conventional choices of axes as well.
Uses only one atom, placed at (0.6 0 0)
Similar to test v2#52, except for the choice of the location" data-toggle="popover" href="/tests/v6/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth, rhombohedral, two atoms per unit cell
Scalar relativistic.
Relax four different images, using the steepest descent algorithm." data-toggle="popover" href="/tests/v6/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation
in (N,V,T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested
together with the three coordinate systems (primitive, normal mode, staging).
NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with
--- Pseudopotential description --" data-toggle="popover" href="/tests/v7/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-toggle="popover" href="/tests/v8/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing." data-toggle="popover" href="/tests/v9/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="LiH molecule in a big box" data-toggle="popover" href="/tests/v9/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbTiO3 with in-plane strain.
Relaxing the third vector using optcell 6" data-toggle="popover" href="/tests/v9/Input/t104.abi" target="_blank">t104.abi</a> &hellip;</li>
</ul>
</details>
<p>Sets a tolerance for differences of forces (in hartree/Bohr) that, reached
TWICE successively, will cause one SCF cycle to stop (and ions to be moved).
If set to zero, this stopping condition is ignored.
Effective only when SCF cycles are done (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&gt;0). This tolerance applies
to any particular cartesian component of any atom, INCLUDING fixed ones. This
is to be used when trying to equilibrate a structure to its lowest energy
configuration (select <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a>), or in case of molecular dynamics (<a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a> = 1)
A value ten times smaller than <a class="wikilink codevar-wikilink" href="/variables/rlx#tolmxf">tolmxf</a> is suggested (for example 5.0d-6
hartree/Bohr).
This stopping criterion is not allowed for RF calculations.
Since <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a>,  <strong>toldff</strong> , <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> are aimed
at the same goal (causing the SCF cycle to stop), they are seen as a unique
input variable at reading. Hence, it is forbidden that two of these input
variables have non-zero values for the same dataset, or generically (for all
datasets). However, a non-zero value for one such variable for one dataset
will have precedence on the non-zero value for another input variable defined generically.</p>
<p><strong>toldff</strong> can be coupled with <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>. In that case, SCF cycle is stopped when both criteria are satisfied.
To do so one has to specify both criteria for the same dataset.
Note that a tolerance defined generically does not couple with a criterion defined for one particular dataset.
See <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> for more details about coupling two criteria.</p>
<h2 id="tolrff"><strong>tolrff</strong><a class="headerlink" href="#tolrff" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on the Relative diFference of Forces<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to tune the computation of forces and stresses" data-toggle="popover" href="/topics/ForcesStresses">topic_ForcesStresses</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Comment:</em> The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> can differ from zero.<br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a>&lsquo;<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [19/1245] in all abinit tests, [4/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2O in isolated boundary conditions (plane waves, NC), try tu use Damiens Poisson cutoff.
Water molecule with HGH pseudo-potentials. This checks that a negative
value in rhor will not make the Poisson solver crashes on XC computation." data-toggle="popover" href="/tests/bigdft/Input/t22.abi" target="_blank">t22.abi</a></li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule NON-spin-polarized, in a big box, without tetragonal symmetry, in order to avoid
spurious degeneracy effects coupled to occupation numbers rapidly changing.
GPU
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization." data-toggle="popover" href="/tests/gpu_omp/Input/t28.abi" target="_blank">t28.abi</a></li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule non-spin-polarized, in a big box.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with underconverged ecut (ecut 18) and box size (5 4 4 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation  (ecut 18, 5 4 4 box) : 1.101, 1.084, 1.085 Angstrom
Better  calculation  (ecut 22, 6 5 5 box) : 1.102, 1.086, 1.086 Angstrom
ABINIT Arnardi report (ecut acell unknown): 1.103, 1.091, 1.092 Angstrom
VASP Arnardi report (ecut acell unknown)  : 1.103, 1.089,  NA   Angstrom
Experimental : 1.098 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule spin-polarized, in a big box.
Norm conserving : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with underconverged ecut (ecut 15) and box size (4 3 3 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation  (ecut 13, 5 4 4 box) : 1.138, 1.130, 1.131 Angstrom
Better  calculation  (ecut 18, 7 6 6 box) : 1.135, 1.124, 1.125 Angstrom
ABINIT Arnardi report (ecut acell unknown): 1.136, 1.124, 1.124 Angstrom
VASP Arnardi report (ecut acell unknown)  : 1.136, 1.124,  NA   Angstrom
Experimental : 1.120 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule spin-polarized, in a big box.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with slightly better converged ecut (ecut 15) and box size (6 5 5 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation (ecut 13, 5 4 4 box)     : 1.130, 1.121, 1.122 Angstrom
Better calculation (ecut 15, 6 5 5 box)      : 1.136, 1.125, 1.126 Angstrom
Even better calculation (ecut 18, 7 6 6 box) : 1.138, 1.126, 1.127 Angstrom
ABINIT Arnardi report (ecut acell unknown)   : 1.136, 1.124, 1.124 Angstrom
VASP Arnardi report (ecut acell unknown)     : 1.136, 1.124,  NA   Angstrom
Experimental : 1.120 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule NON-spin-polarized, in a big box, without tetragonal symmetry, in order to avoid
spurious degeneracy effects coupled to occupation numbers rapidly changing.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization." data-toggle="popover" href="/tests/libxc/Input/t70.abi" target="_blank">t70.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule NON-spin-polarized, in a big box, without tetragonal symmetry, in order to avoid
spurious degeneracy effects coupled to occupation numbers rapidly changing.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization." data-toggle="popover" href="/tests/libxc/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test at a set of decreasing I-I interatomic distances

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_02.abi" target="_blank">tpsic_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test starts from a reasonable I-I interatomic distance, and search for the optimized polaron geometry, without constraint.

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_03.abi" target="_blank">tpsic_03.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : computation of the optimal lattice parameter
Convergence with respect to the number of k points." data-toggle="popover" href="/tests/tutorial/Input/tbase3_4.abi" target="_blank">tbase3_4.abi</a></li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al2 molecule in a big box. Treat 8 bands, occupied using occopt=4.
Compare tolrff and toldff stopping criteria" data-toggle="popover" href="/tests/v5/Input/t41.abi" target="_blank">t41.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with FIRE (ionmov 15)" data-toggle="popover" href="/tests/v8/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiH molecule
test the use of spatial chemical potential. The molecule starts aligned along the x direction,
while the Li chemical potential pulls the Li nucleus.
The z coordinate of the molecule is changed from 0 to 5 Bohr.
There is a linear part to the chemical potential.
The energy and force should be the same in datasets 11 to 15 (without chemical potentiel).
One sees that this is not completely the case.
The force along z vanishes in these cases, because the translational invariance is imposed by ABINIT.
In datasets 21 to 23, the energy should increase linearly, and the force along z should be non-zero and constant.
Small fluctuations are observed.
Dataset 24 and 25 corresponds to the cubic part of the chemical potential.
Dataset 26 places the molecule at a symmetric value of z. The total energy should be the same as with dataset 11, 16, or 21." data-toggle="popover" href="/tests/v8/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiH molecule
test the use of spatial chemical potential. The molecule starts aligned along the x direction,
while the Li chemical potential pulls the Li nucleus toward -z, and the H chemical potential
pushes the H nucleus toward +z. See whether the optimization runs properly." data-toggle="popover" href="/tests/v8/Input/t31.abi" target="_blank">t31.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v9/Input/t189.abi" target="_blank">t189.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
ZnSe wurtzite, rather inaccurate rprimd and xred.
Test automatic correction of rprimd, tnons and xred, as well as
automatic alignment of xred with the FFT grid, within the allowed tolsym tolerance." data-toggle="popover" href="/tests/v9/Input/t193.abi" target="_blank">t193.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule. Quick test of tolwfr coupled with other tolerances" data-toggle="popover" href="/tests/v9/Input/t200.abi" target="_blank">t200.abi</a></li>
</ul>
</details>
<p>Sets a tolerance for the ratio of differences of forces (in hartree/Bohr) to
maximum force, that, reached TWICE successively, will cause one SCF cycle to
stop (and ions to be moved): diffor &lt; tolrff * maxfor.
If set to zero, this stopping condition is ignored.
Effective only when SCF cycles are done (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&gt;0). This tolerance applies
to any particular cartesian component of any atom, INCLUDING fixed ones. This
is to be used when trying to equilibrate a structure to its lowest energy
configuration (select <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a>), or in case of molecular dynamics (<a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a> = 1)
A value of 0.02 is suggested.
This stopping criterion is not allowed for RF calculations.
Since <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a>,  <strong>tolrff</strong>  and <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> are aimed
at the same goal (causing the SCF cycle to stop), they are seen as a unique
input variable at reading. Hence, it is forbidden that two of these input
variables have non-zero values for the same dataset, or generically (for all
datasets). However, a non-zero value for one such variable for one dataset
will have precedence on the non-zero value for another input variable defined
generically.</p>
<p><strong>tolrff</strong> can be coupled with <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>. In that case, SCF cycle is stopped when both criteria are satisfied.
To do so one has to specify both criteria for the same dataset.
Note that a tolerance defined generically does not couple with a criterion defined for one particular dataset.
See <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> for more details about coupling two criteria.</p>
<h2 id="tolvrs"><strong>tolvrs</strong><a class="headerlink" href="#tolvrs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on the potential V(r) ReSidual<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Comment:</em> The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> can differ from zero.<br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a>&lsquo;<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [464/1245] in all abinit tests, [71/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H in isolated boundary conditions (plane waves, PAW).
Tests free boundary conditions Poisson solver for PAW." data-toggle="popover" href="/tests/bigdft/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t32.abi" target="_blank">t32.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Carbon atom
Test the mGGA functionals generating directly XC potentials.
To make the test more poratble, we generate GGA-PBE wave functions as starting point.
Similar to test 08, but with smaller acell and ecut.
Without the use of a &quot;large&quot; xc_denpos, Tran-Blaha is hard to converge. Hypothesis : there is a strong non-linear
region, preventing the Anderson method to work effectively.
Note that the default iscf (=7) does not allow to converge with the default xc_denpos !
By contrast, things are much better behaved with xc_denpos on the order of 1.0e-7 ." data-toggle="popover" href="/tests/libxc/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Testing TB09 XC functional within PAW approach.
Cristalline silicon
Also testing the following variables:
- xc_taupos : filtering of the kinetic energy density
- getkden   : read KE density from previous dataset
- irdkden   : read KE density from an external file" data-toggle="popover" href="/tests/libxc/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Testing TB09 XC functional within PAW approach.
Cristalline silicon
Also testing the following variables:
- xc_taupos : filtering of the kinetic energy density
- getkden   : read KE density from previous dataset
- irdkden   : read KE density from an external file" data-toggle="popover" href="/tests/libxc/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with PAW and spin-orbit coupling. 2x2x2 K grid; low cut-off for test
Test paral_kgb==1 with MPI-FFT/spinor parallelization, the IO of the WFK file,
the output of potential files and the calculation of PJDOS in parallel
(PW term + on-site contributions)" data-toggle="popover" href="/tests/mpiio/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This test check the parallelization over atomic sites both for the ground state
and response function features (within PAW formalism), together with
parallelization over perturbations.
Computation of phonons and response to electric field within PAW (both q=0 and q/=0)
Test on AlAs structure inspired by v6/t62.
Ground state, DDK, effective charges and dielectric tensor are computed.
Phonon modes at q=0 are computed.
Phonon modes at q=(1/4,0,0) and q=(-1/4,1/2/1/4) are computed.
Note: Charge neutrality is not achieved with the present dataset,
but can be easily reached by increasing some parameters; for instance:
(ngkpt 8 8 8, ecut 15., pawecutdg 30.) gives Z(Al)=2.1184310, Z(As)=-2.1184804" data-toggle="popover" href="/tests/mpiio/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the parallelization over spinorial components of WF
Bi A7 structure (2 atoms, treated as semi-conductor),
using PAW, within LDA and spin-orbit coupling.
- with zero magnetization      (nspden=1, nspinor=2)
- with non-collinear magnetism (nspden=4, nspinor=2)" data-toggle="popover" href="/tests/paral/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test for input variable slk_rankpp" data-toggle="popover" href="/tests/paral/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with NC and spin-orbit coupling.
Test RMM-DIIS eigensolver with paral_kgb == 1 and band-spinor MPI parallelization." data-toggle="popover" href="/tests/paral/Input/t32.abi" target="_blank">t32.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : computation of the optimal lattice parameter
Convergence with respect to the number of k points." data-toggle="popover" href="/tests/tutorial/Input/tbase3_4.abi" target="_blank">tbase3_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : optimization of the lattice parameter

Convergence with respect to k points." data-toggle="popover" href="/tests/tutorial/Input/tbase4_2.abi" target="_blank">tbase4_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Lead crystal. Parallelism over k-points" data-toggle="popover" href="/tests/tutorial/Input/tbasepar_1.abi" target="_blank">tbasepar_1.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated like a metal (there is a degeneracy at the Fermi level),
occopt=4 and tsmear=0.04 , with nsppol=2 .
Use spinat to polarize the molecule at start.
Gives total energy of -32.09317 Hartree
This test can be used to check the accuracy of stresses in the
spin-polarized case. Setting acell(1:2) to 7.005 and 6.995
gives ETOT -32.090846193972 and -32.095501753750,
ucvol  441.63023 and 440.37023
so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03,
to be compared with sigma(1)=3.6949713786E-03
and sigma(2)=3.6949681083E-03 from the present test
(the degeneracy is slightly lifted because of incomplete convergence,
using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both
sigma values)." data-toggle="popover" href="/tests/v1/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
3H2 molecule with distant atoms : probe the use of the spinat variable
Use spin-polarized mode, spinor mode, as well as antiferromagnetic mode.
Even consider an initialization with reather crazy, nearly ferromagnetic spinat.
Use PseudosGTH_pwteter/01h.pspgth, in a 8 8 16 box, with 15 Ha cut-off.
Separation is 4 bohr.
Consider anti-parallel spin configuration,  which is the favoured one
for this distance. Get total energy of -0.981 839  Ha .
Note that the spin-polarization is not complete.
Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-toggle="popover" href="/tests/v1/Input/t39.abi" target="_blank">t39.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized. ixc=0. 7 states for each spin.
First, converge using mixing factor, then evaluate RPA dielectric
matrix, and use it for convergence." data-toggle="popover" href="/tests/v1/Input/t53.abi" target="_blank">t53.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
Compares with frozen-phonon calculations. Examine two cases:
varying occupation numbers, and fixed occupation numbers.
A. Varying occupation numbers (occopt=4):
RF calculation in dataset 5 gives
2DE equal to -3.812577 Ha, while finite difference of &quot;TOTAL&quot;
energy (datasets 6 and 7, including entropy term) gives -3.812230 Ha
(the agreement could be better with better finite difference)
B. Fixed occupation numbers (occopt=2):
RF calculation in dataset 8 gives
2DE equal to +5.431807 Ha, while finite difference of total
energy (no entropy term is present with occopt=2) gives +5.431857 Ha
(the agreement could be better with better finite difference)" data-toggle="popover" href="/tests/v2/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Helium q close to Gamma, along Gamma-H
There is a problem with kptopt=1 or 3 for the NSC step." data-toggle="popover" href="/tests/v2/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone,
in test 28. The chosen grid (too coarse, though) is
(0 0 0), (1/4 1/4 0), (1/2 1/2 0), (1/2 0 0),
(1/2 1/4 1/4), (1/2 -1/4 1/4)  (in reduced coordinates).
The ecut and nkpt parameters are really too low (see test 28),
but parameters suitable for physical results (see test 29)
are also provided in the input files." data-toggle="popover" href="/tests/v2/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2.
Use the x-only PBE functional.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.10691 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.10790 Ha
with delta(xred)=0.0001, 189.10703 Ha .
Combining the results gives 189.10675 Ha. The
agreement is quite good, and might likely be improved
by increasing tolvrs." data-toggle="popover" href="/tests/v3/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and GGA.
Similar to test 33 of v2, and preceeding test,
but use the full XC PBE functional.
Also, tolvrs is better.
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 188.81162533 Ha
while finite differences gives :
with delta(xred)=0.0002, 188.81213804 Ha
with delta(xred)=0.0001, 188.81175352 Ha .
Combining the results gives 188.81162525 Ha." data-toggle="popover" href="/tests/v3/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Fe in HCP structure. Low cut-offs and few k-points.
This test is done within GGA and no magnetism in PAW formalism.
The same job is done twice with two differents values of mkmem." data-toggle="popover" href="/tests/v4/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users
Silicon with few k-points and low cut-off" data-toggle="popover" href="/tests/v4/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the pspcod=8 input format (contributed by D.R. Hamann)
This format is primarily intended to offer a flexible platform
for those who wish to experiment with their own features in
norm-conserving pseudopotentials.  A full description and discussion
is given on the ABINIT wiki
https://wiki.abinit.org/doku.php?id=developers:pseudos:psp8_format
This test case, CaO, is an
example of self-interaction-corrected pseudopotentials in the
style of D. Vogel, P. Krueger, and J. Pollmann, Phys. Rev. B 52,
14 316 (1995).  The bandgap (direct) in the test example, 11.2eV,
is in excellent agreement with experiment, but is rather strongly
dependent on the radius at which the self-interaction-correction
of Ca is (smoothly) cut off.  The sic pseudopotentials used in
this test should not be considered anything but early-stage
experiments and should not be used for any other purpose." data-toggle="popover" href="/tests/v4/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
MgB2, space group P6/m m m (#191); Bravais hP (primitive hexag.)
GS calculation followed by a band structure calculation in which the
k-path is automatically defined via the ndivsm input variable.
The third dataset tests the calculation and the output of the Fermi surface (prtfsurf=1)
in the Xcrysden format." data-toggle="popover" href="/tests/v6/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through qptrlatt.
Otherwise, similar to Tv2#26 and Tv6#78." data-toggle="popover" href="/tests/v6/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the WFK, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-toggle="popover" href="/tests/v67mbpt/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-toggle="popover" href="/tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a non-ordered set of atoms. Norm-conserving case.
Similar to v6#97." data-toggle="popover" href="/tests/v67mbpt/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions." data-toggle="popover" href="/tests/wannier90/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Argon FCC
Test the approach of Ambrosetti and Silvestrelli to assess van der Waals interactions." data-toggle="popover" href="/tests/wannier90/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Argon FCC
Test the approach of Silvestrelli to assess van der Waals interactions, combining the QHO model with Wannier functions." data-toggle="popover" href="/tests/wannier90/Input/t13.abi" target="_blank">t13.abi</a> &hellip;</li>
</ul>
</details>
<p>Sets a tolerance for potential residual that, when reached, will cause one SCF
cycle to stop (and ions to be moved).
If set to zero, this stopping condition is ignored.
Effective only when SCF cycles are done (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a>&gt;0).
To get accurate stresses may be quite demanding. For simple materials with
internal positions determined by symmetries, a value of  <strong>tolvrs</strong>  = 10^-12
empirically leads to a very approximate 10^-6 atomic unit accuracy for the
optimized lattice parameter.</p>
<p>Additional explanation: the residual of the potential is the difference
between the input potential and the output potential, when the latter is
obtained from the density determined from the eigenfunctions of the input
potential. When the self-consistency loop is achieved, both input and output
potentials must be equal, and the residual of the potential must be zero. The
tolerance on the potential residual is imposed by first subtracting the mean
of the residual of the potential (or the trace of the potential matrix, if the
system is spin-polarized), then summing the square of this function over all
FFT grid points. The result should be lower than  <strong>tolvrs</strong> .
Since <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a> and  <strong>tolvrs</strong>  are aimed
at the same goal (causing the SCF cycle to stop), they are seen as a unique
input variable at reading. Hence, it is forbidden that two of these input
variables have non-zero values for the same dataset, or generically (for all
datasets). However, a non-zero value for one such variable for one dataset
will have precedence on the non-zero value for another input variable defined
generically.</p>
<p><strong>tolvrs</strong> can be coupled with <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>. In that case, SCF cycle is stopped when both criteria are satisfied.
To do so one has to specify both criteria for the same dataset.
Note that a tolerance defined generically does not couple with a criterion defined for one particular dataset.
See <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> for more details about coupling two criteria.</p>
<h2 id="tolwfr"><strong>tolwfr</strong><a class="headerlink" href="#tolwfr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on the Wavefunction Residuals<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [561/1245] in all abinit tests, [59/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="Water molecule in a big box" data-toggle="popover" href="/tests/bigdft/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with geometry optimisation using BFGS (test the reformating part of the code)." data-toggle="popover" href="/tests/bigdft/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC" data-toggle="popover" href="/tests/built-in/Input/testin_libxc.abi" target="_blank">testin_libxc.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in a box..
Test of prtvol = -2, so stop after init, and echo in a NETCDF file." data-toggle="popover" href="/tests/etsf_io/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure writting the KB form factors to output. This is a two data set run,
the first dataset being a ground state calculation and the writes the WFs + KB form factors" data-toggle="popover" href="/tests/etsf_io/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiF. Interface with CC4S code with NC pseudos.
Use CC4S_FROM_WFK to read the orbitals from an external file produced with istwfk 2 (real orbitals)" data-toggle="popover" href="/tests/gwr/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure" data-toggle="popover" href="/tests/psml/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure" data-toggle="popover" href="/tests/psml/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon

Computation of the band structure.
First, a SCF density computation, then a non-SCF band structure calculation." data-toggle="popover" href="/tests/tutorial/Input/tbase3_5.abi" target="_blank">tbase3_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-toggle="popover" href="/tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections
Dataset 1: ground state calculation to get the density
Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ
Dataset 3: calculation of the screening (epsilon^-1 matrix for W)
Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)" data-toggle="popover" href="/tests/tutorial/Input/tgw1_1.abi" target="_blank">tgw1_1.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Yb (1 atom per unit cell),
using a l=3 psp with s local part.
Crazy cut-off and number of k points.
Shows that the derivative of the eigenenergies
with respect to the wavevector can be obtained
both by finite differences and analytical means
(from a preliminary computation in the
treatment of the ddk perturbation).
For the (0.25,0.25,0.25) k point,
the tenth band eigenvalue is -3.01209 eV.
Going to the (0.251,0.251,0.251) k point
it becomes -3.00562 eV, with finite-difference
estimation of the derivative with respect
to ONE wavevector change (all three
components changed) being 0.00647 eV/0.001/3=2.157 eV
This value is unchanged when using the
data at the (0.253,0.253,0.253) k point.
The analytical value is 2.15566 eV." data-toggle="popover" href="/tests/v3/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
First dataset : compute the density
Second dataset : compute the spinor wfs at one k point,
non-self consistently
Third dataset : use the spinor wfs of the previous dataset
to restart computations at symmetric k points." data-toggle="popover" href="/tests/v3/Input/t13.abi" target="_blank">t13.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni atom in a big box.
Test the use of the atvshift variable :
change the potential of the d orbitals." data-toggle="popover" href="/tests/v5/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the extension of the pspcod=8 input format to include
spin-orbit coupling with multiple non-local projectors.  The
band structure of fcc Pt is computed at Gamma, X, and L.
The pseudopotential used in the test is generated by the open-source
ONCVPSP code, which is available at www.mat-simresearch.com, and
described in D. R. Hamann, Phys. Rev. B 88, 085177 (2013).
The relativistic extension is documented in the code package.
The Pt 5s and 5p semi-cores are treated as valence, and the band
structure is well-converged at the ecut used in the test (20 Ha).
A complete description of the input format is avaiable in
doc/psp_infos/psp8_info.txt." data-toggle="popover" href="/tests/v7/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Similar to v7[07]. Here we test optdriver 8 (WFK post-processing) with NC
and SO. More specifically, we reconstruct the wavefunctions in the full BZ in
dataset 2 and we use this WFK to restart the calculation in dataset 3 with
the full k-mesh (kptopt 3). The SCF cycle should exit at the first iteration
since the wavefunctions are already converged." data-toggle="popover" href="/tests/v7/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fake body-centered tetragonal crystal
This test checks the capability of ABINIT to identify and correct inaccurate primitive vectors
using the tolsym input variable." data-toggle="popover" href="/tests/v7/Input/t13.abi" target="_blank">t13.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-toggle="popover" href="/tests/v8/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Computation of elastic tensor and internal strain in DFPT+PAW
Ground state is computed.
DFPT is computed" data-toggle="popover" href="/tests/v8/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation with constrained charges
Constrain the charge around atom 1 to the value 0.5, then work with both atoms and larger spheres

For dataset 2, the derivative wrt the constraint, the derivative of the total energy with respect to atomic displacement
and the stress calculations have been checked, as follows.

Initially, the total energy is -0.99164352451, the target charge is 0.5, and the gradient wrt the charge is computed -0.58356219787.
Changing the target charge by +0.001 gives etotal -0.99222576777
Changing the target charge by -0.001 gives etotal -0.99105864425
Finite-difference gives -0.5835617, in excellent agreement for that level of methodology.

For atom 1, dE/dtau (=-force in reduced coordinate) is computed 8.330114676.
Changing the atomic position of the first atom from -1.1 to -1.10015
gives etotal -0.99172669330, to -1.09985 gives etotal -0.99156009221, delivering 8.330054.
The result of a similar finite-difference estimation with twice bigger values gives 8.329896.
Combining both results to eliminate the quadratic error gives 8.330107, with an agreement of 5 digits with dE/dtau.

The stress is computed 2.755820639e-4 .
Multiplying both acell and xcart by 1.001 gives etotal -0.99122698240.
Multiplying both acell and xcart by 0.999 gives etotal -0.99205366103.
The derivative of total energy wrt to strain is thus 0.41333932. Dividing by the unit cell volume (1500) gives 2.75559e-4 ,
in excellent agreement for that level of methodology." data-toggle="popover" href="/tests/v8/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 06 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 08 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure. PAW. GGA-PBE. Treated with nsppol=1.
Generate the data for optic (linear coefficients).
to be analysed in test 10 (netcdf files with h1 matrix elements)." data-toggle="popover" href="/tests/v9/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>The signification of this tolerance depends on the basis set. In plane waves,
it gives a convergence tolerance for the largest squared &ldquo;residual&rdquo; (defined
below) for any given band. The squared residual is:</p>
<div>
<div class="MathJax_Preview">
\langle \nk| (H - \enk)^2 |\nk \rangle, \,\text{with}\; \enk = \langle \nk|H|\nk \rangle
</div>
<script type="math/tex; mode=display">
\langle \nk| (H - \enk)^2 |\nk \rangle, \,\text{with}\; \enk = \langle \nk|H|\nk \rangle
</script>
</div>
<p>which clearly is non-negative and goes to 0 as the iterations converge to an
eigenstate. With the squared residual expressed in Hartrees^2  (Hartrees
squared), the largest squared residual (called <em>residm</em> in the code) encountered over all
bands and k-points must be less than <strong>tolwfr</strong> for iterations to halt due to successful convergence.
Note that if <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt; 0, this criterion should be replaced by those based on
<a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> (preferred for <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a> == 0), <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a> <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a> (preferred for
<a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a> /= 0), or <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> (preferred for theoretical reasons!).
When <strong>tolwfr</strong> is 0.0, this criterion is ignored, and a finite value of
<a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> must be specified. This also imposes a
restriction on taking an ion step; ion steps are not permitted unless the
largest squared residual is less than <strong>tolwfr</strong>, ensuring accurate forces.
To get accurate stresses may be quite demanding.
Note that the preparatory GS calculations before a RF calculations must be highly converged.
Typical values for these preparatory runs are <strong>tolwfr</strong> between 1.0d-16 and 1.0d-22.</p>
<p>Note that <strong>tolwfr</strong> is often used in the test cases, but this is
purely for historical reasons: except when <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &lt; 0, <strong>other criteria should be used</strong>.
Indeed, the squared residual can be small even with non self-consistent density and potential.</p>
<p><strong>tolwfr</strong> alone should not be used as SCF criterion, but it can be coupled with <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a>.
In that case, SCF cycle is stopped when both criteria are satisfied.
That way one can insure that physical properties are converged (=SCF converged) while insuring that wavefunctions are converged.
For example, a ground state computations done before DFPT can use stringent values of <strong>tolwfr</strong> in addition to a desired criterion on self-consistency.</p>
<p><strong>tolwfr</strong> is coupled with an other tolerance only if both criteria are specified for one particular dataset, or if both criteria are given generically.
If a single criterion is given (for a single dataset or generically), it will not be coupled with another criterion (defined generically or for a single dataset, respectfully).</p>
<p>In the wavelet case (see <a class="wikilink codevar-wikilink" href="/variables/basic#usewvl">usewvl</a> = 1), this criterion is the favoured one.
It is based on the norm 2 of the gradient of the wavefunctions.
Typical values range from 5*10^-4  to 5*10^-5.</p>
<h2 id="tolwfr_diago"><strong>tolwfr_diago</strong><a class="headerlink" href="#tolwfr_diago" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on WaveFunction squared Residual at the DIAGOnalization level<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a><br />
<em>Added in version:</em> 9.11.3  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [9/1245] in all abinit tests, [1/159] in abinit tutorials</summary><ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, with PAW.
Test the IO routines with paral_kgb in [1, 0] and different combinations
of parameters (npfft, npband, np_spkpt).
Test the plane wave load balancing procedure (pw_unbal_thresh).
Test also the computation of PJDOS." data-toggle="popover" href="/tests/mpiio/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, with NC pseudo generated with oncvps-3.2.3.
Test the IO routines with paral_kgb in [1, 0] and different combinations
of parameters (npfft, npband, np_spkpt).
Test also prtdos (PJDOS) in parallel with MPI-FFT.
Similar to t26.in" data-toggle="popover" href="/tests/mpiio/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, NC pseudopotentials.
Test the IO routines for a typical DFPT calculation" data-toggle="popover" href="/tests/mpiio/Input/t51.abi" target="_blank">t51.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Test for input variable slk_rankpp" data-toggle="popover" href="/tests/paral/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz.
Ground state with LOBPCG + RMM-DIIS eigensolver and paral_kgb parallelism with 4 MPI procs." data-toggle="popover" href="/tests/paral/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test band parallelism in DFPT with PAW" data-toggle="popover" href="/tests/paral/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for SrVO3 using Hubard I code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t86.abi" target="_blank">t86.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test starts from a reasonable I-I interatomic distance, and search for the optimized polaron geometry, without constraint.

Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_03.abi" target="_blank">tpsic_03.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolwfr_diago with lobpcg (114)." data-toggle="popover" href="/tests/v9/Input/t202.abi" target="_blank">t202.abi</a></li>
</ul>
</details>
<p>This criterion is the same than <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>, but used to control the diagonalization algorithm instead of the SCF cycles.
In practice it is used to reduce the number of &ldquo;lines&rdquo; done at the diagonalization step (see <a class="wikilink codevar-wikilink" href="/variables/gstate#nline">nline</a>), saving computational time.
If the squared residual becomes lower than <strong>tolwfr_diago</strong>, the remaining &ldquo;lines&rdquo; to be done are skipped.
For LOBPCG, &ldquo;lines&rdquo; are skipped if the biggest squared residual of the block is less than <strong>tolwfr_diago</strong>.
If <strong>tolwfr_diago</strong>=0, <a class="wikilink codevar-wikilink" href="/variables/gstate#nline">nline</a> &ldquo;lines&rdquo; are done at every self-consistent step.
By default <strong>tolwfr_diago</strong> is equal to <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>, but can be used independently.
One can use <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> (or any other tolerance) to define a criterion for SCF cycles, and use <strong>tolwfr_diago</strong> to save computational time.
However, when <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>&gt;0, <strong>tolwfr_diago</strong>&gt;<a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> is forbidden as the SCF cycles cannot converge in that case.</p>
<p>For <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a>=114 only (LOBPCG), if <strong>tolwfr_diago</strong>=0 then it is set to 1e-20 internally.
As a consequence, to ensure that no lines are skipped one has to set <strong>tolwfr_diago</strong>=1e-30 in the input (instead of 0) in this particular case.</p>
<h2 id="typat"><strong>typat</strong><a class="headerlink" href="#typat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TYPe of AToms<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to specify the types of atoms that form the system" data-toggle="popover" href="/topics/AtomTypes">topic_AtomTypes</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> [3, &lsquo;<a class="wikilink codevar-wikilink" href="/variables/geo#natrd">natrd</a>&rsquo;] if <a class="wikilink codevar-wikilink" href="/variables/geo#natrd">natrd</a>&lt;<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>,
[3, &lsquo;<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>&rsquo;] otherwise.</p>
<p><em>Default value:</em> 1 if <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a> == 1,
None otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1220/1245] in all abinit tests, [147/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Array giving an integer label to every atom in the unit cell to denote its
type.
The different types of atoms are constructed from the pseudopotential files.
There are at most <a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a> types of atoms.
As an example, for BaTiO3, where the pseudopotential for Ba is number 1, the
one of Ti is number 2, and the one of O is number 3, the actual value of the
 <strong>typat</strong>  array might be:</p>
<div class="codehilite"><pre><span></span><code>  typat 1 2 3 3 3
</code></pre></div>

<p>The array  <strong>typat</strong>  has to agree with the actual locations of atoms given in
<a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#xcart">xcart</a>, and the input of pseudopotentials has to
be ordered to agree with the atoms identified in  <strong>typat</strong> .
The nuclear charge of the elements, given by the array <a class="wikilink codevar-wikilink" href="/variables/basic#znucl">znucl</a>, also must
agree with the type of atoms designated in &rdquo; <strong>typat</strong> &ldquo;.
The array  <strong>typat</strong>  is not constrained to be increasing, so</p>
<div class="codehilite"><pre><span></span><code>  typat 3 3 2 3 1
</code></pre></div>

<p>is permitted. An internal
representation of the list of atoms, deep in the code (array atindx), groups
the atoms of same type together. This should be transparent to the user, while
keeping efficiency.</p>
<h2 id="udtset"><strong>udtset</strong><a class="headerlink" href="#udtset" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Upper limit on DaTa SETs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a multi dataset calculation" data-toggle="popover" href="/topics/multidtset">topic_multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> None<br />
<em>Comment:</em> It is not used when it is not defined<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [51/1245] in all abinit tests, [12/159] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of various XC functionals for the response functions
(thus, the XC kernel is also tested).
The test includes 3 different functionals:
1) Perdew-Zunger: ixc=2 and ixc=-001009
2) PBE: ixc=11 and ixc=-101130
3) Perdew-Wang92: ixc=7, ixc=-001012, and ixc=-001013
The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent
unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting
some lines indicated by GMR.
Note that the underlying FFT grid does not have the symmetry of the
lattice." data-toggle="popover" href="/tests/libxc/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of the Perdew-Zunger XC functionals for the response functions
(thus, the XC kernel is also tested) in PAW." data-toggle="popover" href="/tests/libxc/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.abo" data-toggle="popover" href="/tests/paral/Input/t60.abi" target="_blank">t60.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Z2Pack (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tz2_2.abi" target="_blank">tz2_2.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_4.abi" target="_blank">teph_tdep_legacy_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Al fcc metal - elastic constant calculation" data-toggle="popover" href="/tests/tutorespfn/Input/telast_6.abi" target="_blank">telast_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom.
Here, a double loop has been used." data-toggle="popover" href="/tests/tutorial/Input/tbase2_2.abi" target="_blank">tbase2_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom.
Here, a double loop has been used." data-toggle="popover" href="/tests/tutorial/Input/tbase2_3.abi" target="_blank">tbase2_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to optimize the H2 bond length, compute the associated total
energy, then to compute the total energy of the isolated H atom.
Here, the ecut and acell are fixed : the double loop reduces
effectively to a single loop." data-toggle="popover" href="/tests/tutorial/Input/tbase2_4.abi" target="_blank">tbase2_4.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.
Double-loop over acell and ecut using series" data-toggle="popover" href="/tests/v1/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.
Double-loop over acell and ecut using metacharacters only." data-toggle="popover" href="/tests/v1/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Mg atom, in a big box, displaced from the center,
test different k points with time-reversal symmetry, and different fftalg values." data-toggle="popover" href="/tests/v1/Input/t89.abi" target="_blank">t89.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP, with symmetries" data-toggle="popover" href="/tests/v10/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Aluminum in FCC structure.
For occopt=4,5,6,7 , determination of the total energy
at slightly different tsmear values, and check of the
dE/d(tsmear)=-kT.entropy relationship.
For example, for occopt=4, the difference between tsmear=0.101 and
tsmear=0.099 is -11.149450d-6 Ha , while the value of -kT.entropy
is -5.574709d-4Ha, that is about 500 larger, as expected." data-toggle="popover" href="/tests/v2/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Aluminum in FCC structure.
At fixed tsmear (=0.04), check the convergence with respect
to the number of k points, for different occopt.
The grids that are tested have respectively 10, 28, and 60 k points
in the IZB (ngkpt values are 4 4 4 4, 6 6 6 4 and 8 8 8 4
For occopt=4, the total energy (or the enthalpy)
is -2.079770 Ha, -2.080534 Ha, -2.080672 Ha ;
for occopt=5, it is -2.079787 Ha, -2.080563 Ha, -2.080693 Ha ;
for occopt=7, it is -2.084211 Ha, -2.084861 Ha, -2.084916 Ha.
The latter values can be corrected by computing the mean of the
total energy and the internal energy, as described in Marzari&#x27;s
thesis, for example. Thanks to this procedure, one gets :
-2.079732 Ha, -2.080470 Ha, and -2.080626 Ha.
For information, with a 12 12 12 4 grid (182 k points)
and occopt=4, one gets -2.080648 Ha." data-toggle="popover" href="/tests/v2/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box.
Comparison of the modified Broyden algorithm (ionmov=3) with the
original one (ionmov=2). Start with different values
of xcart, from 0.6 to 1.1, by step of 0.1 . The number of Broyden
steps needed to reach acceptable residual forces
with the ionmov=3 algorithm are : 3, 2, 2, 3, 3, 4, while
with the ionmov=2 algorithms, one get : 4, 3, 2, 5, and then,
either the algorithm does not converge within 8 steps, or it
converges to a saddle point of the energy !
This test was hard to make portable. This is why the tolerance
for fldiff is very large." data-toggle="popover" href="/tests/v2/Input/t48.abi" target="_blank">t48.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Mg atom, in a big box, displaced from the center,
test different k points with time-reversal symmetry, and different
fftalg values (4xx) corresponding to the 2002 FFT of SGoedecker." data-toggle="popover" href="/tests/v3/Input/t50.abi" target="_blank">t50.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
GeTe in rhombohedral structure
Test the computation of phonons, dielectric tensor and Born effective
charges, with and without spin-orbit coupling." data-toggle="popover" href="/tests/v5/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NH3 and NH2-CH3 molecules , supercell geometry
Show the computations needed to obtain the differential
pseudopotentials PseudosTM_pwteter/7n.pspnc (just usual atomic configuration)
and 7n.1s_psp.mod (with a hole in state 1s).
The differential core-level shift is obtained by comparing
difference in the total energies of the NH3 molecule with both pseudopotentials
with the one of the NH2CH3 molecule :
0.41522 Ha for the NH3 molecule
0.41768 Ha for the NH2-CH3 molecule, making for a shift of 2.46 mHa=0.0669 eV
due to the replacement of one H atom of the NH3 molecule by a CH3 group.
Note that these are completely non converged values. Parameters
like ecut and acell should be the subject of a convergence study.
For applications of this technique, see
Rignanese GM et al, Phys. Rev. Lett. 79, 5174 (1997),
or Travaly Y et al, Phys. Rev. B 61, 7716 (2000)." data-toggle="popover" href="/tests/v5/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth atom, isolated, in a supercell.
Compares different spin treatments :
- spin-polarized collinear (nspinor=1, nspden=2, nsppol=2, no spin-orbit)
- spinor (nspinor=2, nspden=4, nsppol=1, no spin-orbit)
Both with fixed occupation numbers and metallic occupations.
This test has been contributed by L.E. Diaz.
Additional test added for kinetic energy density by A. Lherbier" data-toggle="popover" href="/tests/v5/Input/t51.abi" target="_blank">t51.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bi atom in a big supercell.
Test the application of a Zeeman field." data-toggle="popover" href="/tests/v6/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon. Diamond structure.
Quick test of the use of datasets with a numbering beyond 1000 (the last one is 1022).
(Tests 35-40 are for response-function)" data-toggle="popover" href="/tests/v6/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Generate first-order responses for FCC Aluminum.
Very low cut-off, to keep CPU the lowest possible
Aim at a regular sampling of phonon wavevectors, needed to
interpolate the dynamical matrix over the whole Brillouin Zone.
Use the definition through qptrlatt.
Otherwise, similar to Tv2#26 and Tv6#78." data-toggle="popover" href="/tests/v6/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-toggle="popover" href="/tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Fake body-centered tetragonal crystal
This test checks the capability of ABINIT to identify and correct inaccurate primitive vectors
using the tolsym input variable." data-toggle="popover" href="/tests/v7/Input/t13.abi" target="_blank">t13.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Diamond dynamical temperature-dependent of the electronic structure.
Three q-points are computed." data-toggle="popover" href="/tests/v7/Input/t55.abi" target="_blank">t55.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (spin-polarized, non-linear XC core correction, LDA)
Fixed occupation numbers. The parameters have been artifically tuned
with the goal to find a small system that reproduces the typical 1D-configuration coordinate diagram,
with a first total energy curve that shows a minimum, a second (different occupations) total energy curve
that shows a slightly higher minimum, at a slightly larger interatomic distance, and then the two total energy curves
cross at an even slightly larger interatomic distance.
This system will be used as a test bed for the next tests" data-toggle="popover" href="/tests/v8/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=4
Check jointly the charge and vector magnetization constraints, with differing vector orientations." data-toggle="popover" href="/tests/v8/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LiH molecule
test the use of spatial chemical potential. The molecule starts aligned along the x direction,
while the Li chemical potential pulls the Li nucleus.
The z coordinate of the molecule is changed from 0 to 5 Bohr.
There is a linear part to the chemical potential.
The energy and force should be the same in datasets 11 to 15 (without chemical potentiel).
One sees that this is not completely the case.
The force along z vanishes in these cases, because the translational invariance is imposed by ABINIT.
In datasets 21 to 23, the energy should increase linearly, and the force along z should be non-zero and constant.
Small fluctuations are observed.
Dataset 24 and 25 corresponds to the cubic part of the chemical potential.
Dataset 26 places the molecule at a symmetric value of z. The total energy should be the same as with dataset 11, 16, or 21." data-toggle="popover" href="/tests/v8/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v9/Input/t189.abi" target="_blank">t189.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="Argon FCC
Test the approach of Ambrosetti and Silvestrelli to assess van der Waals interactions." data-toggle="popover" href="/tests/wannier90/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Argon FCC
Test the approach of Silvestrelli to assess van der Waals interactions, combining the QHO model with Wannier functions." data-toggle="popover" href="/tests/wannier90/Input/t13.abi" target="_blank">t13.abi</a> &hellip;</li>
</ul>
</details>
<p>Used to define the set of indices in the multi-data set mode, when a double
loop is needed (see later).
The values of  <strong>udtset</strong> (1) must be between 1 and 999, the values of
 <strong>udtset</strong> (2) must be between 1 and 9, and their product must be equal to
<a class="wikilink codevar-wikilink" href="/variables/basic#ndtset">ndtset</a>.
The values of <a class="wikilink codevar-wikilink" href="/variables/basic#jdtset">jdtset</a> are obtained by looping on the two indices defined by
 <strong>udtset</strong> (1) and  <strong>udtset</strong> (2) as follows:</p>
<div class="highlight"><pre><span></span><code><span class="k">do </span><span class="n">i1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">intarr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
 <span class="k">do </span><span class="n">i2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">intarr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">idtset</span><span class="o">=</span><span class="n">idtset</span><span class="o">+</span><span class="mi">1</span>
  <span class="n">dtsets</span><span class="p">(</span><span class="n">idtset</span><span class="p">)%</span><span class="n">jdtset</span><span class="o">=</span><span class="n">i1</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">i2</span>
 <span class="k">end do</span>
<span class="k">end do</span>
</code></pre></div>
<p>So,  <strong>udtset</strong> (2) sets the largest value for the unity digit, that varies
between 1 and  <strong>udtset</strong> (2).
If  <strong>udtset</strong>  is used, the input variable <a class="wikilink codevar-wikilink" href="/variables/basic#jdtset">jdtset</a> cannot be used.</p>
<h2 id="usewvl"><strong>usewvl</strong><a class="headerlink" href="#usewvl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Use WaVeLet basis set<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculations on a wavelet basis" data-toggle="popover" href="/topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Comment:</em> use plane-wave basis set<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [27/1245] in all abinit tests, [9/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a> &hellip;</li>
</ul>
</details>
<p>Used to define if the calculation is done on a wavelet basis set or not.
The values of  <strong>usewvl</strong>  must be 0 or 1. Putting  <strong>usewvl</strong>  to 1, makes
<a class="wikilink codevar-wikilink" href="/variables/gstate#icoulomb">icoulomb</a> mandatory to 1. The number of band (<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>) must be set
manually to the strict number need for an isolator system ( <em>i.e.</em> number of
electron over two). The cut-off is not relevant in the wavelet case, use
<a class="wikilink codevar-wikilink" href="/variables/basic#wvl_hgrid">wvl_hgrid</a> instead.
In wavelet case, the system must be isolated systems (molecules or clusters).
All geometry optimization are available (see <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a>, especially the
geometry optimisation and the molecular dynamics).
The spin computation is not currently possible with wavelets and metallic
systems may be slow to converge.</p>
<h2 id="wtk"><strong>wtk</strong><a class="headerlink" href="#wtk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WeighTs for K points<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>)<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a> * 1.0<br />
<em>Comment:</em> Except when <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a>/=0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [240/1245] in all abinit tests, [0/159] in abinit tutorials</summary><ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Helium atom in a box. NC, only local potential (too smooth to reproduce experiment).
Simple system for testing Hartree-Fock and the SCF algorithms with OpenMP GPU. Start from PBE." data-toggle="popover" href="/tests/gpu_omp/Input/t29.abi" target="_blank">t29.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Oxygen atom
Test a few functionals for which HGH pseudopotentials are available (from M. Krack),
that are present also in the lib XC, but not in the native ABINIT set of functionals." data-toggle="popover" href="/tests/libxc/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Carbon atom
Test the Becke-Johnson mGGA functional, generating directly XC potentials.
Convergence parameters are quite high, and the test is reasonably portable.
To make the test more portable, we generate GGA-PBE wave functions as starting point." data-toggle="popover" href="/tests/libxc/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a conductivity calculation (test v5#t10)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 10.
It tests the following parts of the code:
optic_paw, optic_paw_core
Note that, in addition to the psp file, the core wave functions file is needed." data-toggle="popover" href="/tests/v5/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule, using a local pseudopotential, and Wu-Cohen GGA.
Similar to test v3#08
Compute the interatomic force constant for the
displacement of the second atom along x.
RF calculation of the 2DTE gives 189.49410411 Ha
while finite differences gives :
with delta(xred)=0.0002, 189.4945677  Ha
with delta(xred)=0.0001, 189.49422003  Ha .
Combining the results gives 189.4941041 Ha. Perfect !" data-toggle="popover" href="/tests/v5/Input/t29.abi" target="_blank">t29.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with and without PAW XML data (FJollet)" data-toggle="popover" href="/tests/v7/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for PWPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t61.abi" target="_blank">t61.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for GPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t101)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 101.
It tests the following parts of the code:
optic_paw, optic_paw_core, optic_paw_soc
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t100.abi" target="_blank">t100.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t102)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 103.
It tests the following parts of the code:
optic_paw_core
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t102.abi" target="_blank">t102.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule. Quick test of tolwfr coupled with other tolerances" data-toggle="popover" href="/tests/v9/Input/t200.abi" target="_blank">t200.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the k point weights.
The k point weights will have their sum (re)normalized to 1 (unless
<a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a> = 2 and <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> = 0; see description of <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>) within the
program and therefore may be input with any arbitrary normalization. This
feature helps avoid the need for many digits in representing fractional weights such as &#8531;.
 <strong>wtk</strong>  is ignored if <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> is not positive, except if <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> = -3.</p>
<h2 id="wvl_hgrid"><strong>wvl_hgrid</strong><a class="headerlink" href="#wvl_hgrid" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WaVeLet H step GRID<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform calculations on a wavelet basis" data-toggle="popover" href="/topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.5<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [27/1245] in all abinit tests, [9/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a> &hellip;</li>
</ul>
</details>
<p>It gives the step size in real space for the grid resolution in the wavelet
basis set. This value is highly responsible for the memory occupation in the
wavelet computation. The value is a length in atomic units.</p>
<h2 id="xcart"><strong>xcart</strong><a class="headerlink" href="#xcart" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> vectors (X) of atom positions in CARTesian coordinates<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">EVOLVING</a>, <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,min(<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>,<a class="wikilink codevar-wikilink" href="/variables/geo#natrd">natrd</a>))<br />
<em>Default value:</em> None<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [203/1245] in all abinit tests, [34/159] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.  Write t17o_DEN (prtden=1)." data-toggle="popover" href="/tests/fast/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule NON-spin-polarized, in a big box, without tetragonal symmetry, in order to avoid
spurious degeneracy effects coupled to occupation numbers rapidly changing.
GPU
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization." data-toggle="popover" href="/tests/gpu_omp/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock with time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock without time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule non-spin-polarized, in a big box.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with underconverged ecut (ecut 18) and box size (5 4 4 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation  (ecut 18, 5 4 4 box) : 1.101, 1.084, 1.085 Angstrom
Better  calculation  (ecut 22, 6 5 5 box) : 1.102, 1.086, 1.086 Angstrom
ABINIT Arnardi report (ecut acell unknown): 1.103, 1.091, 1.092 Angstrom
VASP Arnardi report (ecut acell unknown)  : 1.103, 1.089,  NA   Angstrom
Experimental : 1.098 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule spin-polarized, in a big box.
Norm conserving : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with underconverged ecut (ecut 15) and box size (4 3 3 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation  (ecut 13, 5 4 4 box) : 1.138, 1.130, 1.131 Angstrom
Better  calculation  (ecut 18, 7 6 6 box) : 1.135, 1.124, 1.125 Angstrom
ABINIT Arnardi report (ecut acell unknown): 1.136, 1.124, 1.124 Angstrom
VASP Arnardi report (ecut acell unknown)  : 1.136, 1.124,  NA   Angstrom
Experimental : 1.120 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule spin-polarized, in a big box.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with slightly better converged ecut (ecut 15) and box size (6 5 5 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation (ecut 13, 5 4 4 box)     : 1.130, 1.121, 1.122 Angstrom
Better calculation (ecut 15, 6 5 5 box)      : 1.136, 1.125, 1.126 Angstrom
Even better calculation (ecut 18, 7 6 6 box) : 1.138, 1.126, 1.127 Angstrom
ABINIT Arnardi report (ecut acell unknown)   : 1.136, 1.124, 1.124 Angstrom
VASP Arnardi report (ecut acell unknown)     : 1.136, 1.124,  NA   Angstrom
Experimental : 1.120 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t69.abi" target="_blank">t69.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-toggle="popover" href="/tests/paral/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using old, rather inaccurate psps.
Computation of the Berry phase.
Test the doubling of the step of the sampling." data-toggle="popover" href="/tests/seq/Input/tsv3_04.abi" target="_blank">tsv3_04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaF Sodium Fluoride FCC (rocksalt structure) with 2 atoms per cell.
Test computation of the Berry phase in PAW." data-toggle="popover" href="/tests/seq/Input/tsv5_112.abi" target="_blank">tsv5_112.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_6.abi" target="_blank">tw90_6.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
Finite difference calculation of the Born effective charges of AlP" data-toggle="popover" href="/tests/tutorespfn/Input/tpolarization_1.abi" target="_blank">tpolarization_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Finite difference calculation of d chi / d tau of AlP" data-toggle="popover" href="/tests/tutorespfn/Input/tnlo_5.abi" target="_blank">tnlo_5.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated like a metal (there is a degeneracy at the Fermi level),
occopt=4 and tsmear=0.04 , with nsppol=2 .
Use spinat to polarize the molecule at start.
Gives total energy of -32.09317 Hartree
This test can be used to check the accuracy of stresses in the
spin-polarized case. Setting acell(1:2) to 7.005 and 6.995
gives ETOT -32.090846193972 and -32.095501753750,
ucvol  441.63023 and 440.37023
so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03,
to be compared with sigma(1)=3.6949713786E-03
and sigma(2)=3.6949681083E-03 from the present test
(the degeneracy is slightly lifted because of incomplete convergence,
using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both
sigma values)." data-toggle="popover" href="/tests/v1/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated as a spin-polarized molecule, with fixed occupation
numbers (occopt=2), with nsppol=2 . Gives total energy of -32.09792 Hartree" data-toggle="popover" href="/tests/v1/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated carbon atom, with PseudosTM_pwteter/6c.pspnc pseudopotential
Test a non-spherical, spin-polarized atom, with nsym=2.
In order to have a fast computation, the cut-off, 19Ha,
is not large enough for good convergence, as well as the box size 9x9x9.
With better convergence parameters, it can be used to find
the atomization energy of carbon-containing molecules." data-toggle="popover" href="/tests/v1/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (non-spin-polarized, non-linear XC core correction, GGA)
Computation of forces in the GGA, and comparison with a finite
difference of energy.
The direct computation of force (dataset 2) gives 0.627251486 Ha/Bohr
A simple finite-difference estimation (dataset 1 and 3) gives
0.627251265 Ha/Bohr. The agreement can be improved if a better
finite-difference estimation is used." data-toggle="popover" href="/tests/v2/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (non-spin-polarized, non-linear XC core correction, GGA)
Computation of uniaxial stresses in the GGA,
and comparison with a finite difference of energy.
The direct computation of sigma(zz) stress (dataset 2)
gives 0.964267876d-3 Ha/Bohr**3
A simple finite-difference estimation (dataset 1 and 3) gives
a difference in total energy of 0.085048409d-3 Ha,
for a difference of volume of 0.0882 Bohr**3 leading
to a stress estimation of 0.96426768d-3 Ha/Bohr**3
The agreement can be improved if a better finite-difference
estimation is used." data-toggle="popover" href="/tests/v2/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
(HeH)+ in a big box. Computation of excitation energies in TDDFT,
in the following approximations : TDxOEP/xOEP, TDLDA/xOEP,
BPG hybrid/xOEP." data-toggle="popover" href="/tests/v2/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 diatomic molecule. Spin-polarized (ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=1 (Teter LSDA)
From dataset 2 and 3, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 10.88934274 Ha, while the direct computation,
in dataset 4 gives 10.88933963 Ha .

Cannot be executed in parallel

chkinp: Checking input parameters for consistency, jdtset= 3.

--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number :
1 The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential version
of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v3/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 diatomic molecule. Spin-polarized (ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=7 (Perdew-Wang 92 LSDA)
From dataset 2 and 3, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 10.88283478 Ha, while the direct computation,
in dataset 4 gives 10.882832 Ha .

Cannot be executed in parallel
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v3/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 diatomic molecule. Spin-polarized (anti-ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=1 (Teter LSDA)
From datasets 3 and 4, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 6.283100652 Ha, while the direct computation,
without using Shubnikov symmetries, gives
6.282967527 Ha." data-toggle="popover" href="/tests/v3/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgO molecule, with low cut-off, in a big box, and one k point.
Pseudopotentials WITHOUT a non-linear core correction.
Prepare the Bader density analysis" data-toggle="popover" href="/tests/v4/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
5-atom Al slab, with three vacuum layers.
First, converge the wavefunctions, then compute the
STM charge density below and above the Fermi energy, within a 2eV range.
Also compute band-by-band decomposition of STM charge density below the Fermi energy, within a 2eV range." data-toggle="popover" href="/tests/v4/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Mg2 molecule chains, in a slab supercell geometry.
Symmetries are broken. k point (1/4 1/4 1/4)
Use of default values of fftalg and exchn2n3
Reference for test #92." data-toggle="popover" href="/tests/v4/Input/t91.abi" target="_blank">t91.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ni molecule in a big box.
Test the use of the atvshift variable
First dataset : no shift, the ten states number 9 to 18
come from the 3d atomic states, the state number 19 is a bonding 4s state.
States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1).
State number 18 is a 3d sigma antibonding state (m=0).
Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the
levels change by less than 0.0002 (and their energy decrease), except state number
9 (a 3d sigma bonding state (m=0)), that goes from -0.24020 to -0.23982 (+0.0004)
and state number 18, that goes from -0.15439 to 0.15399 (+0.0004).
Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials.
All the levels are affected (likely the m=1 and -1 orbitals adjust, and cause modification
of the potential), but the states 10, 11, 16, and 17 increase their energy, while the
other state see their energy decrease.
Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking
of the degeneracy.
This test was not easy to make portable. The problem lies in the fact that when the density
becomes negative, due to Bragg oscillations, the xc kernel can be extremely large, and when
use for the prediction of the residual of the forces, the differences between machines
can be extremely large. IN order to see this effect, put ecut 7 and npulayit 7 (its default value)." data-toggle="popover" href="/tests/v5/Input/t15.abi" target="_blank">t15.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen dimer in a big cell.
Produce different files (_DEN, _POT, _VHXC, _VHA), for subsequent analysis by CUT3D (see next run).
Note the following values, that will allow to check the correctness of the subsequent analysis :
Kinetic energy  =  1.02998395409183E+00
Hartree energy  =  8.05073794254872E-01
Loc. psp. energy= -2.53949740885919E+00
Band energy (Ha)=  -7.2732761066E-01
Also, the mean of the Vxc potential is announced to be
Average Vxc (hartree)=  -0.05293" data-toggle="popover" href="/tests/v6/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl molecule in a big box.
Test of the computation of the polarisation with the routine berryphase_new,
for different k-point grids : only 1 k-point, a line of k-points, and a full mesh of k-points.
Results with acell 20 10 10 are : -9.727 C/m^2, -9.975 C/m^2, -9.503 C/m^2
multiplied by the volume (in a.u.), gives -19454, -19950, -19006
Test provided by S. Leroux
Going to bigger cells make these results converge to the same value :
Results with acell 30 20 20 are : -1.771 C/m^2, -1.746 C/m^2, -1.747 C/m^2
multiplied by the volume (in a.u.), gives -21252, -20952, -20964
Results with acell 40 20 20 are : -1.3167C/m^2, -1.3057C/m^2, -1.3062C/m^2
multiplied by the volume (in a.u.), gives -21067, -20891, -20899
Results with acell 50 20 20 are : -1.0502C/m^2, -1.0444C/m^2, -1.0450C/m^2
multiplied by the volume (in a.u.), gives -21004, -20888, -20900" data-toggle="popover" href="/tests/v6/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
HI 8 molecule per cell, the cell is triclinic (has to change tolsym as default is too permissive)
Prepare the density for the next Bader analysis." data-toggle="popover" href="/tests/v6/Input/t18.abi" target="_blank">t18.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated hydrogen atom
Calculation of the HF levels with different ways to integrate the Coulomb divergence" data-toggle="popover" href="/tests/v67mbpt/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-toggle="popover" href="/tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation
in (N,V,T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested
together with the three coordinate systems (primitive, normal mode, staging).
NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with
--- Pseudopotential description --" data-toggle="popover" href="/tests/v7/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2
Oxygen spin-temperature-dependent of the band energies" data-toggle="popover" href="/tests/v7/Input/t83.abi" target="_blank">t83.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-toggle="popover" href="/tests/v8/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation with constrained charges
Constrain the charge around atom 1 to the value 0.5, then work with both atoms and larger spheres

For dataset 2, the derivative wrt the constraint, the derivative of the total energy with respect to atomic displacement
and the stress calculations have been checked, as follows.

Initially, the total energy is -0.99164352451, the target charge is 0.5, and the gradient wrt the charge is computed -0.58356219787.
Changing the target charge by +0.001 gives etotal -0.99222576777
Changing the target charge by -0.001 gives etotal -0.99105864425
Finite-difference gives -0.5835617, in excellent agreement for that level of methodology.

For atom 1, dE/dtau (=-force in reduced coordinate) is computed 8.330114676.
Changing the atomic position of the first atom from -1.1 to -1.10015
gives etotal -0.99172669330, to -1.09985 gives etotal -0.99156009221, delivering 8.330054.
The result of a similar finite-difference estimation with twice bigger values gives 8.329896.
Combining both results to eliminate the quadratic error gives 8.330107, with an agreement of 5 digits with dE/dtau.

The stress is computed 2.755820639e-4 .
Multiplying both acell and xcart by 1.001 gives etotal -0.99122698240.
Multiplying both acell and xcart by 0.999 gives etotal -0.99205366103.
The derivative of total energy wrt to strain is thus 0.41333932. Dividing by the unit cell volume (1500) gives 2.75559e-4 ,
in excellent agreement for that level of methodology." data-toggle="popover" href="/tests/v8/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check the constrained DFT implementation in case nspden=2
DS2 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08
DS3 Constrains the collinear magnetization around atom 1 to be +0.08 and around atom 2 to be -0.08, and the total charge of both to be 0.69.
DS4 Constrains the collinear magnetization amplitude around atom 1 to be +0.08 and around atom 2 to be -0.08. Same result as DS2.
DS5 Constrains the collinear magnetization along axis z - not really useful simple sanity check" data-toggle="popover" href="/tests/v8/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="LiH molecule in a big box" data-toggle="popover" href="/tests/v9/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Antisymmetric vector potential response and quadrupoles of HF molecule" data-toggle="popover" href="/tests/v9/Input/t146.abi" target="_blank">t146.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Vector potential response and quadrupoles of HF molecule" data-toggle="popover" href="/tests/v9/Input/t147.abi" target="_blank">t147.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nsppol=2 and nspden=2.
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Wannier function for bcc Fe.
To check whether wannier90 interface works properly with nspinor=2  and nspden=4
Small accuracy parameters, small k-mesh and large test tolerance are used." data-toggle="popover" href="/tests/wannier90/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the cartesian coordinates of atoms within unit cell. This information is
redundant with that supplied by array <a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a>. By default,
 <strong>xcart</strong>  is given in Bohr atomic units (1 Bohr=0.5291772108 Angstroms),
although Angstrom can be specified, if preferred, since  <strong>xcart</strong>  has the <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a> characteristics.
If <a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a> are ABSENT from the input file and  <strong>xcart</strong>  is
provided, then the values of <a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a> will be computed from the provided
 <strong>xcart</strong>  (i.e. the user may use  <strong>xcart</strong>  instead of <a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a>
to provide starting coordinates).
One and only one of <a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a> or  <strong>xcart</strong>  must be provided.
Atomic positions evolve if <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a>/=0.</p>
<h2 id="xred"><strong>xred</strong><a class="headerlink" href="#xred" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> vectors (X) of atom positions in REDuced coordinates<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">EVOLVING</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,min(<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>,<a class="wikilink codevar-wikilink" href="/variables/geo#natrd">natrd</a>))<br />
<em>Commentdims:</em> represented internally as xred(3,<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>,<a class="wikilink codevar-wikilink" href="/variables/rlx#nimage">nimage</a>)<br />
<em>Default value:</em> <em>0.0<br />
*Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1034/1245] in all abinit tests, [113/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Graphene. Test wavelet run on surface" data-toggle="popover" href="/tests/bigdft/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si single atom with fractional occupation." data-toggle="popover" href="/tests/bigdft/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
KSS file generation for silicon with a different number of bands in the KSS
computation compared to ground-state." data-toggle="popover" href="/tests/etsf_io/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Same as 03 but run with newer Troullier-Martins psp
with core density PseudosTM_pwteter/14si.pspnc.  Start from wf.03 and run irdwfk=1.
Also iterated to convergence." data-toggle="popover" href="/tests/fast/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant by two different techniques" data-toggle="popover" href="/tests/seq/Input/tsv3_05.abi" target="_blank">tsv3_05.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wannier90 interface with NC pseudopotentials" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_4.abi" target="_blank">tw90_4.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="Crystalline silicon: computation of the total energy" data-toggle="popover" href="/tests/tutorial/Input/tbase3_1.abi" target="_blank">tbase3_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon: computation of the total energy
This input file will NOT work: nkpt does not agree
with ngkpt and shiftk. The error message will be given
in the &quot;log&quot; file." data-toggle="popover" href="/tests/tutorial/Input/tbase3_2.abi" target="_blank">tbase3_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : computation of the total energy
Convergence with respect to the number of k points." data-toggle="popover" href="/tests/tutorial/Input/tbase3_3.abi" target="_blank">tbase3_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW response function calculation of derivative of wavefunction (DDK)
Si with PAW dataset generated from uspp code. Computes derivative with
DFPT formalism, and also computes energies with displaced k+q so that
energies can be checked by finite differences." data-toggle="popover" href="/tests/v5/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the WFK, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-toggle="popover" href="/tests/v67mbpt/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the atomic locations within unit cell in coordinates relative to real
space primitive translations (<strong>NOT in cartesian coordinates</strong>). Thus these are
fractional numbers typically between 0 and 1 and are dimensionless. The
cartesian coordinates of atoms (in Bohr) are given by:
R_cartesian = xred1 * rprimd1 + xred2 * rprimd2 + xred3 * rprimd3
where (xred1,xred2,xred3) are the &ldquo;reduced coordinates&rdquo; given in columns of
&rdquo; <strong>xred</strong> &ldquo;, (rprimd1,rprimd2,rprimd3) are the columns of primitive vectors
array &ldquo;<a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>&rdquo; in Bohr.</p>
<p>If you prefer to work only with cartesian coordinates, you may work entirely
with &ldquo;<a class="wikilink codevar-wikilink" href="/variables/basic#xcart">xcart</a>&rdquo; and ignore  <strong>xred</strong> , in which case  <strong>xred</strong> 
must be absent from the input file.
One and only one of  <strong>xred</strong>  or <a class="wikilink codevar-wikilink" href="/variables/basic#xcart">xcart</a> must be provided.
Atomic positions evolve if <a class="wikilink codevar-wikilink" href="/variables/rlx#ionmov">ionmov</a>/=0.</p>
<p>The echo of <a class="wikilink codevar-wikilink" href="/variables/basic#xcart">xcart</a> in the main output file is accompanied by its echo in Angstrom,
named <code>xangst</code>.</p>
<h2 id="znucl"><strong>znucl</strong><a class="headerlink" href="#znucl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> charge -Z- of the NUCLeus<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify the types of atoms that form the system" data-toggle="popover" href="/topics/AtomTypes">topic_AtomTypes</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to master the use of norm-conserving pseudopotentials and PAW atomic data, and their consequences" data-toggle="popover" href="/topics/PseudosPAW">topic_PseudosPAW</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/gstate#npsp">npsp</a>)<br />
<em>Default value:</em> None<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [1220/1245] in all abinit tests, [147/159] in abinit tutorials</summary><ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk diamond, using the atomic data file generated in test 01" data-toggle="popover" href="/tests/atompaw/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
hcp iron - non magnetic - 2 atoms (metal)
Test the use of GPU within Norm-Conserving PseupoPotential formalism.
Test multidataset mode with different gpu_option values.
paral_kgb is activated." data-toggle="popover" href="/tests/gpu/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/gpu_kokkos/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Helium atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the non-spin-polarized case :
5 LDAs (Teter93, Perdew-Zunger, Wigner, Hedin-Ludqvist, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa)." data-toggle="popover" href="/tests/libxc/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Bismuth atom
Compare the results using the native XC library and the
corresponding ones of LibXC, in the spin-polarized case :
2 LDAs (Teter93, PW92)
7 GGAs (PBE, RPBE, HCTH93, HCTH120, HCTH147, HCTH407, WuCohen)
Results are excellent (better than 10 microHa), except for Wu Cohen (must be a bug somewhere)." data-toggle="popover" href="/tests/libxc/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk silicon, in the diamond structure, to compare with PSML results
from t05 and t09" data-toggle="popover" href="/tests/psml/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk iron, with and without spin-polarization, to compare with the PSML
results of t06 and t10" data-toggle="popover" href="/tests/psml/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-toggle="popover" href="/tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_01.abi" target="_blank">tdfpt_01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al linear response with k point parallelism" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_02.abi" target="_blank">tdfpt_02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule in a big box" data-toggle="popover" href="/tests/tutorial/Input/tbase1_1.abi" target="_blank">tbase1_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file to compute the total energy and forces as a function
of the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_2.abi" target="_blank">tbase1_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box
This file will optimize automatically the interatomic distance" data-toggle="popover" href="/tests/tutorial/Input/tbase1_3.abi" target="_blank">tbase1_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wyckoff positions of trigonal group" data-toggle="popover" href="/tests/v10/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
(see test.ge.xc0 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
with exchange-correlation (ixc=3). Uses 2 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector.
Same as test 1, except ixc and the k-points, and
except that it doesn&#x27;t uses multi-data mode, so GS and RF
calculations are separated.
(see test.ge.xc5 of RESPFN)" data-toggle="popover" href="/tests/v2/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bi A7 structure (2 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions. Treated as a semi-conductor
Test the response to atomic displacements,
with and without spin-orbit.
Perform first computation without spin-orbit.
Datasets 1-3 : frozen-phonon, without SO
Datasets 4 : RF, without SO
the comparison between frozen-phonon
from dataset 1 and 3 (2DTE=2.35465660)
and RF from dataset 4(2DTE=2.35465792)
is excellent.
Dataset 5 : GS, with nspinor=2, but no
spin-orbit yet.
Dataset 6 : RF, with nspinor=2, but no
spin-orbit yet. The agreement with
nspinor=1 RF is excellent.
Dataset 7-9 : frozen-phonon with spin-orbit
Dataset 10 : RF with spin-orbit.
The agreement is as good as without
spin-orbit ! Frozen-phonon 2DTE=2.48156,
RF 2DTE=2.48156 .
NOTE : the old t02.in file, which was giving
troubles in v3.1.2 is now called t02a.in" data-toggle="popover" href="/tests/v3/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of Ge2 molecules (2 atoms per unit cell),
using a local (Starkloff-Joannopoulos) pseudopotential,
and no exchange-correlation (ixc=0). Uses 4 k-points.
Computation of the second derivative of the total energy
with respect to a atomic displacement along the chain,
with q(0 0 0) wavevector. Similar to test v2 #1, except
that it uses dilatmx=1.1 ." data-toggle="popover" href="/tests/v3/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-toggle="popover" href="/tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-toggle="popover" href="/tests/v6/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the possibility to include a file into an input file
Diamond silicon with few k-points and low cut-off
The set of k-points is included in input file from another file" data-toggle="popover" href="/tests/v7/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-toggle="popover" href="/tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, nonmagnetic, GGA, PAW.
Test constrained DFT in non magnetic case." data-toggle="popover" href="/tests/v9/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + collinear spin case.
In dataset 1, unconstrained calculation, the atomic spin on atom 1 and 2 is 2.291834
In dataset 2, symmetric constrained calculation, the atomic spin on atoms 1 and 2 is 2.280003
with very minor deviation from the target 2.28
In dataset 2, unsymmetric constrained calculation, the atomic spin on atoms 1 and 2 are 2.250002 and 2.299998
with very minor deviations from the targets 2.28 and 2.30
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test constrained DFT in the PAW + non-collinear spin case (still collinear constraint, to start with).
At present the test does not work with the constraints on the charge." data-toggle="popover" href="/tests/v9/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives nuclear charge for each type of pseudopotential, in order.
If  <strong>znucl</strong>  does not agree with nuclear charge, as given in pseudopotential
files, the program writes an error message and stops.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the pseudopotential files,  <strong>znucl</strong>  is called &ldquo;zatom&rdquo;.</p>
</div>
<p>For a &ldquo;dummy&rdquo; atom, with  <strong>znucl</strong>  = 0, as used in the case of calculations
with only a jellium surface, ABINIT sets arbitrarily the covalent radius to one.</p>
                
                  
                
              

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://docs.abinit.org/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://docs.abinit.org/"
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              All Variables
            </div>
          </div>
        </a>
      
      
        <a href="../bse/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Bethe-Salpeter
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version b'10.2.3-dirty'</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": "b'10.2.3-dirty'"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>